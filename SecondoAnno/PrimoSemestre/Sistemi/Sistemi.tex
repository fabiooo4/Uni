\documentclass[a4paper]{article}
\usepackage{import}
\input{../../../preamble.sty}

\pgfplotsset{width=7cm}

\begin{document}

\input{title.tex}

\tableofcontents
\pagebreak

% Info:
% Esame: 4 esercizi. Si possono portare appunti, solo scritti a mano e non troppi.
% Libro: Segnali e sistemi (Giuseppe Ricci & Maria Elena Valeher)
% Libro2: Signals & systems second edition (Alan V. Oppenheim & Alan S. Willsky)
\section{Concetti base}
Un sistema è formato da \textbf{segnali trasmessi}, un'esempio di segnale
è la voce che usiamo per comunicare tra di noi. Il sistema prende le informazioni
ricevute dal segnale e le rielabora. 

\noindent 
Degli esempi di sistema sono:
\begin{itemize}
  \item Microfono-Casse
  \item Freno della macchina
\end{itemize}

\subsection{Tipi di segnali}
I segnali possono essere di due tipi:

\begin{itemize}
  \item \textbf{Segnali a tempo continuo}: Segnali che hanno infiniti punti per ogni
    infinitesimo di tempo.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-1,0) -- (5,0) node[right] {$t$};
        \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(t)$};
        \draw[domain=0:4.5,smooth,samples=100,variable=\x,blue] plot ({\x},{sin(\x*5 r)});
      \end{tikzpicture}
      \caption{Esempio di segnale a tempo continuo}
    \end{figure}
  \item \textbf{Segnali a tempo discreto}: Segnali che hanno un numero finito di punti
    per ogni intervallo di tempo.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-1,0) -- (5,0) node[right] {$k$};
        \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
        \draw[domain=0:4.5,smooth,variable=\x,white] plot ({\x},{sin(\x*5 r)});
        \foreach \x in {0,0.2,...,4.5}
       \draw[blue,thick] (\x,0) -- (\x,{sin(\x*5 r)});
      \end{tikzpicture}
      \caption{Esempio di segnale a tempo discreto}
    \end{figure}

\end{itemize}

\noindent
Per elaborare i dati attraverso un computer bisogna convertire un segnale continuo
in uno discreto, questo processo è chiamato \textbf{campionamento} e non è
\textbf{distruttivo}, cioè si può tornare indietro al segnale originale.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-1,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(t)$};
    \draw[domain=0:4.5,smooth,variable=\x] plot ({\x},{sin(\x*5 r)});
    \draw[domain=0:4.5,smooth,variable=\x,blue, thick] plot[ycomb, mark=*, mark size=1.5pt] ({\x},{sin(\x*5 r)});
  \end{tikzpicture}
  \caption{Esempio di campionamento}
\end{figure}

\noindent
Una volta campionato il segnale si deve \textbf{quantizzare}, ovvero approssimare
il valore del segnale a un valore discreto, questa operazione è \textbf{parzialmente
distruttiva}, cioè si può tornare indietro al segnale originale perdendo alcune
informazioni.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-1,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(t)$};
    \draw[domain=0:4.5,smooth,variable=\x,blue] plot[const plot] ({\x},{sin(\x*5 r)});
  \end{tikzpicture}
  \caption{Esempio di quantizzazione}
\end{figure}

Infine si fa \textbf{encoding}, ovvero
si codifica il segnale per poterlo adattare ad un altro tipo di segnale, questo
processo è \textbf{completamente distruttivo}.

\vspace{1em}
\noindent
I segnali possono essere di dimensioni diverse, ad esempio:
\begin{itemize}
  \item L'andamento di una borsa è un segnale a 1 dimensione.
  \item Una foto in bianco e nero è un segnale a 2 dimensioni \( (x,y) \).
  \item Una foto colorata è un segnale multidimensionale \( (x,y)^3 \) per
    rappresentare ogni colore (R,G,B).
\end{itemize}

\subsection{Rappresentazione dei sistemi}
Un sistema lo rappresentiamo con un blocco, dove all'ingresso mettiamo il segnale
in ingresso e all'uscita il segnale in uscita.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {\( \Sigma \) };
    \draw[->] (-1,0) -- (A) node[midway,above left] {$\stackrel{u(t)}{\text{Ingresso}}$};
    \draw[->] (A) -- (1,0) node[midway,above right] {$\stackrel{v(t)}{\text{Uscita}}$};
  \end{tikzpicture}
  \caption{Rappresentazione di un sistema}
\end{figure}

\noindent
L'output di un sistema può essere rielaborato per essere inserito nuovamente come
input in un altro sistema, ad esempio:

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {\( \Sigma \) };
    \draw[->] (-1,0) -- (A) node[midway,above left] {$\stackrel{u(t)}{\text{Ingresso}}$};
    \draw[->] (A) -- (1,0) node[midway,above right] {$\stackrel{v(t)}{\text{Uscita}}$};

    \node[draw,minimum width=1cm,minimum height=1cm] (B) at (0,-1.5) {\( G \) };
    \draw[<-] (-0.75,0) |- (B) node[midway,above left] {};
    \draw[<-] (B) -| (0.75,0) node[midway,above right] {};
  \end{tikzpicture}
  \caption{Rappresentazione di due sistemi in cascata}
\end{figure}

\section{Notazioni}
Tutti i segnali sono indicati con la lettera minuscola, ad esempio:
\[
  \underbrace{f}_{segnale} \quad \underbrace{f(t)}_{\text{segnale a tempo continuo}}
\] 
Oppure si utilizzano delle notazioni standard:
\begin{enumerate}
  \item \( t,\;\tau,\;t_i \): tempo continuo
  \item \( k \): tempo discreto
\end{enumerate}

\noindent
In questo corso si considerano solo segnali continui o discreti monodimensionali
non negativi e solo sistemi \textbf{LTI} (Lineari e Tempo Invarianti):
\begin{enumerate}
  \item \textbf{Lineare}: Vale la \textbf{sovrapposizione degli effetti}, cioè se \( v_1(t) \)
    è l'uscita del sistema per \( u_1(t) \) e \( v_2(t) \) è l'uscita del sistema
    per \( u_2(t) \) allora \( v_1(t) + v_2(t) \) è l'uscita del sistema per
    \( u_1(t) + u_2(t) \).
  \item \textbf{Tempo Invariante}: A prescindere dal punto di tempo in cui si
    applica il segnale, l'uscita del sistema è sempre la stessa.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-0.2,0) -- (6,0) node[right] {$t$};
        \draw[->] (0,-0.2) -- (0,2.2) node[above] {$u(t)$};
        \draw[blue, domain=0:6, smooth] plot ({\x},{sin((cos(\x r) * \x - 3)/2 r)+1});

        \node[draw,minimum width=1cm,minimum height=1cm] (A) at (3,-2) {\( \Sigma \) };
        \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
        \draw[->] (A) -- ++(0,-1) node[midway,above right] {};
        \node[below left, blue] at (0,0) {$t_0$};

        \draw[->] (-0.2,-5) -- (6,-5) node[right] {$t$};
        \draw[->] (0,-5.2) -- (0,-3.2) node[above] {$v(t)$};
        \draw[red, domain=0:6, samples=100, smooth, yshift=-5cm] plot ({\x},{sin((cos(2*\x r) * \x - 3)/2 r)+1});
        \node[below left, red] at (0,-5) {$t_0$};
      \end{tikzpicture}
    \end{figure}
    \[
      t_1 = t_0 + t_n
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-0.2,0) -- (6,0) node[right] {$t$};
        \draw[->] (0,-0.2) -- (0,2.2) node[above] {$u(t)$};
        \node[below left] at (0,0) {$t_0$};
        \draw[blue, domain=0:5, smooth] plot ({\x + 1},{sin((cos(\x r) * \x - 3)/2 r)+1});
        \node[below, blue] at (1,0) {$t_1$};

        \node[draw,minimum width=1cm,minimum height=1cm] (A) at (3,-2) {\( \Sigma \) };
        \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
        \draw[->] (A) -- ++(0,-1) node[midway,above right] {};
        \draw[blue] (0.1,0.1) -- ++(0,0.2) -- ++(0.9,0) node[midway, above, blue] {$t_n$} -- ++(0,-0.2);

        \draw[->] (-0.2,-5) -- (6,-5) node[right] {$t$};
        \draw[->] (0,-5.2) -- (0,-3.2) node[above] {$v(t)$};
        \draw[red, domain=0:5, samples=100, smooth, yshift=-5cm] plot ({\x + 1},{sin((cos(2*\x r) * \x - 3)/2 r)+1});
        \node[below, red] at (1,-5) {$t_1$};
        \draw[red] (0.1,-4.9) -- ++(0,0.2) -- ++(0.9,0) node[midway, above, red] {$t_n$} -- ++(0,-0.2);
      \end{tikzpicture}
      \caption{Esempio di invarianza nel tempo}
    \end{figure}
\end{enumerate}

\noindent
I sistemi vengono rappresentati con lettere maiuscole greche o non.

\section{Modello di sistemi}
\subsection{Approccio classico}
Questo approccio prevede di avere un \textbf{evento fisico} (circuito, molla, ecc...) e per
questo evento bisogna definire un \textbf{modello} del sistema. Questo si può fare attraverso
degli strumenti grafici o matematici. Come strumenti matematici si usano:
\begin{enumerate}
  \item \textbf{Continuo}: 
    \begin{enumerate}
      \item Equazioni differenziali
      \item Trasformate di Laplace
      \item Trasformate di Fourier
    \end{enumerate}
  \item \textbf{Discreto}: 
    \begin{enumerate}
      \item Equazioni alle differenze
      \item Trasformate Z
    \end{enumerate}
\end{enumerate}

\noindent Una volta modellato l'evento fisico si può fare un'analisi del sistema
e ciò permette di descrivere la \textbf{stabilità} e le \textbf{proprietà} del sistema.

\noindent
L'ultima fase è quella di \textbf{sintesi}, cioè la fase di correzione del sistema
per far si che risulti stabile.

\subsection{Approccio moderno}
L'approccio moderno ha solo un blocco per rappresentare gli stati:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {Stati};
    \draw[->] (-1,0) -- (A) node[midway,above left] {Ev. Fisico};
  \end{tikzpicture}
  \caption{Rappresentazione di un sistema con l'approccio moderno}
\end{figure}

\subsection{Obsolescenza}
L'obsolescenza è il numero di anni che un sistema può durare. I sistemi che
verranno studiati sono quelli che si trovano nella sezione di comportamento lineare,
cioè i sistemi che non cambiano nel tempo.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Define constants
    \def\A{1}
    \def\C{1}
    \def\xone{-2}
    \def\xtwo{2}

    % Left quadratic part: A(x - x1)^2
    \draw[blue, thick, domain=-4:\xone, samples=100] 
      plot (\x, {\A*(\x - \xone)^2 + \C});

    % Middle constant part: C
    \draw[blue, thick] 
      plot[domain=\xone:\xtwo] (\x, {\C});

    % Right quadratic part: A(x - x2)^2
    \draw[blue, thick, domain=\xtwo:4, samples=100] 
      plot (\x, {\A*(\x - \xtwo)^2 + \C});

    % Axes
    \draw[->] (-4.2,0) -- (4.5,0) node[right] {$x$};
    \draw[->] (-4,-0.5) -- (-4,5) node[above] {$y$};

    % Labels
    \node[above] at (0, 1) {Comportamento lineare};
  \end{tikzpicture}
  \caption{Sezione di comportamento lineare}
\end{figure}

\noindent
Un'esempio è una molla che si deforma in base alla forza applicata, quando essa
si deforma assume un comportamento plastico e quindi non lineare,
mentre quando non si deforma assume un comportamento elastico e quindi lineare.

\subsection{Causalità}
La causalità è l'input del sistema e l'effetto è l'output che produce, quindi
la causa precede sempre l'effetto. Non esiste un sistema causale che abbia
l'output prima dell'input.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Define constants
    \def\A{-0.4}      % Amplitude
    \def\lambda{0.2}  % Damping factor
    \def\omega{-1.1}     % Angular frequency
    \def\phi{-6.9}       % Phase shift
    \def\offset{-6.7}         % X Offset


    \draw[->] (-0.5,0) -- (6,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,1.5) node[above] {$u(t)$};

    \draw[domain=0:5.9,smooth,tension=0.8,blue] plot ({\x}, {2.2*\x*exp(-0.8*\x)})
      node[above right] {$u(t)$};

    \draw[domain=1:5.9,smooth,tension=0.8,red] plot ({\x}, 
      {\A*exp(-\lambda*(\x + \offset)) * cos((\omega * (\x + \offset) + \phi) r) + 1})
      node[above] {$v(t)$};

    \node[blue] at (0,0) [below left] {$t_0$};
    \node[red] at (1,0) [below] {$t_1$};

    \node at (3,-1) {$\color{blue} t_0 \color{black} < \color{red} t_1$};
  \end{tikzpicture}
  \caption{Esempio di causalità}
\end{figure}

\subsection{Stabilità}
Un sistema è stabile se, a seguito di un'oscillazione, ritorna al suo stato
di equilibrio e il sistema si ferma. Un sistema è instabile se, a seguito di un'oscillazione,
si allontana dal suo stato di equilibrio.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Axis
    \draw[->] (-0.2,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,3) node[above] {$y$};

    \draw[red, domain=-2:1, samples=100, smooth] plot ({\x+2},{exp(\x)});
  \end{tikzpicture}
  \caption{Sistema instabile}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Axis
    \draw[->] (-0.2,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-0.7) -- (0,2) node[above] {$y$};

    \draw[red, domain=0.001:3.9, samples=100, smooth] plot ({\x},{sin(5*\x r)/(3*\x)});
  \end{tikzpicture}
  \caption{Sistema stabile}
\end{figure}

\noindent
Ci sono 2 tipi di stabilità:
\begin{itemize}
  \item \textbf{Stabilità asintotica} \( \to  \forall\;i \;\; \Re{\lambda_i} < 0\) 
  \item \textbf{Stabilità BIBO} verificare che \( h(t) \) sia integrabile:
    \[
      \int_{-\infty}^{+\infty} h(t) \, dt < +\infty
    \] 
\end{itemize}

\subsubsection{Stabilità BIBO (Bounded Input Bounded Output)}
Se il segnale di ingresso è limitato in ampiezza allora il segnale di uscita
è limitato in ampiezza.
\[
\exists M > 0,\; | u(t) | < M \; \forall t \in \mathbb{R}
\] 
\[
\Downarrow
\] 
\[
  \exists N > 0,\; | v(t) | < N \; \forall t \in \mathbb{R}
\] 
\[
  \text{con} \; M,N \in \mathbb{R}\; \text{non per forza uguali}
\] 

\begin{figure}[H]
  \centering
  \begin{tikzpicture}[]
    % Input graph
    \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-2) -- (0,2) node[above] {$u(t)$};
    \draw[blue, domain=0.001:4.8, samples=100, smooth] plot ({\x},{sin(\x*\x r)/(0.5*\x)});
    \draw[blue, dashed] (4.8,1.7) -- (0,1.7) node[left] {$M$};
    \draw[blue, dashed] (4.8,-0.92) -- (0,-0.92) node[left] {$-M$};

    % System
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
    \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
    \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

    % Output graph
    \draw[->] (0,-8) -- (0,-4) node[above] {$v(t)$};
    \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
    \draw[red, domain=0.001:4.8, samples=200, smooth] plot ({\x},{sin(\x*\x*\x*0.5 r)/(0.7*\x) - 6});
    \draw[red, dashed] (4.8,-5) -- (0,-5) node[left] {$N$};
    \draw[red, dashed] (4.8,-6.65) -- (0,-6.65) node[left] {$-N$};
  \end{tikzpicture}
  \caption{Esempio di sistema stabile BIBO}
\end{figure}

\subsubsection{Stabilità Asintotica}
Se il segnale di ingresso si annulla allora il segnale di uscita si annulla.
\[
\lim_{t \to \infty} v(t) = 0 \;\; \forall r \; \text{di} \; u(t),\; t \in \mathbb{R}
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[]
    % Input graph
    \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-2) -- (0,2) node[above] {$u(t)$};
    \draw[blue, domain=0.001:4.8, samples=100, smooth] plot ({\x},{(sin((\x*5)/2 r))/(1.3*\x)});
    \node[above, blue, scale=0.8, yshift=0.2cm] at (5,0) {$\lim_{t \to \infty} = 0$};

    % System
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
    \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
    \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

    % Output graph
    \draw[->] (0,-8) -- (0,-4) node[above] {$v(t)$};
    \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
    \draw[red, domain=0.001:4.8, smooth] plot ({\x},{sin(\x*5 r)/(2.5*\x) - 6});
    \node[above, red, scale=0.8, yshift=0.2cm] at (5,-6) {$\lim_{t \to \infty} = 0$};
  \end{tikzpicture}
  \caption{Esempio di sistema stabile asintotico}
\end{figure}

\noindent
La stabilità asintotica implica la stabilità BIBO, ma non viceversa.

\section{Modello di segnali}
Un segnale si può scrivere nel seguente modo:
\[
\alpha \in \mathbb{C}
\] 
\[
  t \in \mathbb{R}
\] 
\[
l \in \mathbb{Z}
\] 

\[
  y(t) = \sum_{i} \sum_{j} c_{ij} \cdot \color{blue} \underbrace{e^{\alpha t}}_{\text{Parte esponenziale}}
  \color{black} \cdot \color{green!50!black} \underbrace{\frac{t^l}{l!}}_{\text{Parte polinomiale}}
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,3) node[above] {$y(t)$};
    \draw[domain=-3:1.1,smooth,variable=\x,blue] plot ({\x},{exp(\x)}) node[above right, scale=0.9] {$e^{\alpha t} \;\; (\alpha > 0)$};
    \draw[domain=-1.1:3,smooth,variable=\x,cyan] plot ({\x},{exp(-\x)}) node[above right, scale=0.9] {$e^{\alpha t} \;\; (\alpha < 0)$};
    \draw[domain=0:3,smooth,variable=\x,green!50!black] plot ({\x},{\x}) node[above right, scale=0.9] {$t$};

    \draw[->] (0,-1) -- ++(0,-1) node[midway, right] {Risultato};

    \draw[->,yshift=1cm] (-3.2,-6) -- (3,-6) node[right] {$t$};
    \draw[->,yshift=1cm] (-3,-6.2) -- (-3,-4) node[above] {$y(t)$};
    \draw[domain=0:5.9,smooth,tension=0.8,red,yshift=-5cm,xshift=-3cm] plot ({\x}, {2.2*\x*exp(-0.8*\x)});
  \end{tikzpicture}
  \caption{Esempo di segnale}
\end{figure}

\noindent
Ad esempio con \( l = 1 \):
\[
  y(t) = \sum_{i} \sum_{j} c_{ij} \cdot e^{\alpha t} \cdot \frac{t^1}{1!} =
  \sum_{i} \sum_{j} c_{ij} \cdot e^{\alpha t} \cdot t
\] 

\noindent
Con \( \alpha < 0 \) il sistema è stabile perchè l'esponenziale tende a 0.

\vspace{1em}
\noindent 
Con \( l = 2 \):
\[
  y(t) = \sum_{i} \sum_{j} c_{ij} \cdot e^{\alpha t} \cdot \frac{t^2}{2!} =
  \sum_{i} \sum_{j} c_{ij} \cdot e^{\alpha t} \cdot \frac{t^2}{2}
\]
ecc...

\vspace{1em}
\noindent
Siccome \( \alpha \in \mathbb{C} \) si può riscrivere come:
\[
\alpha = \lambda + j \omega
\] 
\[
  \lambda \text{ è la parte reale}
\] 
\[
  j \omega \text{ è la parte immaginaria}
\] 
Quindi il segnale diventa:
\[
  y(t) = \sum_{i} \sum_{j} c_{ij} \cdot e^{\lambda t} \cdot e^{j \omega t} \cdot \frac{t^l}{l!}
\] 
Utilizzando la forma trigonometrica dei numeri complessi si ha che:
\[
  e^{j \omega} = \cos(\omega t) + j \sin(\omega t)
\] 
\[
  e^{(\lambda + j \omega)} = e^{\alpha t} = \rho (cos(\omega t) + j \sin(\omega t))
\] 
Per le formule di Eulero che dice:
\[
  cos\theta = \frac{e^{j \theta} + e^{-j \theta}}{2}
\] 
\[
  sin\theta = \frac{e^{j \theta} - e^{-j \theta}}{2j}
\]
\begin{figure}[H]
  \begin{definition}[Complesso cognugato]
    A ogni numero complesso è associato un cognugato che ha la stessa parte reale,
    ma parte immaginaria opposta.
  \end{definition}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
    \draw[->] (0,-3) -- (0,3) node[above] {$\Im$};

    \draw (0,0) circle (2.5);
    
    \draw[-*,blue,dashed,rotate=45] (0,0) -- (2.6,0) node[midway,above left] {$\rho$} 
      node[above right] {$S$} node (s) {};
    \draw[blue] (1,0) arc (0:45:1) node[midway, right] {$\Theta$};

    \draw[-*,red,dashed,rotate=-45] (0,0) -- (2.6,0) node[midway,below left] {$\rho$} 
      node[below right] {$\bar{S}$} node (bars) {};
    \draw[red] (1,0) arc (0:-45:1) node[midway, right] {$\Theta$};

    \draw[dashed] (s) -- (bars);
  \end{tikzpicture}
  \caption{Circonferenza di proiezione}
\end{figure}
\[
  \color{blue} S = \rho (cos(\theta) + j \sin(\theta)) \color{black}
\] 
\[
  \color{red} \bar{S} = \rho (cos(-\theta) + j \sin(-\theta)) \color{black}
\]
\section{Funzioni in \texorpdfstring{\( \mathbb{C} \)}{C}}
\subsection{Funzione a variabili complesse}
\begin{figure}[H]
  \begin{definition}[Funzione a variabile complessa]
    Una funzione a variabile complessa è una funzione che ha come dominio un insieme
    di numeri complessi e come codominio un insieme di numeri complessi.
  \end{definition}
\end{figure}

\begin{figure}[H]
  \begin{definition}[Punto interno]
    Un punto \( S_0 \) appartenente a un intorno \( D(f) \subseteq \mathbb{C} \) è
    interno a \( D(f) \) se e solo se esiste un disco \( B_\rho(S_0) \)  di raggio \( \rho \in \mathbb{R}_+ \) 
    centrato in \( S_0 \) tale che:
    \[
      B_\rho(S_0) \subset D(f)
    \] 
    Quindi \( D(f) \) è un dominio e \( B_\rho(S_0) \) è un sottoinsieme:
    \[
      B_\rho(S_0) = \left\{ S \in \mathbb{C} \;|\; \|S_0 - S\| < \rho \right\}
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \def\r{1}
        \def\s{(2,2)}
        \def\d{\r * 2.5}

        \draw[->] (-2,0) -- (5,0) node[right] {$\mathbb{C}$};
        \draw[->] (0,-2) -- (0,5) node[above] {};
        \draw[green!50!black] \s circle (\r);
        \draw[blue] \s ++(-0.5,-0.7) circle (\d);
        \draw[fill=black] \s circle (0.05) node[above right] {$S_0$};
        \draw[fill=black] \s ++(\r,0) circle (0.05) node[above right] {$S$};
        \draw[<->] \s -- ++(\r,0) node[midway, below] {$\rho$};
        \node[green!50!black] at (2,1) [below] {$B_\rho(S_0)$};
        \node[blue] at (1.5,3.8) [above] {$D(f)$};
      \end{tikzpicture}
    \end{figure}
  \end{definition}
\end{figure}

\begin{definition}[Insieme aperto]
  È l'insieme di tutti i punti che sono definiti interni.

  \vspace{1em}
  \noindent
  Ad esempio:
  \begin{itemize}
    \item insieme \( \mathbb{C} \) 
    \item insieme \( \emptyset \) 
    \item i dischi in un punto \( S_0 \), \( B_{\rho}(S_0) = \left\{ S \in \mathbb{C} \;|\; \|S_0 - S\| < \rho \right\} \) 
    \item corone circolari centrate in un punto \( x \) ,
      \[
        \; \left\{ S \in \mathbb{C},\;
          \rho_1, \rho_2 \in \mathbb{R} \;|\;
        \rho_1 <  |S-x| < \rho_2\right\}
      \]
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          \def\r{1}
          \def\s{(1,3)}
          \def\d{1.5}
          \def\x{(3.5,1.5)}

          \draw[->] (-2,0) -- (5,0) node[right] {$\mathbb{C}$};
          \draw[->] (0,-2) -- (0,5) node[above] {};
          \draw[green!50!black] \s circle (\r);
          \draw[blue] \x circle (\d);
          \draw[blue] \x circle (\d/2);
          \draw[fill=black] \s circle (0.05) node[above right] {$S_0$};
          \draw[fill=black] \x circle (0.05) node[above right] {$x$};
          \draw[<->] \x -- ++(\d/2,0) node[midway, below] {$\rho_1$};
          \draw[<->] \x ++(\d/2,0) -- ++(\d/2,0) node[midway, below] {$\rho_2$};
          \node[green!50!black] at (1,3.6 + \r) [below] {$B_\rho(S_0)$};
        \end{tikzpicture}
      \end{figure}
    \item semipiani destri o sinistri, superiori o inferiori
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          \def\pdx{1.5}
          \def\psx{-1.5}

          \def\psp{1.5}
          \def\pif{-1.5}


          \def\x{3}
          \def\y{3}
          \draw[->] (-\x,0) -- (\x,0) node[right] {$\Re$};
          \draw[->] (0,-\y) -- (0,\y) node[above] {$\Im$};

          \draw[red,dashed] (\psx,\y) -- (\psx,-\y);
          \draw[red,fill,opacity=0.2] (-\x,\y) rectangle (\psx,-\y);

          \draw[blue,dashed] (\pdx,\y) -- (\pdx,-\y);
          \draw[blue,fill,opacity=0.2] (\pdx,\y) rectangle (\x,-\y);


          \draw[green!50!black,dashed] (-\x,\psp) -- (\x,\psp);
          \draw[green!50!black,fill,opacity=0.2] (-\x,\psp) rectangle (\x,\y);

          \draw[cyan,dashed] (-\x,\pif) -- (\x,\pif);
          \draw[cyan,fill,opacity=0.2] (-\x,-\y) rectangle (\x,\pif);

          \node[red,left,align=right] at (-\x,0) {$\Pi_1$\\Semipiano\\Sinistro};
          \node[blue,right,xshift=0.5cm,align=left] at (\x,0) {$\Pi_2$\\Semipiano\\Destro};
          \node[green!50!black,above,yshift=0.5cm,align=center] at (0,\y) {Semipiano\\Superiore\\$\Pi_3$};
          \node[cyan,below,align=center] at (0,-\y) {$\Pi_4$\\Semipiano\\Inferiore};
        \end{tikzpicture}
      \end{figure}
  \end{itemize}
\end{definition}

\subsection{Funzioni complesse}
\[
f: D(f) \to \mathbb{C} \quad D(f) \subseteq \mathbb{C} \text{ e aperto}
\] 
Alcuni esempi sono:
\begin{itemize}
  \item \( S \to S \quad D(f) = \mathbb{C} \) 
  \item \( S \to S^2 \quad D(f) = \mathbb{C} \) 
  \item \( S \to \Re(S) + j \Im(S)^2 \quad D(f) = \mathbb{C} \) 
  \item \( S \to \sum_{k=0}^{n} a_k^S \quad a_k \in \mathbb{C};\;\; k,\;n \in \mathbb{Z} \)
    (Funzioni polinomiali)
  \item \( \sum_{k=0}^{\infty} a_k (S - S_0)^k \quad a_k \in \mathbb{C};\;\; S,\;S_0 \in \mathbb{C};\;\; k \in \mathbb{Z}\) 
    (Serie di potenze)
\end{itemize}

\subsection{Funzioni polinomiali}
\[
  P(s) = \sum_{k=0}^{n} a_k \cdot \underbrace{S^k}_{\text{Variabile complessa}}
\] 
Con \( n=2 \):
\[
a_0 S^0 + a_1 S^1 + a_2 S^2
\] 
Con \( n=3 \):
\[
a_0 S^0 + a_1 S^1 + a_2 S^2 + a_3 S^3
\] 
\subsubsection{Risoluzione}
Per risolvere una funzione polinomiale si usano le solite tecniche, ad esempio:
\[
S^2-2S+1 = (S-1)^2
\] 
Che ha una sola soluzione, ma con molteplicità 2.

\begin{figure}[H]
  \begin{theorem}[Teorema fondamentale delle radici]
    Ogni polinomio \( P(S) \) a coefficienti complessi di grado \( n > 0 \) ha
    \( n \) \textbf{radici complesse} ed è decomponibile in un solo modo
    \[
      P(s) = a_n \prod_{r=1}^{r} (s - s_r)^{\mu_r}
    \] 
    Dove:

    \noindent
    \( s_r \) sono delle radici

    \noindent \( \mu_r \) sono le molteplicità delle radici

    \noindent \( a_n \) è il coefficiente del polinomio

    \vspace{1em}
    \noindent
    \( \sum_{r=1}^{\infty} \mu_r = n \) 
  \end{theorem}
\end{figure}

\section{Segnali}
Il segnale più presente è quello \textbf{sinusoidale}.
\subsection{Segnali continui}
\[
t \in \mathbb{R}\;\; \mathbb{R} \to \mathbb{C};\;\; \mathbb{R} \to \mathbb{R}
\] 

\subsubsection{Sinusoidale}
\[
x(t) = A \cdot cos(\omega_0 t + \phi) 
\] 
Dove:
\begin{itemize}
  \item \( A \) è l'ampiezza
  \item \( \omega \) è la frequenza \( f = \frac{1}{T} \) (\( T = \text{ periodo} \) )
  \item \( \phi \) è la fase
\end{itemize}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$k$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
    \draw[blue,domain=-3:3,samples=100] plot ({\x},{cos(\x*5 r)});

    \draw (1.25,1) -- ++(0,0.2) -- ++(1.25,0) node[midway,above] {$T_0 = \frac{2\pi}{\omega_0}$} -- ++(0,-0.2);

    \draw[fill] (-2.3,0.5) circle (1pt) node[above right, xshift=-2, scale=0.8] {$A cos\phi$};
  \end{tikzpicture}
  \caption{Funzione sinusoidale}
\end{figure}

\begin{itemize}
  \item \textbf{Periodico}
    \[
      x(t) = x(t + T_0)
    \] 
    \[
      A cos(\omega_0 t + \phi) = A cos(\omega_0 t + \omega_0 T_0 + \phi)
    \] 
    \[
      T_0 = \frac{2 \pi m}{\omega_0} \to \text{ periodo } \frac{2\pi}{\omega_0} \quad m \in \mathbb{R} \text{ (indica il multiplo)}
    \] 
    Il sistema si comporta nello stesso modo per ogni periodo.

  \item \textbf{Shift temporale} equivale ad un cambio di fase
    \[
      A cos[\omega_0 (t - t_0)] = A cos(\omega_0t + \underbrace{\omega_0t_0}_{\Delta \phi})
    \] 
    \[
      A cos[\omega_0 (t+t_0) + \phi] = A cos(\omega_o t + \omega_0 t_0 + \phi)
    \] 

  \item Se \( \phi = 0 \) Il segnale assume la seguente forma:
    \[
    A = cos(\omega_0 t)
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-3,0) -- (3,0) node[right] {$k$};
        \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
        \draw[blue,domain=-3:3,samples=100] plot ({\x},{cos(\x*3 r)});

        \draw[blue,fill] (0,1) circle (1pt) node[above right, blue] {$A$};
        \draw[blue,fill] (0,-1) circle (1pt) node[right, blue] {$-A$};
      \end{tikzpicture}
      \caption{Funzione coseno}
    \end{figure}

    e ha le seguenti proprietà:
    \begin{itemize}
      \item Periodico
        \[
        T_0 = \frac{2\pi}{\omega_o}
        \] 
      \item Pari
        \[
          x(t) = x(-t)
        \] 
    \end{itemize}
    Se \( \phi = -\frac{\pi}{2} \) Il segnale assume la seguente forma:
    \[
    x(t) = \begin{cases}
      A cos(\omega_0 t - \frac{\pi}{2})\\
      A sin(\omega_0 t)\\
      A cos(\omega_0 (t + \frac{T_0}{4}))
    \end{cases}
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-3,0) -- (3,0) node[right] {$k$};
        \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
        \draw[blue,domain=-3:3,samples=100] plot ({\x},{sin(\x*3 r)});
      \end{tikzpicture}
      \caption{Funzione seno}
    \end{figure}
    e ha le seguenti proprietà:
    \begin{itemize}
      \item Periodico
        \[
        T_0 = \frac{2\pi}{\omega_0}
        \] 
      \item Dispari
        \[
        x(t) = -x(-t)
        \] 
    \end{itemize}
\end{itemize}

\subsubsection{Esponenziali reali}
\[
  x(t) = C e^{\alpha t}
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,3) node[above] {$x(t)$};
    \draw[domain=-3:1.1,smooth,variable=\x,blue] plot ({\x},{exp(\x)}) node[above right, scale=0.9] {$e^{\alpha t} \;\; (\alpha > 0)$};
    \draw[fill] (0,1) circle (0.03) node[right] {C};
  \end{tikzpicture}
  \caption{Esempo di segnale}
\end{figure}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,3) node[above] {$x(t)$};
    \draw[domain=-1.1:3,smooth,variable=\x,cyan] plot ({\x},{exp(-\x)}) node[above right, scale=0.9] {$e^{\alpha t} \;\; (\alpha < 0)$};
    \draw[fill] (0,1) circle (0.03) node[right] {C};
  \end{tikzpicture}
  \caption{Esempo di segnale}
\end{figure}

\begin{itemize}
  \item \textbf{Shift Temporale}
    \[
      C e^{\alpha(t+t_0)} = C e^{\alpha t} \cdot \underbrace{C e^{\alpha t_0}}_{\mathbb{R}}
    \] 
\end{itemize}

\subsubsection{Esponenziali complessi}
\[
  x(t) = C e^{\alpha t}
\] 
\[
  C = |c| e^{j \Theta} \text{ (polare)}
\] 
\[
  \alpha = r + j \omega_o \text{ (cartesiana)}
\] 
\vspace{1em}
\[
  x(t) = |c| e^{j \Theta} \cdot e^{(r + j \omega_0)t} =
\] 
\[
 = |c| e^{rt} \cdot e^{j(\omega_0 t + \Theta)} \text{ (Eulero)}
\] 
\begin{definition}[Eulero]
  La formula di Eulero è la seguente:
  \[
    e^{j(\omega_0 t + \Theta)} = cos(\omega_0 t + \Theta) + j sin(\omega_0 t + \Theta)
  \] 
\end{definition}

\[
  x(t) = |c| e^{rt} \cdot (cos(\omega_0 t + \Theta) + j sin(\omega_0 t + \Theta))
\] 

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-3.5) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{-exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {};
    \draw[domain=-4:4,smooth,variable=\x,blue,samples=70] plot ({\x},{exp(\sigm*\x)*cos(\omeg*\x r)}) node[above right, scale=0.9,align=center] {$r>0$};
  \end{tikzpicture}
  \caption{Esponenziale sinusoidale continuo con \( r > 0 \)}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{-0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-3.5) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{-exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {};
    \draw[domain=-4:4,smooth,variable=\x,blue,samples=70] plot ({\x},{exp(\sigm*\x)*cos(\omeg*\x r)}) node[above right, scale=0.9,align=center] {$r>0$};
  \end{tikzpicture}
  \caption{Esponenziale sinusoidale continuo con \( r < 0 \)}
\end{figure}



\subsection{Segnali discreti}
\[
k \in \mathbb{Z}\;\; \mathbb{Z} \to \mathbb{Z};\;\; \mathbb{Z} \to \mathbb{R};\;\; \mathbb{Z} \to \mathbb{C}
\] 
\subsubsection{Sinusoidale}
\[
  x[n] = A cos(\Omega_0 n + \phi)
\] 
Dove:
\begin{itemize}
  \item \( A \) è l'ampiezza
  \item \( \Omega_0 \) è la frequenza \( f = \frac{\Omega_0}{2\pi} \) 
  \item \( \phi \) è la fase
\end{itemize}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$k$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
    \draw[domain=-3:3,smooth,variable=\x,red,thin,samples=100] plot ({\x},{sin(\x*5 r)}) node[above right, red] {Inviluppo};
    \foreach \x in {-3,-2.8,...,3}
    \draw[blue,thick] (\x,0) -- (\x,{sin(\x*5 r)});
  \end{tikzpicture}
  \caption{Esempio di segnale sinusoidale discreto}
\end{figure}

\begin{itemize}
  \item \textbf{Shift temporale} equivale ad un cambio di fase
    \[
      A cos[\Omega_0 (n + n_0)] = A cos(\Omega_0 n + \underbrace{\Omega_0 n_0}_{\Delta \phi})
    \] 

  \item Se \( \phi = 0 \) Il segnale rimane coseno ed è pari
    \[
      x[n] = x[-n]
    \] 
    Se \( \phi = -\frac{\pi}{2} \) Il segnale diventa un seno ed è dispari:
    \[
      x[n] = -x[-n]
    \] 
\end{itemize}

\begin{itemize}
  \item Il cambio di fase equivale allo shift temporale?
    \[
      A cos[\Omega_0 (n + n_0)] \stackrel{?}{=} A cos[\Omega_0 n + \Omega_0 \omega_0 \phi]
    \] 
    dove \( \phi \) è il rapporto tra \( \phi \) e \( \Omega_0 \) è un numero intero:
    \[
    \phi = \Omega_0 \omega_0
    \] 
    \[
    \frac{\phi}{\Omega_0} = n_0
    \] 
    \begin{figure}[H]
      \begin{example}
        \begin{figure}[H]
          \centering
          \begin{tikzpicture}
            \draw[->] (-3,0) -- (3,0) node[right] {$k$};
            \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
            \draw[blue,domain=-3:3,samples=100] plot ({\x},{sin(\x*3 r)});
            \draw[blue,domain=-3:3] plot[ycomb] ({\x},{sin(\x*3 r)});
          \end{tikzpicture}
          \caption{Calcolo del cambio di fase}
        \end{figure}
        \[
          \phi = \frac{2\pi}{12}
        \] 
        \[
        \Omega_0 = ?
        \] 
        \[
          \frac{2\pi}{\Omega_0} = \frac{2\pi}{12} = 12 = \Omega_0 \quad (m = 1)
        \] 
      \end{example}
    \end{figure}
\end{itemize}


\subsubsection{Esponenziali Reali}
\[
  x[n] = C e^{\beta n} = C \alpha^n \quad \alpha = e^\beta;\;\; C,\;\alpha \in \mathbb{R}
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-0.2) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,blue,samples=50] plot[ycomb] ({\x},{exp(\sigm * \x)}) node[below right,scale=0.9,align=center] {$\alpha > 0$\\$|\alpha| > 1$};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
  \end{tikzpicture}
  \caption{Esponenziale reale con \( \alpha > 0 \; |\alpha| > 1 \)}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{-0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-0.2) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,blue,samples=50] plot[ycomb] ({\x},{exp(\sigm * \x)}) node[below right,scale=0.9,align=center,xshift=0.3cm] {$\alpha > 0$\\$|\alpha| > 1$};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
  \end{tikzpicture}
  \caption{Esponenziale reale con \( \alpha > 0 \; |\alpha| < 1 \)}
\end{figure}

\subsubsection{Esponenziali Complessi}
\[
  x[n] = C \alpha^n \quad C,\alpha \in \mathbb{C}
\] 
dove
\[
  \begin{aligned}
    C = |C| e^{j \Theta}\\
    \alpha = |\alpha| e^{j \omega_0}
  \end{aligned}
\] 
\vspace{1em}
\[
  \begin{aligned}
    x[n] = |C| e^{j \Theta} \cdot \left( |\alpha| e^{j \omega_0} \right) =\\
    |C| \cdot |\alpha|^n \cdot e^{j(\omega_0 n + \Theta)}
  \end{aligned}
\] 
Usando la formula di Eulero:
\[
  x[n] = |C| \cdot |\alpha|^n \cdot (cos(\omega_0 n + \Theta) + j 
  sin(\omega_0 n + \Theta))
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-3.5) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{-exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {};
    \draw[domain=-4:4,smooth,variable=\x,blue,samples=70] plot[ycomb] ({\x},{exp(\sigm*\x)*cos(\omeg*\x r)}) node[above right, scale=0.9,align=center] {$|\alpha| > 1$};
  \end{tikzpicture}
  \caption{Esponenziale sinusoidale con \(|\alpha| > 1 \)}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{-0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-3.5) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{-exp(\sigm * \x)}) node[below right, scale=0.9,align=center] {Inviluppo};
    \draw[domain=-4:4,smooth,variable=\x,blue,samples=70] plot[ycomb] ({\x},{exp(\sigm*\x)*cos(\omeg*\x r)}) node[above right, scale=0.9,align=center] {$|\alpha| < 1$};
  \end{tikzpicture}
  \caption{Esponenziale sinusoidale con \( |\alpha| < 1 \)}
\end{figure}

\subsection{Rappresentazione}
I segnali che appartengono all'insieme dei complessi sono tridimensionali e sono
rappresentati in 2 assi cartesiani diversi, che mostrano lo stesso segnale, ma
da 2 punti di vista differenti. Il segnale viene generato da un punto che  
che continua a girare periodicamente su una circonferenza proiettando su entrambi
gli assi il suo valore.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
    \draw[->] (0,-3) -- (0,3) node[above] {$\Im$};

    \draw[cyan] (0,0) circle (2.5);
    
    \draw[->,red,rotate=30] (0,0) -- (2.5,0) node[midway, above] {};
    \draw[red] (1.5,0) arc (0:30:1.5) node[midway, right] {$\Theta$};
    \draw[->,red] (2,0) arc (0:360:2) node[midway, right] {};
  \end{tikzpicture}
  \caption{Circonferenza di proiezione}
\end{figure}

La proiezione sull'asse dei reali è la parte reale del segnale:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$\Re$};

    \draw[blue,domain=0:5,smooth,samples=100] plot ({\x},{cos(\x*3 r)});
  \end{tikzpicture}
  \caption{Proiezione su asse reale}
\end{figure}

La proiezione sull'asse degli immaginari è la parte immaginaria del segnale ed è
traslata di \( \frac{\pi}{2} \) rispetto alla parte reale:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$\Im$};

    \draw[red,domain=0:5,smooth,samples=100] plot ({\x},{sin(\x*3 r)});
  \end{tikzpicture}
  \caption{Proiezione su asse immaginario}
\end{figure}

In 3 dimensioni diventa:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      axis lines = center,
      xlabel = \( \Re \),
      ylabel = \( t \),
      zlabel = \( \Im \),
      ymin = 0,
      ymax = 15,
      view={45}{30}
      ]


      \addplot3[
        domain=0:25,
        cyan,
        samples=500,
        samples y=1,
        ] (
        {cos(deg(x))},
        {4*x/(2*pi)},
        {sin(deg(x))}
        );
    \end{axis}
  \end{tikzpicture}
  \caption{Circonferenza di proiezione in 3D}
\end{figure}

\subsection{Problema della periodicità}
Il problema della periodicità consiste nel fatto che alcuni segnali possono
sembrare periodici anche se non lo sono. Ad esempio:
\begin{example}
  \[
    \begin{aligned}
      \Omega_0 = \frac{2\pi}{12}\\
      \phi = 0
    \end{aligned}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\omega{(2*pi)/12}
      \def\phi{0}

      \draw[->] (-3,0) -- (3.2,0) node[right] {$n$};
      \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(n)$};
      \draw[red,domain=-3:3,samples=100] plot ({\x},{cos((\x*\omega*5 + \phi) r)});
      \draw[blue,domain=-3:3,samples=40] plot[ycomb,mark=*,mark size=1.5pt] ({\x},{cos((\x*\omega*5 + \phi) r)});
    \end{tikzpicture}
  \end{figure}
  Il periodo è:
  \[
    \begin{aligned}
      T_0 = \frac{2\pi}{\Omega_0} m\\
      T_0 = \frac{2\pi}{\frac{2\pi}{12}} m = 12m
    \end{aligned}
  \] 
  Con \( m = 1 \):
  \[
    T_0 = 12 \cdot 1 = 12 \in \mathbb{Z}
  \] 
  Quindi il segnale è periodico.
\end{example}

\begin{example}
  \[
    \begin{aligned}
      \Omega_0 = \frac{8\pi}{31}\\
      \phi = 0
    \end{aligned}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\omega{(8*pi)/31}
      \def\phi{0}

      \draw[->] (-3,0) -- (3.2,0) node[right] {$n$};
      \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(n)$};
      \draw[red,domain=-3:3,samples=100] plot ({\x},{cos((\x*\omega*5 + \phi) r)});
      \draw[blue,domain=-3:3,samples=40] plot[ycomb,mark=*,mark size=1.5pt] ({\x},{cos((\x*\omega*5 + \phi) r)});
    \end{tikzpicture}
  \end{figure}
  Il periodo è:
  \[
  \begin{aligned}
    T_0 = \frac{2\pi}{\Omega_0} m\\
    T_0 = \frac{2\pi}{\frac{8\pi}{31}} m = \frac{31}{4} m
  \end{aligned}
  \] 
  Con \( m = 4 \):
  \[
    T_0 = \frac{31}{4} \cdot 4 = 31 \in \mathbb{Z}
  \] 
\end{example}

\begin{example}
  \[
    \begin{aligned}
      \Omega_0 = \frac{1}{6}\\
      \phi = 0
    \end{aligned}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\omega{1/6}
      \def\phi{0}

      \draw[->] (-3,0) -- (3.2,0) node[right] {$n$};
      \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(n)$};
      \draw[red,domain=-3:3,samples=100] plot ({\x},{cos((\x*\omega*5 + \phi) r)});
      \draw[blue,domain=-3:3,samples=40] plot[ycomb,mark=*,mark size=1.5pt] ({\x},{cos((\x*\omega*5 + \phi) r)});
    \end{tikzpicture}
  \end{figure}
  Il periodo è:
  \[
    \begin{aligned}
      T_0 = \frac{2\pi}{\Omega_0} m\\
      T_0 = \frac{2\pi}{\frac{1}{6}} m = 2\pi \cdot 6 m
    \end{aligned}
  \] 
  Non esiste \( m \in \mathbb{Z} \) che mi tolga \( \pi \) dalla formula del periodo,
  quindi il segnale non è periodico anche se lo sembra
\end{example}

\section{Segnali generalizzati}
Ci sono alcune grandezze che non si possono facilmente calcolare con i segnali
tradizionali, quindi analiticamente, ma solo con strumenti appositi.
\begin{figure}[H]
  \begin{example}
    La tensione della corrente elettrica
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \node[draw,ellipse,minimum size=1cm] (grandezza) at (0,0) {Grandezza};
        \node[draw,minimum size=1cm] (strumento) at (3,0) {Strumento};
        \node[draw,minimum size=1cm] (misura) at (5.5,0) {N};
        \node[below] at (misura.south) {Misura};

        \draw[->] (grandezza) -- (strumento);
        \draw[->] (strumento) -- (misura);
      \end{tikzpicture}
    \end{figure}
    Per misurare la tensione si usa il multimetro. Queste sono grandezze
    definite all'interno di un'operazione integrale.
    \[
      \int_\infty^\infty \underbrace{\sigma(t)}_{\text{Grandezza}} \cdot
      \underbrace{\phi(t)}_{\text{Strumento}} \; dt = \underbrace{N}_{\text{Misura}}
    \] 
  \end{example}
\end{figure}

\subsection{Segnali di impulso}
\begin{itemize}
  \item \textbf{Impulso di Dirac}
    È una funzione con supporto \textbf{infinitesimo}, altezza \textbf{infinita} e area = 1
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

        \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$\infty$};

        \node[below, scale=0.8] at (0,-0.1) {$0$};
        \node[above left, scale=0.8] at (0,0) {$0^-$};
        \node[above right, scale=0.8] at (0,0) {$0^+$};
      \end{tikzpicture}
      \caption{Impulso di Dirac}
    \end{figure}

    \noindent 
    È definita in \( [0^-,0^+] \) 
    \[
      \int_{-\infty}^{+\infty} \underbrace{\delta(t)}_{\text{Impulso}} \cdot \underbrace{1}_{\text{Strumento}} \; dt = \underbrace{1}_{\text{Valore}}
    \] 
    \[
      \delta(t) = \begin{cases}
        \infty \text{ in } 0\\
        0 \text{ altrimenti}
      \end{cases}
    \] 

  \item \textbf{Impulso unitario}

    \noindent
    Matematicamente non si usa l'impulso di Dirac, ma l'\textbf{impulso unitario}.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

        \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$1$};

        \node[below, scale=0.8] at (0,-0.1) {$0$};
        \node[above left, scale=0.8] at (0,0) {$0^-$};
        \node[above right, scale=0.8] at (0,0) {$0^+$};
      \end{tikzpicture}
      \caption{Impulso unitario}
    \end{figure}
    \[
    \delta(t) = \begin{cases}
      1 \text{ in } 0\\
      0 \text{ altrimenti}
    \end{cases}
    \] 
\end{itemize}

\noindent
In natura, il segnale che si avvicina di più al segnale di impulso è il seguente:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \def\u{0.5}
    \def\s{0.1}

    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

    \draw (-0.05,1) -- ++(0.1,0) node[left,xshift=-0.05cm] {1};

    \draw[blue,thick,smooth,domain=-1.4:1.4,samples=100] plot ({\x}, {exp(-(\x-\u)^2/(2*\s^2))});

    \draw[red,fill] (\u,1) circle (1pt) node[above,scale=0.8] {Picco};
    \draw[->, cyan] (0.1,0.2) -- ++(0.1,0.6) node[midway,left,align=center,scale=0.8,xshift=-0.2cm] {Fronte\\di salita};
    \draw[->, cyan] (0.8,0.8) -- ++(0.1,-0.6) node[midway,right,align=center,scale=0.8,xshift=0.2cm] {Fronte\\di discesa};
  \end{tikzpicture}
  \caption{Segnale che si avvicina all'impulso}
\end{figure}
\noindent
In ogni caso, non si avvicina mai all'impulso di Dirac, perchè ha sempre un
fronte di salita e discesa, quindi non è istantaneo.

\subsubsection{Finestra rettangolare unitaria}
È una funzione che definisce un rettangolo di altezza \( A = 1 \)  e larghezza \( T \).
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\Pi(t)$};

    \draw (-0.05,1) -- ++(0.1,0) node[above left,xshift=-0.05cm] {1};

    \draw[blue,thick] (-1.4,0) -- (-0.5,0) node[below] {$-\frac{T}{2}$}
      -- (-0.5,1) -- (0.5,1) node[above right] {$A=1$} -- (0.5,0) node[below] {$\frac{T}{2}$}
      -- (1.4,0);
  \end{tikzpicture}
  \caption{Finestra rettangolare unitaria}
\end{figure}
È definita nel seguente modo:
\[
\Pi(t) := \begin{cases}
  1 \text{ se } -\frac{T}{2} \le t \le \frac{T}{2}\\
  0 \text{ altrimenti}
\end{cases}
\] 
Se questo segnale è ripetuto nel tempo si chiama \textbf{onda quadra}.

\vspace{1em}
\noindent
Alcune applicazioni possono essere:
\begin{itemize}
  \item Gestione di motori elettrici
  \item Equalizzazione di audio
\end{itemize}

\subsubsection{Finestra triangolare unitaria o Impulso triangolare unitario}
È una funzione che definisce un triangolo di altezza \( A = 1 \) e larghezza \( T \).
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\Lambda(t)$};

    \draw (-0.05,1) -- ++(0.1,0) node[above left,xshift=-0.05cm] {1};

    \draw[blue,thick] (-1.4,0) -- (-0.5,0) node[below] {$-T$}
      -- (0,1) -- (0.5,0) node[below] {$T$}
      -- (1.4,0);
  \end{tikzpicture}
  \caption{Finestra triangolare unitaria}
\end{figure}
\noindent
È definita nel seguente modo:
\[
\Lambda(t) := \begin{cases}
  1 - |t| \text{ se } -T \le t \le T\\
  0 \text{ altrimenti}
\end{cases}
\]

\vspace{1em}
\noindent
Le applicazioni sono le stesse del rettangolo, ma con una forma più armonica (smooth).
Si possono anche generare segnali sinusoidali.

\subsection{Come si realizza un impulso}
\begin{itemize}
  \item Rettangolo:

    \noindent
    L'impulso si definisce come una successione di funzioni per cui vengono cambiati
    dei valori:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \def\a{1}
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

        \draw[blue,thick] (-\a/2,0) node[below] {$-\frac{a}{2}$}
          -- (-\a/2,1/\a) -- (\a/2,1/\a) node[above right] {$\frac{1}{a}$} -- (\a/2,0) node[below] {$\frac{a}{2}$};
      \end{tikzpicture}
      \caption{Impulso rettangolare}
    \end{figure}
    L'obiettivo è raddoppiare l'altezza e dimezzare la larghezza, mantenendo l'area
    uguale.

    \noindent
    Calcoliamo l'area di questa funzione:
    \[
      Area = \left(\frac{a}{2} + \frac{a}{2}\right) \cdot \frac{1}{a} = \frac{2a}{2} \cdot \frac{1}{a} = 1
    \] 

    Ora cambiamo la funzione:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \def\a{1}
        \def\b{0.5}
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,2.5) node[above] {$\delta(t)$};

        \draw[blue,thick] (-\a/2,0) node[below left] {$-\frac{a}{2}$}
          -- (-\a/2,1/\a) -- (\a/2,1/\a) node[above right] {$\frac{1}{a}$} --
          (\a/2,0) node[below right] {$\frac{a}{2}$};

        \draw[red,thick] (-\b/2,0) node[below] {$-\frac{a}{4}$}
          -- (-\b/2,1/\b) -- (\b/2,1/\b) node[above right] {$\frac{2}{a}$} --
          (\b/2,0) node[below] {$\frac{a}{4}$};
      \end{tikzpicture}
      \caption{Impulsi rettangolari}
    \end{figure}
    E calcoliamo di nuovo l'area
    \[
      Area = \left(\frac{a}{4} + \frac{a}{4}\right) \cdot \frac{2}{a} = \frac{2a}{4} \cdot \frac{2}{a} = 1
    \] 

    \[
      \delta(t) = \lim_{n \to \infty} A_n = 1 
    \] 

  \item Triangolo:

    \noindent
    Facciamo la stessa cosa con il triangolo:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \def\a{1}
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

        \draw[blue,thick] (-\a,0) node[below] {$-\frac{a}{2}$}
          -- (0,1/\a) node[above right] {$\frac{2}{a}$} -- (\a,0) node[below] {$\frac{a}{2}$};
      \end{tikzpicture}
      \caption{Impulso triangolare}
    \end{figure}
    \[
    Area = \left( \frac{a}{2} + \frac{a}{2} \right) \cdot  \frac{2}{a} \cdot \frac{1}{2} = 1
    \] 
    Ora cambiamo la funzione:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \def\a{1}
        \def\b{0.5}
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,2.5) node[above] {$\delta(t)$};

        \draw[blue,thick] (-\a,0) node[below] {$-\frac{a}{2}$}
          -- (0,1/\a) node[above right,xshift=-0.1cm,yshift=-0.1cm] {$\frac{2}{a}$} -- (\a,0) node[below] {$\frac{a}{2}$};

        \draw[red,thick] (-\b,0) node[below] {$-\frac{a}{4}$}
          -- (0,1/\b) node[right] {$\frac{4}{a}$} -- (\b,0) node[below] {$\frac{a}{4}$};
      \end{tikzpicture}
      \caption{Impulsi triangolari}
    \end{figure}
    \[
      Area = \left( \frac{a}{4} + \frac{a}{4} \right) \cdot \frac{2}{a} \cdot \frac{1}{2} = 1
    \] 

    \[
      \delta(t) = \lim_{n \to \infty} A_n = 1
    \] 
\end{itemize}

\subsection{Derivata dell'impulso}
Considerando l'impulso come successione di triangoli abbiamo che all'infinito 
ci sarà un fronte di salita e discesa, quindi la derivata saranno degli
inpulsi positivi e negativi.
\[
  \frac{d \delta(t)}{dt} = \dot{\delta}(t) = \delta'(t)
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$\delta(t)$};
    
    \draw[blue,thick] (-\a,0) -- (0,1/\a) node[right,yshift=0.1cm] {$\delta(t) = \delta_0(t)$}
      -- (\a,0);

    \draw[->] (2.5,0) -- ++(1,0) node[midway,above] {Derivata};
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$\delta_1(t)$};
    
    \draw[->,blue,thick] (0.25,0) -- (0.25,\a) node[right,yshift=0.1cm] {$\delta'(t) = \delta_1(t)$};
    \draw[->,blue,thick] (0.5,0) -- (0.5,-\a);

  \end{tikzpicture}
  \caption{Derivata del segnale triangolare}
\end{figure}

\subsection{Integrale dell'impulso}
I segnali polinomiali (o segnali canonici) sono definiti come l'integrale di un impulso. È definito
come:
\[
  \delta_{-n}(t) = \begin{cases}
    \frac{t^{n-1}}{(n-1)!} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
\] 

\[
  \int \delta_0(t) \; dt = \delta_{-1}(t)
\] 

\subsubsection{Funzione gradino}
Si ottiene integrando una volta:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};
    
    \draw[->,blue,thick] (0,0) -- (0,\a);

    \draw[->] (2.5,0.75) -- ++(1,0) node[midway,above] {Integrale};
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-1}(t)$};
    
    \draw[blue,thick] (-1.4,0) -- (0,0) -- (0,\a) -- (1.4,\a);

  \end{tikzpicture}
  \caption{Funzione gradino}
\end{figure}
\[
  \delta_{-1}(t) = \begin{cases}
    \frac{t^{1-1}}{(1-1)!} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
  =
  \begin{cases}
    1 \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
\] 

\noindent
Moltiplicare un segnale per il gradino unitario permette di ottenere la parte
positiva del segnale:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-4,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$f(t)$};

    \draw[blue,domain=-3.9:3.9,smooth,samples=100] plot ({\x},{sin(\x * 3 r)});
    
    \draw[red,thick] (-3.9,0) -- (1,0) node[below] {$t_0$} -- (1,\a) -- (3.9,\a);

    \node[above,red] at (-2,1.1) {Sparisce};
    \node[above,red,align=center] at (2,1.1) {Rimane\\invariato};
  \end{tikzpicture}
  \caption{Moltiplicazione per gradino unitario}
\end{figure}
Si ottiene:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-4,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$f(t)$};

    \draw[blue,thick,domain=1:3.9,smooth,samples=100] plot ({\x},{sin(\x * 3 r)});
    \draw[blue,thick] (-3.9,0) -- (1,0);
    \node[below] at (1,0) {$t_0$};
  \end{tikzpicture}
  \caption{Risultato della moltiplicazione}
\end{figure}
\[
  f(t) \cdot \delta_{-1}(t) = f_1(t) \text{ (che è causale)}
\] 
La funzione del gradino è anche nota come \textbf{funzione di Heaviside}.

\subsubsection{Funzione rampa}
Si ottiene integrando due volte:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-1}(t)$};

    \draw[blue,thick] (-1.4,0) -- (0,0) -- (0,\a) -- (1.4,\a);

    \draw[->] (2.5,0.75) -- ++(1,0) node[midway,above] {Integrale};
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-2}(t)$};

    \draw[blue,thick] (-1.4,0) -- (0,0) -- (1.4,\a);
  \end{tikzpicture}
  \caption{Funzione rampa}
\end{figure}
\[
  \delta_{-2}(t) = \begin{cases}
    \frac{t^{2-1}}{(2-1)!} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
  = \begin{cases}
    t \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
\] 

\subsubsection{Funzione parabolica}
Si ottiene integrando tre volte:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-2}(t)$};

    \draw[blue,thick] (-1.4,0) -- (0,0) -- (1.4,\a);

    \draw[->] (2.5,0.75) -- ++(1,0) node[midway,above] {Integrale};
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-3}(t)$};
    
    \draw[blue,thick] (-1.4,0) -- (0,0);
    \draw[blue,thick,domain=0:1.2,smooth,samples=100] plot ({\x},{\x*\x});
  \end{tikzpicture}
  \caption{Funzione rampa}
\end{figure}
\[
  \delta_{-3}(t) = \begin{cases}
    \frac{t^{3-1}}{(3-1)!} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
  = \begin{cases}
    \frac{t^2}{2} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
\]

\subsubsection{A cosa servono i segnali canonici}
Non si sa cosa contengono i sistemi LTI che si analizzano, perchè si gestiscono
solo gli input e gli output.

\noindent
Di solito si cerca di dare il segnale gradino al sistema e si guarda qual'è la risposta
del sistema a questo segnale. Ad esempio:

\begin{figure}[H]
  \begin{example}
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-0.1,0) -- (6,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,3) node[above] {$f(t)$};

        \draw[blue,thick] (0,0) -- (0,1) -- (5.9,1);
        \draw[green!50!black,thick,domain=0:5.9,smooth,samples=100] plot ({\x},{1 - exp(-0.1 * 6.2 * \x)* cos(-10 * \x r)});
        \draw[red,thick,domain=0:5.9,smooth,samples=100] plot ({\x},{1 - exp(-\x)});
        \draw[orange,thick,domain=0:5.9,smooth,samples=100] plot ({\x},{0.1 * exp(0.4 * \x)});

        \node[align=center] at (7,1.5) {\color{green!50!black}Oscilla\\\color{red}Veloce\\\color{orange}Lento};
      \end{tikzpicture}
      \caption{Esempi di risposta di un sistema}
    \end{figure}
    Il sistema rosso cresce lentamente, ma ad un certo punto arriva a 1, mentre quello
    arancione è un sistema più lento.

    Quello verde è più veloce, ma non arriva mai a regime perchè continua a oscillare
    e quindi non è asintoticamente stabile, ma potrebbe essere BIBO stabile.
    \begin{itemize}
      \item Per una luce il sistema verde potrebbe andare bene se l'oscillazione non è troppa
      \item Per un sistema frenante il sistema arancione potrebbe essere troppo lento
    \end{itemize}
  \end{example}
\end{figure}

\subsection{Proprietà degli impulsi}
È un segnale ideale (canonico) centrato in 0 e definito in \( [0^-, 0^1] \) con
altezza 1.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

    \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$1$};

    \node[below, scale=0.8] at (0,-0.1) {$0$};
    \node[above left, scale=0.8] at (0,0) {$0^-$};
    \node[above right, scale=0.8] at (0,0) {$0^+$};
  \end{tikzpicture}
  \caption{Impulso unitario}
\end{figure}

\begin{itemize}
  \item \textbf{Pari}:
    \[
    \delta(t) = \delta(-t) \quad \forall t \in \mathbb{R}
    \] 

  \item \textbf{Area unitaria}

    \noindent
    Se
    \[
       0 \in [a,b] \subset \mathbb{R}
    \] 
    Allora
    \[
    \int_a^b \delta(t) \; dt = 1
    \] 
    Altrimenti
    \[
    \int_a^b \delta(t) \; dt = 0
  \]
  Cioè se l'intervallo contiene lo 0, l'area è 1, altrimenti è 0.
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1.5]
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

      \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$1$};

      \draw[green!50!black,thick] (-0.2,-0.2) node[below] {a} -- ++(0.4,0) node[below,scale=0.8] {b}
        node[midway,below,scale=0.8] {1};

      \draw[red,thick] (1,-0.2) node[below] {a} -- ++(0.4,0) node[below,scale=0.8] {b}
        node[midway,below,scale=0.8] {0};

    \end{tikzpicture}
    \caption{Area dell'impulso}
  \end{figure}

  \item \textbf{Proprietà del campionamento o riproducibilità}

    \noindent Se \( v: \mathbb{R}\to \mathbb{R} \) è una funzione continua in
    \( t_0 \in \mathbb{R} \), allora:
    \[
    v(t) \delta(t-t_0) = v(t_0) \delta(t-t_0) \quad \text{ per } t \in \mathbb{R}
    \] 
    Se prendo un impulso traslato in \( t_0 \)  e lo moltiplico per una funzione
    ottengo il valore della funzione in quel punto.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \draw[->] (-0.1,0) -- (4,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,2) node[above] {$v(t)$};

        \draw[blue,domain=0:3.9,smooth,samples=100] plot ({\x},{sin(\x * 3 r)/2 + 1}) node[right] {$v(t)$};

        \draw[red] (pi/2,0.5) node[above,yshift=0.3cm,scale=0.8] {$\delta(t-t_0)$} -- (pi/2,0) node[below] {\(t_0\)};
      \end{tikzpicture}
    \end{figure}
    \noindent
    Per riuscire a passare dal continuo al discreto si continua a moltiplicare
    la funzione per un impulso traslato in \( t_0 \) e si ottiene il valore
    della funzione in quel punto.

    \vspace{1em}
    \noindent
    Questa formula può essere riscritta come:
    \[
      v(t_0) = \int_{-\infty}^{+\infty} v(\tau) \delta(\tau-t_0) \; d\tau
    \] 
    Il valore di una funzione in \( t_0 \) l'integrale della funzione moltiplicata
    per un impulso traslato in \( t_0 \).
\end{itemize}

\section{Sistemi}
Un sistema è un modello matematico o una formulizzazione di un processo o di un fenomeno
fisico che permette di trasformare un input in un output. Ci sono più tipi di sistemi:
\begin{itemize}
  \item \textbf{Sistemi SISO} (Single Input Single Output): Sono sistemi che hanno un solo
    input e un solo output.
  \item \textbf{Sistemi dinamici}: Sono sistemi che "ricordano" l'input precedente,
    quindi l'output dipende dall'input attuale e da quello precedente.
\end{itemize}

\begin{example}
  Un esempio di sistema fisico stabile è il pendolo:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1.5]
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.1) -- (0,1.5) node[above] {};

      \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$u(t)$};
    \end{tikzpicture}
    \caption{Input}
  \end{figure}

  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      % Top bar
      \draw (0,0) -- ++(4,0);

      % y axis
      \draw[->] (0,-3) -- ++(2,0) -- ++(0,0.1) -- ++(0,-0.1) node[below] {$0$}
        -- ++(2,0) node[right] {$y$};

      % Pendulums
      % \draw[fill=black] (2,-2) circle (0.4) node (c1) {};
      \node[draw,fill=black,circle,inner sep=0.3cm] (c1) at (2,-2) {};
      \node[draw,fill=black,circle,inner sep=0.3cm] (c2) at (0.5,-1.5) {};
      \node[draw,fill=black,circle,inner sep=0.3cm] (c3) at (3.5,-1.5) {};

      % Bars
      \draw (2,0) -- (c1);
      \draw (2,0) -- (c2);
      \draw (2,0) -- (c3);

      % Arc arrows between pendulums
      \draw[->, blue] (c1.west) arc (-90:-120:1.4);
      \draw[->, blue] (c1.east) arc (-90:-60:1.4);
    \end{tikzpicture}
    \caption{Sistema}
  \end{figure}

  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\sigm{-0.45}
      \def\omeg{3.3}
      \draw[->] (-0.2,0) -- (6,0) node[right] {$t$};
      \draw[->] (0,-3.5) -- (0,4) node[left] {$y$};

      \draw[domain=-2.4:3.5,smooth,variable=\x,green!50!black]
        plot ({\x+2.4},{exp(\sigm * \x)})
        node[above left, scale=0.9,align=center,yshift=0.5cm,xshift=0.2cm]
        {Andamento con\\stabilità asintotica};

      \draw[domain=-2.4:3.5,smooth,variable=\x,green!50!black]
        plot ({\x+2.4},{-exp(\sigm * \x)})
        node[above right, scale=0.9,align=center] {};

      \draw[domain=-2.4:3.5,smooth,variable=\x,red,samples=70]
        plot ({\x+2.4},{exp(\sigm*\x)*cos(\omeg*\x r)})
        node[below right,scale=0.9,align=center,yshift=-0.3cm] {$v(t)$};
    \end{tikzpicture}
    \caption{Output}
  \end{figure}
\end{example}

\begin{example}
  Un esempio di sistema fisico instabile è il seguente:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1.5]
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.1) -- (0,1.5) node[above] {};

      \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$u(t)$};
    \end{tikzpicture}
    \caption{Input}
  \end{figure}

  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1.5]
      % Base
      \draw[->] (0,0) -- ++(4,0) node[right] {$y$};

      % Semicircle
      \draw[fill,black] (1,0) arc (180:0:1);

      % Top circle
      \draw[fill,red] (2,1 + 0.2) circle (0.2) node[right] (c) {};
      \draw[->,blue] (c) -- ++(0.5,0) node[right] {$u(t)$};
    \end{tikzpicture}
    \caption{Sistema}
  \end{figure}

  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-0.2,0) -- (6,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,4) node[left] {$y$};

      \draw[domain=0:sqrt(2),smooth,variable=\x,red,samples=70] plot ({\x},{\x^2/2});
      \draw[domain=sqrt(2):5.5,smooth,variable=\x,red,samples=70] plot ({\x},{\x/sqrt(2)});
    \end{tikzpicture}
    \caption{Output}
  \end{figure}
\end{example}

\subsection{Proprietà dei sistemi LTI}
\begin{definition}[Sistema LTI]
  Un sistema a tempo continuo per cui valgono le proprietà di:
  \begin{itemize}
    \item Linearità
    \item Tempo invarianza
    \item Causalità
  \end{itemize}
  si definisce \textbf{Sistema Lineare Tempo Invariante} (LTI).
\end{definition}

\subsubsection{Linearità}
Se ho un sistema con un primo input \( u_1(t) \) e un secondo input \( u_2(t) \) che
insieme fanno un terzo input allora l'output del sistema sarà la combinazione lineare
degli output dei due input.
\[
  \underbrace{\underbrace{au_1(t)}_{\text{Input 1}} + \underbrace{bu_2(t)}_{\text{Input 2}}}_{\text{Input 3}}
  \to \text{Sistema} \to \underbrace{\underbrace{a \cdot y_1(t)}_{\text{Output 1}} + \underbrace{b \cdot y_2(t)}_{\text{Output 2}}}_{\text{Output 3}}
\] 

\subsubsection{Tempo invarianza}
Un sistema a tempo continuo è tempo invariante se e solo se:
\[
  u(t) \to v(t) \implies u(t+\tau) \to  v(t+\tau) \quad \forall \tau \in \mathbb{R}
\] 

\subsubsection{Causalità}
Un sistema si dice causale se e solo se l'uscita all'istante \( \tau \) dipende soltanto
dall'ingresso per \( t \le \tau \) (\( v(\tau) \) dipende solo da \( u(t) \; t \le \tau \)
e non dipende dai valori successivi). La causa non precede mai l'effetto.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Input graph
    \draw[->] (-0.5,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1) -- (0,1) node[above] {$u(t)$};
    \draw[blue, domain=0:4.8, samples=100, smooth] plot ({\x},{sin(\x*5 r)/1.5});

    \node[above left] (a) at (-0.5,0.5) {A riposo};
    \draw[->] (a) -- (-0.1,0.1);
    \node[below left] at (0,0) {$\tau = 0$};

    % System
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
    \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
    \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

    % Output graph
    \draw[->] (0,-6.2) -- (0,-4) node[above] {$v(t)$};
    \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
    \draw[red, domain=0.001:4.8, smooth] plot ({\x},{ln(\x+1) - 6});

    \node[above left] (b) at (-0.5,-5.5) {Causalità};
    \draw[->] (b) -- (-0.1,-5.9);
    \node[below left] at (0,-6) {$\tau = 0$};
  \end{tikzpicture}
  \caption{Sistema a riposo}
\end{figure}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\t{1.2566370614}
    % Input graph
    \draw[->] (-0.5,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1) -- (0,1) node[above] {$u(t)$};
    \draw[blue, domain=0:4.8, samples=100, smooth] plot ({\x},{sin(\x*5 r)/1.5});

    \node[below right] at (\t,0) {$\tau$};
    \draw[fill=black] (\t,0) circle (0.05);

    % System
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
    \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
    \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

    % Output graph
    \draw[->] (0,-6.2) -- (0,-4) node[above] {$v(t)$};
    \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
    \draw[red, domain=\t:4.8, smooth] plot ({\x},{ln(\x+1-\t) - 6});
    \draw[red, domain=0:\t, smooth] plot ({\x},{-6});

    \node[above, xshift=-0.3cm] (b) at (\t,-5.5) {Causalità};
    \draw[->] (b) -- (\t-0.1,-5.9);

    \node[below right] at (\t,-6) {$\tau$};
    \draw[fill=black] (\t,-6) circle (0.05);
  \end{tikzpicture}
  \caption{Sistema non a riposo}
\end{figure}

\noindent
Per comodità si considerano solo i sistemi a riposo (\( \tau = 0 \)).

\subsubsection{Proprietà di stabilità asintotica}
\begin{definition}
  Un sistema si dice \textbf{asintoticamente stabile} se:
  \[
  \exists \tau \in \mathbb{R} \; t.c \; u(\tau) = 0, \;\; \forall t \le \tau \Rightarrow
  \lim_{t \to \infty} v(t) = 0
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=0.8]
      % Input graph
      \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
      \draw[->] (0,-2) -- (0,2) node[above] {$u(t)$};
      \draw[blue, domain=0.001:4.8, samples=100, smooth] plot ({\x},{(sin((\x*5)/2 r))/(1.3*\x)});
      \node[above, blue, scale=0.8, yshift=0.2cm] at (5,0) {$u(t) = 0$};

      % System
      \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
      \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
      \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

      % Output graph
      \draw[->] (0,-8) -- (0,-4) node[above] {$v(t)$};
      \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
      \draw[red, domain=0.001:4.8, smooth] plot ({\x},{sin(\x*5 r)/(2.5*\x) - 6});
      \node[above, red, scale=0.8, yshift=0.2cm] at (5,-6) {$\lim_{t \to \infty} v(t) = 0$};
    \end{tikzpicture}
    \caption{Esempio di sistema asintoticamente stabile}
  \end{figure}
\end{definition}

\noindent
Per capire se un sistema è asintoticamente stabile bisogna verificare se ogni soluzione 
del sistema è minore di 0:
\[
\forall i \;\; \Re(\lambda_i) < 0
\] 

\subsubsection{Proprietà di BIBO stabilità}
\begin{definition}
  Un sistema si dice \textbf{BIBO stabile} se:
  \[
    \exists  \tau \in \mathbb{R}, \; e \; U_u \in \mathbb{R} \; t.c \;
    \text{se } |u(t)| \le U_u, \; \forall t \le \tau
  \] 
  \[
    \Downarrow
  \] 
  \[
    \exists U_v > 0 \; t.c \; |v(t)| \le U_v, \; \forall t \ge \tau
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=0.8]
      % Input graph
      \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
      \draw[->] (0,-2) -- (0,2) node[above] {$u(t)$};
      \draw[blue, domain=0.001:4.8, samples=100, smooth] plot ({\x},{sin(\x*\x r)/(0.5*\x)});
      \draw[blue, dashed] (4.8,0.7) -- (0,0.7) node[left] {$M_u$};
      \draw[blue, dashed] (4.8,-0.7) -- (0,-0.7) node[left] {$-M_u$};

      % System
      \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
      \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
      \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

      % Output graph
      \draw[->] (0,-8) -- (0,-4) node[above] {$v(t)$};
      \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
      \draw[red, domain=0.001:4.8, samples=200, smooth] plot ({\x},{sin(\x*\x*\x*0.5 r)/(0.7*\x) - 6});
      \draw[red, dashed] (4.8,-5.3) -- (0,-5.3) node[left] {$M_v$};
      \draw[red, dashed] (4.8,-6.7) -- (0,-6.7) node[left] {$-M_v$};
    \end{tikzpicture}
    \caption{Esempio di sistema stabile BIBO}
  \end{figure}

  \noindent
  Ogni sistema asintoticamente stabile è anche BIBO stabile, ma non il contrario.
\end{definition}

\noindent
Per capire se un sistema è BIBO stabile si deve verificare che \( h(t) \) (risposta 
all'impulso) sia assolutamente integrabile e che abbia un valore finito:
\[
  \int_{-\infty}^{+\infty} |h(t)| \; dt < \infty
\] 

\subsection{Sistemi descritti da equazioni differenziali}
I sistemi che si analizzano in questo corso sono solo un sottoinsieme:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw (0,0) circle (4cm) node[above=3cm,align=center,scale=0.9]
      {Sistemi a\\tempo continuo};
    \draw (0,0) circle (3cm);
    \draw (0,0) circle (2cm) node[above=2.2cm] {LTI};
    \draw (0,0) circle (1cm) node[above=1cm,align=center,scale=0.8]
      {Risposta\\impulsiva \( h(t) \)};

    \node[scale=0.7,align=center] at (0,0) {Modellabili con\\eq. diff};

    \begin{scope}
      \clip (0,0) circle (1cm);
      \fill[blue, fill opacity=0.3] (1.9,0) ellipse (1.8cm and 3cm);
    \end{scope}
    \draw (1.9,0) ellipse (1.8cm and 3cm);
    \node at (1.9,-2.5) {Causali};

    \draw[->,blue] (1,-0.5) -- (3.5,-3) node[below right] {Sistemi studiati nel corso};
  \end{tikzpicture}
  \caption{Sistemi LTI}
\end{figure}
\begin{example}
  Prendiamo come esempio un sistema massa molla smorzatore:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\offset{0.4}

      \draw (-0.2,0) -- (4,0);
      \draw[->] (0,-0.2) -- (0,3) node[right] {$x$};

      % Spring
      \draw[decoration={aspect=0.3, segment length=1.5mm, amplitude=2mm,coil},decorate]
        (2-\offset,0) -- ++(0,1) node[midway,left,xshift=-0.2cm] (k) {$k$};
      \draw[->,blue] (k) ++(-0.3,0.3) -- ++(0,-0.6) node[midway,left] {$F_k$};


      % Damper
      \draw (2+\offset,0) -- ++(0,0.4) (2+\offset-0.2,0.4+0.2) -- ++(0,-0.2) 
        -- ++(0.4,0) -- ++(0,0.2) node[midway,right] (d) {$D$}
        (2+\offset-0.1,0.4+0.1) -- ++(0.2,0)
        (2+\offset,0.4+0.1) -- ++(0,0.5);
      \draw[->,blue] (d) ++(0.3,0.3) -- ++(0,-0.6) node[midway,right] {$F_D$};

      % Mass
      \draw (2-\offset-0.3,1) rectangle ++(1.4,1) node[midway] {$M$};
      \draw[->,blue] (2,2) -- ++(0,0.6) node[midway,right] {$u(t)$};
    \end{tikzpicture}
    \label{massa-molla-smorzatore}
    \caption{Sistema massa molla smorzatore}
  \end{figure}
  \noindent
  Andiamo a vedere le forze in gioco:
  \[
    \begin{aligned}
      F & = m \cdot a\\
      a & = \frac{d^2x}{dt^2}
    \end{aligned}
  \] 
  \( x(t) \) è lo spostamento nel tempo
  \[
  M \cdot a(t) = u(t) - F_k - F_D
  \] 
  che equivale a
  \renewcommand{\thempfootnote}{\fnsymbol{mpfootnote}}
  \[
    M \cdot \frac{\partial ^2x}{\partial t^2} =
    u(t) - k \cdot x(t) - D \cdot \frac{\partial x}{\partial t}
    \footnote{
      Il simbolo \( \partial \) indica la derivata parziale. Una derivata parziale
      è una derivata rispetto ad una funzione a più variabili.
    }
  \] 
  \renewcommand{\thempfootnote}{\arabic{mpfootnote}}
  \setcounter{mpfootnote}{0}
  \[
    \underbrace{M \cdot \frac{\partial ^2x}{\partial t^2} + D \cdot
    \frac{\partial x}{\partial t} + k \cdot x(t)}_{\text{Segnale di uscita}}
    = \underbrace{u(t)}_{\text{Segnale di ingresso}}
  \] 
\end{example}
\begin{example}
  Un altro esempio è il sistema RL (Resistenza Induttanza):
  \begin{figure}[H]
    \centering
    \begin{circuitikz}[american voltages]
      % Input voltage source and ground
      \draw
        (0,0) node[ground] (ground) {} to[short] ++(0,1)
        to[V=$u(t)$] (0,2)
        to[short] ++(0,1)

        % Inductor L
        to[L, l=$L$] ++(3,0)

        % Resistor R
        to[R, l=$R$] ++(0,-3)

        % Output voltage v(t)
        (3,3) to[short, -*] (5,3)
        to[open, v^>=$v(t)$] (5,0)

        % Ground connection
        (0,0) to[short, -*] (5,0)
        ;

    \node at (ground) [below,yshift=-0.6cm,align=center] {Messa a\\terra};
    \node at (-1,1.2) [below,align=center] {Tensione\\di input};
    \node at (6.2,1.9) [below,align=center] {Tensione\\di output};

    \draw[<-] (2.2,2) arc (45:315:0.7) node[midway,right,xshift=0.3cm] {$i(t)$};
    \end{circuitikz}
    \caption{Sistema RL}
  \end{figure}
  \noindent
  Possiamo descrivere l'imput del sistema come:
  \[
    u(t) = L \cdot \frac{\partial i(t)}{\partial t} + \underbrace{R \cdot i(t)}_{v(t)}
  \] 
  Possiamo descrivere l'output come:
  \[
    v(t) = R \cdot i(t) \stackrel{\text{Legge di Ohm}}{\to} i(t) = \frac{1}{R} v(t)
  \] 

  \noindent
  Usando la legge di Ohm \( (V = Ri) \) possiamo scrivere:
  \[
    \underbrace{\frac{L}{R} \cdot \frac{\partial v(t)}{\partial t} + v(t)}
    _{\text{Segnale d'uscita}} =
    \underbrace{u(t)}_{\text{Segnale d'ingresso}}
  \] 
\end{example}

Quindi in generale possiamo scrivere un sistema LTI come:
\[
  \begin{aligned}
    a_n \frac{\partial ^{n} v(t)}{\partial t} + a_{n-1} \frac{\partial ^{(n-1)} v(t)}{\partial t} + \ldots + a_1 \frac{\partial v(t)}{\partial t} + a_0 v(t) & =\\
    b_m \frac{\partial ^{m} u(t)}{\partial t} + b_{m-1} \frac{\partial ^{(m-1)} u(t)}{\partial t} + \ldots + b_1 \frac{\partial u(t)}{\partial t} + b_0 u(t) &
  \end{aligned}
\] 
Dove:
\begin{itemize}
  \item \( u(t) \) è il segnale di ingresso
  \item \( v(t) \) è il segnale di uscita
  \item \( a_n, b_m \neq 0 \;\; \in \mathbb{R} \) 
\end{itemize}
Tutto ciò si può riscrivere come:
\begin{equation}
  \sum_{i=o}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} =
  \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}
  \label{equazione-del-sistema}
\end{equation}
  
\( n \) e \( m \) sono gli ordini delle equazioni differenziali con \( n \ge m \).
\begin{itemize}
  \item Se \( n > m \) il sistema è detto \textbf{strettamente proprio}
  \item Se \( n \ge m \) il sistema è detto \textbf{proprio}

\end{itemize}

\noindent
Ora possiamo inserire all'interno dei sistemi l'equazione differenziale:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=2cm] (A) at (0,0)
      {
        \begin{tabular}{c}
          \scalebox{2}{$\Sigma$}\\
          \\
          $\sum_{i=o}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} =
            \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}$
          \end{tabular}
      };

    \draw[->] (A.east) -- ++(1,0) node[right] {$u(t)$};
    \draw[<-] (A.west) -- ++(-1,0) node[left] {$v(t)$};
  \end{tikzpicture}
  \caption{Contenuto del sistema}
\end{figure}

\begin{figure}[H]
  \begin{example}
    Un esempio di sistema descritto da un'equazione differenziale è il seguente e
    riprende il sistema massa molla smorzatore dell'esempio \ref{massa-molla-smorzatore}:
    \[
      \underbrace{M}_{a_2} x''(t) + \underbrace{D}_{a_1} x'(t) + \underbrace{K}_{a_0} x(t) =
      \underbrace{1}_{b_0} u(t)
    \] 
  \end{example}
\end{figure}

\subsubsection{Risoluzione}
Un sistema descritto da un'equazione differenziale non ha una sola soluzione, a meno che
non vengano imposte \( n \) \textbf{condizioni iniziali}.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw (0,0) node[right] {$t=0^-$} -- (0,1) node[left] {$v(t)$};
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw (0,0) node[right] {$t=0^-$} -- (0,1) node[left] {$\frac{\partial v(t)}{\partial t}$}
      node[midway, right, xshift=1cm] {$\ldots$};
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw (0.5,0) node[right] {$t=0^-$} -- (0.5,1) node[left] {$\frac{\partial ^{(n-1)}v(t)}{\partial t}$};
  \end{tikzpicture}
  \caption{Derivata di ordine \( n-1 \) di \( v(t) \) calcolata al tempo \( t = 0^- \)}
\end{figure}

\noindent
La soluzione è l'uscita \( v \) del sistema (reale o complesa) che può essere scomposta
in:
\[
  \underbrace{v_t}_{\text{risposta totale}} = \underbrace{v_l}_{\text{Risposta libera}} + \underbrace{v_f}_{\text{Risposta forzata}}
\] 
\begin{itemize}
  \item \textbf{Risposta libera}: Dipende soltanto dalle condizioni iniziali, quindi
    è il comportamento del sistema in assenza di input.
    \[
    \begin{aligned}
      \text{C.I.} \neq 0\\
      u(t) = 0
    \end{aligned}
    \] 

  \item \textbf{Risposta forzata}: Dipende solo dall'input del sistema e la maggior parte
    delle volte è diversa dalla risposta libera.
    \[
    \begin{aligned}
      \text{C.I.} = 0\\
      u(t) \neq 0
    \end{aligned}
    \] 
\end{itemize}

\subsubsection{Risposta libera (o evoluzione libera)}
Per calcolare la risposta libera del sistema definito in \ref{equazione-del-sistema}
bisogna risolvere l'equazione omogenea 
($=0$) associata, quindi si prende la parte sinistra
dell'equazione differenziale e si pone uguale a 0 la parte destra.
\begin{equation}
  \sum_{i=0}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} = 0
  \label{eq-risposta-libera}
\end{equation}
\[
\] 
Per farlo bisogna definire il \textbf{polinomio caratteristico}:
\[
P(s) = \sum_{i=0}^{n} a_i s^i
\] 
\begin{example}
  Ad esempio:
  \[
  3 y''(t) + 2 y'(t) + y(t) = u(t)
  \] 
  Come prima cosa si toglie la parte destra
  \[
  3 y''(t) + 2 y'(t) + y(t) = 0
  \] 
  Successivamente si scrive il polinomio caratteristico sostituendo a \( y(t) \) la
  variabile \( s \) e mettendo come potenza di \( s \)  l'ordine della derivata:
  \[
  3s^2 + 2s + 1 = 0
  \] 
\end{example}
Ricordando il teorema fondamentale dell'algebra, cioè che la somma delle molteplicità
delle radici è uguale all'ordine del polinomio, si può dire che:
\[
\lambda_1, \lambda_2, \ldots, \lambda_r
\]
sono le soluzioni del polinomio caratteristico \( P(s) \) con relative molteplicità
\[ \mu_1, \mu_2, \ldots, \mu_r \] vale che \[ \sum_{i=0}^{r} \mu_i = r \]. Si ha quindi:
\[
  v_l(t) = \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} 
  \underbrace{c_{i,l}}_{\in \mathbb{R}, \mathbb{C}}  \cdot 
  \underbrace{e^{\lambda_i t}}_{\text{Esponenziale}} \cdot 
  \underbrace{\frac{t^l}{l!}}_{\text{Polinomiale}}
\] 
I valori \( c_{i,l} \) vengono calcolati usando le condizioni iniziali.

\begin{example}
  Prendendo come esempio il sistema definito in \ref{massa-molla-smorzatore} abbiamo l'equazione:
  \[
  Mx''(t) + Dx'(t) + Kx(t) = 0
  \] 
  Poniamo:
  \[
    M=1, \quad D=2, \quad K=1
  \] 
  \[
  x''(t) + 2x'(t) + x(t) = 0
  \] 
  Il polinomio caratteristico è:
  \[
    \begin{aligned}
      P(s) &= s^2 + 2s + 1 =\\
           &= (s+1)^2 
    \end{aligned}
  \] 
  Risolvendo l'equazione differenziale si ottiene:
  \[
  \lambda_1 = \lambda_2 = -1
  \] 
  con molteplicità algebrica è \( \mu_1 = 2 \). Quindi si hanno 2 soluzioni coincidenti
  e una sola radice distinta: $r = 1$ La risposta libera quindi sarà:
  \[
    \begin{aligned}
      v_l(t) &= \sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} c_{i,l} \cdot  e^{\lambda_i t} \cdot \frac{t^l}{l!} \\
             &= \sum_{i=1}^{1} \sum_{l=0}^{1} c_{i,l} \cdot  e^{\lambda_i t} \cdot \frac{t^l}{l!} \\
             &= c_{1,0} e^{-1t} \cdot \frac{t^0}{0!} + c_{1,1} \cdot e^{-1t} \cdot \frac{t^1}{1!} \\
             &= c_{1,0} \cdot e^{-t} \cdot 1 + c_{1,1} \cdot e^{-t} \cdot t
    \end{aligned}
  \] 
\end{example}
\begin{example}
  Prendiamo ad esempio il sistema:
  \[
    v'''(t) + 3v''(t) + 3v'(t) + 1 = 0
  \] 
  Calcoliamo il polinomio caratteristico:
  \[
    \begin{aligned}
      P(s) &= s^3 + 3s^2 + 3s + 1 = 0 \\
           &= (s + 1)^3
    \end{aligned}
  \] 
  Le soluzioni sono:
  \[
  \lambda_1 = \lambda_2 = \lambda_3 = -1
  \] 
  Il numero di soluzioni è \( r = 1 \) con molteplicità \( \mu = 3 \).

  \vspace{1em}
  \noindent
  La risposta libera è:
  \[
    \begin{aligned}
      v_l(t) &= \sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} c_{i,l} \cdot e^{\lambda_i t} \cdot \frac{t^l}{l!} \\
             &\;\;\vdots\\
             &= c_{1,0} \cdot e^{-t} + c_{1,1} \cdot e^{-t} \cdot t + c_{1,2} \cdot e^{-t} \cdot \frac{t^2}{2}
    \end{aligned}
  \] 
  Ora troviamo i coefficenti \( c_{i,l} \) per trovare la risposta libera specifica
  al nostro caso, considerando i seguenti valori iniziali: 
  \[
  \begin{cases}
    v(0) = 0\\
    v'(0) = 1\\
    v''(0) = 0
  \end{cases}
  \] 
  Sostituendo \( t \) con \( 0 \) troviamo il valore di \( c_{1,0} \):
  \[
  \begin{aligned}
    v_l(0) &= c_{1,0} \cdot e^0 + c_{1,1} \cdot e^0 \cdot 0 + c_{1,2} \cdot e^0 \cdot \frac{0}{2}\\
           &= c_{1,0} = 0
  \end{aligned}
  \] 
  Troviamo il valore di \( c_{1,1} \) derivando la risposta libera:
  \[
    v'_l(t) = -1 c_{1,0} \cdot e^{-t} + c_{1,1} \cdot e^{-t} \cdot t - c_{1,1} \cdot e^{-t} 
    - c_{1,2} \cdot e^{-t} \cdot \frac{t^2}{2} + c_{1,2} \cdot e^{-t} \cdot t
  \] 
  una volta calcolata la derivata, poniamo \( t = 0 \) 
  \[
  \begin{aligned}
    v'_l(0) &= -c_{1,0} + c_{1,1} - c_{1,1} + c_{1,2} \cdot 0 + c_{1,2} \cdot 0\\
            &= -c_{1,0} + c_{1,1} \\
            &= 0 + 1 = 1
  \end{aligned}
  \] 
  Troviamo il valore di \( c_{1,2} \) facendo la derivata seconda:
  \[
    v''(t) = 0 + 1 \cdot e^{-t} \cdot t - e^{-t} \cdot t + c_{1,2} \cdot e^{-t} \cdot \frac{t^2}{2} -
    c_{1,2} \cdot e^{-t} \cdot t + c_{1,2} \cdot e^{-t}
  \] 
  poniamo \( t = 0 \):
  \[
    \begin{aligned}
      v''_l(0) &= 0 + 1 \cdot 0 - 0 + c_{1,2} \cdot 0 - c_{1,2} \cdot 0 + c_{1,2} = 0\\
               &= c_{1,2} = 0
    \end{aligned}
  \] 
  Quindi alla fine la risposta libera specifica risulta:
  \[
    \begin{aligned}
      v_l(t) &= c_{1,0} \cdot e^{-t} + c_{1,1} \cdot e^{-t} \cdot t + c_{1,2} \cdot e^{-t} \cdot \frac{t^2}{2} \\
             &= e^{-t} \cdot t
    \end{aligned}
  \] 
\end{example}

\begin{example}
  Prendiamo ad esempio un sistema descritto nel seguente modo:
  \[
    v''(t) + 3v'(t) + -4v(t) = 5u'(t) - u(t)
  \] 
  Vogliamo calcolare la risposta libera del sistema. Per farlo bisogna imporre le
  condizioni iniziali:
  \[
    \begin{cases}
      v(0) = 0\\
      v'(0) = 1
    \end{cases}
  \] 
  Il primo passo è calcolare il polinomio caratteristico dell'equazione omogenea:
  \[
    \begin{aligned}
      P(s) &= s^2 + 3s - 4 = 0\\
           &= (s-1) (s+4)
    \end{aligned}
  \] 
  Il secondo passo è trovare le radici e le molteplicità:
  \[
    \begin{aligned}
      \lambda_1 &= 1, \quad \mu_1 = 1\\
      \lambda_2 &= -4, \quad \mu_2 = 1
    \end{aligned}
  \]
  La risposta libera generica si calcola come:
  \[
    v_l(t) = \sum_{i=1}^{r} \sum_{l=0}^{\mu_i -1} c_{i,l} \cdot e^{\lambda_i t} \cdot
    \frac{t^l}{l!}
  \] 
  e nel nostro caso è:
  \[
    \begin{aligned}
      v_l(t) &= c_{1,0} \cdot e^{t} + c_{2,0} \cdot e^{-4t}\\
             &= c_1 \cdot e^{t} + c_2 \cdot e^{-4t}
    \end{aligned}
  \] 

  \vspace{1em}
  \noindent
  Per trovare la risposta libera specifica bisogna calcolare i coefficenti \( c_1 \) e \( c_2 \)
  derivando e valutande nelle condizioni iniziali:
  \[
    \begin{aligned}
      v(t)  &= c_1 \cdot e^{t} + c_2 \cdot e^{-4t}\\
      v'(t) &= c_1 \cdot e^{t} - 4c_2 \cdot e^{-4t}
  \end{aligned}
  \] 
  Mettiamo a sistema, valutando in \( t = 0 \):
  \[
    \begin{aligned}
      &\begin{cases}
        v(0) = c_1 \cdot e^0 + c_2 \cdot e^0\\
        v'(0) = c_1 \cdot e^0 - 4c_2 \cdot e^0
      \end{cases}
      =\\
      &\begin{cases}
        c_1 + c_2 = 0\\
        c_1 - 4c_2 = 1
      \end{cases}
      =\\
      &\begin{cases}
        c_1 = -c_2\\
        -c_2 - 4c_2 = 1
      \end{cases}
      =\\
      &\begin{cases}
        c_1 = -c_2\\
        -5c_2 = 1
      \end{cases}
      =\\
      &\begin{cases}
        c_1 = \frac{1}{5}\\
        c_2 = -\frac{1}{5}
      \end{cases}
    \end{aligned}
  \] 
  La risposta libera specifica è quindi:
  \[
    v_l(t) = \frac{1}{5} \cdot e^t - \frac{1}{5} \cdot e^{-4t}
  \] 
\end{example}

\begin{definition}
  Le formule più importanti sono:
  \begin{itemize}
    \item \textbf{Modello di un sistema}:
      \[
        \sum_{i=o}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} =
        \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}
      \] 

    \item \textbf{Risposta libera}:
      \[
        v_l(t) = \sum_{i=1}^{r} \sum_{l=0}^{\mu_i -1} c_{i,l} \cdot \underbrace{
        e^{\lambda_i t} \cdot \frac{t^l}{l!}}_{\text{Modo elementare}}
      \] 
  \end{itemize}
  Dove:
  \[
  \begin{aligned}
    r &= \text{numero di radici distinte}\\
    \mu_i &= \text{molteplicità della radice } \lambda_i\\
    c_{i,l} &= \text{coefficienti da calcolare}
  \end{aligned}
  \] 
\end{definition}

\subsubsection{Convergenza dei modi elementari}
È una funzione che si comporta come un esponenziale, quindi la convergenza dipende dal
valore di \( \lambda \).
\[
  m(t) = e^{\lambda t} \cdot \frac{t^l}{l!}
\] 
Vale che:
\begin{enumerate}
  \item \( \lim_{t \to 0} m(t) = 0 \) se e solo se \( \Re(\lambda) < 0 \).
    \textbf{Stabilità asintotica}
    
  \item \( m(t) \) è limitato, cioè puo prendere solo valori limitati, su \( [0,\infty) \) 
    se e solo se \( \Re(\lambda) \le 0 \). Se \( \Re(\lambda) = 0 \), allora perchè
    questo valga \( l \) deve essere uguale a 0 \( l=0 \).
    \textbf{Stabilità semplice}.

  \item \( \lim_{t \to \infty} m(t) = \infty \) in tutti gli altri casi. Quindi:
    \[
      \Re(\lambda) > 0
    \] 
    oppure
    \[
      \Re(\lambda) = 0,\; l \neq 0
    \] 
    \textbf{Instabilità}.
\end{enumerate}

\subsubsection{Dimostrazioni}
\begin{enumerate}
  \item \( \Re(\lambda) < 0 \):

    \vspace{1em}
    \noindent
    Riscriviamo \( \lambda \) come:
    \[
    \lambda = a+bi = \sigma +j\omega
    \] 
    e riscriviamo \( m(t) \) come:
    \[
      \begin{aligned}
        m &= e^{\lambda t} \cdot \frac{t^l}{l!} = \left( e^{\sigma t} \cdot 
        e^{j \omega t} \right) \cdot \frac{t^l}{l!}\\
          &= \underbrace{\frac{t^l}{l!}}_{\text{Polinomiale}} \cdot
          \underbrace{\overbrace{e^{\sigma t}}^{\Re} \cdot \overbrace{e^{j \omega t}}^{\Im}}_{\text{Esponenziale}}
      \end{aligned}
    \] 
    con \( a = -\sigma \) diventa:
    \[
    \begin{aligned}
      m &= \frac{t^l}{l!} \cdot \frac{1}{e^{at}} \cdot e^{j \omega t}\\
        &= \underbrace{\frac{t^l}{l!} \cdot \frac{1}{e^{-\sigma t}}}_{=0} 
        \cdot \underbrace{e^{j \omega t}}_{\text{Limitato}}
    \end{aligned}
    \] 
    Il blocco \( e^{j \omega t} \) è un punto che gira su un cerchio di raggio 1, quindi
    è limitato. Il blocco \( \frac{t^l}{l!} \cdot \frac{1}{e^{-\sigma t}} \) è limitato
    per \( t = 0 \) e quindi \( m(t) \) tende a 0.

  \item \( \Re(\lambda) = 0 \;\; l=0 \):

    \vspace{1em}
    \noindent
    \[
      \begin{aligned}
        m(t) &= e^{\lambda t} \cdot \frac{t^l}{l!}\\
             &= \frac{t^l}{l!} \cdot e^{\sigma t} 
             \cdot e^{j \omega t}\\
             &= \frac{t^0}{0!} \cdot e^0 \cdot e^{j \omega t}\\
             &= e^{j \omega t}
      \end{aligned}
    \] 
    che è per definizione limitato in modulo.

  \item \( \Re(\lambda) > 0 \) 

    \vspace{1em}
    \noindent
    \[
    \begin{aligned}
      m(t) = \frac{t^l}{l!} \cdot e^{\sigma t} \cdot e^{j \omega t}
    \end{aligned}
    \] 


    \( \Re(\lambda) = 0 \; l \neq 0\) 
    \vspace{1em}
    \noindent
    \[
      m(t) = \frac{t^l}{l!} \cdot \stackrel{1}{\cancel{e^{\sigma t}}} \cdot e^{j \omega t}
    \] 
    Siccome \( \sigma = \Re(\lambda) = 0 \) 
    \[
    \lim_{t \to \infty} m(t) = \infty
    \] 
\end{enumerate}

\begin{definition}
  Un sistema LTI descritto dell'equazione:
  \[
    \sum_{i=0}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} =
    \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}
  \]
  è detto \textbf{asintoticamente stabile} (la risposta è asintoticamente stabile)
  se e solo se ogni suo modo elementare converge a 0, cioè:
  \[
    \forall i \;\; \lim_{t \to \infty} m_i(t) = 0 \quad m_i = e^{\lambda_i t} \cdot \frac{t^l}{l!}
  \] 

  \vspace{1em}
  \noindent
  \textbf{Osservazione}

  \noindent
  È detto \textbf{asintoticamente stabile} se e solo se tutte le radici del polinomio
  caratteristico, \( P(s) \), hanno parte reale negativa.
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2.5,0) -- (2.5,0) node[right] {$\Re$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$\Im$};

      \draw[fill=blue,blue] (-2,1.5) circle (0.05) node[above] (l_1) {$\lambda_1$};
      \draw[fill=blue,blue] (-1.5,1.2) circle (0.05) node[above] (l_2) {$\lambda_2$};
      \draw[fill=blue,blue] (-1,0.7) circle (0.05) node[above] (l_3) {$\lambda_3$};
      \draw[fill=blue,blue] (-0.5,1.8) circle (0.05) node[above] (l_4) {$\lambda_4$};

      \draw[dashed] (l_1) -- (l_1 |- 52,0);
      \draw[dashed] (l_2) -- (l_2 |- 52,0);
      \draw[dashed] (l_3) -- (l_3 |- 52,0);
      \draw[dashed] (l_4) -- (l_4 |- 52,0);
    \end{tikzpicture}
    \caption{Asintoticamente stabile}
  \end{figure}
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2.5,0) -- (2.5,0) node[right] {$\Re$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$\Im$};

      \draw[fill=blue,blue] (-2,1.5) circle (0.05) node[above] (l_1) {$\lambda_1$};
      \draw[fill=blue,blue] (1.5,1.2) circle (0.05) node[above] (l_4) {$\lambda_2$};
      \draw[fill=blue,blue] (-1,0.7) circle (0.05) node[above] (l_2) {$\lambda_3$};
      \draw[fill=blue,blue] (-0.5,1.8) circle (0.05) node[above] (l_3) {$\lambda_4$};

      \draw[dashed] (l_1) -- (l_1 |- 52,0);
      \draw[dashed] (l_2) -- (l_2 |- 52,0);
      \draw[dashed] (l_3) -- (l_3 |- 52,0);
      \draw[dashed] (l_4) -- (l_4 |- 52,0);
    \end{tikzpicture}
    \caption{Non asintoticamente stabile}
  \end{figure}
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2.5,0) -- (2.5,0) node[right] {$\Re$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$\Im$};

      \draw[fill=blue,blue] (-2,1.5) circle (0.05) node[above] (l_1) {$\lambda_1$};
      \draw[fill=blue,blue] (-1.5,1.2) circle (0.05) node[above] (l_2) {$\lambda_2$};
      \draw[fill=blue,blue] (-1,0.7) circle (0.05) node[above] (l_3) {$\lambda_3$};
      \draw[fill=blue,blue] (-0.5,1.8) circle (0.05) node[above] (l_4) {$\lambda_4$};
      \draw[fill=blue,blue] (0,1) circle (0.05) node[above right] (l_5) {$\lambda_5$};

      \draw[dashed] (l_1) -- (l_1 |- 52,0);
      \draw[dashed] (l_2) -- (l_2 |- 52,0);
      \draw[dashed] (l_3) -- (l_3 |- 52,0);
      \draw[dashed] (l_4) -- (l_4 |- 52,0);
      \draw[dashed] (l_5) -- (l_5 |- 52,0);
    \end{tikzpicture}
    \caption{Semplicemente stabile}
  \end{figure}
\end{definition}

\subsubsection{Prodotto di convoluzione}
Il concetto di correlazione indica quanto due segnali siano simili tra loro e si calcola
con il prodotto di convoluzione.

Il concetto di convoluzione è un'operazione tra due segnali che restituisce un terzo
segnale.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2) node[above] {$u(t)$};

    \draw[blue] (0.5,0) -- ++(1,1) node[above right,align=center] {Segnale\\fisso} -- ++(0,-1);
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2) node[above] {$v(t)$};

    \draw[red] (0.5,0) -- ++(0,1) -- ++(1,0) node[above right,align=center] {Kernel} -- ++(0,-1);
  \end{tikzpicture}
  \caption{Segnale fisso e kernel}
\end{figure}

\noindent
Il \textbf{kernel} è un segnale che viene riflesso rispetto all'asse \( y \) e traslato
nel tempo \( t \) e moltiplicato per il segnale fisso. Il risultato è un segnale che
rappresenta l'area sottesa dal prodotto dei due segnali.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2.5) node[above] {};

    \draw[blue] (0.5,0) -- ++(1,1) node[above right,align=center] {} -- ++(0,-1);
    \draw[red] (-1.5,0) -- ++(0,2) -- ++(1,0) node[above right,align=center] {} -- ++(0,-2);
    \draw[->,red] (-1,2.5) -- ++(0.5,0) node[midway,above] {$t$};
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2.5) node[above] {};

    \draw[blue] (0.5,0) -- ++(1,1) node[above right,align=center] {} -- ++(0,-1);
    \draw[red] (0.25,0) -- ++(0,2) -- ++(1,0) node[above right,align=center] {} -- ++(0,-2);
    \draw[fill=green!50!black,green!50!black, fill opacity=0.5] (0.5,0) --
      ++(0.75,0.75*2) node[above right,scale=0.8,align=center] {Area della\\convoluzione} -- ++(0,-0.75*2) -- cycle;
  \end{tikzpicture}
  \caption{Convoluzione}
\end{figure}

\noindent
Il grafico della convoluzione risultante è un segnale che rappresenta il cambiamento
nel tempo del prodotto dei due segnali.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-0.2,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2.5) node[above] {$u(t) \ast v(t)$};

    \draw[domain=0:2,smooth,samples=100,variable=\x,green] plot ({\x},{\x^2/2});
    \draw[domain=2:3.297,smooth,samples=100,variable=\x,green] plot ({\x},{ln(-\x/1.5 + 2.33333) + 2});
    \draw[domain=3.297:4,smooth,samples=100,variable=\x,green] plot ({\x},{0});
  \end{tikzpicture}
  \caption{Grafico della convoluzione}
\end{figure}

\begin{definition}
  L'operatore di convoluzione tra due segnali \( u(t) \) e \( v(t) \) è definito come:
  \[
    \begin{aligned}
      (u \ast v)(t) &= \int_{-\infty}^{+\infty} u(\tau) \cdot v(t-\tau) \, d\tau = \\
      (v \ast u)(t) &= \int_{-\infty}^{+\infty} v(\tau) \cdot 
      u(\underbrace{t}_{\text{Varia nel tempo}}\underbrace{-\tau}_{\text{Riflessione su y}}) \, d\tau
    \end{aligned}
  \]
  Il segnale riflesso viene moltiplicato per il segnale \( u(t) \).
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2,0) -- (2,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,2.5) node[above] {};

      \draw[domain=-2:2,smooth,samples=1000,variable=\x,blue] plot 
        ({\x},{cos((\x*10) r)/5 + 2})
        node[right] {$u(t)$};

      \draw[red] (0.5,0) -- ++(1,1) node[right] {$v(t)$} -- ++(0,-1);
      \draw[red] (-0.5,0) -- ++(-1,1) -- ++(0,-1);
      \draw[->] (-1.25,-0.2) -- ++(0.5,0)
        node[midway,below,scale=0.8,align=center] {Traslazione\\nel tempo};

      \draw[fill] (-0.5,0) circle (0.05) node[above right] {$t$};
    \end{tikzpicture}
    \caption{Convoluzione}
  \end{figure}
\end{definition}
Se la convoluzione viene effettuata con un impulso, il segnale viene campionato.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2) node[above] {$u(t)$};

    \draw[blue] (0.5,0) -- ++(1,1) node[above right,align=center] {Segnale\\fisso} -- ++(0,-1);
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2) node[above] {$v(t)$};

    \draw[->,red] (1,0) -- ++(0,1) node[above right,align=center] {Kernel};
  \end{tikzpicture}
  \caption{Segnale fisso e kernel}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-0.2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2.5) node[above] {$u(t) \ast v(t)$};

    \draw[green!50!black] (0.5,0) -- ++(1,1) -- ++(0,-1);
  \end{tikzpicture}
  \caption{Grafico della convoluzione}
\end{figure}
\begin{example}
  Ad esempio il segnale triangolo è formato dalla convoluzione di due segnali rettangolari.
  \[
  u(t) = v(t) = \Pi(t)
  \] 
  (\( \Pi(t) \) è la funzione rettangolo)
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$v(t)$};

      \draw[red] (-0.5,0) node[below] {$-\frac{1}{2}$} -- ++(0,1) -- ++(1,0) node[above right,align=center] {$u(t)$} -- ++(0,-1) node[below] {$\frac{1}{2}$};
    \end{tikzpicture}
    \begin{tikzpicture}
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$v(t)$};

      \draw[blue] (-0.5,0) node[below] {$-\frac{1}{2}$} -- ++(0,1) -- ++(1,0) node[above right,align=center] {$v(t)$} -- ++(0,-1) node[below] {$\frac{1}{2}$};
    \end{tikzpicture}
  \end{figure}
  \begin{enumerate}
    \item Scegliere il segnale più semplice
    \item Specchiare l'altro segnale rispetto a $y$ (\( f(t) \mapsto f(-t) \))
    \item Traslare il segnale mobile (quello specchiato) nel tempo
    \item Spostare \( \forall t \) e calcolare l'integrale (aree sottese)
  \end{enumerate}
  Il risultato della convoluzione sarà:
  \[
    \begin{aligned}
      u(-2) \ast v(-2) &= 1 \cdot 0 = 0\\
      u(-1) \ast v(-1) &= 1 \cdot 0 = 0\\
      u(0) \ast v(0) &= 1 \cdot 1 = 1\\
                       &\;\;\vdots\\
    \end{aligned}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2,0) -- (2,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,2.5) node[above] {$u(t) \ast v(t)$};

      \draw[green!50!black] (-1,0) node[below] {$-1$} -- ++(1,1) node[above right] {$1$}
        -- ++(1,-1) node[below] {$1$};
    \end{tikzpicture}
    \caption{Grafico della convoluzione}
  \end{figure}
\end{example}

\subsubsection{Risposta impulsiva}
\begin{definition}
  Dato un sistema a tempo continuo inizialmente a riposo (causale) definiamo la 
  \textbf{risposta impulsiva} come l'uscita del sistema in corrispondenza di un ingresso
  uguale all'impulso unitario
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {\( \Sigma \) };
      \draw[->] (-1,0) -- (A) node[midway,above left] {$\delta(t)$} node[midway,below left,scale=0.7] {Impulso};
      \draw[->] (A) -- (1,0) node[midway,above right] {$h(t)$} node[midway,below right,align=center,scale=0.7] {Risposta\\impulsiva};
    \end{tikzpicture}
    \caption{Risposta impulsiva}
  \end{figure}
\end{definition}

\begin{theorem}
  L'uscita \( v(t) \) di un sistema LTI, inizialmente a riposo, in corrispondenza di un
  ingresso \( u(t) \) è dato dal seguente prodotto di convoluzione:
  \[
    \begin{aligned}
      v(t) = (u \ast h)(t) &= \int_{-\infty}^{+\infty} h(\tau) \cdot u(t-\tau) \, d\tau\\
                           &= \int_{-\infty}^{+\infty} u(\tau) \cdot h(t-\tau) \, d\tau
    \end{aligned}
  \] 
\end{theorem}

\noindent
\textbf{Proprietà dell'integrale di convoluzione:}
\begin{itemize}
  \item \textbf{Commutativa}: \( (u \ast v)(t) = (v \ast u)(t) \) 
  \item \textbf{Associativa}: \( (u \ast v)(t) \ast w(t) = u(t) \ast (v \ast w)(t) \)
  \item \textbf{Distributiva} (rispetto alla somma): \( u(t) \ast (v(t) + w(t)) = (u \ast v)(t) + (u \ast w)(t) \)
\end{itemize}

\noindent
\textbf{Osservazione}: Un sistema LTI causale inizialmente a riposo, siccome \( h(t) = 0
, t < 0\) (perchè \( \delta(t) = 0, t < 0 \)):
\[
  \begin{aligned}
    v(t) = (u \ast h)(t) &= \int_{0^-}^{+\infty} h(\tau) \cdot u(t-\tau) \, d\tau\\
                         &= \int_{-\infty}^{t^+} u(\tau) \cdot u(t-\tau) \, d\tau\\
  \end{aligned}
\] 

\vspace{1em}
\noindent
Per calcolare la risposta impulsiva: 
\[
  h(t) = d_0 \cdot \delta(t) + \left[\sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} d_{i,l} \cdot \frac{t^l}{l!}
  \cdot e^{\lambda_i t}\right] \cdot \delta_{-1}(t)
\] 
dove:
\begin{itemize}
  \item \( d_0 \) è il termine costante:
    \begin{itemize}
      \item \( d_0 \neq 0 \) se e solo se il sistema è proprio (\( n=m \))
    \end{itemize}

  \item \( \delta(t) \) è l'impulso unitario

  \item \( d_{i,l} \) sono i coefficienti della risposta impulsiva 
    (diversi da \( c_{i,l} \) della risposta libera)

  \item \( \frac{t^l}{l!} \cdot e^{\lambda_i t} \) sono i modi elementari e sono
    gli stessi della risposta libera

  \item \( \delta_{-1}(t) \) è il gradino e serve a moltiplicare per 0 la parte
    non causale della risposta impulsiva e serve quindi per la causalità
\end{itemize}

\begin{example}
  Prendiamo ad esempio il sistema:
  \[
  v'(t) + 2v(t) = u'(t) + u(t)
  \] 
  Questo sistema ha \( n=m \) perchè è un sistema proprio, quindi: \( d_0 \neq 0 \) 
  \begin{enumerate}
    \item Il primo passo è quello di trovare l'equazione omogenea:
      \[
      v'(t) + 2v(t) = 0
      \] 

    \item Poi bisogna calcolare il polinomio caratteristico:
      \[
      P(s) = s + 2 = 0
      \] 

    \item Bisogna poi trovare le radici e i modi elementari:
      \[
      \lambda_1 = -2 \quad r = 1 \quad \mu = 1
      \] 
      \( \left( l = 0 \ldots \mu_i -1 \right)  \) 
      i modi elementari sono:
      \[
        m(t) = e^{-2t}
      \] 

    \item Scriviamo la risposta impulsiva:
      \[
        \begin{aligned}
          h(t) &= d_0 \cdot \delta(t) + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} d_{i,l} \cdot
          \frac{t^l}{l!} \cdot e^{\lambda_i t} \cdot \delta_{-1}(t)\\
               &= d_0 \cdot \delta(t) + d_{1,0} \cdot e^{-2t} \cdot \delta_{-1}(t)
        \end{aligned}
      \] 

    \item Riscrivo l'equazione iniziale ponendo:
      \[
      v(t) = h(t) \quad u(t) = \delta(t)
      \] 
      L'eqauzione diventa:
      \[
      v'(t) + 2v(t) = u'(t) + u(t)
      \] 
      \[
      \Downarrow
      \] 
      \[
      h'(t) + 2h(t) = \delta'(t) + \delta(t)
      \] 
      \begin{itemize}
        \item Calcolo tutte le derivate di \( h(t) \):
          \[
            h'(t) = \delta_0 \cdot \delta'(t) - 2d_{1,0} \cdot e^{-2t} \cdot \delta_{-1}(t)
            + d_{1,0} \cdot e^{-2t} \cdot \delta(t)
          \] 
      \end{itemize}

    \item Sostituisco \( v(t) \mapsto h(t) \) e \( u(t) \mapsto \delta(t) \) 
      \[
      v'(t) + 2v(t) = u'(t) + u(t)
      \] 
      \[
      \Downarrow
      \] 
      \[
        \color{green}h'(t) \color{black}+ \color{purple}2h(t) \color{black}= 
        \color{yellow}\delta'(t) + \color{red}\delta(t)
      \] 
      \[
        \begin{aligned}
          &\color{green}d_0 \cdot \delta'(t) - 2d_{1,0} \cdot e^{-2t} \cdot \delta_{-1}(t) + d_{1,0}
          \cdot e^{-2t} \cdot \delta(t) \\
          &\color{purple}+ 2 \left( d_0 \cdot \delta(t) + d_{1,0} \cdot
          e^{-2t} \cdot \delta_{-1}(t) \right)\\
          &= \color{yellow}\delta'(t) + \color{red}\delta(t)
        \end{aligned}
      \] 
      \[
      \begin{aligned}
        d_0 \cdot \delta'(t) - 2d_0 \cdot  \delta(t) + d_{1,0} \cdot e^{-2t} \cdot
        \delta(t) = \delta'(t) + \delta(t)\\
      \end{aligned}
      \] 
      Valutiamo le funzioni in \( t=0 \) 
      \[
        d_0 \cdot \delta'(0) - 2d_0 \cdot  \delta(0) + d_{1,0} \cdot \cancel{e^{-2 \cdot 0}}
        \cdot \delta(0) = \delta'(0) + \delta(0)
      \] 
      Sposto tutto a sinistra:
      \[
        d_0 \cdot \delta'(0) - 2d_0 \cdot \delta(0) + d_{1,0} \cdot \delta(0) - \delta'(0) -
        \delta(0) = 0
      \] 
      Raccolgo per \( \delta(0), \delta'(0)\ldots \delta^n(t) \) che sono linearmente
      indipendenti:
      \[
        \left( d_0 - 1 \right) \cdot \delta'(0) + \left( d_{1,0} - 2d_0 - 1 \right) \cdot
        \delta(0) = 0
      \] 

    \item Risolvo il sistema
      \[
      \begin{cases}
        \left( d_0 - 1 \right) \cdot \delta'(0) = 0\\
        \left( d_{1,0} - 2d_0 - 1 \right) \cdot \delta(0) = 0
      \end{cases}
      \to 
      \begin{cases}
        d_0 = 1\\
        d_1 = -1
      \end{cases}
      \] 

    \item Sostituisco i coefficienti appena trovati
      \[
        \begin{aligned}
          h(t) &= \underbrace{d_0}_{1} \cdot \delta(t) + \underbrace{d_{1,0}}_{-1}
          \cdot e^{-2t} \cdot \delta_{-1}(t)\\
               &= \delta(t) - e^{-2t} \cdot \delta_{-1}(t)
        \end{aligned}
      \] 
      E questa è la risposta impulsiva del sistema

    \item Bisogna calcolare la risposta forzata...
  \end{enumerate}
  \label{ex:risposta_impulsiva}
\end{example}

\begin{exercise}
  Si vuole calcolare la risposta impulsiva del sistema:
  \[
    2v'(t) - v(t) = u'(t) + 3u(t)
  \] 
  Siccome abbiamo la derivata prima sia a sinistra a destra il sistema è proprio
  \( (n = m) \to d_0 \neq 0 \).
  \[
    h(t) = d_0 \cdot \delta(t) + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} d_{i,l} \cdot
    \frac{t^l}{l!} \cdot e^{\lambda_i t} \cdot \delta_{-1}(t)
  \] 
  \begin{enumerate}
    \item Calcolo le radici usando l'equazione omogenea del polinomio caratteristico:
      \[
        \begin{aligned}
          2s - 1 &= 0\\
          2s &= 1\\
          s = \frac{1}{2}
        \end{aligned}
      \] 
      \[
        \lambda_1 = \frac{1}{2} \quad r = 1 \quad \mu = 1
      \] 

    \item Calcolo la risposta impulsiva:
      \[
        h(t) = d_0 \cdot \delta_0(t) + d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_{-1}(t)
      \] 

    \item Riscrivo l'equazione iniziale con \( v(t) = h(t),\; u(t) = \delta_0(t) \):
      \[
        2h'(t) - h(t) = \delta_0'(t) + 3\delta_0(t)
      \] 

    \item Calcolo le derivate di \( h(t) \):
      \[
      \begin{aligned}
        h'(t) = d_0 \cdot \delta_0'(t) + \frac{1}{2} \cdot d_1 \cdot e^{\frac{1}{2}t}
        \cdot \delta_{-1}(t) + d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_0(t)
      \end{aligned}
      \] 

    \item Sostituisco:
      \[
        \begin{aligned}
          2 \left[ d_0 \delta_0'(t) + \frac{1}{2} \cdot d_1 \cdot e^{\frac{1}{2}t} \cdot
          \delta_{-1}(t) + d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_0(t) \right] -\\
          \left[ d_0 \cdot \delta_0(t) + d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_{-1}(t) \right]\\
          = \delta_0'(t) + 3\delta_0(t)
        \end{aligned}
      \] 
      Togliere tutti i termini \( \delta_{-1}(0^-) = 0 \) 

    \item Raccolgo le funzioni indipendenti \( \delta_0(t), \delta_0'(t), \delta_0''(t) \):
      \[
      \begin{cases}
        2d_0 \cdot \delta_0'(t) = \delta_0'(t)\\
        2d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_0(t) = 3\delta_0(t)
      \end{cases}
      \] 
      Imponiamo \( t = 0^- \) 
      \[
      \begin{cases}
        2d_0 \cdot \cancel{\delta_0'(0)} = \cancel{\delta_0'(0)}\\
        \left( 2d_1 \cdot \underset{=1}{\cancel{e^{\frac{1}{2} \cdot 0}}} \right) \cdot \delta_0(0) = 3\delta_0(0)
      \end{cases}
      \] 
      \[
      \begin{cases}
        2d_0 = 1\\
        2d_1 - d_0 = 3
      \end{cases}
      \to 
      \begin{cases}
        d_0 = \frac{1}{2}\\
        d_1 = \frac{7}{4}
      \end{cases}
      \] 

    \item Scrivo la risposta impulsiva:
      \[
        h(t) = \frac{1}{2} \cdot \delta_0(t) + \frac{7}{4} \cdot e^{\frac{1}{2}t} \cdot \delta_{-1}(t)
      \]
    \item Calcolo la risposta forzata nell'esercizio \ref{ex:risposta_forzata}
  \end{enumerate}
  \label{ex:risposta_impulsiva_2}
\end{exercise}

\subsubsection{Risposta forzata}
\begin{definition}
  La risposta forzata vuol dire che l'uscita del sistema dipende solo dall'input di un
  sistema LTI, causale per un ingresso \( u(t) \) (\( u(t) = 0, t < 0 \)) e si definisce
  come:
  \[
    \begin{aligned}
      v_f(t) = (u \ast h)(t) &= \int_{0^-}^{t^+} u(\tau) \cdot h(t-\tau) \, d\tau\\
                             &= \int_{0^-}^{t^+} u(t-\tau) \cdot h(\tau) \, d\tau
    \end{aligned}
  \] 
  dove:
  \[
  \begin{aligned}
    u &= \text{Input}\\
    h &= \text{Risposta impulsiva}\\
  \end{aligned}
  \] 
\end{definition}

\begin{example}
  Riprendendo l'ultimo punto dell'esempio \ref{ex:risposta_impulsiva}, la risposta
  forzata è:
  \[
    \begin{aligned}
      v_f(t) = (u \ast h)(t) &= \int_{+\infty}^{-\infty} u(\tau) \cdot h(t-\tau) \, d\tau\\
                             &= \int_{t^+}^{0} u(t) \cdot h(t-\tau) \, d\tau
    \end{aligned}
  \] 
\end{example}

\begin{exercise}
  \label{ex:risposta_forzata}
  Data la risposta impulsiva dell'esercizio \ref{ex:risposta_impulsiva_2} calcoliamo la
  risposta forzata con un input \( u(t) = 3\delta_{-1}(t) \) (gradino alto 3):
  \[
  \begin{aligned}
    v_f &= (h \ast u)(t) \\
        &= (h \ast 3\delta_{-1})(t)\\
        &= \int_{-\infty}^{+\infty} h(\tau) \cdot 3\delta_{-1}(t-\tau) \, d\tau\\
        &= \int_{-\infty}^{+\infty} \left[ \frac{1}{2} \cdot \delta_0(\tau) + \frac{7}{4}
        \cdot e^{\frac{1}{2}\tau} \cdot \delta_{-1}(\tau) \right] \cdot 3\delta_{-1}(t-\tau) \, d\tau\\
        &= \int_{-\infty}^{+\infty} \frac{1}{2} \delta_0(\tau) \cdot
        3\delta_{-1}(t-\tau) \, d\tau + \int_{-\infty}^{+\infty} \frac{7}{4} e^{\frac{1}{2}\tau}
        \cdot \delta_{-1}(\tau) \cdot 3\delta_{-1}(t-\tau) \, d\tau\\
        &= \frac{3}{2} \int_{\cancel{\stackrel{\color{green!50!black}0^-\color{black}}{-\infty}}}^{\cancel{\stackrel{\color{orange}0^+\color{black}}{+\infty}}} 
        \stackrel{=1}{
        \cancel{
        \underbrace{\delta_0(\tau)}_{[0^-,0^+]} \cdot
        \underbrace{\delta_{-1}(t-\tau)}_{[-\infty,t]}
        }}
        \, d\tau + \frac{21}{4} 
        \int_{\cancel{\stackrel{\color{blue}0\color{black}}{-\infty}}}^{\cancel{\stackrel{\color{red}t\color{black}}{+\infty}}}
        e^{\frac{1}{2}\tau} \cdot \delta_{-1}(\tau) \cdot \delta_{-1}(t-\tau) \, d\tau\\
        &= \frac{3}{2} \cdot 1 + \frac{21}{4} \cdot \int_{0}^{t} e^{\frac{1}{2}\tau} \, d\tau\\
        &\to \frac{3}{2} + \frac{21}{4} \cdot \left[ \frac{1}{2} \cdot e^{\frac{1}{2}\tau} \right]_0^t\\
        &= \frac{3}{2} + \frac{21}{4} \cdot \left( \frac{1}{2} \cdot e^{\frac{1}{2}t} - \frac{1}{2} \right)\\
        &= \frac{3}{2} + \frac{21}{8} \cdot e^{\frac{1}{2}t} - \frac{21}{8} \cdot \frac{1}{2}\\
        &= v_f(t)
  \end{aligned}
  \] 
  Teniamo fissa la risposta impulsiva \( h(t) \) e trasliamo il gradino \( u(t) \)
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\a{1}
      \draw[->] (-4,0) -- (4,0) node[right] {$t$};
      \draw[->] (0,-1.5) -- (0,1.5) node[above] {$f(t)$};

      \node[below left,scale=0.6,green!50!black] at (0,0) {\( 0^- \)};
      \node[below right,scale=0.6,orange] at (0,0) {\( 0^+ \)};

      \draw[orange,thick] (-3.9,0)  -- (0,0) -- (0,\a) -- (3.9,\a) 
        node[above] {\( 3 \delta_{-1}(t) \)};
      \draw[green!50!black,thick] (-3.9,\a) node[above] {\( 3 \delta_{-1}(t - \tau) \)} -- 
        (0,\a) -- (0,0) -- (3.9,0);
    \end{tikzpicture}
    \caption{\( 3 \delta_{-1}(t - \tau) \) viene traslato}
  \end{figure}
  \( +\infty \) e \( -\infty \) diventano \( 0 \) e \( t \) perchè:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\a{1}
      \draw[->] (-4,0) -- (4,0) node[right] {$t$};
      \draw[->] (0,-1.5) -- (0,1.5) node[above] {$f(t)$};

      \node[below right,scale=0.6,blue] at (0,0) {\( 0 \)};

      \draw[blue,thick] (-3.9,0)  -- (0,0) -- (0,\a) -- (3.9,\a) 
        node[above] {\( 3 \delta_{-1}(t) \)};
      \draw[red,thick] (-3.9,\a) node[above] {\( 3 \delta_{-1}(t - \tau) \)} -- 
        (2,\a) -- (2,0) node[below] {\( t \)} -- (3.9,0);
    \end{tikzpicture}
    \caption{\( 3 \delta_{-1}(t - \tau) \) viene traslato}
  \end{figure}
\end{exercise}

\subsubsection{Risposta totale}
Data un'equazione che descrive un sistema LTI:
\[
  \sum_{i=0}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} = \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}
\] 
la risposta totale si calcola come la somma della risposta libera e forzata:
\[
  v_t(t) = v_l(t) + v_f(t)
\] 
La risposta libera è data da:
\[
  v_l(t) = \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} c_{i,l} \cdot \frac{t^l}{l!} \cdot e^{\lambda_i t}
\] 
La risposta forzata è data da:
\[
  \begin{aligned}
    v_f(t) &= (\underbrace{u}_{\text{Input}} \ast \underbrace{h}_{\text{Risposta impulsiva}})(t)\\
           &= \int_{0^-}^{t^+} u(\tau) \cdot h(t-\tau) \, d\tau\\
           &= \int_{0^-}^{t^+} u(t-\tau) \cdot h(\tau) \, d\tau
  \end{aligned}
\]
e la risposta impulsiva è data da:
\[
  h(t) = d_0 \cdot \delta(t) + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} d_{i,l} \cdot \frac{t^l}{l!} \cdot e^{\lambda_i t} \cdot \delta_{-1}(t)
\]


\end{document}
