\documentclass[a4paper]{article}
\usepackage{import}
\input{../../../preamble.sty}

\pgfplotsset{width=7cm}

\begin{document}

\input{title.tex}

\tableofcontents
\pagebreak

% Info:
% Esame: 4 esercizi. Si possono portare appunti, solo scritti a mano e non troppi.
% Libro: Segnali e sistemi (Giuseppe Ricci & Maria Elena Valeher)
% Libro2: Signals & systems second edition (Alan V. Oppenheim & Alan S. Willsky)
\section{Concetti base}
Un sistema è formato da \textbf{segnali trasmessi}, un'esempio di segnale
è la voce che usiamo per comunicare tra di noi. Il sistema prende le informazioni
ricevute dal segnale e le rielabora. 

\noindent 
Degli esempi di sistema sono:
\begin{itemize}
  \item Microfono-Casse
  \item Freno della macchina
\end{itemize}

\subsection{Tipi di segnali}
I segnali possono essere di due tipi:

\begin{itemize}
  \item \textbf{Segnali a tempo continuo}: Segnali che hanno infiniti punti per ogni
    infinitesimo di tempo.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-1,0) -- (5,0) node[right] {$t$};
        \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(t)$};
        \draw[domain=0:4.5,smooth,samples=100,variable=\x,blue] plot ({\x},{sin(\x*5 r)});
      \end{tikzpicture}
      \caption{Esempio di segnale a tempo continuo}
    \end{figure}
  \item \textbf{Segnali a tempo discreto}: Segnali che hanno un numero finito di punti
    per ogni intervallo di tempo.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-1,0) -- (5,0) node[right] {$k$};
        \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
        \draw[domain=0:4.5,smooth,variable=\x,white] plot ({\x},{sin(\x*5 r)});
        \foreach \x in {0,0.2,...,4.5}
       \draw[blue,thick] (\x,0) -- (\x,{sin(\x*5 r)});
      \end{tikzpicture}
      \caption{Esempio di segnale a tempo discreto}
    \end{figure}

\end{itemize}

\noindent
Per elaborare i dati attraverso un computer bisogna convertire un segnale continuo
in uno discreto, questo processo è chiamato \textbf{campionamento} e non è
\textbf{distruttivo}, cioè si può tornare indietro al segnale originale.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-1,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(t)$};
    \draw[domain=0:4.5,smooth,variable=\x] plot ({\x},{sin(\x*5 r)});
    \draw[domain=0:4.5,smooth,variable=\x,blue, thick] plot[ycomb, mark=*, mark size=1.5pt] ({\x},{sin(\x*5 r)});
  \end{tikzpicture}
  \caption{Esempio di campionamento}
\end{figure}

\noindent
Una volta campionato il segnale si deve \textbf{quantizzare}, ovvero approssimare
il valore del segnale a un valore discreto, questa operazione è \textbf{parzialmente
distruttiva}, cioè si può tornare indietro al segnale originale perdendo alcune
informazioni.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-1,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(t)$};
    \draw[domain=0:4.5,smooth,variable=\x,blue] plot[const plot] ({\x},{sin(\x*5 r)});
  \end{tikzpicture}
  \caption{Esempio di quantizzazione}
\end{figure}

Infine si fa \textbf{encoding}, ovvero
si codifica il segnale per poterlo adattare ad un altro tipo di segnale, questo
processo è \textbf{completamente distruttivo}.

\vspace{1em}
\noindent
I segnali possono essere di dimensioni diverse, ad esempio:
\begin{itemize}
  \item L'andamento di una borsa è un segnale a 1 dimensione.
  \item Una foto in bianco e nero è un segnale a 2 dimensioni \( (x,y) \).
  \item Una foto colorata è un segnale multidimensionale \( (x,y)^3 \) per
    rappresentare ogni colore (R,G,B).
\end{itemize}

\subsection{Rappresentazione dei sistemi}
Un sistema lo rappresentiamo con un blocco, dove all'ingresso mettiamo il segnale
in ingresso e all'uscita il segnale in uscita.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {\( \Sigma \) };
    \draw[->] (-1,0) -- (A) node[midway,above left] {$\stackrel{u(t)}{\text{Ingresso}}$};
    \draw[->] (A) -- (1,0) node[midway,above right] {$\stackrel{v(t)}{\text{Uscita}}$};
  \end{tikzpicture}
  \caption{Rappresentazione di un sistema}
\end{figure}

\noindent
L'output di un sistema può essere rielaborato per essere inserito nuovamente come
input in un altro sistema, ad esempio:

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {\( \Sigma \) };
    \draw[->] (-1,0) -- (A) node[midway,above left] {$\stackrel{u(t)}{\text{Ingresso}}$};
    \draw[->] (A) -- (1,0) node[midway,above right] {$\stackrel{v(t)}{\text{Uscita}}$};

    \node[draw,minimum width=1cm,minimum height=1cm] (B) at (0,-1.5) {\( G \) };
    \draw[<-] (-0.75,0) |- (B) node[midway,above left] {};
    \draw[<-] (B) -| (0.75,0) node[midway,above right] {};
  \end{tikzpicture}
  \caption{Rappresentazione di due sistemi in cascata}
\end{figure}

\section{Notazioni}
Tutti i segnali sono indicati con la lettera minuscola, ad esempio:
\[
  \underbrace{f}_{segnale} \quad \underbrace{f(t)}_{\text{segnale a tempo continuo}}
\] 
Oppure si utilizzano delle notazioni standard:
\begin{enumerate}
  \item \( t,\;\tau,\;t_i \): tempo continuo
  \item \( k \): tempo discreto
\end{enumerate}

\noindent
In questo corso si considerano solo segnali continui o discreti monodimensionali
non negativi e solo sistemi \textbf{LTI} (Lineari e Tempo Invarianti):
\begin{enumerate}
  \item \textbf{Lineare}: Vale la \textbf{sovrapposizione degli effetti}, cioè se \( v_1(t) \)
    è l'uscita del sistema per \( u_1(t) \) e \( v_2(t) \) è l'uscita del sistema
    per \( u_2(t) \) allora \( v_1(t) + v_2(t) \) è l'uscita del sistema per
    \( u_1(t) + u_2(t) \).
  \item \textbf{Tempo Invariante}: A prescindere dal punto di tempo in cui si
    applica il segnale, l'uscita del sistema è sempre la stessa.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-0.2,0) -- (6,0) node[right] {$t$};
        \draw[->] (0,-0.2) -- (0,2.2) node[above] {$u(t)$};
        \draw[blue, domain=0:6, smooth] plot ({\x},{sin((cos(\x r) * \x - 3)/2 r)+1});

        \node[draw,minimum width=1cm,minimum height=1cm] (A) at (3,-2) {\( \Sigma \) };
        \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
        \draw[->] (A) -- ++(0,-1) node[midway,above right] {};
        \node[below left, blue] at (0,0) {$t_0$};

        \draw[->] (-0.2,-5) -- (6,-5) node[right] {$t$};
        \draw[->] (0,-5.2) -- (0,-3.2) node[above] {$v(t)$};
        \draw[red, domain=0:6, samples=100, smooth, yshift=-5cm] plot ({\x},{sin((cos(2*\x r) * \x - 3)/2 r)+1});
        \node[below left, red] at (0,-5) {$t_0$};
      \end{tikzpicture}
    \end{figure}
    \[
      t_1 = t_0 + t_n
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-0.2,0) -- (6,0) node[right] {$t$};
        \draw[->] (0,-0.2) -- (0,2.2) node[above] {$u(t)$};
        \node[below left] at (0,0) {$t_0$};
        \draw[blue, domain=0:5, smooth] plot ({\x + 1},{sin((cos(\x r) * \x - 3)/2 r)+1});
        \node[below, blue] at (1,0) {$t_1$};

        \node[draw,minimum width=1cm,minimum height=1cm] (A) at (3,-2) {\( \Sigma \) };
        \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
        \draw[->] (A) -- ++(0,-1) node[midway,above right] {};
        \draw[blue] (0.1,0.1) -- ++(0,0.2) -- ++(0.9,0) node[midway, above, blue] {$t_n$} -- ++(0,-0.2);

        \draw[->] (-0.2,-5) -- (6,-5) node[right] {$t$};
        \draw[->] (0,-5.2) -- (0,-3.2) node[above] {$v(t)$};
        \draw[red, domain=0:5, samples=100, smooth, yshift=-5cm] plot ({\x + 1},{sin((cos(2*\x r) * \x - 3)/2 r)+1});
        \node[below, red] at (1,-5) {$t_1$};
        \draw[red] (0.1,-4.9) -- ++(0,0.2) -- ++(0.9,0) node[midway, above, red] {$t_n$} -- ++(0,-0.2);
      \end{tikzpicture}
      \caption{Esempio di invarianza nel tempo}
    \end{figure}
\end{enumerate}

\noindent
I sistemi vengono rappresentati con lettere maiuscole greche o non.

\section{Modello di sistemi}
\subsection{Approccio classico}
Questo approccio prevede di avere un \textbf{evento fisico} (circuito, molla, ecc...) e per
questo evento bisogna definire un \textbf{modello} del sistema. Questo si può fare attraverso
degli strumenti grafici o matematici. Come strumenti matematici si usano:
\begin{enumerate}
  \item \textbf{Continuo}: 
    \begin{enumerate}
      \item Equazioni differenziali
      \item Trasformate di Laplace
      \item Trasformate di Fourier
    \end{enumerate}
  \item \textbf{Discreto}: 
    \begin{enumerate}
      \item Equazioni alle differenze
      \item Trasformate Z
    \end{enumerate}
\end{enumerate}

\noindent Una volta modellato l'evento fisico si può fare un'analisi del sistema
e ciò permette di descrivere la \textbf{stabilità} e le \textbf{proprietà} del sistema.

\noindent
L'ultima fase è quella di \textbf{sintesi}, cioè la fase di correzione del sistema
per far si che risulti stabile.

\subsection{Approccio moderno}
L'approccio moderno ha solo un blocco per rappresentare gli stati:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {Stati};
    \draw[->] (-1,0) -- (A) node[midway,above left] {Ev. Fisico};
  \end{tikzpicture}
  \caption{Rappresentazione di un sistema con l'approccio moderno}
\end{figure}

\subsection{Obsolescenza}
L'obsolescenza è il numero di anni che un sistema può durare. I sistemi che
verranno studiati sono quelli che si trovano nella sezione di comportamento lineare,
cioè i sistemi che non cambiano nel tempo.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Define constants
    \def\A{1}
    \def\C{1}
    \def\xone{-2}
    \def\xtwo{2}

    % Left quadratic part: A(x - x1)^2
    \draw[blue, thick, domain=-4:\xone, samples=100] 
      plot (\x, {\A*(\x - \xone)^2 + \C});

    % Middle constant part: C
    \draw[blue, thick] 
      plot[domain=\xone:\xtwo] (\x, {\C});

    % Right quadratic part: A(x - x2)^2
    \draw[blue, thick, domain=\xtwo:4, samples=100] 
      plot (\x, {\A*(\x - \xtwo)^2 + \C});

    % Axes
    \draw[->] (-4.2,0) -- (4.5,0) node[right] {$x$};
    \draw[->] (-4,-0.5) -- (-4,5) node[above] {$y$};

    % Labels
    \node[above] at (0, 1) {Comportamento lineare};
  \end{tikzpicture}
  \caption{Sezione di comportamento lineare}
\end{figure}

\noindent
Un'esempio è una molla che si deforma in base alla forza applicata, quando essa
si deforma assume un comportamento plastico e quindi non lineare,
mentre quando non si deforma assume un comportamento elastico e quindi lineare.

\subsection{Causalità}
La causalità è l'input del sistema e l'effetto è l'output che produce, quindi
la causa precede sempre l'effetto. Non esiste un sistema causale che abbia
l'output prima dell'input.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Define constants
    \def\A{-0.4}      % Amplitude
    \def\lambda{0.2}  % Damping factor
    \def\omega{-1.1}     % Angular frequency
    \def\phi{-6.9}       % Phase shift
    \def\offset{-6.7}         % X Offset


    \draw[->] (-0.5,0) -- (6,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,1.5) node[above] {$u(t)$};

    \draw[domain=0:5.9,smooth,tension=0.8,blue] plot ({\x}, {2.2*\x*exp(-0.8*\x)})
      node[above right] {$u(t)$};

    \draw[domain=1:5.9,smooth,tension=0.8,red] plot ({\x}, 
      {\A*exp(-\lambda*(\x + \offset)) * cos((\omega * (\x + \offset) + \phi) r) + 1})
      node[above] {$v(t)$};

    \node[blue] at (0,0) [below left] {$t_0$};
    \node[red] at (1,0) [below] {$t_1$};

    \node at (3,-1) {$\color{blue} t_0 \color{black} < \color{red} t_1$};
  \end{tikzpicture}
  \caption{Esempio di causalità}
\end{figure}

\subsection{Stabilità}
Un sistema è stabile se, a seguito di un'oscillazione, ritorna al suo stato
di equilibrio e il sistema si ferma. Un sistema è instabile se, a seguito di un'oscillazione,
si allontana dal suo stato di equilibrio.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Axis
    \draw[->] (-0.2,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,3) node[above] {$y$};

    \draw[red, domain=-2:1, samples=100, smooth] plot ({\x+2},{exp(\x)});
  \end{tikzpicture}
  \caption{Sistema instabile}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Axis
    \draw[->] (-0.2,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-0.7) -- (0,2) node[above] {$y$};

    \draw[red, domain=0.001:3.9, samples=100, smooth] plot ({\x},{sin(5*\x r)/(3*\x)});
  \end{tikzpicture}
  \caption{Sistema stabile}
\end{figure}

\noindent
Ci sono 2 tipi di stabilità:
\begin{itemize}
  \item \textbf{Stabilità asintotica} \( \to  \forall\;i \;\; \Re{\lambda_i} < 0\) 
  \item \textbf{Stabilità BIBO} verificare che \( h(t) \) sia integrabile:
    \[
      \int_{-\infty}^{+\infty} h(t) \, dt < +\infty
    \] 
\end{itemize}

\subsubsection{Stabilità BIBO (Bounded Input Bounded Output)}
Se il segnale di ingresso è limitato in ampiezza allora il segnale di uscita
è limitato in ampiezza.
\[
\exists M > 0,\; | u(t) | < M \; \forall t \in \mathbb{R}
\] 
\[
\Downarrow
\] 
\[
  \exists N > 0,\; | v(t) | < N \; \forall t \in \mathbb{R}
\] 
\[
  \text{con} \; M,N \in \mathbb{R}\; \text{non per forza uguali}
\] 

\begin{figure}[H]
  \centering
  \begin{tikzpicture}[]
    % Input graph
    \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-2) -- (0,2) node[above] {$u(t)$};
    \draw[blue, domain=0.001:4.8, samples=100, smooth] plot ({\x},{sin(\x*\x r)/(0.5*\x)});
    \draw[blue, dashed] (4.8,1.7) -- (0,1.7) node[left] {$M$};
    \draw[blue, dashed] (4.8,-0.92) -- (0,-0.92) node[left] {$-M$};

    % System
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
    \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
    \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

    % Output graph
    \draw[->] (0,-8) -- (0,-4) node[above] {$v(t)$};
    \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
    \draw[red, domain=0.001:4.8, samples=200, smooth] plot ({\x},{sin(\x*\x*\x*0.5 r)/(0.7*\x) - 6});
    \draw[red, dashed] (4.8,-5) -- (0,-5) node[left] {$N$};
    \draw[red, dashed] (4.8,-6.65) -- (0,-6.65) node[left] {$-N$};
  \end{tikzpicture}
  \caption{Esempio di sistema stabile BIBO}
\end{figure}

\subsubsection{Stabilità Asintotica}
Se il segnale di ingresso si annulla allora il segnale di uscita si annulla.
\[
\lim_{t \to \infty} v(t) = 0 \;\; \forall r \; \text{di} \; u(t),\; t \in \mathbb{R}
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[]
    % Input graph
    \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-2) -- (0,2) node[above] {$u(t)$};
    \draw[blue, domain=0.001:4.8, samples=100, smooth] plot ({\x},{(sin((\x*5)/2 r))/(1.3*\x)});
    \node[above, blue, scale=0.8, yshift=0.2cm] at (5,0) {$\lim_{t \to \infty} = 0$};

    % System
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
    \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
    \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

    % Output graph
    \draw[->] (0,-8) -- (0,-4) node[above] {$v(t)$};
    \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
    \draw[red, domain=0.001:4.8, smooth] plot ({\x},{sin(\x*5 r)/(2.5*\x) - 6});
    \node[above, red, scale=0.8, yshift=0.2cm] at (5,-6) {$\lim_{t \to \infty} = 0$};
  \end{tikzpicture}
  \caption{Esempio di sistema stabile asintotico}
\end{figure}

\noindent
La stabilità asintotica implica la stabilità BIBO, ma non viceversa.

\section{Modello di segnali}
Un segnale si può scrivere nel seguente modo:
\[
\alpha \in \mathbb{C}
\] 
\[
  t \in \mathbb{R}
\] 
\[
l \in \mathbb{Z}
\] 

\[
  y(t) = \sum_{i} \sum_{j} c_{ij} \cdot \color{blue} \underbrace{e^{\alpha t}}_{\text{Parte esponenziale}}
  \color{black} \cdot \color{green!50!black} \underbrace{\frac{t^l}{l!}}_{\text{Parte polinomiale}}
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,3) node[above] {$y(t)$};
    \draw[domain=-3:1.1,smooth,variable=\x,blue] plot ({\x},{exp(\x)}) node[above right, scale=0.9] {$e^{\alpha t} \;\; (\alpha > 0)$};
    \draw[domain=-1.1:3,smooth,variable=\x,cyan] plot ({\x},{exp(-\x)}) node[above right, scale=0.9] {$e^{\alpha t} \;\; (\alpha < 0)$};
    \draw[domain=0:3,smooth,variable=\x,green!50!black] plot ({\x},{\x}) node[above right, scale=0.9] {$t$};

    \draw[->] (0,-1) -- ++(0,-1) node[midway, right] {Risultato};

    \draw[->,yshift=1cm] (-3.2,-6) -- (3,-6) node[right] {$t$};
    \draw[->,yshift=1cm] (-3,-6.2) -- (-3,-4) node[above] {$y(t)$};
    \draw[domain=0:5.9,smooth,tension=0.8,red,yshift=-5cm,xshift=-3cm] plot ({\x}, {2.2*\x*exp(-0.8*\x)});
  \end{tikzpicture}
  \caption{Esempo di segnale}
\end{figure}

\noindent
Ad esempio con \( l = 1 \):
\[
  y(t) = \sum_{i} \sum_{j} c_{ij} \cdot e^{\alpha t} \cdot \frac{t^1}{1!} =
  \sum_{i} \sum_{j} c_{ij} \cdot e^{\alpha t} \cdot t
\] 

\noindent
Con \( \alpha < 0 \) il sistema è stabile perchè l'esponenziale tende a 0.

\vspace{1em}
\noindent 
Con \( l = 2 \):
\[
  y(t) = \sum_{i} \sum_{j} c_{ij} \cdot e^{\alpha t} \cdot \frac{t^2}{2!} =
  \sum_{i} \sum_{j} c_{ij} \cdot e^{\alpha t} \cdot \frac{t^2}{2}
\]
ecc...

\vspace{1em}
\noindent
Siccome \( \alpha \in \mathbb{C} \) si può riscrivere come:
\[
\alpha = \lambda + j \omega
\] 
\[
  \lambda \text{ è la parte reale}
\] 
\[
  j \omega \text{ è la parte immaginaria}
\] 
Quindi il segnale diventa:
\[
  y(t) = \sum_{i} \sum_{j} c_{ij} \cdot e^{\lambda t} \cdot e^{j \omega t} \cdot \frac{t^l}{l!}
\] 
Utilizzando la forma trigonometrica dei numeri complessi si ha che:
\[
  e^{j \omega} = \cos(\omega t) + j \sin(\omega t)
\] 
\[
  e^{(\lambda + j \omega)} = e^{\alpha t} = \rho (cos(\omega t) + j \sin(\omega t))
\] 
Per le formule di Eulero che dice:
\[
  cos\theta = \frac{e^{j \theta} + e^{-j \theta}}{2}
\] 
\[
  sin\theta = \frac{e^{j \theta} - e^{-j \theta}}{2j}
\]
\begin{figure}[H]
  \begin{definition}[Complesso cognugato]
    A ogni numero complesso è associato un cognugato che ha la stessa parte reale,
    ma parte immaginaria opposta.
  \end{definition}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
    \draw[->] (0,-3) -- (0,3) node[above] {$\Im$};

    \draw (0,0) circle (2.5);
    
    \draw[-*,blue,dashed,rotate=45] (0,0) -- (2.6,0) node[midway,above left] {$\rho$} 
      node[above right] {$S$} node (s) {};
    \draw[blue] (1,0) arc (0:45:1) node[midway, right] {$\Theta$};

    \draw[-*,red,dashed,rotate=-45] (0,0) -- (2.6,0) node[midway,below left] {$\rho$} 
      node[below right] {$\bar{S}$} node (bars) {};
    \draw[red] (1,0) arc (0:-45:1) node[midway, right] {$\Theta$};

    \draw[dashed] (s) -- (bars);
  \end{tikzpicture}
  \caption{Circonferenza di proiezione}
\end{figure}
\[
  \color{blue} S = \rho (cos(\theta) + j \sin(\theta)) \color{black}
\] 
\[
  \color{red} \bar{S} = \rho (cos(-\theta) + j \sin(-\theta)) \color{black}
\]
\section{Funzioni in \texorpdfstring{\( \mathbb{C} \)}{C}}
\subsection{Funzione a variabili complesse}
\begin{figure}[H]
  \begin{definition}[Funzione a variabile complessa]
    Una funzione a variabile complessa è una funzione che ha come dominio un insieme
    di numeri complessi e come codominio un insieme di numeri complessi.
  \end{definition}
\end{figure}

\begin{figure}[H]
  \begin{definition}[Punto interno]
    Un punto \( S_0 \) appartenente a un intorno \( D(f) \subseteq \mathbb{C} \) è
    interno a \( D(f) \) se e solo se esiste un disco \( B_\rho(S_0) \)  di raggio \( \rho \in \mathbb{R}_+ \) 
    centrato in \( S_0 \) tale che:
    \[
      B_\rho(S_0) \subset D(f)
    \] 
    Quindi \( D(f) \) è un dominio e \( B_\rho(S_0) \) è un sottoinsieme:
    \[
      B_\rho(S_0) = \left\{ S \in \mathbb{C} \;|\; \|S_0 - S\| < \rho \right\}
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \def\r{1}
        \def\s{(2,2)}
        \def\d{\r * 2.5}

        \draw[->] (-2,0) -- (5,0) node[right] {$\mathbb{C}$};
        \draw[->] (0,-2) -- (0,5) node[above] {};
        \draw[green!50!black] \s circle (\r);
        \draw[blue] \s ++(-0.5,-0.7) circle (\d);
        \draw[fill=black] \s circle (0.05) node[above right] {$S_0$};
        \draw[fill=black] \s ++(\r,0) circle (0.05) node[above right] {$S$};
        \draw[<->] \s -- ++(\r,0) node[midway, below] {$\rho$};
        \node[green!50!black] at (2,1) [below] {$B_\rho(S_0)$};
        \node[blue] at (1.5,3.8) [above] {$D(f)$};
      \end{tikzpicture}
    \end{figure}
  \end{definition}
\end{figure}

\begin{definition}[Insieme aperto]
  È l'insieme di tutti i punti che sono definiti interni.

  \vspace{1em}
  \noindent
  Ad esempio:
  \begin{itemize}
    \item insieme \( \mathbb{C} \) 
    \item insieme \( \emptyset \) 
    \item i dischi in un punto \( S_0 \), \( B_{\rho}(S_0) = \left\{ S \in \mathbb{C} \;|\; \|S_0 - S\| < \rho \right\} \) 
    \item corone circolari centrate in un punto \( x \) ,
      \[
        \; \left\{ S \in \mathbb{C},\;
          \rho_1, \rho_2 \in \mathbb{R} \;|\;
        \rho_1 <  |S-x| < \rho_2\right\}
      \]
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          \def\r{1}
          \def\s{(1,3)}
          \def\d{1.5}
          \def\x{(3.5,1.5)}

          \draw[->] (-2,0) -- (5,0) node[right] {$\mathbb{C}$};
          \draw[->] (0,-2) -- (0,5) node[above] {};
          \draw[green!50!black] \s circle (\r);
          \draw[blue] \x circle (\d);
          \draw[blue] \x circle (\d/2);
          \draw[fill=black] \s circle (0.05) node[above right] {$S_0$};
          \draw[fill=black] \x circle (0.05) node[above right] {$x$};
          \draw[<->] \x -- ++(\d/2,0) node[midway, below] {$\rho_1$};
          \draw[<->] \x ++(\d/2,0) -- ++(\d/2,0) node[midway, below] {$\rho_2$};
          \node[green!50!black] at (1,3.6 + \r) [below] {$B_\rho(S_0)$};
        \end{tikzpicture}
      \end{figure}
    \item semipiani destri o sinistri, superiori o inferiori
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          \def\pdx{1.5}
          \def\psx{-1.5}

          \def\psp{1.5}
          \def\pif{-1.5}


          \def\x{3}
          \def\y{3}
          \draw[->] (-\x,0) -- (\x,0) node[right] {$\Re$};
          \draw[->] (0,-\y) -- (0,\y) node[above] {$\Im$};

          \draw[red,dashed] (\psx,\y) -- (\psx,-\y);
          \draw[red,fill,opacity=0.2] (-\x,\y) rectangle (\psx,-\y);

          \draw[blue,dashed] (\pdx,\y) -- (\pdx,-\y);
          \draw[blue,fill,opacity=0.2] (\pdx,\y) rectangle (\x,-\y);


          \draw[green!50!black,dashed] (-\x,\psp) -- (\x,\psp);
          \draw[green!50!black,fill,opacity=0.2] (-\x,\psp) rectangle (\x,\y);

          \draw[cyan,dashed] (-\x,\pif) -- (\x,\pif);
          \draw[cyan,fill,opacity=0.2] (-\x,-\y) rectangle (\x,\pif);

          \node[red,left,align=right] at (-\x,0) {$\Pi_1$\\Semipiano\\Sinistro};
          \node[blue,right,xshift=0.5cm,align=left] at (\x,0) {$\Pi_2$\\Semipiano\\Destro};
          \node[green!50!black,above,yshift=0.5cm,align=center] at (0,\y) {Semipiano\\Superiore\\$\Pi_3$};
          \node[cyan,below,align=center] at (0,-\y) {$\Pi_4$\\Semipiano\\Inferiore};
        \end{tikzpicture}
      \end{figure}
  \end{itemize}
\end{definition}

\subsection{Funzioni complesse}
\[
f: D(f) \to \mathbb{C} \quad D(f) \subseteq \mathbb{C} \text{ e aperto}
\] 
Alcuni esempi sono:
\begin{itemize}
  \item \( S \to S \quad D(f) = \mathbb{C} \) 
  \item \( S \to S^2 \quad D(f) = \mathbb{C} \) 
  \item \( S \to \Re(S) + j \Im(S)^2 \quad D(f) = \mathbb{C} \) 
  \item \( S \to \sum_{k=0}^{n} a_k^S \quad a_k \in \mathbb{C};\;\; k,\;n \in \mathbb{Z} \)
    (Funzioni polinomiali)
  \item \( \sum_{k=0}^{\infty} a_k (S - S_0)^k \quad a_k \in \mathbb{C};\;\; S,\;S_0 \in \mathbb{C};\;\; k \in \mathbb{Z}\) 
    (Serie di potenze)
\end{itemize}

\subsection{Funzioni polinomiali}
\[
  P(s) = \sum_{k=0}^{n} a_k \cdot \underbrace{S^k}_{\text{Variabile complessa}}
\] 
Con \( n=2 \):
\[
a_0 S^0 + a_1 S^1 + a_2 S^2
\] 
Con \( n=3 \):
\[
a_0 S^0 + a_1 S^1 + a_2 S^2 + a_3 S^3
\] 
\subsubsection{Risoluzione}
Per risolvere una funzione polinomiale si usano le solite tecniche, ad esempio:
\[
S^2-2S+1 = (S-1)^2
\] 
Che ha una sola soluzione, ma con molteplicità 2.

\begin{figure}[H]
  \begin{theorem}[Teorema fondamentale delle radici]
    Ogni polinomio \( P(S) \) a coefficienti complessi di grado \( n > 0 \) ha
    \( n \) \textbf{radici complesse} ed è decomponibile in un solo modo
    \[
      P(s) = a_n \prod_{r=1}^{r} (s - s_r)^{\mu_r}
    \] 
    Dove:

    \noindent
    \( s_r \) sono delle radici

    \noindent \( \mu_r \) sono le molteplicità delle radici

    \noindent \( a_n \) è il coefficiente del polinomio

    \vspace{1em}
    \noindent
    \( \sum_{r=1}^{\infty} \mu_r = n \) 
  \end{theorem}
\end{figure}

\section{Segnali}
Il segnale più presente è quello \textbf{sinusoidale}.
\subsection{Segnali continui}
\[
t \in \mathbb{R}\;\; \mathbb{R} \to \mathbb{C};\;\; \mathbb{R} \to \mathbb{R}
\] 

\subsubsection{Sinusoidale}
\[
x(t) = A \cdot cos(\omega_0 t + \phi) 
\] 
Dove:
\begin{itemize}
  \item \( A \) è l'ampiezza
  \item \( \omega \) è la frequenza \( f = \frac{1}{T} \) (\( T = \text{ periodo} \) )
  \item \( \phi \) è la fase
\end{itemize}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$k$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
    \draw[blue,domain=-3:3,samples=100] plot ({\x},{cos(\x*5 r)});

    \draw (1.25,1) -- ++(0,0.2) -- ++(1.25,0) node[midway,above] {$T_0 = \frac{2\pi}{\omega_0}$} -- ++(0,-0.2);

    \draw[fill] (-2.3,0.5) circle (1pt) node[above right, xshift=-2, scale=0.8] {$A cos\phi$};
  \end{tikzpicture}
  \caption{Funzione sinusoidale}
\end{figure}

\begin{itemize}
  \item \textbf{Periodico}
    \[
      x(t) = x(t + T_0)
    \] 
    \[
      A cos(\omega_0 t + \phi) = A cos(\omega_0 t + \omega_0 T_0 + \phi)
    \] 
    \[
      T_0 = \frac{2 \pi m}{\omega_0} \to \text{ periodo } \frac{2\pi}{\omega_0} \quad m \in \mathbb{R} \text{ (indica il multiplo)}
    \] 
    Il sistema si comporta nello stesso modo per ogni periodo.

  \item \textbf{Shift temporale} equivale ad un cambio di fase
    \[
      A cos[\omega_0 (t - t_0)] = A cos(\omega_0t + \underbrace{\omega_0t_0}_{\Delta \phi})
    \] 
    \[
      A cos[\omega_0 (t+t_0) + \phi] = A cos(\omega_o t + \omega_0 t_0 + \phi)
    \] 

  \item Se \( \phi = 0 \) Il segnale assume la seguente forma:
    \[
    A = cos(\omega_0 t)
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-3,0) -- (3,0) node[right] {$k$};
        \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
        \draw[blue,domain=-3:3,samples=100] plot ({\x},{cos(\x*3 r)});

        \draw[blue,fill] (0,1) circle (1pt) node[above right, blue] {$A$};
        \draw[blue,fill] (0,-1) circle (1pt) node[right, blue] {$-A$};
      \end{tikzpicture}
      \caption{Funzione coseno}
    \end{figure}

    e ha le seguenti proprietà:
    \begin{itemize}
      \item Periodico
        \[
        T_0 = \frac{2\pi}{\omega_o}
        \] 
      \item Pari
        \[
          x(t) = x(-t)
        \] 
    \end{itemize}
    Se \( \phi = -\frac{\pi}{2} \) Il segnale assume la seguente forma:
    \[
    x(t) = \begin{cases}
      A cos(\omega_0 t - \frac{\pi}{2})\\
      A sin(\omega_0 t)\\
      A cos(\omega_0 (t + \frac{T_0}{4}))
    \end{cases}
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-3,0) -- (3,0) node[right] {$k$};
        \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
        \draw[blue,domain=-3:3,samples=100] plot ({\x},{sin(\x*3 r)});
      \end{tikzpicture}
      \caption{Funzione seno}
    \end{figure}
    e ha le seguenti proprietà:
    \begin{itemize}
      \item Periodico
        \[
        T_0 = \frac{2\pi}{\omega_0}
        \] 
      \item Dispari
        \[
        x(t) = -x(-t)
        \] 
    \end{itemize}
\end{itemize}

\subsubsection{Esponenziali reali}
\[
  x(t) = C e^{\alpha t}
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,3) node[above] {$x(t)$};
    \draw[domain=-3:1.1,smooth,variable=\x,blue] plot ({\x},{exp(\x)}) node[above right, scale=0.9] {$e^{\alpha t} \;\; (\alpha > 0)$};
    \draw[fill] (0,1) circle (0.03) node[right] {C};
  \end{tikzpicture}
  \caption{Esempo di segnale}
\end{figure}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,3) node[above] {$x(t)$};
    \draw[domain=-1.1:3,smooth,variable=\x,cyan] plot ({\x},{exp(-\x)}) node[above right, scale=0.9] {$e^{\alpha t} \;\; (\alpha < 0)$};
    \draw[fill] (0,1) circle (0.03) node[right] {C};
  \end{tikzpicture}
  \caption{Esempo di segnale}
\end{figure}

\begin{itemize}
  \item \textbf{Shift Temporale}
    \[
      C e^{\alpha(t+t_0)} = C e^{\alpha t} \cdot \underbrace{C e^{\alpha t_0}}_{\mathbb{R}}
    \] 
\end{itemize}

\subsubsection{Esponenziali complessi}
\[
  x(t) = C e^{\alpha t}
\] 
\[
  C = |c| e^{j \Theta} \text{ (polare)}
\] 
\[
  \alpha = r + j \omega_o \text{ (cartesiana)}
\] 
\vspace{1em}
\[
  x(t) = |c| e^{j \Theta} \cdot e^{(r + j \omega_0)t} =
\] 
\[
 = |c| e^{rt} \cdot e^{j(\omega_0 t + \Theta)} \text{ (Eulero)}
\] 
\begin{definition}[Eulero]
  La formula di Eulero è la seguente:
  \[
    e^{j(\omega_0 t + \Theta)} = cos(\omega_0 t + \Theta) + j sin(\omega_0 t + \Theta)
  \] 
\end{definition}

\[
  x(t) = |c| e^{rt} \cdot (cos(\omega_0 t + \Theta) + j sin(\omega_0 t + \Theta))
\] 

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-3.5) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{-exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {};
    \draw[domain=-4:4,smooth,variable=\x,blue,samples=70] plot ({\x},{exp(\sigm*\x)*cos(\omeg*\x r)}) node[above right, scale=0.9,align=center] {$r>0$};
  \end{tikzpicture}
  \caption{Esponenziale sinusoidale continuo con \( r > 0 \)}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{-0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-3.5) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{-exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {};
    \draw[domain=-4:4,smooth,variable=\x,blue,samples=70] plot ({\x},{exp(\sigm*\x)*cos(\omeg*\x r)}) node[below right,xshift=0.3cm, scale=0.9,align=center] {$r>0$};
  \end{tikzpicture}
  \caption{Esponenziale sinusoidale continuo con \( r < 0 \)}
\end{figure}



\subsection{Segnali discreti}
\[
k \in \mathbb{Z}\;\; \mathbb{Z} \to \mathbb{Z};\;\; \mathbb{Z} \to \mathbb{R};\;\; \mathbb{Z} \to \mathbb{C}
\] 
\subsubsection{Sinusoidale}
\[
  x[n] = A cos(\Omega_0 n + \phi)
\] 
Dove:
\begin{itemize}
  \item \( A \) è l'ampiezza
  \item \( \Omega_0 \) è la frequenza \( f = \frac{\Omega_0}{2\pi} \) 
  \item \( \phi \) è la fase
\end{itemize}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$k$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
    \draw[domain=-3:3,smooth,variable=\x,red,thin,samples=100] plot ({\x},{sin(\x*5 r)}) node[above right, red] {Inviluppo};
    \foreach \x in {-3,-2.8,...,3}
    \draw[blue,thick] (\x,0) -- (\x,{sin(\x*5 r)});
  \end{tikzpicture}
  \caption{Esempio di segnale sinusoidale discreto}
\end{figure}

\begin{itemize}
  \item \textbf{Shift temporale} equivale ad un cambio di fase
    \[
      A cos[\Omega_0 (n + n_0)] = A cos(\Omega_0 n + \underbrace{\Omega_0 n_0}_{\Delta \phi})
    \] 

  \item Se \( \phi = 0 \) Il segnale rimane coseno ed è pari
    \[
      x[n] = x[-n]
    \] 
    Se \( \phi = -\frac{\pi}{2} \) Il segnale diventa un seno ed è dispari:
    \[
      x[n] = -x[-n]
    \] 
\end{itemize}

\begin{itemize}
  \item Il cambio di fase equivale allo shift temporale?
    \[
      A cos[\Omega_0 (n + n_0)] \stackrel{?}{=} A cos[\Omega_0 n + \Omega_0 \omega_0 \phi]
    \] 
    dove \( \phi \) è il rapporto tra \( \phi \) e \( \Omega_0 \) è un numero intero:
    \[
    \phi = \Omega_0 \omega_0
    \] 
    \[
    \frac{\phi}{\Omega_0} = n_0
    \] 
    \begin{figure}[H]
      \begin{example}
        \begin{figure}[H]
          \centering
          \begin{tikzpicture}
            \draw[->] (-3,0) -- (3,0) node[right] {$k$};
            \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(k)$};
            \draw[blue,domain=-3:3,samples=100] plot ({\x},{sin(\x*3 r)});
            \draw[blue,domain=-3:3] plot[ycomb] ({\x},{sin(\x*3 r)});
          \end{tikzpicture}
          \caption{Calcolo del cambio di fase}
        \end{figure}
        \[
          \phi = \frac{2\pi}{12}
        \] 
        \[
        \Omega_0 = ?
        \] 
        \[
          \frac{2\pi}{\Omega_0} = \frac{2\pi}{12} = 12 = \Omega_0 \quad (m = 1)
        \] 
      \end{example}
    \end{figure}
\end{itemize}


\subsubsection{Esponenziali Reali}
\[
  x[n] = C e^{\beta n} = C \alpha^n \quad \alpha = e^\beta;\;\; C,\;\alpha \in \mathbb{R}
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-0.2) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,blue,samples=50] plot[ycomb] ({\x},{exp(\sigm * \x)}) node[below right,scale=0.9,align=center] {$\alpha > 0$\\$|\alpha| > 1$};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
  \end{tikzpicture}
  \caption{Esponenziale reale con \( \alpha > 0 \; |\alpha| > 1 \)}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{-0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-0.2) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,blue,samples=50] plot[ycomb] ({\x},{exp(\sigm * \x)}) node[below right,scale=0.9,align=center,xshift=0.3cm] {$\alpha > 0$\\$|\alpha| > 1$};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
  \end{tikzpicture}
  \caption{Esponenziale reale con \( \alpha > 0 \; |\alpha| < 1 \)}
\end{figure}

\subsubsection{Esponenziali Complessi}
\[
  x[n] = C \alpha^n \quad C,\alpha \in \mathbb{C}
\] 
dove
\[
  \begin{aligned}
    C = |C| e^{j \Theta}\\
    \alpha = |\alpha| e^{j \omega_0}
  \end{aligned}
\] 
\vspace{1em}
\[
  \begin{aligned}
    x[n] = |C| e^{j \Theta} \cdot \left( |\alpha| e^{j \omega_0} \right) =\\
    |C| \cdot |\alpha|^n \cdot e^{j(\omega_0 n + \Theta)}
  \end{aligned}
\] 
Usando la formula di Eulero:
\[
  x[n] = |C| \cdot |\alpha|^n \cdot (cos(\omega_0 n + \Theta) + j 
  sin(\omega_0 n + \Theta))
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-3.5) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {Inviluppo};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{-exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {};
    \draw[domain=-4:4,smooth,variable=\x,blue,samples=70] plot[ycomb] ({\x},{exp(\sigm*\x)*cos(\omeg*\x r)}) node[above right, scale=0.9,align=center] {$|\alpha| > 1$};
  \end{tikzpicture}
  \caption{Esponenziale sinusoidale con \(|\alpha| > 1 \)}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\sigm{-0.35}
    \def\omeg{3.3}
    \draw[->] (-4,0) -- (4,0) node[right] {$n$};
    \draw[->] (0,-3.5) -- (0,4) node[above] {$A$};

    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{exp(\sigm * \x)}) node[above right, scale=0.9,align=center] {};
    \draw[domain=-4:4,smooth,variable=\x,red] plot ({\x},{-exp(\sigm * \x)}) node[below right, scale=0.9,align=center] {Inviluppo};
    \draw[domain=-4:4,smooth,variable=\x,blue,samples=70] plot[ycomb] ({\x},{exp(\sigm*\x)*cos(\omeg*\x r)}) node[above right, scale=0.9,align=center] {$|\alpha| < 1$};
  \end{tikzpicture}
  \caption{Esponenziale sinusoidale con \( |\alpha| < 1 \)}
\end{figure}

\subsection{Rappresentazione}
I segnali che appartengono all'insieme dei complessi sono tridimensionali e sono
rappresentati in 2 assi cartesiani diversi, che mostrano lo stesso segnale, ma
da 2 punti di vista differenti. Il segnale viene generato da un punto che  
che continua a girare periodicamente su una circonferenza proiettando su entrambi
gli assi il suo valore.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
    \draw[->] (0,-3) -- (0,3) node[above] {$\Im$};

    \draw[cyan] (0,0) circle (2.5);
    
    \draw[->,red,rotate=30] (0,0) -- (2.5,0) node[midway, above] {};
    \draw[red] (1.5,0) arc (0:30:1.5) node[midway, right] {$\Theta$};
    \draw[->,red] (2,0) arc (0:360:2) node[midway, right] {};
  \end{tikzpicture}
  \caption{Circonferenza di proiezione}
  \label{fig:fasore}
\end{figure}

La proiezione sull'asse dei reali è la parte reale del segnale:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$\Re$};

    \draw[blue,domain=0:5,smooth,samples=100] plot ({\x},{cos(\x*3 r)});
  \end{tikzpicture}
  \caption{Proiezione su asse reale}
\end{figure}

La proiezione sull'asse degli immaginari è la parte immaginaria del segnale ed è
traslata di \( \frac{\pi}{2} \) rispetto alla parte reale:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$\Im$};

    \draw[red,domain=0:5,smooth,samples=100] plot ({\x},{sin(\x*3 r)});
  \end{tikzpicture}
  \caption{Proiezione su asse immaginario}
\end{figure}

In 3 dimensioni diventa:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      axis lines = center,
      xlabel = \( \Re \),
      ylabel = \( t \),
      zlabel = \( \Im \),
      ymin = 0,
      ymax = 15,
      view={45}{30}
      ]


      \addplot3[
        domain=0:25,
        cyan,
        samples=500,
        samples y=1,
        ] (
        {cos(deg(x))},
        {4*x/(2*pi)},
        {sin(deg(x))}
        );
    \end{axis}
  \end{tikzpicture}
  \caption{Circonferenza di proiezione in 3D}
\end{figure}

\subsection{Problema della periodicità}
Il problema della periodicità consiste nel fatto che alcuni segnali possono
sembrare periodici anche se non lo sono. Ad esempio:
\begin{example}
  \[
    \begin{aligned}
      \Omega_0 = \frac{2\pi}{12}\\
      \phi = 0
    \end{aligned}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\omega{(2*pi)/12}
      \def\phi{0}

      \draw[->] (-3,0) -- (3.2,0) node[right] {$n$};
      \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(n)$};
      \draw[red,domain=-3:3,samples=100] plot ({\x},{cos((\x*\omega*5 + \phi) r)});
      \draw[blue,domain=-3:3,samples=40] plot[ycomb,mark=*,mark size=1.5pt] ({\x},{cos((\x*\omega*5 + \phi) r)});
    \end{tikzpicture}
  \end{figure}
  Il periodo è:
  \[
    \begin{aligned}
      T_0 = \frac{2\pi}{\Omega_0} m\\
      T_0 = \frac{2\pi}{\frac{2\pi}{12}} m = 12m
    \end{aligned}
  \] 
  Con \( m = 1 \):
  \[
    T_0 = 12 \cdot 1 = 12 \in \mathbb{Z}
  \] 
  Quindi il segnale è periodico.
\end{example}

\begin{example}
  \[
    \begin{aligned}
      \Omega_0 = \frac{8\pi}{31}\\
      \phi = 0
    \end{aligned}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\omega{(8*pi)/31}
      \def\phi{0}

      \draw[->] (-3,0) -- (3.2,0) node[right] {$n$};
      \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(n)$};
      \draw[red,domain=-3:3,samples=100] plot ({\x},{cos((\x*\omega*5 + \phi) r)});
      \draw[blue,domain=-3:3,samples=40] plot[ycomb,mark=*,mark size=1.5pt] ({\x},{cos((\x*\omega*5 + \phi) r)});
    \end{tikzpicture}
  \end{figure}
  Il periodo è:
  \[
  \begin{aligned}
    T_0 = \frac{2\pi}{\Omega_0} m\\
    T_0 = \frac{2\pi}{\frac{8\pi}{31}} m = \frac{31}{4} m
  \end{aligned}
  \] 
  Con \( m = 4 \):
  \[
    T_0 = \frac{31}{4} \cdot 4 = 31 \in \mathbb{Z}
  \] 
\end{example}

\begin{example}
  \[
    \begin{aligned}
      \Omega_0 = \frac{1}{6}\\
      \phi = 0
    \end{aligned}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\omega{1/6}
      \def\phi{0}

      \draw[->] (-3,0) -- (3.2,0) node[right] {$n$};
      \draw[->] (0,-1.5) -- (0,1.5) node[above] {$x(n)$};
      \draw[red,domain=-3:3,samples=100] plot ({\x},{cos((\x*\omega*5 + \phi) r)});
      \draw[blue,domain=-3:3,samples=40] plot[ycomb,mark=*,mark size=1.5pt] ({\x},{cos((\x*\omega*5 + \phi) r)});
    \end{tikzpicture}
  \end{figure}
  Il periodo è:
  \[
    \begin{aligned}
      T_0 = \frac{2\pi}{\Omega_0} m\\
      T_0 = \frac{2\pi}{\frac{1}{6}} m = 2\pi \cdot 6 m
    \end{aligned}
  \] 
  Non esiste \( m \in \mathbb{Z} \) che mi tolga \( \pi \) dalla formula del periodo,
  quindi il segnale non è periodico anche se lo sembra
\end{example}

\section{Segnali generalizzati}
Ci sono alcune grandezze che non si possono facilmente calcolare con i segnali
tradizionali, quindi analiticamente, ma solo con strumenti appositi.
\begin{figure}[H]
  \begin{example}
    La tensione della corrente elettrica
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \node[draw,ellipse,minimum size=1cm] (grandezza) at (0,0) {Grandezza};
        \node[draw,minimum size=1cm] (strumento) at (3,0) {Strumento};
        \node[draw,minimum size=1cm] (misura) at (5.5,0) {N};
        \node[below] at (misura.south) {Misura};

        \draw[->] (grandezza) -- (strumento);
        \draw[->] (strumento) -- (misura);
      \end{tikzpicture}
    \end{figure}
    Per misurare la tensione si usa il multimetro. Queste sono grandezze
    definite all'interno di un'operazione integrale.
    \[
      \int_\infty^\infty \underbrace{\sigma(t)}_{\text{Grandezza}} \cdot
      \underbrace{\phi(t)}_{\text{Strumento}} \; dt = \underbrace{N}_{\text{Misura}}
    \] 
  \end{example}
\end{figure}

\subsection{Segnali di impulso}
\begin{itemize}
  \item \textbf{Impulso di Dirac}
    È una funzione con supporto \textbf{infinitesimo}, altezza \textbf{infinita} e area = 1
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

        \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$\infty$};

        \node[below, scale=0.8] at (0,-0.1) {$0$};
        \node[above left, scale=0.8] at (0,0) {$0^-$};
        \node[above right, scale=0.8] at (0,0) {$0^+$};
      \end{tikzpicture}
      \caption{Impulso di Dirac}
    \end{figure}

    \noindent 
    È definita in \( [0^-,0^+] \) 
    \[
      \int_{-\infty}^{+\infty} \underbrace{\delta(t)}_{\text{Impulso}} \cdot \underbrace{1}_{\text{Strumento}} \; dt = \underbrace{1}_{\text{Valore}}
    \] 
    \[
      \delta(t) = \begin{cases}
        \infty \text{ in } 0\\
        0 \text{ altrimenti}
      \end{cases}
    \] 

  \item \textbf{Impulso unitario}

    \noindent
    Matematicamente non si usa l'impulso di Dirac, ma l'\textbf{impulso unitario}.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

        \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$1$};

        \node[below, scale=0.8] at (0,-0.1) {$0$};
        \node[above left, scale=0.8] at (0,0) {$0^-$};
        \node[above right, scale=0.8] at (0,0) {$0^+$};
      \end{tikzpicture}
      \caption{Impulso unitario}
    \end{figure}
    \[
    \delta(t) = \begin{cases}
      1 \text{ in } 0\\
      0 \text{ altrimenti}
    \end{cases}
    \] 
\end{itemize}

\noindent
In natura, il segnale che si avvicina di più al segnale di impulso è il seguente:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \def\u{0.5}
    \def\s{0.1}

    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

    \draw (-0.05,1) -- ++(0.1,0) node[left,xshift=-0.05cm] {1};

    \draw[blue,thick,smooth,domain=-1.4:1.4,samples=100] plot ({\x}, {exp(-(\x-\u)^2/(2*\s^2))});

    \draw[red,fill] (\u,1) circle (1pt) node[above,scale=0.8] {Picco};
    \draw[->, cyan] (0.1,0.2) -- ++(0.1,0.6) node[midway,left,align=center,scale=0.8,xshift=-0.2cm] {Fronte\\di salita};
    \draw[->, cyan] (0.8,0.8) -- ++(0.1,-0.6) node[midway,right,align=center,scale=0.8,xshift=0.2cm] {Fronte\\di discesa};
  \end{tikzpicture}
  \caption{Segnale che si avvicina all'impulso}
\end{figure}
\noindent
In ogni caso, non si avvicina mai all'impulso di Dirac, perchè ha sempre un
fronte di salita e discesa, quindi non è istantaneo.

\subsubsection{Finestra rettangolare unitaria}
È una funzione che definisce un rettangolo di altezza \( A = 1 \)  e larghezza \( T \).
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\Pi(t)$};

    \draw (-0.05,1) -- ++(0.1,0) node[above left,xshift=-0.05cm] {1};

    \draw[blue,thick] (-1.4,0) -- (-0.5,0) node[below] {$-\frac{T}{2}$}
      -- (-0.5,1) -- (0.5,1) node[above right] {$A=1$} -- (0.5,0) node[below] {$\frac{T}{2}$}
      -- (1.4,0);
  \end{tikzpicture}
  \caption{Finestra rettangolare unitaria}
\end{figure}
È definita nel seguente modo:
\[
\Pi(t) := \begin{cases}
  1 \text{ se } -\frac{T}{2} \le t \le \frac{T}{2}\\
  0 \text{ altrimenti}
\end{cases}
\] 
Se questo segnale è ripetuto nel tempo si chiama \textbf{onda quadra}.

\vspace{1em}
\noindent
Alcune applicazioni possono essere:
\begin{itemize}
  \item Gestione di motori elettrici
  \item Equalizzazione di audio
\end{itemize}

\subsubsection{Finestra triangolare unitaria o Impulso triangolare unitario}
È una funzione che definisce un triangolo di altezza \( A = 1 \) e larghezza \( T \).
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\Lambda(t)$};

    \draw (-0.05,1) -- ++(0.1,0) node[above left,xshift=-0.05cm] {1};

    \draw[blue,thick] (-1.4,0) -- (-0.5,0) node[below] {$-T$}
      -- (0,1) -- (0.5,0) node[below] {$T$}
      -- (1.4,0);
  \end{tikzpicture}
  \caption{Finestra triangolare unitaria}
\end{figure}
\noindent
È definita nel seguente modo:
\[
\Lambda(t) := \begin{cases}
  1 - |t| \text{ se } -T \le t \le T\\
  0 \text{ altrimenti}
\end{cases}
\]

\vspace{1em}
\noindent
Le applicazioni sono le stesse del rettangolo, ma con una forma più armonica (smooth).
Si possono anche generare segnali sinusoidali.

\subsection{Come si realizza un impulso}
\begin{itemize}
  \item Rettangolo:

    \noindent
    L'impulso si definisce come una successione di funzioni per cui vengono cambiati
    dei valori:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \def\a{1}
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

        \draw[blue,thick] (-\a/2,0) node[below] {$-\frac{a}{2}$}
          -- (-\a/2,1/\a) -- (\a/2,1/\a) node[above right] {$\frac{1}{a}$} -- (\a/2,0) node[below] {$\frac{a}{2}$};
      \end{tikzpicture}
      \caption{Impulso rettangolare}
    \end{figure}
    L'obiettivo è raddoppiare l'altezza e dimezzare la larghezza, mantenendo l'area
    uguale.

    \noindent
    Calcoliamo l'area di questa funzione:
    \[
      Area = \left(\frac{a}{2} + \frac{a}{2}\right) \cdot \frac{1}{a} = \frac{2a}{2} \cdot \frac{1}{a} = 1
    \] 

    Ora cambiamo la funzione:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \def\a{1}
        \def\b{0.5}
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,2.5) node[above] {$\delta(t)$};

        \draw[blue,thick] (-\a/2,0) node[below left] {$-\frac{a}{2}$}
          -- (-\a/2,1/\a) -- (\a/2,1/\a) node[above right] {$\frac{1}{a}$} --
          (\a/2,0) node[below right] {$\frac{a}{2}$};

        \draw[red,thick] (-\b/2,0) node[below] {$-\frac{a}{4}$}
          -- (-\b/2,1/\b) -- (\b/2,1/\b) node[above right] {$\frac{2}{a}$} --
          (\b/2,0) node[below] {$\frac{a}{4}$};
      \end{tikzpicture}
      \caption{Impulsi rettangolari}
    \end{figure}
    E calcoliamo di nuovo l'area
    \[
      Area = \left(\frac{a}{4} + \frac{a}{4}\right) \cdot \frac{2}{a} = \frac{2a}{4} \cdot \frac{2}{a} = 1
    \] 

    \[
      \delta(t) = \lim_{n \to \infty} A_n = 1 
    \] 

  \item Triangolo:

    \noindent
    Facciamo la stessa cosa con il triangolo:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \def\a{1}
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

        \draw[blue,thick] (-\a,0) node[below] {$-\frac{a}{2}$}
          -- (0,1/\a) node[above right] {$\frac{2}{a}$} -- (\a,0) node[below] {$\frac{a}{2}$};
      \end{tikzpicture}
      \caption{Impulso triangolare}
    \end{figure}
    \[
    Area = \left( \frac{a}{2} + \frac{a}{2} \right) \cdot  \frac{2}{a} \cdot \frac{1}{2} = 1
    \] 
    Ora cambiamo la funzione:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \def\a{1}
        \def\b{0.5}
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,2.5) node[above] {$\delta(t)$};

        \draw[blue,thick] (-\a,0) node[below] {$-\frac{a}{2}$}
          -- (0,1/\a) node[above right,xshift=-0.1cm,yshift=-0.1cm] {$\frac{2}{a}$} -- (\a,0) node[below] {$\frac{a}{2}$};

        \draw[red,thick] (-\b,0) node[below] {$-\frac{a}{4}$}
          -- (0,1/\b) node[right] {$\frac{4}{a}$} -- (\b,0) node[below] {$\frac{a}{4}$};
      \end{tikzpicture}
      \caption{Impulsi triangolari}
    \end{figure}
    \[
      Area = \left( \frac{a}{4} + \frac{a}{4} \right) \cdot \frac{2}{a} \cdot \frac{1}{2} = 1
    \] 

    \[
      \delta(t) = \lim_{n \to \infty} A_n = 1
    \] 
\end{itemize}

\subsection{Derivata dell'impulso}
Considerando l'impulso come successione di triangoli abbiamo che all'infinito 
ci sarà un fronte di salita e discesa, quindi la derivata saranno degli
inpulsi positivi e negativi.
\[
  \frac{d \delta(t)}{dt} = \dot{\delta}(t) = \delta'(t)
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$\delta(t)$};
    
    \draw[blue,thick] (-\a,0) -- (0,1/\a) node[right,yshift=0.1cm] {$\delta(t) = \delta_0(t)$}
      -- (\a,0);

    \draw[->] (2.5,0) -- ++(1,0) node[midway,above] {Derivata};
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$\delta_1(t)$};
    
    \draw[->,blue,thick] (0.25,0) -- (0.25,\a) node[right,yshift=0.1cm] {$\delta'(t) = \delta_1(t)$};
    \draw[->,blue,thick] (0.5,0) -- (0.5,-\a);

  \end{tikzpicture}
  \caption{Derivata del segnale triangolare}
\end{figure}

\subsection{Integrale dell'impulso}
I segnali polinomiali (o segnali canonici) sono definiti come l'integrale di un impulso. È definito
come:
\[
  \delta_{-n}(t) = \begin{cases}
    \frac{t^{n-1}}{(n-1)!} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
\] 

\[
  \int \delta_0(t) \; dt = \delta_{-1}(t)
\] 

\subsubsection{Funzione gradino}
Si ottiene integrando una volta:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};
    
    \draw[->,blue,thick] (0,0) -- (0,\a);

    \draw[->] (2.5,0.75) -- ++(1,0) node[midway,above] {Integrale};
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-1}(t)$};
    
    \draw[blue,thick] (-1.4,0) -- (0,0) -- (0,\a) -- (1.4,\a);

  \end{tikzpicture}
  \caption{Funzione gradino}
\end{figure}
\[
  \delta_{-1}(t) = \begin{cases}
    \frac{t^{1-1}}{(1-1)!} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
  =
  \begin{cases}
    1 \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
\] 

\noindent
Moltiplicare un segnale per il gradino unitario permette di ottenere la parte
positiva del segnale:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-4,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$f(t)$};

    \draw[blue,domain=-3.9:3.9,smooth,samples=100] plot ({\x},{sin(\x * 3 r)});
    
    \draw[red,thick] (-3.9,0) -- (1,0) node[below] {$t_0$} -- (1,\a) -- (3.9,\a);

    \node[above,red] at (-2,1.1) {Sparisce};
    \node[above,red,align=center] at (2,1.1) {Rimane\\invariato};
  \end{tikzpicture}
  \caption{Moltiplicazione per gradino unitario}
\end{figure}
Si ottiene:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-4,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-1.5) -- (0,1.5) node[above] {$f(t)$};

    \draw[blue,thick,domain=1:3.9,smooth,samples=100] plot ({\x},{sin(\x * 3 r)});
    \draw[blue,thick] (-3.9,0) -- (1,0);
    \node[below] at (1,0) {$t_0$};
  \end{tikzpicture}
  \caption{Risultato della moltiplicazione}
\end{figure}
\[
  f(t) \cdot \delta_{-1}(t) = f_1(t) \text{ (che è causale)}
\] 
La funzione del gradino è anche nota come \textbf{funzione di Heaviside}.

\subsubsection{Funzione rampa}
Si ottiene integrando due volte:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-1}(t)$};

    \draw[blue,thick] (-1.4,0) -- (0,0) -- (0,\a) -- (1.4,\a);

    \draw[->] (2.5,0.75) -- ++(1,0) node[midway,above] {Integrale};
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-2}(t)$};

    \draw[blue,thick] (-1.4,0) -- (0,0) -- (1.4,\a);
  \end{tikzpicture}
  \caption{Funzione rampa}
\end{figure}
\[
  \delta_{-2}(t) = \begin{cases}
    \frac{t^{2-1}}{(2-1)!} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
  = \begin{cases}
    t \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
\] 

\subsubsection{Funzione parabolica}
Si ottiene integrando tre volte:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-2}(t)$};

    \draw[blue,thick] (-1.4,0) -- (0,0) -- (1.4,\a);

    \draw[->] (2.5,0.75) -- ++(1,0) node[midway,above] {Integrale};
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-3}(t)$};
    
    \draw[blue,thick] (-1.4,0) -- (0,0);
    \draw[blue,thick,domain=0:1.2,smooth,samples=100] plot ({\x},{\x*\x});
  \end{tikzpicture}
  \caption{Funzione rampa}
\end{figure}
\[
  \delta_{-3}(t) = \begin{cases}
    \frac{t^{3-1}}{(3-1)!} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
  = \begin{cases}
    \frac{t^2}{2} \text{ se } t \ge 0\\
    0 \text{ altrimenti}
  \end{cases}
\]

\subsubsection{A cosa servono i segnali canonici}
Non si sa cosa contengono i sistemi LTI che si analizzano, perchè si gestiscono
solo gli input e gli output.

\noindent
Di solito si cerca di dare il segnale gradino al sistema e si guarda qual'è la risposta
del sistema a questo segnale. Ad esempio:

\begin{figure}[H]
  \begin{example}
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-0.1,0) -- (6,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,3) node[above] {$f(t)$};

        \draw[blue,thick] (0,0) -- (0,1) -- (5.9,1);
        \draw[green!50!black,thick,domain=0:5.9,smooth,samples=100] plot ({\x},{1 - exp(-0.1 * 6.2 * \x)* cos(-10 * \x r)});
        \draw[red,thick,domain=0:5.9,smooth,samples=100] plot ({\x},{1 - exp(-\x)});
        \draw[orange,thick,domain=0:5.9,smooth,samples=100] plot ({\x},{0.1 * exp(0.4 * \x)});

        \node[align=center] at (7,1.5) {\color{green!50!black}Oscilla\\\color{red}Veloce\\\color{orange}Lento};
      \end{tikzpicture}
      \caption{Esempi di risposta di un sistema}
    \end{figure}
    Il sistema rosso cresce lentamente, ma ad un certo punto arriva a 1, mentre quello
    arancione è un sistema più lento.

    Quello verde è più veloce, ma non arriva mai a regime perchè continua a oscillare
    e quindi non è asintoticamente stabile, ma potrebbe essere BIBO stabile.
    \begin{itemize}
      \item Per una luce il sistema verde potrebbe andare bene se l'oscillazione non è troppa
      \item Per un sistema frenante il sistema arancione potrebbe essere troppo lento
    \end{itemize}
  \end{example}
\end{figure}

\subsection{Proprietà degli impulsi}
È un segnale ideale (canonico) centrato in 0 e definito in \( [0^-, 0^1] \) con
altezza 1.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

    \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$1$};

    \node[below, scale=0.8] at (0,-0.1) {$0$};
    \node[above left, scale=0.8] at (0,0) {$0^-$};
    \node[above right, scale=0.8] at (0,0) {$0^+$};
  \end{tikzpicture}
  \caption{Impulso unitario}
\end{figure}

\begin{itemize}
  \item \textbf{Pari}:
    \[
    \delta(t) = \delta(-t) \quad \forall t \in \mathbb{R}
    \] 

  \item \textbf{Area unitaria}

    \noindent
    Se
    \[
       0 \in [a,b] \subset \mathbb{R}
    \] 
    Allora
    \[
    \int_a^b \delta(t) \; dt = 1
    \] 
    Altrimenti
    \[
    \int_a^b \delta(t) \; dt = 0
  \]
  Cioè se l'intervallo contiene lo 0, l'area è 1, altrimenti è 0.
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1.5]
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

      \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$1$};

      \draw[green!50!black,thick] (-0.2,-0.2) node[below] {a} -- ++(0.4,0) node[below,scale=0.8] {b}
        node[midway,below,scale=0.8] {1};

      \draw[red,thick] (1,-0.2) node[below] {a} -- ++(0.4,0) node[below,scale=0.8] {b}
        node[midway,below,scale=0.8] {0};

    \end{tikzpicture}
    \caption{Area dell'impulso}
  \end{figure}

  \item \textbf{Proprietà del campionamento o riproducibilità}

    \noindent Se \( v: \mathbb{R}\to \mathbb{R} \) è una funzione continua in
    \( t_0 \in \mathbb{R} \), allora:
    \[
    v(t) \delta(t-t_0) = v(t_0) \delta(t-t_0) \quad \text{ per } t \in \mathbb{R}
    \] 
    Se prendo un impulso traslato in \( t_0 \)  e lo moltiplico per una funzione
    ottengo il valore della funzione in quel punto.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \draw[->] (-0.1,0) -- (4,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,2) node[above] {$v(t)$};

        \draw[blue,domain=0:3.9,smooth,samples=100] plot ({\x},{sin(\x * 3 r)/2 + 1}) node[right] {$v(t)$};

        \draw[red] (pi/2,0.5) node[above,yshift=0.3cm,scale=0.8] {$\delta(t-t_0)$} -- (pi/2,0) node[below] {\(t_0\)};
      \end{tikzpicture}
    \end{figure}
    \noindent
    Per riuscire a passare dal continuo al discreto si continua a moltiplicare
    la funzione per un impulso traslato in \( t_0 \) e si ottiene il valore
    della funzione in quel punto.

    \vspace{1em}
    \noindent
    Questa formula può essere riscritta come:
    \[
      v(t_0) = \int_{-\infty}^{+\infty} v(\tau) \delta(\tau-t_0) \; d\tau
    \] 
    Il valore di una funzione in \( t_0 \) l'integrale della funzione moltiplicata
    per un impulso traslato in \( t_0 \).
\end{itemize}

\section{Sistemi}
Un sistema è un modello matematico o una formulizzazione di un processo o di un fenomeno
fisico che permette di trasformare un input in un output. Ci sono più tipi di sistemi:
\begin{itemize}
  \item \textbf{Sistemi SISO} (Single Input Single Output): Sono sistemi che hanno un solo
    input e un solo output.
  \item \textbf{Sistemi dinamici}: Sono sistemi che "ricordano" l'input precedente,
    quindi l'output dipende dall'input attuale e da quello precedente.
\end{itemize}

\begin{example}
  Un esempio di sistema fisico stabile è il pendolo:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1.5]
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.1) -- (0,1.5) node[above] {};

      \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$u(t)$};
    \end{tikzpicture}
    \caption{Input}
  \end{figure}

  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      % Top bar
      \draw (0,0) -- ++(4,0);

      % y axis
      \draw[->] (0,-3) -- ++(2,0) -- ++(0,0.1) -- ++(0,-0.1) node[below] {$0$}
        -- ++(2,0) node[right] {$y$};

      % Pendulums
      % \draw[fill=black] (2,-2) circle (0.4) node (c1) {};
      \node[draw,fill=black,circle,inner sep=0.3cm] (c1) at (2,-2) {};
      \node[draw,fill=black,circle,inner sep=0.3cm] (c2) at (0.5,-1.5) {};
      \node[draw,fill=black,circle,inner sep=0.3cm] (c3) at (3.5,-1.5) {};

      % Bars
      \draw (2,0) -- (c1);
      \draw (2,0) -- (c2);
      \draw (2,0) -- (c3);

      % Arc arrows between pendulums
      \draw[->, blue] (c1.west) arc (-90:-120:1.4);
      \draw[->, blue] (c1.east) arc (-90:-60:1.4);
    \end{tikzpicture}
    \caption{Sistema}
  \end{figure}

  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\sigm{-0.45}
      \def\omeg{3.3}
      \draw[->] (-0.2,0) -- (6,0) node[right] {$t$};
      \draw[->] (0,-3.5) -- (0,4) node[left] {$y$};

      \draw[domain=-2.4:3.5,smooth,variable=\x,green!50!black]
        plot ({\x+2.4},{exp(\sigm * \x)})
        node[above left, scale=0.9,align=center,yshift=0.5cm,xshift=0.2cm]
        {Andamento con\\stabilità asintotica};

      \draw[domain=-2.4:3.5,smooth,variable=\x,green!50!black]
        plot ({\x+2.4},{-exp(\sigm * \x)})
        node[above right, scale=0.9,align=center] {};

      \draw[domain=-2.4:3.5,smooth,variable=\x,red,samples=70]
        plot ({\x+2.4},{exp(\sigm*\x)*cos(\omeg*\x r)})
        node[below right,scale=0.9,align=center,yshift=-0.3cm] {$v(t)$};
    \end{tikzpicture}
    \caption{Output}
  \end{figure}
\end{example}

\begin{example}
  Un esempio di sistema fisico instabile è il seguente:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1.5]
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.1) -- (0,1.5) node[above] {};

      \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$u(t)$};
    \end{tikzpicture}
    \caption{Input}
  \end{figure}

  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1.5]
      % Base
      \draw[->] (0,0) -- ++(4,0) node[right] {$y$};

      % Semicircle
      \draw[fill,black] (1,0) arc (180:0:1);

      % Top circle
      \draw[fill,red] (2,1 + 0.2) circle (0.2) node[right] (c) {};
      \draw[->,blue] (c) -- ++(0.5,0) node[right] {$u(t)$};
    \end{tikzpicture}
    \caption{Sistema}
  \end{figure}

  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-0.2,0) -- (6,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,4) node[left] {$y$};

      \draw[domain=0:sqrt(2),smooth,variable=\x,red,samples=70] plot ({\x},{\x^2/2});
      \draw[domain=sqrt(2):5.5,smooth,variable=\x,red,samples=70] plot ({\x},{\x/sqrt(2)});
    \end{tikzpicture}
    \caption{Output}
  \end{figure}
\end{example}

\subsection{Proprietà dei sistemi LTI}
\begin{definition}[Sistema LTI]
  Un sistema a tempo continuo per cui valgono le proprietà di:
  \begin{itemize}
    \item Linearità
    \item Tempo invarianza
    \item Causalità
  \end{itemize}
  si definisce \textbf{Sistema Lineare Tempo Invariante} (LTI).
\end{definition}

\subsubsection{Linearità}
Se ho un sistema con un primo input \( u_1(t) \) e un secondo input \( u_2(t) \) che
insieme fanno un terzo input allora l'output del sistema sarà la combinazione lineare
degli output dei due input.
\[
  \underbrace{\underbrace{au_1(t)}_{\text{Input 1}} + \underbrace{bu_2(t)}_{\text{Input 2}}}_{\text{Input 3}}
  \to \text{Sistema} \to \underbrace{\underbrace{a \cdot y_1(t)}_{\text{Output 1}} + \underbrace{b \cdot y_2(t)}_{\text{Output 2}}}_{\text{Output 3}}
\] 

\subsubsection{Tempo invarianza}
Un sistema a tempo continuo è tempo invariante se e solo se:
\[
  u(t) \to v(t) \implies u(t+\tau) \to  v(t+\tau) \quad \forall \tau \in \mathbb{R}
\] 

\subsubsection{Causalità}
Un sistema si dice causale se e solo se l'uscita all'istante \( \tau \) dipende soltanto
dall'ingresso per \( t \le \tau \) (\( v(\tau) \) dipende solo da \( u(t) \; t \le \tau \)
e non dipende dai valori successivi). La causa non precede mai l'effetto.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    % Input graph
    \draw[->] (-0.5,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1) -- (0,1) node[above] {$u(t)$};
    \draw[blue, domain=0:4.8, samples=100, smooth] plot ({\x},{sin(\x*5 r)/1.5});

    \node[above left] (a) at (-0.5,0.5) {A riposo};
    \draw[->] (a) -- (-0.1,0.1);
    \node[below left] at (0,0) {$\tau = 0$};

    % System
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
    \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
    \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

    % Output graph
    \draw[->] (0,-6.2) -- (0,-4) node[above] {$v(t)$};
    \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
    \draw[red, domain=0.001:4.8, smooth] plot ({\x},{ln(\x+1) - 6});

    \node[above left] (b) at (-0.5,-5.5) {Causalità};
    \draw[->] (b) -- (-0.1,-5.9);
    \node[below left] at (0,-6) {$\tau = 0$};
  \end{tikzpicture}
  \caption{Sistema a riposo}
\end{figure}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\t{1.2566370614}
    % Input graph
    \draw[->] (-0.5,0) -- (5,0) node[right] {$t$};
    \draw[->] (0,-1) -- (0,1) node[above] {$u(t)$};
    \draw[blue, domain=0:4.8, samples=100, smooth] plot ({\x},{sin(\x*5 r)/1.5});

    \node[below right] at (\t,0) {$\tau$};
    \draw[fill=black] (\t,0) circle (0.05);

    % System
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
    \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
    \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

    % Output graph
    \draw[->] (0,-6.2) -- (0,-4) node[above] {$v(t)$};
    \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
    \draw[red, domain=\t:4.8, smooth] plot ({\x},{ln(\x+1-\t) - 6});
    \draw[red, domain=0:\t, smooth] plot ({\x},{-6});

    \node[above, xshift=-0.3cm] (b) at (\t,-5.5) {Causalità};
    \draw[->] (b) -- (\t-0.1,-5.9);

    \node[below right] at (\t,-6) {$\tau$};
    \draw[fill=black] (\t,-6) circle (0.05);
  \end{tikzpicture}
  \caption{Sistema non a riposo}
\end{figure}

\noindent
Per comodità si considerano solo i sistemi a riposo (\( \tau = 0 \)).

\subsubsection{Proprietà di stabilità asintotica}
\begin{definition}
  Un sistema si dice \textbf{asintoticamente stabile} se:
  \[
  \exists \tau \in \mathbb{R} \; t.c \; u(\tau) = 0, \;\; \forall t \le \tau \Rightarrow
  \lim_{t \to \infty} v(t) = 0
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=0.8]
      % Input graph
      \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
      \draw[->] (0,-2) -- (0,2) node[above] {$u(t)$};
      \draw[blue, domain=0.001:4.8, samples=100, smooth] plot ({\x},{(sin((\x*5)/2 r))/(1.3*\x)});
      \node[above, blue, scale=0.8, yshift=0.2cm] at (5,0) {$u(t) = 0$};

      % System
      \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
      \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
      \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

      % Output graph
      \draw[->] (0,-8) -- (0,-4) node[above] {$v(t)$};
      \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
      \draw[red, domain=0.001:4.8, smooth] plot ({\x},{sin(\x*5 r)/(2.5*\x) - 6});
      \node[above, red, scale=0.8, yshift=0.2cm] at (5,-6) {$\lim_{t \to \infty} v(t) = 0$};
    \end{tikzpicture}
    \caption{Esempio di sistema asintoticamente stabile}
  \end{figure}
\end{definition}

\noindent
Per capire se un sistema è asintoticamente stabile bisogna verificare se ogni soluzione 
del sistema è minore di 0:
\[
\forall i \;\; \Re(\lambda_i) < 0
\] 

\subsubsection{Proprietà di BIBO stabilità}
\begin{definition}
  Un sistema si dice \textbf{BIBO stabile} se:
  \[
    \exists  \tau \in \mathbb{R}, \; e \; U_u \in \mathbb{R} \; t.c \;
    \text{se } |u(t)| \le U_u, \; \forall t \le \tau
  \] 
  \[
    \Downarrow
  \] 
  \[
    \exists U_v > 0 \; t.c \; |v(t)| \le U_v, \; \forall t \ge \tau
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=0.8]
      % Input graph
      \draw[->] (-0.2,0) -- (5,0) node[right] {$t$};
      \draw[->] (0,-2) -- (0,2) node[above] {$u(t)$};
      \draw[blue, domain=0.001:4.8, samples=100, smooth] plot ({\x},{sin(\x*\x r)/(0.5*\x)});
      \draw[blue, dashed] (4.8,0.7) -- (0,0.7) node[left] {$M_u$};
      \draw[blue, dashed] (4.8,-0.7) -- (0,-0.7) node[left] {$-M_u$};

      % System
      \node[draw,minimum width=1cm,minimum height=1cm] (A) at (2.5,-3) {\( \Sigma \) };
      \draw[<-] (A) -- ++(0,1) node[midway,above left] {};
      \draw[->] (A) -- ++(0,-1) node[midway,above right] {};

      % Output graph
      \draw[->] (0,-8) -- (0,-4) node[above] {$v(t)$};
      \draw[->] (-0.2,-6) -- (5,-6) node[right] {$t$};
      \draw[red, domain=0.001:4.8, samples=200, smooth] plot ({\x},{sin(\x*\x*\x*0.5 r)/(0.7*\x) - 6});
      \draw[red, dashed] (4.8,-5.3) -- (0,-5.3) node[left] {$M_v$};
      \draw[red, dashed] (4.8,-6.7) -- (0,-6.7) node[left] {$-M_v$};
    \end{tikzpicture}
    \caption{Esempio di sistema stabile BIBO}
  \end{figure}

  \noindent
  Ogni sistema asintoticamente stabile è anche BIBO stabile, ma non il contrario.
\end{definition}

\noindent
Per capire se un sistema è BIBO stabile si deve verificare che \( h(t) \) (risposta 
all'impulso) sia assolutamente integrabile e che abbia un valore finito:
\[
  \int_{-\infty}^{+\infty} |h(t)| \; dt < \infty
\] 

\subsection{Sistemi descritti da equazioni differenziali}
I sistemi che si analizzano in questo corso sono solo un sottoinsieme:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw (0,0) circle (4cm) node[above=3cm,align=center,scale=0.9]
      {Sistemi a\\tempo continuo};
    \draw (0,0) circle (3cm);
    \draw (0,0) circle (2cm) node[above=2.2cm] {LTI};
    \draw (0,0) circle (1cm) node[above=1cm,align=center,scale=0.8]
      {Risposta\\impulsiva \( h(t) \)};

    \node[scale=0.7,align=center] at (0,0) {Modellabili con\\eq. diff};

    \begin{scope}
      \clip (0,0) circle (1cm);
      \fill[blue, fill opacity=0.3] (1.9,0) ellipse (1.8cm and 3cm);
    \end{scope}
    \draw (1.9,0) ellipse (1.8cm and 3cm);
    \node at (1.9,-2.5) {Causali};

    \draw[->,blue] (1,-0.5) -- (3.5,-3) node[below right] {Sistemi studiati nel corso};
  \end{tikzpicture}
  \caption{Sistemi LTI}
\end{figure}
\begin{example}
  Prendiamo come esempio un sistema massa molla smorzatore:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\offset{0.4}

      \draw (-0.2,0) -- (4,0);
      \draw[->] (0,-0.2) -- (0,3) node[right] {$x$};

      % Spring
      \draw[decoration={aspect=0.3, segment length=1.5mm, amplitude=2mm,coil},decorate]
        (2-\offset,0) -- ++(0,1) node[midway,left,xshift=-0.2cm] (k) {$k$};
      \draw[->,blue] (k) ++(-0.3,0.3) -- ++(0,-0.6) node[midway,left] {$F_k$};


      % Damper
      \draw (2+\offset,0) -- ++(0,0.4) (2+\offset-0.2,0.4+0.2) -- ++(0,-0.2) 
        -- ++(0.4,0) -- ++(0,0.2) node[midway,right] (d) {$D$}
        (2+\offset-0.1,0.4+0.1) -- ++(0.2,0)
        (2+\offset,0.4+0.1) -- ++(0,0.5);
      \draw[->,blue] (d) ++(0.3,0.3) -- ++(0,-0.6) node[midway,right] {$F_D$};

      % Mass
      \draw (2-\offset-0.3,1) rectangle ++(1.4,1) node[midway] {$M$};
      \draw[->,blue] (2,2) -- ++(0,0.6) node[midway,right] {$u(t)$};
    \end{tikzpicture}
    \label{massa-molla-smorzatore}
    \caption{Sistema massa molla smorzatore}
  \end{figure}
  \noindent
  Andiamo a vedere le forze in gioco:
  \[
    \begin{aligned}
      F & = m \cdot a\\
      a & = \frac{d^2x}{dt^2}
    \end{aligned}
  \] 
  \( x(t) \) è lo spostamento nel tempo
  \[
  M \cdot a(t) = u(t) - F_k - F_D
  \] 
  che equivale a
  \renewcommand{\thempfootnote}{\fnsymbol{mpfootnote}}
  \[
    M \cdot \frac{\partial ^2x}{\partial t^2} =
    u(t) - k \cdot x(t) - D \cdot \frac{\partial x}{\partial t}
    \footnote{
      Il simbolo \( \partial \) indica la derivata parziale. Una derivata parziale
      è una derivata rispetto ad una funzione a più variabili.
    }
  \] 
  \renewcommand{\thempfootnote}{\arabic{mpfootnote}}
  \setcounter{mpfootnote}{0}
  \[
    \underbrace{M \cdot \frac{\partial ^2x}{\partial t^2} + D \cdot
    \frac{\partial x}{\partial t} + k \cdot x(t)}_{\text{Segnale di uscita}}
    = \underbrace{u(t)}_{\text{Segnale di ingresso}}
  \] 
\end{example}
\begin{example}
  Un altro esempio è il sistema RL (Resistenza Induttanza):
  \begin{figure}[H]
    \centering
    \begin{circuitikz}[american voltages]
      % Input voltage source and ground
      \draw
        (0,0) node[ground] (ground) {} to[short] ++(0,1)
        to[V=$u(t)$] (0,2)
        to[short] ++(0,1)

        % Inductor L
        to[L, l=$L$] ++(3,0)

        % Resistor R
        to[R, l=$R$] ++(0,-3)

        % Output voltage v(t)
        (3,3) to[short, -*] (5,3)
        to[open, v^>=$v(t)$] (5,0)

        % Ground connection
        (0,0) to[short, -*] (5,0)
        ;

    \node at (ground) [below,yshift=-0.6cm,align=center] {Messa a\\terra};
    \node at (-1,1.2) [below,align=center] {Tensione\\di input};
    \node at (6.2,1.9) [below,align=center] {Tensione\\di output};

    \draw[<-] (2.2,2) arc (45:315:0.7) node[midway,right,xshift=0.3cm] {$i(t)$};
    \end{circuitikz}
    \caption{Sistema RL}
  \end{figure}
  \noindent
  Possiamo descrivere l'imput del sistema come:
  \[
    u(t) = L \cdot \frac{\partial i(t)}{\partial t} + \underbrace{R \cdot i(t)}_{v(t)}
  \] 
  Possiamo descrivere l'output come:
  \[
    v(t) = R \cdot i(t) \stackrel{\text{Legge di Ohm}}{\to} i(t) = \frac{1}{R} v(t)
  \] 

  \noindent
  Usando la legge di Ohm \( (V = Ri) \) possiamo scrivere:
  \[
    \underbrace{\frac{L}{R} \cdot \frac{\partial v(t)}{\partial t} + v(t)}
    _{\text{Segnale d'uscita}} =
    \underbrace{u(t)}_{\text{Segnale d'ingresso}}
  \] 
\end{example}

Quindi in generale possiamo scrivere un sistema LTI come:
\[
  \begin{aligned}
    a_n \frac{\partial ^{n} v(t)}{\partial t} + a_{n-1} \frac{\partial ^{(n-1)} v(t)}{\partial t} + \ldots + a_1 \frac{\partial v(t)}{\partial t} + a_0 v(t) & =\\
    b_m \frac{\partial ^{m} u(t)}{\partial t} + b_{m-1} \frac{\partial ^{(m-1)} u(t)}{\partial t} + \ldots + b_1 \frac{\partial u(t)}{\partial t} + b_0 u(t) &
  \end{aligned}
\] 
Dove:
\begin{itemize}
  \item \( u(t) \) è il segnale di ingresso
  \item \( v(t) \) è il segnale di uscita
  \item \( a_n, b_m \neq 0 \;\; \in \mathbb{R} \) 
\end{itemize}
Tutto ciò si può riscrivere come:
\begin{equation}
  \sum_{i=o}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} =
  \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}
  \label{equazione-del-sistema}
\end{equation}
  
\( n \) e \( m \) sono gli ordini delle equazioni differenziali con \( n \ge m \).
\begin{itemize}
  \item Se \( n > m \) il sistema è detto \textbf{strettamente proprio}
  \item Se \( n \ge m \) il sistema è detto \textbf{proprio}

\end{itemize}

\noindent
Ora possiamo inserire all'interno dei sistemi l'equazione differenziale:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=2cm] (A) at (0,0)
      {
        \begin{tabular}{c}
          \scalebox{2}{$\Sigma$}\\
          \\
          $\sum_{i=o}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} =
            \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}$
          \end{tabular}
      };

    \draw[->] (A.east) -- ++(1,0) node[right] {$u(t)$};
    \draw[<-] (A.west) -- ++(-1,0) node[left] {$v(t)$};
  \end{tikzpicture}
  \caption{Contenuto del sistema}
\end{figure}

\begin{figure}[H]
  \begin{example}
    Un esempio di sistema descritto da un'equazione differenziale è il seguente e
    riprende il sistema massa molla smorzatore dell'esempio \ref{massa-molla-smorzatore}:
    \[
      \underbrace{M}_{a_2} x''(t) + \underbrace{D}_{a_1} x'(t) + \underbrace{K}_{a_0} x(t) =
      \underbrace{1}_{b_0} u(t)
    \] 
  \end{example}
\end{figure}

\subsubsection{Risoluzione}
Un sistema descritto da un'equazione differenziale non ha una sola soluzione, a meno che
non vengano imposte \( n \) \textbf{condizioni iniziali}.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw (0,0) node[right] {$t=0^-$} -- (0,1) node[left] {$v(t)$};
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw (0,0) node[right] {$t=0^-$} -- (0,1) node[left] {$\frac{\partial v(t)}{\partial t}$}
      node[midway, right, xshift=1cm] {$\ldots$};
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw (0.5,0) node[right] {$t=0^-$} -- (0.5,1) node[left] {$\frac{\partial ^{(n-1)}v(t)}{\partial t}$};
  \end{tikzpicture}
  \caption{Derivata di ordine \( n-1 \) di \( v(t) \) calcolata al tempo \( t = 0^- \)}
\end{figure}

\noindent
La soluzione è l'uscita \( v \) del sistema (reale o complesa) che può essere scomposta
in:
\[
  \underbrace{v_t}_{\text{risposta totale}} = \underbrace{v_l}_{\text{Risposta libera}} + \underbrace{v_f}_{\text{Risposta forzata}}
\] 
\begin{itemize}
  \item \textbf{Risposta libera}: Dipende soltanto dalle condizioni iniziali, quindi
    è il comportamento del sistema in assenza di input.
    \[
    \begin{aligned}
      \text{C.I.} \neq 0\\
      u(t) = 0
    \end{aligned}
    \] 

  \item \textbf{Risposta forzata}: Dipende solo dall'input del sistema e la maggior parte
    delle volte è diversa dalla risposta libera.
    \[
    \begin{aligned}
      \text{C.I.} = 0\\
      u(t) \neq 0
    \end{aligned}
    \] 
\end{itemize}

\subsubsection{Risposta libera (o evoluzione libera)}
Per calcolare la risposta libera del sistema definito in \ref{equazione-del-sistema}
bisogna risolvere l'equazione omogenea 
($=0$) associata, quindi si prende la parte sinistra
dell'equazione differenziale e si pone uguale a 0 la parte destra.
\begin{equation}
  \sum_{i=0}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} = 0
  \label{eq-risposta-libera}
\end{equation}
\[
\] 
Per farlo bisogna definire il \textbf{polinomio caratteristico}:
\[
P(s) = \sum_{i=0}^{n} a_i s^i
\] 
\begin{example}
  Ad esempio:
  \[
  3 y''(t) + 2 y'(t) + y(t) = u(t)
  \] 
  Come prima cosa si toglie la parte destra
  \[
  3 y''(t) + 2 y'(t) + y(t) = 0
  \] 
  Successivamente si scrive il polinomio caratteristico sostituendo a \( y(t) \) la
  variabile \( s \) e mettendo come potenza di \( s \)  l'ordine della derivata:
  \[
  3s^2 + 2s + 1 = 0
  \] 
\end{example}
Ricordando il teorema fondamentale dell'algebra, cioè che la somma delle molteplicità
delle radici è uguale all'ordine del polinomio, si può dire che:
\[
\lambda_1, \lambda_2, \ldots, \lambda_r
\]
sono le soluzioni del polinomio caratteristico \( P(s) \) con relative molteplicità
\[ \mu_1, \mu_2, \ldots, \mu_r \] vale che \[ \sum_{i=0}^{r} \mu_i = r \]. Si ha quindi:
\[
  v_l(t) = \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} 
  \underbrace{c_{i,l}}_{\in \mathbb{R}, \mathbb{C}}  \cdot 
  \underbrace{e^{\lambda_i t}}_{\text{Esponenziale}} \cdot 
  \underbrace{\frac{t^l}{l!}}_{\text{Polinomiale}}
\] 
I valori \( c_{i,l} \) vengono calcolati usando le condizioni iniziali.

\begin{example}
  Prendendo come esempio il sistema definito in \ref{massa-molla-smorzatore} abbiamo l'equazione:
  \[
  Mx''(t) + Dx'(t) + Kx(t) = 0
  \] 
  Poniamo:
  \[
    M=1, \quad D=2, \quad K=1
  \] 
  \[
  x''(t) + 2x'(t) + x(t) = 0
  \] 
  Il polinomio caratteristico è:
  \[
    \begin{aligned}
      P(s) &= s^2 + 2s + 1 =\\
           &= (s+1)^2 
    \end{aligned}
  \] 
  Risolvendo l'equazione differenziale si ottiene:
  \[
  \lambda_1 = \lambda_2 = -1
  \] 
  con molteplicità algebrica è \( \mu_1 = 2 \). Quindi si hanno 2 soluzioni coincidenti
  e una sola radice distinta: $r = 1$ La risposta libera quindi sarà:
  \[
    \begin{aligned}
      v_l(t) &= \sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} c_{i,l} \cdot  e^{\lambda_i t} \cdot \frac{t^l}{l!} \\
             &= \sum_{i=1}^{1} \sum_{l=0}^{1} c_{i,l} \cdot  e^{\lambda_i t} \cdot \frac{t^l}{l!} \\
             &= c_{1,0} e^{-1t} \cdot \frac{t^0}{0!} + c_{1,1} \cdot e^{-1t} \cdot \frac{t^1}{1!} \\
             &= c_{1,0} \cdot e^{-t} \cdot 1 + c_{1,1} \cdot e^{-t} \cdot t
    \end{aligned}
  \] 
\end{example}
\begin{example}
  Prendiamo ad esempio il sistema:
  \[
    v'''(t) + 3v''(t) + 3v'(t) + 1 = 0
  \] 
  Calcoliamo il polinomio caratteristico:
  \[
    \begin{aligned}
      P(s) &= s^3 + 3s^2 + 3s + 1 = 0 \\
           &= (s + 1)^3
    \end{aligned}
  \] 
  Le soluzioni sono:
  \[
  \lambda_1 = \lambda_2 = \lambda_3 = -1
  \] 
  Il numero di soluzioni è \( r = 1 \) con molteplicità \( \mu = 3 \).

  \vspace{1em}
  \noindent
  La risposta libera è:
  \[
    \begin{aligned}
      v_l(t) &= \sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} c_{i,l} \cdot e^{\lambda_i t} \cdot \frac{t^l}{l!} \\
             &\;\;\vdots\\
             &= c_{1,0} \cdot e^{-t} + c_{1,1} \cdot e^{-t} \cdot t + c_{1,2} \cdot e^{-t} \cdot \frac{t^2}{2}
    \end{aligned}
  \] 
  Ora troviamo i coefficenti \( c_{i,l} \) per trovare la risposta libera specifica
  al nostro caso, considerando i seguenti valori iniziali: 
  \[
  \begin{cases}
    v(0) = 0\\
    v'(0) = 1\\
    v''(0) = 0
  \end{cases}
  \] 
  Sostituendo \( t \) con \( 0 \) troviamo il valore di \( c_{1,0} \):
  \[
  \begin{aligned}
    v_l(0) &= c_{1,0} \cdot e^0 + c_{1,1} \cdot e^0 \cdot 0 + c_{1,2} \cdot e^0 \cdot \frac{0}{2}\\
           &= c_{1,0} = 0
  \end{aligned}
  \] 
  Troviamo il valore di \( c_{1,1} \) derivando la risposta libera:
  \[
    v'_l(t) = -1 c_{1,0} \cdot e^{-t} + c_{1,1} \cdot e^{-t} \cdot t - c_{1,1} \cdot e^{-t} 
    - c_{1,2} \cdot e^{-t} \cdot \frac{t^2}{2} + c_{1,2} \cdot e^{-t} \cdot t
  \] 
  una volta calcolata la derivata, poniamo \( t = 0 \) 
  \[
  \begin{aligned}
    v'_l(0) &= -c_{1,0} + c_{1,1} - c_{1,1} + c_{1,2} \cdot 0 + c_{1,2} \cdot 0\\
            &= -c_{1,0} + c_{1,1} \\
            &= 0 + 1 = 1
  \end{aligned}
  \] 
  Troviamo il valore di \( c_{1,2} \) facendo la derivata seconda:
  \[
    v''(t) = 0 + 1 \cdot e^{-t} \cdot t - e^{-t} \cdot t + c_{1,2} \cdot e^{-t} \cdot \frac{t^2}{2} -
    c_{1,2} \cdot e^{-t} \cdot t + c_{1,2} \cdot e^{-t}
  \] 
  poniamo \( t = 0 \):
  \[
    \begin{aligned}
      v''_l(0) &= 0 + 1 \cdot 0 - 0 + c_{1,2} \cdot 0 - c_{1,2} \cdot 0 + c_{1,2} = 0\\
               &= c_{1,2} = 0
    \end{aligned}
  \] 
  Quindi alla fine la risposta libera specifica risulta:
  \[
    \begin{aligned}
      v_l(t) &= c_{1,0} \cdot e^{-t} + c_{1,1} \cdot e^{-t} \cdot t + c_{1,2} \cdot e^{-t} \cdot \frac{t^2}{2} \\
             &= e^{-t} \cdot t
    \end{aligned}
  \] 
\end{example}

\begin{example}
  Prendiamo ad esempio un sistema descritto nel seguente modo:
  \[
    v''(t) + 3v'(t) + -4v(t) = 5u'(t) - u(t)
  \] 
  Vogliamo calcolare la risposta libera del sistema. Per farlo bisogna imporre le
  condizioni iniziali:
  \[
    \begin{cases}
      v(0) = 0\\
      v'(0) = 1
    \end{cases}
  \] 
  Il primo passo è calcolare il polinomio caratteristico dell'equazione omogenea:
  \[
    \begin{aligned}
      P(s) &= s^2 + 3s - 4 = 0\\
           &= (s-1) (s+4)
    \end{aligned}
  \] 
  Il secondo passo è trovare le radici e le molteplicità:
  \[
    \begin{aligned}
      \lambda_1 &= 1, \quad \mu_1 = 1\\
      \lambda_2 &= -4, \quad \mu_2 = 1
    \end{aligned}
  \]
  La risposta libera generica si calcola come:
  \[
    v_l(t) = \sum_{i=1}^{r} \sum_{l=0}^{\mu_i -1} c_{i,l} \cdot e^{\lambda_i t} \cdot
    \frac{t^l}{l!}
  \] 
  e nel nostro caso è:
  \[
    \begin{aligned}
      v_l(t) &= c_{1,0} \cdot e^{t} + c_{2,0} \cdot e^{-4t}\\
             &= c_1 \cdot e^{t} + c_2 \cdot e^{-4t}
    \end{aligned}
  \] 

  \vspace{1em}
  \noindent
  Per trovare la risposta libera specifica bisogna calcolare i coefficenti \( c_1 \) e \( c_2 \)
  derivando e valutande nelle condizioni iniziali:
  \[
    \begin{aligned}
      v(t)  &= c_1 \cdot e^{t} + c_2 \cdot e^{-4t}\\
      v'(t) &= c_1 \cdot e^{t} - 4c_2 \cdot e^{-4t}
  \end{aligned}
  \] 
  Mettiamo a sistema, valutando in \( t = 0 \):
  \[
    \begin{aligned}
      &\begin{cases}
        v(0) = c_1 \cdot e^0 + c_2 \cdot e^0\\
        v'(0) = c_1 \cdot e^0 - 4c_2 \cdot e^0
      \end{cases}
      =\\
      &\begin{cases}
        c_1 + c_2 = 0\\
        c_1 - 4c_2 = 1
      \end{cases}
      =\\
      &\begin{cases}
        c_1 = -c_2\\
        -c_2 - 4c_2 = 1
      \end{cases}
      =\\
      &\begin{cases}
        c_1 = -c_2\\
        -5c_2 = 1
      \end{cases}
      =\\
      &\begin{cases}
        c_1 = \frac{1}{5}\\
        c_2 = -\frac{1}{5}
      \end{cases}
    \end{aligned}
  \] 
  La risposta libera specifica è quindi:
  \[
    v_l(t) = \frac{1}{5} \cdot e^t - \frac{1}{5} \cdot e^{-4t}
  \] 
\end{example}

\begin{definition}
  Le formule più importanti sono:
  \begin{itemize}
    \item \textbf{Modello di un sistema}:
      \[
        \sum_{i=o}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} =
        \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}
      \] 

    \item \textbf{Risposta libera}:
      \[
        v_l(t) = \sum_{i=1}^{r} \sum_{l=0}^{\mu_i -1} c_{i,l} \cdot \underbrace{
        e^{\lambda_i t} \cdot \frac{t^l}{l!}}_{\text{Modo elementare}}
      \] 
  \end{itemize}
  Dove:
  \[
  \begin{aligned}
    r &= \text{numero di radici distinte}\\
    \mu_i &= \text{molteplicità della radice } \lambda_i\\
    c_{i,l} &= \text{coefficienti da calcolare}
  \end{aligned}
  \] 
\end{definition}

\subsubsection{Convergenza dei modi elementari}
È una funzione che si comporta come un esponenziale, quindi la convergenza dipende dal
valore di \( \lambda \).
\[
  m(t) = e^{\lambda t} \cdot \frac{t^l}{l!}
\] 
Vale che:
\begin{enumerate}
  \item \( \lim_{t \to 0} m(t) = 0 \) se e solo se \( \Re(\lambda) < 0 \).
    \textbf{Stabilità asintotica}
    
  \item \( m(t) \) è limitato, cioè puo prendere solo valori limitati, su \( [0,\infty) \) 
    se e solo se \( \Re(\lambda) \le 0 \). Se \( \Re(\lambda) = 0 \), allora perchè
    questo valga \( l \) deve essere uguale a 0 \( l=0 \).
    \textbf{Stabilità semplice}.

  \item \( \lim_{t \to \infty} m(t) = \infty \) in tutti gli altri casi. Quindi:
    \[
      \Re(\lambda) > 0
    \] 
    oppure
    \[
      \Re(\lambda) = 0,\; l \neq 0
    \] 
    \textbf{Instabilità}.
\end{enumerate}

\subsubsection{Dimostrazioni}
\begin{enumerate}
  \item \( \Re(\lambda) < 0 \):

    \vspace{1em}
    \noindent
    Riscriviamo \( \lambda \) come:
    \[
    \lambda = a+bi = \sigma +j\omega
    \] 
    e riscriviamo \( m(t) \) come:
    \[
      \begin{aligned}
        m &= e^{\lambda t} \cdot \frac{t^l}{l!} = \left( e^{\sigma t} \cdot 
        e^{j \omega t} \right) \cdot \frac{t^l}{l!}\\
          &= \underbrace{\frac{t^l}{l!}}_{\text{Polinomiale}} \cdot
          \underbrace{\overbrace{e^{\sigma t}}^{\Re} \cdot \overbrace{e^{j \omega t}}^{\Im}}_{\text{Esponenziale}}
      \end{aligned}
    \] 
    con \( a = -\sigma \) diventa:
    \[
    \begin{aligned}
      m &= \frac{t^l}{l!} \cdot \frac{1}{e^{at}} \cdot e^{j \omega t}\\
        &= \underbrace{\frac{t^l}{l!} \cdot \frac{1}{e^{-\sigma t}}}_{=0} 
        \cdot \underbrace{e^{j \omega t}}_{\text{Limitato}}
    \end{aligned}
    \] 
    Il blocco \( e^{j \omega t} \) è un punto che gira su un cerchio di raggio 1, quindi
    è limitato. Il blocco \( \frac{t^l}{l!} \cdot \frac{1}{e^{-\sigma t}} \) è limitato
    per \( t = 0 \) e quindi \( m(t) \) tende a 0.

  \item \( \Re(\lambda) = 0 \;\; l=0 \):

    \vspace{1em}
    \noindent
    \[
      \begin{aligned}
        m(t) &= e^{\lambda t} \cdot \frac{t^l}{l!}\\
             &= \frac{t^l}{l!} \cdot e^{\sigma t} 
             \cdot e^{j \omega t}\\
             &= \frac{t^0}{0!} \cdot e^0 \cdot e^{j \omega t}\\
             &= e^{j \omega t}
      \end{aligned}
    \] 
    che è per definizione limitato in modulo.

  \item \( \Re(\lambda) > 0 \) 

    \vspace{1em}
    \noindent
    \[
    \begin{aligned}
      m(t) = \frac{t^l}{l!} \cdot e^{\sigma t} \cdot e^{j \omega t}
    \end{aligned}
    \] 


    \( \Re(\lambda) = 0 \; l \neq 0\) 
    \vspace{1em}
    \noindent
    \[
      m(t) = \frac{t^l}{l!} \cdot \stackrel{1}{\cancel{e^{\sigma t}}} \cdot e^{j \omega t}
    \] 
    Siccome \( \sigma = \Re(\lambda) = 0 \) 
    \[
    \lim_{t \to \infty} m(t) = \infty
    \] 
\end{enumerate}

\begin{definition}
  Un sistema LTI descritto dell'equazione:
  \[
    \sum_{i=0}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} =
    \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}
  \]
  è detto \textbf{asintoticamente stabile} (la risposta è asintoticamente stabile)
  se e solo se ogni suo modo elementare converge a 0, cioè:
  \[
    \forall i \;\; \lim_{t \to \infty} m_i(t) = 0 \quad m_i = e^{\lambda_i t} \cdot \frac{t^l}{l!}
  \] 

  \vspace{1em}
  \noindent
  \textbf{Osservazione}

  \noindent
  È detto \textbf{asintoticamente stabile} se e solo se tutte le radici del polinomio
  caratteristico, \( P(s) \), hanno parte reale negativa.
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2.5,0) -- (2.5,0) node[right] {$\Re$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$\Im$};

      \draw[fill=blue,blue] (-2,1.5) circle (0.05) node[above] (l_1) {$\lambda_1$};
      \draw[fill=blue,blue] (-1.5,1.2) circle (0.05) node[above] (l_2) {$\lambda_2$};
      \draw[fill=blue,blue] (-1,0.7) circle (0.05) node[above] (l_3) {$\lambda_3$};
      \draw[fill=blue,blue] (-0.5,1.8) circle (0.05) node[above] (l_4) {$\lambda_4$};

      \draw[dashed] (l_1) -- (l_1 |- 52,0);
      \draw[dashed] (l_2) -- (l_2 |- 52,0);
      \draw[dashed] (l_3) -- (l_3 |- 52,0);
      \draw[dashed] (l_4) -- (l_4 |- 52,0);
    \end{tikzpicture}
    \caption{Asintoticamente stabile}
  \end{figure}
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2.5,0) -- (2.5,0) node[right] {$\Re$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$\Im$};

      \draw[fill=blue,blue] (-2,1.5) circle (0.05) node[above] (l_1) {$\lambda_1$};
      \draw[fill=blue,blue] (1.5,1.2) circle (0.05) node[above] (l_4) {$\lambda_2$};
      \draw[fill=blue,blue] (-1,0.7) circle (0.05) node[above] (l_2) {$\lambda_3$};
      \draw[fill=blue,blue] (-0.5,1.8) circle (0.05) node[above] (l_3) {$\lambda_4$};

      \draw[dashed] (l_1) -- (l_1 |- 52,0);
      \draw[dashed] (l_2) -- (l_2 |- 52,0);
      \draw[dashed] (l_3) -- (l_3 |- 52,0);
      \draw[dashed] (l_4) -- (l_4 |- 52,0);
    \end{tikzpicture}
    \caption{Non asintoticamente stabile}
  \end{figure}
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2.5,0) -- (2.5,0) node[right] {$\Re$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$\Im$};

      \draw[fill=blue,blue] (-2,1.5) circle (0.05) node[above] (l_1) {$\lambda_1$};
      \draw[fill=blue,blue] (-1.5,1.2) circle (0.05) node[above] (l_2) {$\lambda_2$};
      \draw[fill=blue,blue] (-1,0.7) circle (0.05) node[above] (l_3) {$\lambda_3$};
      \draw[fill=blue,blue] (-0.5,1.8) circle (0.05) node[above] (l_4) {$\lambda_4$};
      \draw[fill=blue,blue] (0,1) circle (0.05) node[above right] (l_5) {$\lambda_5$};

      \draw[dashed] (l_1) -- (l_1 |- 52,0);
      \draw[dashed] (l_2) -- (l_2 |- 52,0);
      \draw[dashed] (l_3) -- (l_3 |- 52,0);
      \draw[dashed] (l_4) -- (l_4 |- 52,0);
      \draw[dashed] (l_5) -- (l_5 |- 52,0);
    \end{tikzpicture}
    \caption{Semplicemente stabile}
  \end{figure}
\end{definition}

\subsubsection{Prodotto di convoluzione}
Il concetto di correlazione indica quanto due segnali siano simili tra loro e si calcola
con il prodotto di convoluzione.

Il concetto di convoluzione è un'operazione tra due segnali che restituisce un terzo
segnale.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2) node[above] {$u(t)$};

    \draw[blue] (0.5,0) -- ++(1,1) node[above right,align=center] {Segnale\\fisso} -- ++(0,-1);
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2) node[above] {$v(t)$};

    \draw[red] (0.5,0) -- ++(0,1) -- ++(1,0) node[above right,align=center] {Kernel} -- ++(0,-1);
  \end{tikzpicture}
  \caption{Segnale fisso e kernel}
\end{figure}

\noindent
Il \textbf{kernel} è un segnale che viene riflesso rispetto all'asse \( y \) e traslato
nel tempo \( t \) e moltiplicato per il segnale fisso. Il risultato è un segnale che
rappresenta l'area sottesa dal prodotto dei due segnali.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2.5) node[above] {};

    \draw[blue] (0.5,0) -- ++(1,1) node[above right,align=center] {} -- ++(0,-1);
    \draw[red] (-1.5,0) -- ++(0,2) -- ++(1,0) node[above right,align=center] {} -- ++(0,-2);
    \draw[->,red] (-1,2.5) -- ++(0.5,0) node[midway,above] {$t$};
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2.5) node[above] {};

    \draw[blue] (0.5,0) -- ++(1,1) node[above right,align=center] {} -- ++(0,-1);
    \draw[red] (0.25,0) -- ++(0,2) -- ++(1,0) node[above right,align=center] {} -- ++(0,-2);
    \draw[fill=green!50!black,green!50!black, fill opacity=0.5] (0.5,0) --
      ++(0.75,0.75*2) node[above right,scale=0.8,align=center] {Area della\\convoluzione} -- ++(0,-0.75*2) -- cycle;
  \end{tikzpicture}
  \caption{Convoluzione}
\end{figure}

\noindent
Il grafico della convoluzione risultante è un segnale che rappresenta il cambiamento
nel tempo del prodotto dei due segnali.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-0.2,0) -- (4,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2.5) node[above] {$u(t) \ast v(t)$};

    \draw[domain=0:2,smooth,samples=100,variable=\x,green] plot ({\x},{\x^2/2});
    \draw[domain=2:3.297,smooth,samples=100,variable=\x,green] plot ({\x},{ln(-\x/1.5 + 2.33333) + 2});
    \draw[domain=3.297:4,smooth,samples=100,variable=\x,green] plot ({\x},{0});
  \end{tikzpicture}
  \caption{Grafico della convoluzione}
\end{figure}

\begin{definition}
  L'operatore di convoluzione tra due segnali \( u(t) \) e \( v(t) \) è definito come:
  \[
    \begin{aligned}
      (u \ast v)(t) &= \int_{-\infty}^{+\infty} u(\tau) \cdot v(t-\tau) \, d\tau = \\
      (v \ast u)(t) &= \int_{-\infty}^{+\infty} v(\tau) \cdot 
      u(\underbrace{t}_{\text{Varia nel tempo}}\underbrace{-\tau}_{\text{Riflessione su y}}) \, d\tau
    \end{aligned}
  \]
  Il segnale riflesso viene moltiplicato per il segnale \( u(t) \).
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2,0) -- (2,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,2.5) node[above] {};

      \draw[domain=-2:2,smooth,samples=1000,variable=\x,blue] plot 
        ({\x},{cos((\x*10) r)/5 + 2})
        node[right] {$u(t)$};

      \draw[red] (0.5,0) -- ++(1,1) node[right] {$v(t)$} -- ++(0,-1);
      \draw[red] (-0.5,0) -- ++(-1,1) -- ++(0,-1);
      \draw[->] (-1.25,-0.2) -- ++(0.5,0)
        node[midway,below,scale=0.8,align=center] {Traslazione\\nel tempo};

      \draw[fill] (-0.5,0) circle (0.05) node[above right] {$t$};
    \end{tikzpicture}
    \caption{Convoluzione}
  \end{figure}
\end{definition}
Se la convoluzione viene effettuata con un impulso, il segnale viene campionato.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2) node[above] {$u(t)$};

    \draw[blue] (0.5,0) -- ++(1,1) node[above right,align=center] {Segnale\\fisso} -- ++(0,-1);
  \end{tikzpicture}
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2) node[above] {$v(t)$};

    \draw[->,red] (1,0) -- ++(0,1) node[above right,align=center] {Kernel};
  \end{tikzpicture}
  \caption{Segnale fisso e kernel}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-0.2,0) -- (2,0) node[right] {$t$};
    \draw[->] (0,-0.2) -- (0,2.5) node[above] {$u(t) \ast v(t)$};

    \draw[green!50!black] (0.5,0) -- ++(1,1) -- ++(0,-1);
  \end{tikzpicture}
  \caption{Grafico della convoluzione}
\end{figure}
\begin{example}
  Ad esempio il segnale triangolo è formato dalla convoluzione di due segnali rettangolari.
  \[
  u(t) = v(t) = \Pi(t)
  \] 
  (\( \Pi(t) \) è la funzione rettangolo)
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$v(t)$};

      \draw[red] (-0.5,0) node[below] {$-\frac{1}{2}$} -- ++(0,1) -- ++(1,0) node[above right,align=center] {$u(t)$} -- ++(0,-1) node[below] {$\frac{1}{2}$};
    \end{tikzpicture}
    \begin{tikzpicture}
      \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,2) node[above] {$v(t)$};

      \draw[blue] (-0.5,0) node[below] {$-\frac{1}{2}$} -- ++(0,1) -- ++(1,0) node[above right,align=center] {$v(t)$} -- ++(0,-1) node[below] {$\frac{1}{2}$};
    \end{tikzpicture}
  \end{figure}
  \begin{enumerate}
    \item Scegliere il segnale più semplice
    \item Specchiare l'altro segnale rispetto a $y$ (\( f(t) \mapsto f(-t) \))
    \item Traslare il segnale mobile (quello specchiato) nel tempo
    \item Spostare \( \forall t \) e calcolare l'integrale (aree sottese)
  \end{enumerate}
  Il risultato della convoluzione sarà:
  \[
    \begin{aligned}
      u(-2) \ast v(-2) &= 1 \cdot 0 = 0\\
      u(-1) \ast v(-1) &= 1 \cdot 0 = 0\\
      u(0) \ast v(0) &= 1 \cdot 1 = 1\\
                       &\;\;\vdots\\
    \end{aligned}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-2,0) -- (2,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,2.5) node[above] {$u(t) \ast v(t)$};

      \draw[green!50!black] (-1,0) node[below] {$-1$} -- ++(1,1) node[above right] {$1$}
        -- ++(1,-1) node[below] {$1$};
    \end{tikzpicture}
    \caption{Grafico della convoluzione}
  \end{figure}
\end{example}

\subsubsection{Risposta impulsiva}
\begin{definition}
  Dato un sistema a tempo continuo inizialmente a riposo (causale) definiamo la 
  \textbf{risposta impulsiva} come l'uscita del sistema in corrispondenza di un ingresso
  uguale all'impulso unitario
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {\( \Sigma \) };
      \draw[->] (-1,0) -- (A) node[midway,above left] {$\delta(t)$} node[midway,below left,scale=0.7] {Impulso};
      \draw[->] (A) -- (1,0) node[midway,above right] {$h(t)$} node[midway,below right,align=center,scale=0.7] {Risposta\\impulsiva};
    \end{tikzpicture}
    \caption{Risposta impulsiva}
  \end{figure}
\end{definition}

\begin{theorem}
  L'uscita \( v(t) \) di un sistema LTI, inizialmente a riposo, in corrispondenza di un
  ingresso \( u(t) \) è dato dal seguente prodotto di convoluzione:
  \[
    \begin{aligned}
      v(t) = (u \ast h)(t) &= \int_{-\infty}^{+\infty} h(\tau) \cdot u(t-\tau) \, d\tau\\
                           &= \int_{-\infty}^{+\infty} u(\tau) \cdot h(t-\tau) \, d\tau
    \end{aligned}
  \] 
\end{theorem}

\noindent
\textbf{Proprietà dell'integrale di convoluzione:}
\begin{itemize}
  \item \textbf{Commutativa}: \( (u \ast v)(t) = (v \ast u)(t) \) 
  \item \textbf{Associativa}: \( (u \ast v)(t) \ast w(t) = u(t) \ast (v \ast w)(t) \)
  \item \textbf{Distributiva} (rispetto alla somma): \( u(t) \ast (v(t) + w(t)) = (u \ast v)(t) + (u \ast w)(t) \)
\end{itemize}

\noindent
\textbf{Osservazione}: Un sistema LTI causale inizialmente a riposo, siccome \( h(t) = 0
, t < 0\) (perchè \( \delta(t) = 0, t < 0 \)):
\[
  \begin{aligned}
    v(t) = (u \ast h)(t) &= \int_{0^-}^{+\infty} h(\tau) \cdot u(t-\tau) \, d\tau\\
                         &= \int_{-\infty}^{t^+} u(\tau) \cdot u(t-\tau) \, d\tau\\
  \end{aligned}
\] 

\vspace{1em}
\noindent
Per calcolare la risposta impulsiva: 
\[
  h(t) = d_0 \cdot \delta(t) + \left[\sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} d_{i,l} \cdot \frac{t^l}{l!}
  \cdot e^{\lambda_i t}\right] \cdot \delta_{-1}(t)
\] 
dove:
\begin{itemize}
  \item \( d_0 \) è il termine costante:
    \begin{itemize}
      \item \( d_0 \neq 0 \) se e solo se il sistema è proprio (\( n=m \))
    \end{itemize}

  \item \( \delta(t) \) è l'impulso unitario

  \item \( d_{i,l} \) sono i coefficienti della risposta impulsiva 
    (diversi da \( c_{i,l} \) della risposta libera)

  \item \( \frac{t^l}{l!} \cdot e^{\lambda_i t} \) sono i modi elementari e sono
    gli stessi della risposta libera

  \item \( \delta_{-1}(t) \) è il gradino e serve a moltiplicare per 0 la parte
    non causale della risposta impulsiva e serve quindi per la causalità
\end{itemize}

\begin{example}
  Prendiamo ad esempio il sistema:
  \[
  v'(t) + 2v(t) = u'(t) + u(t)
  \] 
  Questo sistema ha \( n=m \) perchè è un sistema proprio, quindi: \( d_0 \neq 0 \) 
  \begin{enumerate}
    \item Il primo passo è quello di trovare l'equazione omogenea:
      \[
      v'(t) + 2v(t) = 0
      \] 

    \item Poi bisogna calcolare il polinomio caratteristico:
      \[
      P(s) = s + 2 = 0
      \] 

    \item Bisogna poi trovare le radici e i modi elementari:
      \[
      \lambda_1 = -2 \quad r = 1 \quad \mu = 1
      \] 
      \( \left( l = 0 \ldots \mu_i -1 \right)  \) 
      i modi elementari sono:
      \[
        m(t) = e^{-2t}
      \] 

    \item Scriviamo la risposta impulsiva:
      \[
        \begin{aligned}
          h(t) &= d_0 \cdot \delta(t) + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} d_{i,l} \cdot
          \frac{t^l}{l!} \cdot e^{\lambda_i t} \cdot \delta_{-1}(t)\\
               &= d_0 \cdot \delta(t) + d_{1,0} \cdot e^{-2t} \cdot \delta_{-1}(t)
        \end{aligned}
      \] 

    \item Riscrivo l'equazione iniziale ponendo:
      \[
      v(t) = h(t) \quad u(t) = \delta(t)
      \] 
      L'eqauzione diventa:
      \[
      v'(t) + 2v(t) = u'(t) + u(t)
      \] 
      \[
      \Downarrow
      \] 
      \[
      h'(t) + 2h(t) = \delta'(t) + \delta(t)
      \] 
      \begin{itemize}
        \item Calcolo tutte le derivate di \( h(t) \):
          \[
            h'(t) = \delta_0 \cdot \delta'(t) - 2d_{1,0} \cdot e^{-2t} \cdot \delta_{-1}(t)
            + d_{1,0} \cdot e^{-2t} \cdot \delta(t)
          \] 
      \end{itemize}

    \item Sostituisco \( v(t) \mapsto h(t) \) e \( u(t) \mapsto \delta(t) \) 
      \[
      v'(t) + 2v(t) = u'(t) + u(t)
      \] 
      \[
      \Downarrow
      \] 
      \[
        \color{green}h'(t) \color{black}+ \color{purple}2h(t) \color{black}= 
        \color{yellow}\delta'(t) + \color{red}\delta(t)
      \] 
      \[
        \begin{aligned}
          &\color{green}d_0 \cdot \delta'(t) - 2d_{1,0} \cdot e^{-2t} \cdot \delta_{-1}(t) + d_{1,0}
          \cdot e^{-2t} \cdot \delta(t) \\
          &\color{purple}+ 2 \left( d_0 \cdot \delta(t) + d_{1,0} \cdot
          e^{-2t} \cdot \delta_{-1}(t) \right)\\
          &= \color{yellow}\delta'(t) + \color{red}\delta(t)
        \end{aligned}
      \] 
      \[
      \begin{aligned}
        d_0 \cdot \delta'(t) - 2d_0 \cdot  \delta(t) + d_{1,0} \cdot e^{-2t} \cdot
        \delta(t) = \delta'(t) + \delta(t)\\
      \end{aligned}
      \] 
      Valutiamo le funzioni in \( t=0 \) 
      \[
        d_0 \cdot \delta'(0) - 2d_0 \cdot  \delta(0) + d_{1,0} \cdot \cancel{e^{-2 \cdot 0}}
        \cdot \delta(0) = \delta'(0) + \delta(0)
      \] 
      Sposto tutto a sinistra:
      \[
        d_0 \cdot \delta'(0) - 2d_0 \cdot \delta(0) + d_{1,0} \cdot \delta(0) - \delta'(0) -
        \delta(0) = 0
      \] 
      Raccolgo per \( \delta(0), \delta'(0)\ldots \delta^n(t) \) che sono linearmente
      indipendenti:
      \[
        \left( d_0 - 1 \right) \cdot \delta'(0) + \left( d_{1,0} - 2d_0 - 1 \right) \cdot
        \delta(0) = 0
      \] 

    \item Risolvo il sistema
      \[
      \begin{cases}
        \left( d_0 - 1 \right) \cdot \delta'(0) = 0\\
        \left( d_{1,0} - 2d_0 - 1 \right) \cdot \delta(0) = 0
      \end{cases}
      \to 
      \begin{cases}
        d_0 = 1\\
        d_1 = -1
      \end{cases}
      \] 

    \item Sostituisco i coefficienti appena trovati
      \[
        \begin{aligned}
          h(t) &= \underbrace{d_0}_{1} \cdot \delta(t) + \underbrace{d_{1,0}}_{-1}
          \cdot e^{-2t} \cdot \delta_{-1}(t)\\
               &= \delta(t) - e^{-2t} \cdot \delta_{-1}(t)
        \end{aligned}
      \] 
      E questa è la risposta impulsiva del sistema

    \item Bisogna calcolare la risposta forzata...
  \end{enumerate}
  \label{ex:risposta_impulsiva}
\end{example}

\begin{exercise}
  Si vuole calcolare la risposta impulsiva del sistema:
  \[
    2v'(t) - v(t) = u'(t) + 3u(t)
  \] 
  Siccome abbiamo la derivata prima sia a sinistra a destra il sistema è proprio
  \( (n = m) \to d_0 \neq 0 \).
  \[
    h(t) = d_0 \cdot \delta(t) + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} d_{i,l} \cdot
    \frac{t^l}{l!} \cdot e^{\lambda_i t} \cdot \delta_{-1}(t)
  \] 
  \begin{enumerate}
    \item Calcolo le radici usando l'equazione omogenea del polinomio caratteristico:
      \[
        \begin{aligned}
          2s - 1 &= 0\\
          2s &= 1\\
          s = \frac{1}{2}
        \end{aligned}
      \] 
      \[
        \lambda_1 = \frac{1}{2} \quad r = 1 \quad \mu = 1
      \] 

    \item Calcolo la risposta impulsiva:
      \[
        h(t) = d_0 \cdot \delta_0(t) + d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_{-1}(t)
      \] 

    \item Riscrivo l'equazione iniziale con \( v(t) = h(t),\; u(t) = \delta_0(t) \):
      \[
        2h'(t) - h(t) = \delta_0'(t) + 3\delta_0(t)
      \] 

    \item Calcolo le derivate di \( h(t) \):
      \[
      \begin{aligned}
        h'(t) = d_0 \cdot \delta_0'(t) + \frac{1}{2} \cdot d_1 \cdot e^{\frac{1}{2}t}
        \cdot \delta_{-1}(t) + d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_0(t)
      \end{aligned}
      \] 

    \item Sostituisco:
      \[
        \begin{aligned}
          2 \left[ d_0 \delta_0'(t) + \frac{1}{2} \cdot d_1 \cdot e^{\frac{1}{2}t} \cdot
          \delta_{-1}(t) + d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_0(t) \right] -\\
          \left[ d_0 \cdot \delta_0(t) + d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_{-1}(t) \right]\\
          = \delta_0'(t) + 3\delta_0(t)
        \end{aligned}
      \] 
      Togliere tutti i termini \( \delta_{-1}(0^-) = 0 \) 

    \item Raccolgo le funzioni indipendenti \( \delta_0(t), \delta_0'(t), \delta_0''(t) \):
      \[
      \begin{cases}
        2d_0 \cdot \delta_0'(t) = \delta_0'(t)\\
        2d_1 \cdot e^{\frac{1}{2}t} \cdot \delta_0(t) = 3\delta_0(t)
      \end{cases}
      \] 
      Imponiamo \( t = 0^- \) 
      \[
      \begin{cases}
        2d_0 \cdot \cancel{\delta_0'(0)} = \cancel{\delta_0'(0)}\\
        \left( 2d_1 \cdot \underset{=1}{\cancel{e^{\frac{1}{2} \cdot 0}}} \right) \cdot \delta_0(0) = 3\delta_0(0)
      \end{cases}
      \] 
      \[
      \begin{cases}
        2d_0 = 1\\
        2d_1 - d_0 = 3
      \end{cases}
      \to 
      \begin{cases}
        d_0 = \frac{1}{2}\\
        d_1 = \frac{7}{4}
      \end{cases}
      \] 

    \item Scrivo la risposta impulsiva:
      \[
        h(t) = \frac{1}{2} \cdot \delta_0(t) + \frac{7}{4} \cdot e^{\frac{1}{2}t} \cdot \delta_{-1}(t)
      \]
    \item Calcolo la risposta forzata nell'esercizio \ref{ex:risposta_forzata}
  \end{enumerate}
  \label{ex:risposta_impulsiva_2}
\end{exercise}

\subsubsection{Risposta forzata}
\begin{definition}
  La risposta forzata vuol dire che l'uscita del sistema dipende solo dall'input di un
  sistema LTI, causale per un ingresso \( u(t) \) (\( u(t) = 0, t < 0 \)) e si definisce
  come:
  \[
    \begin{aligned}
      v_f(t) = (u \ast h)(t) &= \int_{0^-}^{t^+} u(\tau) \cdot h(t-\tau) \, d\tau\\
                             &= \int_{0^-}^{t^+} u(t-\tau) \cdot h(\tau) \, d\tau
    \end{aligned}
  \] 
  dove:
  \[
  \begin{aligned}
    u &= \text{Input}\\
    h &= \text{Risposta impulsiva}\\
  \end{aligned}
  \] 
\end{definition}

\begin{example}
  Riprendendo l'ultimo punto dell'esempio \ref{ex:risposta_impulsiva}, la risposta
  forzata è:
  \[
    \begin{aligned}
      v_f(t) = (u \ast h)(t) &= \int_{+\infty}^{-\infty} u(\tau) \cdot h(t-\tau) \, d\tau\\
                             &= \int_{t^+}^{0} u(t) \cdot h(t-\tau) \, d\tau
    \end{aligned}
  \] 
\end{example}

\begin{exercise}
  \label{ex:risposta_forzata}
  Data la risposta impulsiva dell'esercizio \ref{ex:risposta_impulsiva_2} calcoliamo la
  risposta forzata con un input \( u(t) = 3\delta_{-1}(t) \) (gradino alto 3):
  \[
  \begin{aligned}
    v_f &= (h \ast u)(t) \\
        &= (h \ast 3\delta_{-1})(t)\\
        &= \int_{-\infty}^{+\infty} h(\tau) \cdot 3\delta_{-1}(t-\tau) \, d\tau\\
        &= \int_{-\infty}^{+\infty} \left[ \frac{1}{2} \cdot \delta_0(\tau) + \frac{7}{4}
        \cdot e^{\frac{1}{2}\tau} \cdot \delta_{-1}(\tau) \right] \cdot 3\delta_{-1}(t-\tau) \, d\tau\\
        &= \int_{-\infty}^{+\infty} \frac{1}{2} \delta_0(\tau) \cdot
        3\delta_{-1}(t-\tau) \, d\tau + \int_{-\infty}^{+\infty} \frac{7}{4} e^{\frac{1}{2}\tau}
        \cdot \delta_{-1}(\tau) \cdot 3\delta_{-1}(t-\tau) \, d\tau\\
        &= \frac{3}{2} \int_{\cancel{\stackrel{\color{green!50!black}0^-\color{black}}{-\infty}}}^{\cancel{\stackrel{\color{orange}0^+\color{black}}{+\infty}}} 
        \stackrel{=1}{
        \cancel{
        \underbrace{\delta_0(\tau)}_{[0^-,0^+]} \cdot
        \underbrace{\delta_{-1}(t-\tau)}_{[-\infty,t]}
        }}
        \, d\tau + \frac{21}{4} 
        \int_{\cancel{\stackrel{\color{blue}0\color{black}}{-\infty}}}^{\cancel{\stackrel{\color{red}t\color{black}}{+\infty}}}
        e^{\frac{1}{2}\tau} \cdot \delta_{-1}(\tau) \cdot \delta_{-1}(t-\tau) \, d\tau\\
        &= \frac{3}{2} \cdot 1 + \frac{21}{4} \cdot \int_{0}^{t} e^{\frac{1}{2}\tau} \, d\tau\\
        &\to \frac{3}{2} + \frac{21}{4} \cdot \left[ \frac{1}{2} \cdot e^{\frac{1}{2}\tau} \right]_0^t\\
        &= \frac{3}{2} + \frac{21}{4} \cdot \left( \frac{1}{2} \cdot e^{\frac{1}{2}t} - \frac{1}{2} \right)\\
        &= \frac{3}{2} + \frac{21}{8} \cdot e^{\frac{1}{2}t} - \frac{21}{8} \cdot \frac{1}{2}\\
        &= v_f(t)
  \end{aligned}
  \] 
  Teniamo fissa la risposta impulsiva \( h(t) \) e trasliamo il gradino \( u(t) \)
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\a{1}
      \draw[->] (-4,0) -- (4,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,1.5) node[above] {$f(t)$};

      \node[below left,scale=0.6,green!50!black] at (0,0) {\( 0^- \)};
      \node[below right,scale=0.6,orange] at (0,0) {\( 0^+ \)};

      \draw[orange,thick] (-3.9,0)  -- (0,0) -- (0,\a) -- (3.9,\a) 
        node[above] {\( 3 \delta_{-1}(t) \)};
      \draw[green!50!black,thick] (-3.9,\a) node[above] {\( 3 \delta_{-1}(t - \tau) \)} -- 
        (0,\a) -- (0,0) -- (3.9,0);
    \end{tikzpicture}
    \caption{\( 3 \delta_{-1}(t - \tau) \) viene traslato}
  \end{figure}
  \( +\infty \) e \( -\infty \) diventano \( 0 \) e \( t \) perchè:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\a{1}
      \draw[->] (-4,0) -- (4,0) node[right] {$t$};
      \draw[->] (0,-0.2) -- (0,1.5) node[above] {$f(t)$};

      \node[below right,scale=0.6,blue] at (0,0) {\( 0 \)};

      \draw[blue,thick] (-3.9,0)  -- (0,0) -- (0,\a) -- (3.9,\a) 
        node[above] {\( 3 \delta_{-1}(t) \)};
      \draw[red,thick] (-3.9,\a) node[above] {\( 3 \delta_{-1}(t - \tau) \)} -- 
        (2,\a) -- (2,0) node[below] {\( t \)} -- (3.9,0);
    \end{tikzpicture}
    \caption{\( 3 \delta_{-1}(t - \tau) \) viene traslato}
  \end{figure}
\end{exercise}

\subsubsection{Risposta totale}
Data un'equazione che descrive un sistema LTI:
\[
  \sum_{i=0}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} = \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}
\] 
la risposta totale si calcola come la somma della risposta libera e forzata:
\[
  v_t(t) = v_l(t) + v_f(t)
\] 
La risposta libera è data da:
\[
  v_l(t) = \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} c_{i,l} \cdot \frac{t^l}{l!} \cdot e^{\lambda_i t}
\] 
La risposta forzata è data da:
\[
  \begin{aligned}
    v_f(t) &= (\underbrace{u}_{\text{Input}} \ast \underbrace{h}_{\text{Risposta impulsiva}})(t)\\
           &= \int_{0^-}^{t^+} u(\tau) \cdot h(t-\tau) \, d\tau\\
           &= \int_{0^-}^{t^+} u(t-\tau) \cdot h(\tau) \, d\tau
  \end{aligned}
\]
e la risposta impulsiva è data da:
\[
  h(t) = d_0 \cdot \delta(t) + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} d_{i,l} \cdot \frac{t^l}{l!} \cdot e^{\lambda_i t} \cdot \delta_{-1}(t)
\]

\subsection{Stabilità in base alle radici}
Considerando 3 radici si ha:
\begin{itemize}
  \item \textbf{Stabilità asintotica}: Tutte le radici devono avere parte reale minore
    di 0:
    \[
    \forall i \;\; \Re(\lambda_i) < 0
    \] 
    ad esempio:
    \[
      \underbrace{-1}_{\Re(\lambda_1) < 0} + i \quad
      \underbrace{-2}_{\Re(\lambda_2) < 0} - i \quad
      \underbrace{-3}_{\Re(\lambda_3) < 0}
    \] 

  \item \textbf{Semplicemente stabile}: Solo una radice ha parte reale uguale a 0: 
    \[
    \exists i \;\; \Re(\lambda_i) = 0
    \] 
    ad esempio:
    \[
      \underbrace{0}_{\Re(\lambda_1) = 0} + i \quad
      -2 > 0 - i \quad
      -3 > 0
    \]

  \item \textbf{Asintoticamente instabile}: Tutte le radici hanno parte reale minore di
    0 tranne un sottoinsieme che hanno parte reale uguale a 0:
    \[
    \forall i \;\; \Re(\lambda_i) \le 0
    \] 
    ad esempio:
    \[
      \underbrace{0}_{\Re(\lambda_i = 0)} + i \quad
      \underbrace{0}_{\Re(\lambda_i = 0)} - i \quad
      -3 + i
    \]

  \item \textbf{Totalmente instabile}: Almeno una radice ha la parte reale maggiore di 0:
    \[
    \exists i \;\; \Re(\lambda_i) > 0
    \] 
    ad esempio:
    \[
      \underbrace{1}_{\Re(\lambda_1) > 0} + i \quad
      0 - i \quad
      -3 + i
    \]
\end{itemize}

\subsection{Risposta in frequenza}
La risposta in frequenza è la risposta di un sistema LTI a un segnale sinusoidale.
Abbiamo visto che gli esponenziali complessi si rappresentano come:
\[
  Ae^{j \left( \omega_0 t + \phi \right)} = A e^{j \phi} \cdot e^{j \omega_0 t}
\] 
Questi esponenziali si chiamano \textbf{Fasori} perchè vengono rappresentati come
vettori rotanti in un piano complesso, come mostrato in figura \ref{fig:fasore}.

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {\( \Sigma \) };
    \draw[->] (-1,0) -- (A) node[midway,above left] {\( u(t) = A e^{j \phi} \cdot e^{j \omega_0 t} \)};
    \draw[->] (A) -- (1,0) node[midway,above right] {\( v(t) \)};
  \end{tikzpicture}
  \caption{Fasore}
\end{figure}
La risposta in frequenza si calcola come la convoluzione tra l'ingresso e la risposta
impulsiva \( h(t),\; t \in \mathbb{R} \):
\[
  \begin{aligned}
    v(t) &= \int_{-\infty}^{+\infty} h(\tau) \cdot u(t-\tau) \, d\tau\\
         &= \int_{-\infty}^{+\infty} h(\tau) \cdot A e^{j \left( \omega_0 \left( t - 
         \tau \right) + \phi \right) } \, d\tau\\
         &= 
         \underbrace{A e^{j \left( \omega_0 t + \phi \right) }}_{\text{Costante}}
         \cdot 
         \underbrace{\int_{-\infty}^{+\infty} h(\tau) \cdot e^{-j \omega_0 \tau} \, d\tau}_
         { \left| \int \right| < \infty }\\
  \end{aligned}
\] 
\[
  \left| \int_{-\infty}^{+\infty} h(\tau) \cdot e^{-j \omega_0 \tau} \, d\tau \right| <
  \int_{-\infty}^{+\infty} \left| h(\tau) \cdot e^{-j \omega_0 \tau} \right| \, d\tau\\
\] 
\[
  \begin{aligned}
    &= \int_{-\infty}^{+\infty} \left| h(\tau) \right| \cdot \left| e^{-j \omega_0 \tau} \right| \, d\tau\\
    &= \int_{-\infty}^{+\infty} \left| h(\tau) \right| \cdot 1 \, d\tau < \infty
  \end{aligned}
\] 
La risposta in frequenza è quindi:
\[
  H(j \omega_0) = \int_{-\infty}^{+\infty} h(\tau) \cdot e^{-j \omega_0 \tau} \, d\tau
\] 
Da questa formula si ha che l'uscita \( v(t) \) è uguale a:
\[
  v(t) = H(j \omega_0) \cdot A e^{j \left( \omega_0 t + \phi \right) }, \quad t \in \mathbb{R}
\] 
La risposta in frequenza è la trasformata di Fourier della risposta impulsiva del sistema e
anche la trasformata di Laplace della risposta impulsiva ristretta al solo asse immaginario:
\begin{theorem}
  \[
    H(j \omega) = \mathcal{F}[h(t)](s) = \mathcal{L}[h(t)](s), \; s = j \omega
  \] 
  Dove:
  \[
    \begin{aligned}
      \mathcal{F} &= \text{Trasformata di Fourier}\\
      \mathcal{L} &= \text{Trasformata di Laplace}
    \end{aligned}
  \] 
\end{theorem}
\begin{example}
  Se prendiamo in considerazione un sistema dinamico, come ad esempio il sistema
  massa-molla-smorzatore dell'esempio \ref{massa-molla-smorzatore}, 
  descritto dall'equazione:
  \[
     \sum_{i=0}^{n} a_i \frac{\partial^{i} v(t)}{\partial t} = \sum_{j=0}^{m} b_j \frac{\partial^{j} u(t)}{\partial t}
  \] 
  Per calcolare la soluzione nel dominio del tempo si può fare il passaggio solito fatto fin'ora,
  oppure si può prendere una scorciatoia e calcolare la trasformata di Laplace delle equazioni
  algebriche per trovare poi la soluzione in \( \mathbb{C} \) rendendo più semplice il calcolo.
\end{example}

\section{Trasformata unilatera di Laplace (TDL)}
\begin{definition}[Trasformata unilatera di Laplace]
  Sia \( v(t) \) una funzione generica (non l'uscita di un sistema) con
  \( t \in \mathbb{R} \) ottenuta da somme di funzioni a variabili reali con valori 
  reali o complessi (ad esempio somma di fasori).
  \begin{itemize}
    \item Localmente sommabile in \( [0,\infty) \) :
      \[
        \int_a^b \left| v(t) \right| \, dt < \infty, \quad \forall a,b \in [0,\infty)
      \] 

    \item Formata da un insieme finito di segnali polinomiali
  \end{itemize}
  Definiamo la trasformata unilatera di Laplace come:
  \[
    \begin{aligned}
      V(s) &= \int_{0^-}^{+\infty} v(t) \cdot e^{-st} \, dt
           &= \mathcal{L}[v(t)](s)
    \end{aligned}
  \] 
  \textbf{N.B.}: Data \( v(t) \) localmente sommabile, non significa che \( V(s) \) sia 
  localmente sommabile
\end{definition}
Bisogna ora definire la \textbf{Regione di convergenza}:
\begin{definition}
  La regione di convergenza è un semipiano positivo definito come:
  \[
    \text{RDC} = \left\{ s \in \mathbb{C},\; \alpha \in \mathbb{R} \; | \; \Re(s) > \alpha \right\}
  \] 
  Dove \( \alpha \) è l'ascissa di convergenza:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-1,0) -- (4,0) node[right] {\( \Re(s) \)};
      \draw[->] (0,-1) -- (0,4) node[above] {\( \Im(s) \)};
      \draw[dashed, blue] (2,0) node[below] {\( \alpha \)} -- (2,4);
      \draw[fill=black] (2,0) circle (0.05);
      \fill[blue, fill opacity=0.2] (2,0) rectangle (4,4);
    \end{tikzpicture}
  \end{figure}
\end{definition}
\textbf{Dimostrazione}:
Sia \( v(t) \) una combinazione lineare di esponenziali:
\[
  v(t) = \sum_{i=0}^{n} c_i \cdot e^{\lambda_i t}
\] 
\[
\lambda_i = \sigma_i + j \omega_i \in \mathbb{C}
\] 
Vogliamo dimostrare che la regione di convergenza della trasformata di Laplace è un
semipiano a destra di \( \alpha \):
\[
  \text{RDC} \mathcal{L}[v(t)](s) = \left\{ s \in \mathbb{C},\; \alpha \in \mathbb{R} \; | \; \Re(s) > \alpha \right\}
\] 
Dimostro:
\[
  \begin{aligned}
    \mathcal{L}[v(t)](s) &= \int_{0^-}^{+\infty} v(t) \cdot e^{-st} \, dt \\
                         &= \int_{0^-}^{+\infty} \sum_{i=0}^{n} c_i \cdot e^{\lambda_i t} \cdot e^{-st} \, dt\\
                         &= \sum_{i=0}^{n} c_i \int_{0^-}^{+\infty} e^{\lambda_i t} \cdot e^{-st} \, dt\\
  \end{aligned}
\] 
Prendiamo un preciso \( i \to \lambda_i = \sigma_i + j \omega_i \quad s = \sigma + j \omega\) 
\[
  \int_{0^-}^{+\infty} e^{\sigma_i t} \cdot e^{j \omega_i t} \cdot e^{-\sigma t} \cdot e^{-j \omega t} \, dt =
  \int_{0^-}^{+\infty} e^{(\sigma_i - \sigma + j \omega_i - j \omega) t} \, dt
\] 
\[
  = \lim_{t \to \infty} \left( \frac{e^{(\sigma_i - \sigma) t} \cdot e^{j (\omega_i - \omega) t}}
  {\sigma_i - \sigma + j \omega_i - j \omega} \right)
  = \frac{1}{\sigma - \sigma_i + j \omega_i - j\omega)}
\] 
L'integrale converge se \( \sigma_i - \sigma < 0 \to \sigma > \sigma_i \) e quindi:
\[
\sigma  = \Re(s) \quad \sigma_i = \Re(\lambda_i)
\] 
\[
\forall s \in \mathbb{C} \; \Re(s) > \Re(\lambda_i) \quad i = 0,1,\ldots,n
\] 
\[
\alpha \ge max(\Re(\lambda_i))
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.3]
    \draw[->] (-2.5,0) -- (2.5,0) node[right] {$\Re$};
    \draw[->] (0,-0.2) -- (0,2) node[above] {$\Im$};

    \draw[fill=blue,blue] (-2,1.5) circle (0.05) node[above] (l_1) {$\lambda_1$};
    \draw[fill=blue,blue] (-1.5,1.2) circle (0.05) node[above] (l_2) {$\lambda_2$};
    \draw[fill=blue,blue] (-1,0.7) circle (0.05) node[above] (l_3) {$\lambda_3$};
    \draw[fill=blue,blue] (-0.5,1.8) circle (0.05) node[above] (l_4) {$\lambda_4$};
    \node[below,blue] at (-0.5,0) {\( \alpha \)};

    \draw[dashed] (l_1) -- (l_1 |- 52,0);
    \draw[dashed] (l_2) -- (l_2 |- 52,0);
    \draw[dashed] (l_3) -- (l_3 |- 52,0);
    \draw[dashed] (l_4) -- (l_4 |- 52,0);

    \fill[blue,fill opacity=0.2] (-0.5,0) rectangle (2.5,1.8);
  \end{tikzpicture}
  \caption{Asintoticamente stabile}
\end{figure}
Per un sistema LTI stabile RDC contiene sempre l'asse immaginatio

\subsection{Proprietà della trasformata di Laplace}
\subsubsection{Linearità}
  Siano \( v_1 \) e \( v_2 \)  funzioni che ammettono la trasformata di Laplace e 
  rispettivamente \( V_1 \) e \( V_2 \) le loro trasformate di Laplace:
  \[
    \begin{aligned}
      v_1 &\to V_1(s)\\
      v_2 &\to V_2(s)
    \end{aligned}
  \] 
  allora: $a v_1(t) + b v_2(t)$ ammette la trasformata di Laplace ed è definita come:
  \[
    \mathcal{L}[a v_1(t) + b v_2(t)](s) = a V_1(s) + b V_2(s)
  \] 
  Ha come ascissa di convergenza:
  \[
    \alpha \ge max \left\{ \alpha_1,\alpha_2 \right\} 
  \] 

\subsubsection{Traslazione nel tempo (ritardo temporale)}
  Sia \( v(t) \) una funzione che ammette la trasformata di Laplace \( V(s) \), allora
  la trasformata di Laplace di \( v(t - \tau) \), con \( \tau > 0 \) è:
  \[
    \mathcal{L}[v(t - \tau)](s) = e^{-s \tau} \cdot \mathcal{L}[v(t)](s)
  \] 
  L'ascissa di convergenza rimane immutata

  \vspace{1em}
  \noindent
  \textbf{Dimostrazione}:
  \[
    \begin{aligned}
      \mathcal{L}[v(t-\tau)](s) &= \int_{0^-}^{+\infty} v(t-\tau) \cdot e^{-st} \, dt\\
                                &= \int_{\tau^-}^{+\infty} v(t-\tau) \cdot e^{-st)} \, d\tau\\
                                x = t - \tau\\
                                t = x + \tau\\
                                dt = dx\\
                                &= \int_{0^-}^{+\infty} v(x) \cdot e^{-s(x+\tau)} \, dx\\
                                &= e^{-s \tau} \int_{0^-}^{+\infty} v(x) \cdot e^{-sx} \, dx\\
                                &= e^{-s \tau} \cdot \mathcal{L}[v(t)](s)
    \end{aligned}
  \] 

\subsubsection{Traslazione nel dominio dei complessi (spostamento in frequenza)}

  Sia \( v(t) \) una funzione che ammette la trasformata di Laplace \( V(s) \), allora
  la trasformata di Laplace di \( e^{\lambda t} \cdot v(t) \) è:
  \[
    \mathcal{L}\left[e^{\lambda t} \cdot v(t)\right](s) = V(s - \lambda)
  \] 
  L'ascissa di convergenza rimane spostata:
  \[
    \alpha = \alpha_0 + \Re(\lambda)
  \] 

  \vspace{1em}
  \noindent
  \textbf{Dimostrazione}:
  \[
    \begin{aligned}
      \mathcal{L}\left[e^{\lambda t} \cdot v(t)\right](s) &= \int_{0^-}^{+\infty} e^{\lambda t} \cdot v(t) \cdot e^{-st} \, dt\\
                                               &= \int_{0^-}^{+\infty} v(t) \cdot e^{(\lambda - s)t} \, dt\\
                                               &= \int_{0^-}^{+\infty} v(t) \cdot e^{-\overbrace{(s - \lambda)}^{r}t} \, dt\\
                                               &= \mathcal{L}[v(t)](r)\\
                                               &= \mathcal{L}[v(t)](s - \lambda)
    \end{aligned}
  \] 

  \subsubsection{Cambio di scala}
  Sia \( v(t) \) una funzione che ammette la trasformata di Laplace \( V(s) \), allora
  la trasformata di Laplace di \( v(r t) \) è:
  \[
    \mathcal{L}[v(r t)](s) = \frac{1}{r} \cdot V\left( \frac{s}{r} \right)
  \] 
  L'ascissa di convergenza viene scalata:
  \[
    \alpha = r \cdot \alpha_0
  \] 

  \vspace{1em}
  \noindent
  \textbf{Dimostrazione}:
  \[
    \begin{aligned}
      \mathcal{L}[v(r t)](s) &= \int_{0^-}^{+\infty} v(r t) \cdot e^{-st} \, dt\\
      x = rt\\
      t = \frac{x}{r}\\
      dt = \frac{dx}{r}\\
                             &= \int_{0^-}^{+\infty} v(x) \cdot e^{-s \frac{x}{r}} \, dx\\
                             &= \frac{1}{r} \int_{0^-}^{+\infty} v(x) \cdot e^{-\frac{s}{r} x} \, dx\\
                             &= \frac{\mathcal{L}[v(t)](\frac{s}{r})}{r}
    \end{aligned}
  \]

\subsubsection{Proprietà della derivata}
\label{subsubsec:derivata}
Sia \( v(t) \) una funzinoe che ammette la trasformata di Laplace \( V(s) \) ed
esiste ed è finito il limite: \( v(0^-)= \lim_{t \to o^-} v(t) \), allora anche la
sua derivata i-esima ammette la trasformata di Laplace e vale:
\[
  \mathcal{L}\left[ \frac{d^{i} v(t)}{dt^{i}} \right](s) = s^{i} \cdot V(s) -
  \sum_{k=0}^{i-1} \frac{d^k v(t)}{dt^k} \Big|_{t=0^-} \cdot s^{i-k-1}
\] 
L'ascissa di convergenza è minore dell'ascissa di convergenza originale
\[
  \alpha \le \alpha_0
\] 

\vspace{1em}
\noindent
\textbf{Dimostrazione}:
\[
  \begin{aligned}
    \mathcal{L}\left[\frac{d v(t)}{dt}\right](s) &= \int_{0^-}^{+\infty} \overbrace{\frac{d v(t)}{dt}}^{
    f'(t)} \cdot \overbrace{e^{-st}}^{g(t)} \, dt\\
    &= v(t) \cdot e^{-st} \Big|_{0^-}^{+\infty} - \left( 
    -s \underbrace{\int_{0^-}^{+\infty} v(t) \cdot e^{-st} \, dt}_{\text{TdL}} \right)\\
    &= \stackrel{0}{\cancel{\lim_{\varepsilon \to \infty} v(\varepsilon )
    \cdot e^{-s \varepsilon }}} - \lim_{\varepsilon \to 0^-}
    v(\varepsilon ) \cdot e^{-s \varepsilon } + s \cdot V(s)\\
    &= s \cdot V(s) - v(0^-)
  \end{aligned}
\] 

\vspace{1em}
\noindent
\textbf{Dimostrazione per la derivata seconda}:
\[
\begin{aligned}
  \mathcal{L}\left[ \frac{d^{2} v(t)}{dt^{2}} \right](s) &= \mathcal{L}\left[ \frac{d}{dt}
  \left( \frac{d v(t)}{dt} \right) \right](s)\\
    &= s \cdot \mathcal{L}\left[
    \frac{d v(t)}{dt} \right](s) - 
    \frac{d v(t)}{dt} \Big|_{0^-}\\
    &= s \cdot \left( s \cdot \mathcal{L}[v(t)](s) - v(0^-) \right) -
    \frac{d v(t)}{dt} \Big|_{0^-}\\
    &= s^{2} \cdot V(s) - s \cdot v(0^-) - \frac{d v(t)}{dt} \Big|_{0^-}
\end{aligned}
\] 

\subsubsection{Moltiplicazione per una funzione polinomiale}
Sia \( v(t) \) una funzione che ammette la trasformata di Laplace \( V(s) \), allora
la trasformata di Laplace di \( t^{i} \cdot v(t) \) è:
\[
  \mathcal{L}[t^{i} \cdot v(t)](s) = (-1)^{i} \cdot \frac{d^{i} V(s)}{ds^{i}}
\] 

\vspace{1em}
\noindent
\textbf{Dimostrazione} (\( i = 1 \)):
\[
  \begin{aligned}
    \mathcal{L}[t \cdot v(t)](s) &= \int_{0^-}^{+\infty} t \cdot v(t) \cdot e^{-st} \, dt\\
                                 &= - \int_{0^-}^{+\infty} v(t) \cdot \left( -t \cdot e^{-st} \right) \, dt\\
                                 &= - \int_{0^-}^{+\infty} v(t) \cdot \frac{d}{ds} \left( e^{-st} \right) \, dt\\
                                 &= - \frac{d}{ds} \underbrace{\int_{0^-}^{+\infty} v(t) \cdot e^{-st} \, dt}_{\text{TdL \( v(t) \) }}\\
                                 &= - \frac{d}{ds} V(s)
  \end{aligned}
\] 

\subsubsection{Integrazione nel tempo}
Sia \( v(t) \) una funzione che ammette la trasformata di Laplace \( V(s) \), allora
la trasformata di Laplace di \( \psi(t) = \int_{0^-}^{t} v(t) \, dt \) è:
\[
  \mathcal{L}\left[\int_{0^-}^{t} v(\tau) \, d\tau\right](s) = \frac{V(s)}{s}
\] 
E l'ascissa di convergenza è:
\[
\alpha = max(\alpha_0,0)
\] 

\vspace{1em}
\noindent
\textbf{Dimostrazione}:
\[
  v_i(t) = \int_{0^-}^{t} v(\tau) \, d\tau \to v'_1(t) = v(t) \text{ e }
  v(0^-) = \int_{0^-}^{0^-} v(\tau) \, d\tau = 0
\] 
Quindi
\[
  \begin{aligned}
    \mathcal{L}[v(t)](s) &\stackrel{ \ref{subsubsec:derivata} }{\to} \mathcal{L}[v'_1(t)](s)\\ 
                         &= s \cdot \mathcal{L}[v_1(t)](s) - v_1(0^-)\\
                         &= s \mathcal{L}[\int_{0^-}^{t} v(\tau) \, d\tau](s)\\
  \end{aligned}
\] 
Quindi:
\[
  \mathcal{L}[\int_{0^-}^{t} v(\tau) \, d\tau](s) = \frac{V(s)}{s}
\] 

\subsubsection{Integrale nel dominio dei complessi}
Sia \( v(t) \) una funzione che ammette la trasformata di Laplace \( V(s) \), se
esiste il \( \lim_{t \to 0^-} \frac{v(t)}{t} \), allora la trasformata di Laplace è:
\[
  \mathcal{L}\left[ \frac{v(t)}{t} \right](s) = \int_{s}^{+\infty} \mathcal{L}[v(t)](s) \, ds
\] 

\subsubsection{Teorema del valore iniziale}
Sia \( v(t) \) una funzione che ammette la trasformata di Laplace \( V(s) \), ed esiste
ed è finito il limite \( \lim_{t \to 0^-} v(t) \), allora:
\[
  \lim_{t \to o^-} v(t) = \lim_{s \to +\infty} s \cdot \mathcal{L}[v(t)](s)
\] 

\subsubsection{Teorema del valore finale}
Sia \( v(t) \) una funzione che ammette la trasformata di Laplace \( V(s) \), ed esiste
ed è finito il limite \( \lim_{t \to +\infty} v(t) \), allora:
\[
  \lim_{t \to +\infty} v(t) = \lim_{s \to 0^+} s \cdot \mathcal{L}[v(t)](s)
\]

\subsubsection{Convoluzione nel dominio del tempo}
Siano \( u(t) \) e \( v(t) \) due funzioni causali (nulle per \( t < 0 \)) che ammettono
la trasformata di Laplace \( U(s) \) e \( V(s) \), allora \( (u \ast v)(t) \) ammette
la trasformata di Laplace e vale:
\[
  \mathcal{L}[(u \ast v)(t)](s) = \mathcal{L}[u(t)](s) \cdot \mathcal{L}[v(t)](s)
\] 

\vspace{1em}
\noindent
\textbf{Dimostrazione}:
\[
  \begin{aligned}
    \mathcal{L}[(u \ast v)(t)](s) &= \int_{0^-}^{+\infty} \left( 
    \int_{-\infty}^{+\infty} u(\tau) \cdot v(t-\tau) \, d\tau \right) \cdot e^{-st} \, dt\\
    \left\{ u(t) = 0, \;\; t < 0 \right\} \quad &= \int_{0^-}^{+\infty} \int_{-\infty}^{+\infty} u(\tau) \cdot v(t-\tau) \cdot e^{-st} \, d\tau \, dt\\
                               &= \int_{0^-}^{+\infty} u(\tau) \cdot \left( 
                                 \int_{0^-}^{+\infty} v(t-\tau) \cdot e^{-st} \, dt \right) \, d\tau\\
    \text{Sostituisco: } & x = t-\tau, \quad t = x + \tau, \quad dt = dx\\
    \mathcal{L}[(u \ast v)(t)](s) &= \int_{0^-}^{+\infty} u(\tau) \cdot \left(
      \int_{0^-}^{+\infty} v(x) \cdot e^{-s(x+\tau)} \, dx \right) \, d\tau\\
                                  &= \int_{0^-}^{+\infty} u(\tau) \cdot e^{-s \tau} \, d\tau \cdot
                                  \int_{0^-}^{+\infty} v(x) \cdot e^{-sx} \, dx\\
                                  &= \mathcal{L}[u(t)](s) \cdot \mathcal{L}[v(t)](s)
  \end{aligned}
\]

\subsection{Trasformate notevoli}
\subsubsection{Impulso}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta(t)$};

    \draw[->,blue,thick] (0,0) -- (0,1) node[right] {$1$};

    \node[below, scale=0.8] at (0,-0.1) {$0$};
    \node[above left, scale=0.8] at (0,0) {$0^-$};
    \node[above right, scale=0.8] at (0,0) {$0^+$};
  \end{tikzpicture}
  \caption{Impulso}
\end{figure}
\begin{itemize}
  \item 
    La trasformata di Laplace dell'impulso \( \delta_0(t) \) è:
    \[
      \begin{aligned}
        \mathcal{L}[\delta_0(t)](s) &= \int_{0^-}^{+\infty} \stackrel{\text{Proprietà impulso}}{\cancel{\delta_0(t)}^1} \cdot e^{-st} \, dt\\
                                    &= e^{-st} \Big|_{t=0} = 1
      \end{aligned}
    \] 

  \item 
    La trasformata di Laplace di un impulso di altezza \( A \) è:
    \[
      \begin{aligned}
        \mathcal{L}[A \cdot \delta_0(t)](s) &= A \cdot \mathcal{L}[\delta_0(t)](s)\\
                                            &= A
      \end{aligned}
    \] 
  \item 
    La trasformata di laplace dell'impulso ritardato è:
    \[
      \begin{aligned}
        \mathcal{L}[\delta_0(t - \tau)](s) &= \int_{0^-}^{+\infty} \delta_{\tau}(t) \cdot e^{-st} \, dt\\
                                             &= e^{-s \tau}
      \end{aligned}
    \] 
\end{itemize}



\subsubsection{Gradino}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \def\a{1}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$\delta_{-1}(t)$};

    \draw[blue,thick] (-1.4,0) -- (0,0) -- (0,\a) -- (1.4,\a);

  \end{tikzpicture}
\end{figure}
\begin{itemize}
  \item 
    La trasformata di Laplace del gradino \( \delta_{-1}(t) \) è:
    \[
      \begin{aligned}
        \mathcal{L}[\delta_{-1}(t)](s) &= \int_{0^-}^{+\infty} \stackrel{1}{\cancel{\delta_{-1}(t)}} \cdot e^{-st} \, dt\\
                                       &= \int_{0^-}^{+\infty} e^{-st} \, dt\\
                                       &= \lim_{\varepsilon \to \infty;\; \mu \to 0^-} \left( - \frac{e^{-st}}{s} \right) \Big|^{\varepsilon}_{t=\mu}\\
                                       &= \lim_{\mu \to 0^-}  \frac{e^{-st}}{s} - \lim_{\varepsilon \to \infty} \frac{e^{-st}}{s}\\
                                       &= \frac{1}{s}
      \end{aligned}
    \] 

  \item 
    La trasformata di Laplace del gradino di altezza \( A \) è:
    \[
      \begin{aligned}
        \mathcal{L}[A \cdot \delta_{-1}(t)](s) &= A \cdot \mathcal{L}[\delta_{-1}(t)](s)\\
                                               &= \frac{A}{s}
      \end{aligned}
    \]
  \item 
    La trasformata di Laplace del gradino ritardato è:
    \[
      \begin{aligned}
        \mathcal{L}[\delta_{-1}(t - \tau)](s) &= e^{-s \tau} \cdot \frac{1}{s}
      \end{aligned}
    \]
\end{itemize}

\subsubsection{Esponenziale complesso causale}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \def\a{1/2}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$v(t)$};

    \draw[blue,thick,domain=0:0.99, samples=100] plot (\x,{\a * exp(\x)})
      node[above right] {\( \lambda > 0 \) };
    \draw[blue,thick,domain=0:1.4, samples=100] plot (\x,{\a * exp(-\x)})
      node[above right] {\( \lambda < 0 \) };
  \end{tikzpicture}
\end{figure}
\begin{itemize}
  \item La trasformata di Laplace dell'esponenziale complesso causale
    \( v(t) = e^{\lambda t} \cdot \delta_{-1}(t) \) è:
    \[
      \begin{aligned}
        \mathcal{L}[e^{\lambda t} \cdot \delta_{-1}(t)](s) &= \mathcal{L}[\delta_{-1}(t)](s-\lambda)
                                                           &= \frac{1}{s-\lambda}
      \end{aligned}
    \] 
  \item La trasformata di Laplace dell'esponenziale con una costante \( A \) è:
    \[
      \begin{aligned}
        \mathcal{L}\left[A \cdot e^{\lambda t} \cdot \delta_{-1}(t)\right](s) &= A \cdot \mathcal{L}[e^{\lambda t} \cdot \delta_{-1}(t)](s)\\
                                                                 &= \frac{A}{s-\lambda}
      \end{aligned}
    \]
  \item La trasformata di Laplace dell'esponenziale complesso ritardato è:
    \[
      \begin{aligned}
        \mathcal{L}\left[e^{\lambda (t - \tau)} \cdot \delta_{-1}(t)\right](s) &= \frac{e^{-(s -\lambda) \tau}}{s-\lambda}
      \end{aligned}
    \]
\end{itemize}

\subsubsection{Esponenziale complesso causale moltiplicato per una funzione polinomiale}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \def\a{1/2}
    \draw[->] (-1.5,0) -- (3.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,2.5) node[above] {$v(t)$};

    \draw[blue,thick,domain=0:3.4, samples=100] plot (\x,{exp(-2*\x)+2*exp(-2*\x)*\x})
      node[above right] {\( \lambda < 0 \) };

    \draw[blue,thick,domain=0:1.5, samples=100] plot (\x,{exp(1/2*\x)+2*exp(-4*\x)*\x})
      node[above right] {\( \lambda > 0 \) };
  \end{tikzpicture}
\end{figure}
La trasformata di Laplace di \( v(t) = \frac{t^l}{l!} \cdot e^{\lambda t} \cdot \delta_{-1}(t) \) è:
\[
  \begin{aligned}
    \mathcal{L}\left[\frac{t^l}{l!} \cdot e^{\lambda t} \cdot \delta_{-1}(t)\right](s) &= 
    \frac{1}{l!} \cdot \mathcal{L}[t^l \cdot e^{\lambda t} \cdot \delta_{-1}(t)](s)\\
                                                                                       &= \frac{(-1)^l}{l!} \cdot \frac{d^{l}}{ds^{l}} \mathcal{L}\left[e^{\lambda t} \cdot \delta_{-1}(t)\right](s)\\
                                                                                       &= \frac{(-1)^l}{l!} \cdot \frac{d^{l}}{ds^{l}} \left( \frac{1}{s-\lambda} \right) \\
                                                                                       &= \frac{(-1)^l}{l!} \cdot \frac{l! (-1)^e}{(s-\lambda)^{l+1}}\\
                                                                                       &= \frac{1}{(s-\lambda)^{l+1}}
  \end{aligned}
\] 
\begin{example}
  Ad esempio se:
  \begin{itemize}
    \item 
      \( l = 1\), la trasformata di Laplace è:
      \[
        \begin{aligned}
          \mathcal{L}\left[t \cdot e^{\lambda t} \cdot \delta_{-1}(t)\right](s) &= \frac{1}{(s-\lambda)^{2}}
        \end{aligned}
      \] 
    \item \( l = 2 \) 
      \[
        \begin{aligned}
          \mathcal{L}\left[\frac{t^2}{2} \cdot e^{\lambda t} \cdot \delta_{-1}(t)\right](s) &= \frac{1}{(s-\lambda)^{3}}
        \end{aligned}
      \]
  \end{itemize}
\end{example}
\begin{example}
  Alcuni casi speciali sono:
  \begin{itemize}
    \item \[
        \mathcal{L}\left[ \frac{t}{l!} \cdot \delta_{-1}(t) \right](s) = \frac{1}{s^{l+1}}
    \] 

    \item
      \[
        \mathcal{L}\left[ t \cdot \delta_{-1}(t) \right](s) = \frac{l!}{s^{l+1}}
      \] 
      
    \item
      \[
        \mathcal{L}\left[ e^{-\lambda t} \cdot \delta_{-1}(t) \right](s) = \frac{1}{s+\lambda}
      \] 
  \end{itemize}
\end{example}

\subsubsection{Funzione coseno}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \def\a{1/2}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$v(t)$};

    \draw[blue,thick,domain=-1.4:1.4, samples=100] plot (\x,{cos(5*\x r)/2 + 1/2});
  \end{tikzpicture}
\end{figure}

La trasformata di Laplace di \( cos(\omega t) \) è:
\[
\begin{aligned}
  \mathcal{L}\left[ \cos(\omega t) \right](s) &\stackrel{\text{Eulero}}{=} \mathcal{L}\left[ \frac{e^{j \omega t} + e^{-j \omega t}}{2} \right](s)\\
                                              &= \frac{1}{2} \mathcal{L}\left[ e^{j \omega t} + e^{-j \omega t} \right](s)\\
                                              &= \frac{1}{2} \left( \mathcal{L}\left[ e^{j \omega t} \right](s) + \mathcal{L}\left[ e^{-j \omega t} \right](s) \right)\\
                                              &= \frac{1}{2} \left( \frac{1}{s-j \omega} + \frac{1}{s+j \omega} \right)\\
                                              &= \frac{1}{2} \left( \frac{s+\cancel{j \omega} + s-\cancel{j \omega}}{s^{2} + \omega^{2}} \right)\\
                                              &= \frac{s}{s^{2} + \omega^{2}}
\end{aligned}
\] 

\subsubsection{Funzione seno}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=1.5]
    \def\a{1/2}
    \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
    \draw[->] (0,-0.1) -- (0,1.5) node[above] {$v(t)$};

    \draw[blue,thick,domain=-1.4:1.4, samples=100] plot (\x,{sin(5*\x r)/2 + 1/2});
  \end{tikzpicture}
\end{figure}

La trasformata di Laplace di \( \sin(\omega t) \) è:
\[
\begin{aligned}
  \mathcal{L}\left[ \sin(\omega t) \right](s) &\stackrel{\text{Eulero}}{=} \mathcal{L}\left[ \frac{e^{j \omega t} - e^{-j \omega t}}{2j} \right](s)\\
                                              &= \frac{1}{2j} \mathcal{L}\left[ e^{j \omega t} - e^{-j \omega t} \right](s)\\
                                              &= \frac{1}{2j} \left( \mathcal{L}\left[ e^{j \omega t} \right](s) - \mathcal{L}\left[ e^{-j \omega t} \right](s) \right)\\
                                              &= \frac{1}{2j} \left( \frac{1}{s-j \omega} - \frac{1}{s+j \omega} \right)\\
                                              &= \frac{1}{2j} \left( \frac{\cancel{s}+j \omega - \cancel{s}+j \omega}{s^{2} + \omega^{2}} \right)\\
                                              &= \frac{\omega}{s^{2} + \omega^{2}}
\end{aligned}
\]

\subsection{Risoluzione di sistemi LTI causali}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,align=center] (sistema) at (0,0) {Sistema a\\tempo continuo};
    \node[draw,align=center,right=of sistema] (eqr) {Equazioni\\differenziali};
    \node[draw,align=center,right=of eqr] (sol) {Soluzione in \( \mathbb{R} \)\\nel tempo};
    \node[draw,align=center,below=of eqr] (eqc) {Equazioni\\algebriche\\in \( \mathbb{C} \)};
    \node[draw,align=center,right=of eqc] (solc) {Soluzione in \( \mathbb{C} \)};

    \draw[->] (sistema) -- (eqr);
    \draw[->] (eqr) -- (sol);
    \draw[->] (eqr) -- (eqc) node[midway,right] {\( \mathcal{L} \)};
    \draw[->] (eqc) -- (solc);
    \draw[->] (solc) -- (sol) node[midway,right] {\( \mathcal{L}^{-1} \)};
  \end{tikzpicture}
  \caption{Risoluzione di sistemi LTI causali tramite trasformata di Laplace}
\end{figure}
Per un sistema LTI causale:
\[
  \sum_{i=0}^{n} a_i \frac{d^{i} y(t)}{dt^{i}} = \sum_{j=0}^{m} b_j \frac{d^{j} x(t)}{dt^{j}}
\] 
Se \( n \ge m \) e \( u(t) = u(t) \cdot \delta_{-1}(t) \), (cioè \( u(t) = 0,\; t < 0 \)) 
e consideriamo le \( n-1 \) condizioni iniziali:
\[
  v(0^-); \; \frac{dv(0^-)}{dt}; \; \ldots; \; \frac{d^{n-1}v(0^-)}{dt^{n-1}}
\] 
Se \( u(t) \) ammette la trasformata di Laplace \( U(s) \) e \( v(t) \) ammette la trasformata
di Laplace \( V(s) \), con \( t \ge 0 \) allora si ha che:
\[
  \begin{aligned}
    \mathcal{L}\left[ \sum_{i=0}^{n} a_i \frac{d^{i} v(t)}{dt^{i}} \right](s) &= \mathcal{L}\left[ \sum_{j=0}^{m} b_j \frac{d^{j} u(t)}{dt^{j}} \right](s)\\
    \sum_{i=0}^{n} a_i \cdot \mathcal{L}\left[ \frac{d^{i} v(t)}{dt^{i}} \right](s) &= \sum_{j=0}^{m} b_j \cdot \mathcal{L}\left[ \frac{d^{j} u(t)}{dt^{j}} \right](s)\\
  \end{aligned}
\] 
Applicando \( n+m \) vale la regola della derivata:
\[
  \begin{aligned}
    a_n \left[ s^n V(s) - \sum_{k=0}^{n-1} \frac{d^{k} v(t)}{dt^{k}} \Big|_{t=0^-} \cdot s^{n-k-1} \right] &+\\
    a_{n-1} \left[ s^{n-1} V(s) - \sum_{k=0}^{n-2} \frac{d^{k} v(t)}{dt^{k}} \Big|_{t=0^-} \cdot s^{n-k-2} \right] &+ \ldots + a_0 V(S)\\
  \end{aligned}
\] 
Imponiamo le condizioni iniziali \( u(t) \Big|_{t=0^-} = 0 \), quindi si ha che le
derivate in 0 sono nulle:
\[
  \begin{aligned}
    = b_m s^{m} U(s) + b_{m-1} s^{m-1} U(s) + \ldots + b_0 U(s)
  \end{aligned}
\] 
Espandendo le sommatorie e raccogliendo si ha:
\[
\begin{aligned}
  \color{blue}\underbrace{\left( a_n s^n + a_{n-1} s^{n-1} + \ldots + a_0 \right)}_{d(s)}\color{black} V(s) \\
  - \color{green!50!black}\overbrace{a_n \cdot  v(0^-) \cdot  s^{n-1} - \left( a_{n-1} \cdot  v(0^-) + a_n \cdot  \frac{dv(t)}{dt} \Big|_{t=0^-} \right) s^{n-2} - \ldots}^{p(s)}\\
  \color{green!50!black}\ldots - \left( \sum_{k=0}^{n-1} a_{k+1} \cdot  \frac{d^{k} v(t)}{dt^{k}} \Big|_{t=0^-} \right) \color{black}=\\
  = \color{red}\underbrace{\left( b_m s^{m} + b_{m-1} s^{m-1} + \ldots + b_0 \right)}_{n(s)}\color{black} U(s)
\end{aligned}
\] 
Sostituendo diventa:
\[
  \color{blue}d(s)\color{black} \cdot V(s) - \color{green!50!black}p(s)\color{black} = \color{red}n(s)\color{black} \cdot U(s)
\] 
quindi:
\[
  V(s) = \frac{n(s)}{d(s)} \cdot U(s) + \frac{p(s)}{d(s)}
\] 

\vspace{1em}
\noindent
\begin{itemize}
  \item 
    \( n(s) \) è un polinomio di grado \( m \) che dipende solo dai coefficienti delle derivate
    associate all'ingresso. È il \textbf{polinomio caratteristico} di \( u(t) \)

  \item
    \( d(s) \) è un polinomio di grado \( n \) che dipende solo dai coefficienti delle derivate
    associate all'uscita. È il \textbf{polinomio caratteristico} di \( v(t) \)

  \item \( p(s) \) è un polinomio di grado \( n-1 \) che dipende dalle condizioni iniziali
    \[
      p(s) = \sum_{k=0}^{n-1} s^k \left( \sum_{j=k+1}^{n} a_{j+1} \cdot \frac{d^{n-j} v(t)}{dt^{n-j}} \Big|_{t=0^-} \right)
    \] 

  \item \( \frac{p(s)}{d(s)} \) è una funzione razionale che dipende solo dalle condizioni iniziali
    del sistema e dai coefficienti del polinomio caratteristico dell'uscita \( v(t) \).
    È la \textbf{trasformata di Laplace della risposta libera}:
    \[
      V_l(s) = \frac{p(s)}{d(s)}
    \] 

  \item \( \frac{n(s)}{d(s)} \) è una funzione razionale che dipende dai coefficienti del
    polinomio caratteristico dell'ingresso \( u(t) \) e dai coefficienti
    del polinomio caratteristico dell'uscita \( v(t) \) moltiplicati per la trasformata di 
    Laplace di \( u(t) \). È la \textbf{trasformata di Laplace della
    risposta forzata} siccome una convoluzione diventa un prodotto di trasformate:
    \[
      V_f(s) = \frac{n(s)}{d(s)} \cdot U(s)
    \]

  \item \( \frac{n(s)}{d(s)} \) si chiama \textbf{Funzione di trasferimento} \( H(s) \) ed
    è definita come:
    \[
      H(s) = \frac{\sum_{j=0}^{m} b_j s^{j}}{\sum_{i=0}^{n} a_i s^{i}}
    \] 
    è il rapporto tra i polinomi caratteristici dell'ingresso \( u(t) \) e dell'uscita \( v(t) \).
    \vspace{1em}
    \noindent
    \( H(s) \) è definita come la \textbf{trasformata di Laplace della risposta impulsiva}
    \( h(t) \)
    \[
      \begin{aligned}
        h(t) &= d_0 \cdot \delta_0(t) + \left( \sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} d_{i,l} \cdot  \frac{t^l}{l!} \cdot e^{\lambda_i t} \right) \cdot \delta_{-1}(t) \\
        \downarrow \mathcal{L}\\
        H(s) &= d_0 + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} \frac{d_{i,l}}{(s- \lambda_i)^{l+1}}
      \end{aligned}
    \] 
\end{itemize}

\begin{example}
  Dato un sistema LTI:
  \[
    \frac{d^3 v(t)}{dt^3} + \frac{d^2 v(t)}{dt^2} = \frac{d u(t)}{dt}
  \] 
  Si può trasformare usando la trasformata di Laplace:
  \[
    \color{green!50!black}\mathcal{L}\left[ \frac{d^3 v(t)}{dt^3} \right](s)\color{black}
    + \color{blue}\mathcal{L}\left[ \frac{d^2 v(t)}{dt^2} \right](s) \color{black} =
    \color{purple}\mathcal{L}\left[ \frac{d u(t)}{dt} \right](s)
  \] 
  Applicationo la regola della derivata:
  \[
    \begin{aligned}
      \color{green!50!black}s^3 V(s) - s^2 v(0^-) - \frac{dv(0^-)}{dt} \cdot s - \frac{d^2v(0^-)}{dt^2} \cdot s^0 \color{black}+\\
      +\, \color{blue}s^2 V(s) - s \cdot v(0^-) - \frac{dv(0^-)}{dt} \cdot s^0\color{black} = \color{purple}s \cdot U(s)
    \end{aligned}
  \] 
  Raccogliendo si ha:
  \[
    \begin{aligned}
      \underbrace{\left( s^3 + s^2 \right)}_{d(s)} V(s) - \underbrace{\left[ s^2 v(0^-) + \frac{dv(0^-)}{dt}s + \frac{d^2v(0^-)}{dt^2} +
      sv(0^-) + \frac{dv(0^-)}{dt} \right]}_{p(s)}\\ = \underbrace{s}_{n(s)} \cdot U(s)
    \end{aligned}
  \] 
  Quindi:
  \[
    \begin{aligned}
      V(s) &= \frac{n(s)}{d(s)} \cdot U(s) + \frac{p(s)}{d(s)}\\
           &= \frac{s}{(s^3+s^2)} \cdot U(s) + \frac{s^2 v(0^-) + \frac{dv(0^-)}{dt}s + \frac{d^2v(0^-)}{dt^2} +
           sv(0^-) + \frac{dv(0^-)}{dt}}{s^3+s}\\
    \end{aligned}
  \] 
  Considerando le seguenti condizioni iniziali
  \[
    v(0^-) = 0; \quad \frac{dv(0^-)}{dt} = \frac{d^2v(0^-)}{dt^2} = 0
  \] 
  allora si ha:
  \[
    V(s) = \frac{s}{s^3 + s^2} \cdot U(s)
  \] 

  \vspace{1em}
  \noindent
  Considerando le seguenti condizioni iniziali
  \[
    v(0^-) = 1; \quad \frac{dv(0^-)}{dt} = \frac{d^2v(0^-)}{dt^2} = 0
  \] 
  allora si ha:
  \[
    V(s) = \frac{s}{s^3 + s} \cdot U(s) + \frac{s^2 + s}{s^3 + s^2}
  \] 
\end{example}


\subsubsection{Stabilità di sistemi LTI causali}
Considerando la funzione di trasferimento \( H(s) \), cioè il rapporto tra i polinomi
caratteristici dell'ingresso e dell'uscita, si ha che
il grado del numeratore è generalmente minore o uguale a quello del denominatore.
\[
  H(s) = \frac{\sum_{j=0}^{m} b_j s^{j}}{\sum_{i=0}^{n} a_i s^{i}}
\] 
Fattorizzando si ottiene:
\[
  \begin{aligned}
    H(s) = \frac{b_m \overbrace{\left( s - \beta_1 \right)^{\xi_1}}^{\text{Radici del numeratore}} \cdot \left( s - \beta_2 \right)^{\xi_2} \cdot \ldots \cdot \left( s - \beta_q \right)^{\xi_q}}
    {a_n \underbrace{\left( s - \alpha_1 \right)^{ \mu_1 }}_{\text{Radici del denominatore}} \cdot \left( s - \alpha_2 \right)^{ \mu_2 } \cdot \ldots \cdot \left( s - \alpha_r \right)^{ \mu_r }}
  \end{aligned}
\] 
Dove:
\[
  \begin{aligned}
    \xi_i &= \text{molteplicità delle soluzioni del numeratore}\\
    \mu_i &= \text{molteplicità delle soluzioni del denominatore}
  \end{aligned}
\] 
\[
  q \le m; \quad \sum \xi_i = m; \qquad r \le n; \quad \sum \mu_i = n
\] 
\[
  H(s) = k \frac{\left( s - z_1\right) \cdot \left( s - z_2 \right) \cdot \ldots \cdot \left( s - z_m \right)}
  {\left( s - p_1 \right) \cdot \left( s - p_2 \right) \cdot \ldots \cdot \left( s - p_n \right)}
\] 
Dove:
\[
  \begin{aligned}
    (s-z_i) &= \text{Zeri della funzione razionale (radici numeratore)}\\
    (s-p_i) &= \text{Poli della funzione razionale (radici denominatore)}
  \end{aligned}
\]
Definiamo uno \textbf{zero} di una funzione razionale \( H(s) \) un qualsiasi
numero \( \beta \in \mathbb{C} \) tale che \( H(\beta) = 0\).

Definiamo un \textbf{polo} di una funzione razionale \( H(s) \) un qualsiasi
numero \( \alpha \in \mathbb{C} \) tale che \( H(\alpha) = \infty \).

\vspace{1em}
\noindent
\begin{definition}
  Dato \( H(s) \) in forma ridotta (senza radici comuni), siano \( \lambda_i, \ldots,
  \lambda_r\) con \( r \le n \) i suoi poli dopo la semplificazione. Se:
  \[
    \Re(\lambda_i) < 0 \quad \forall i = 1, \ldots, r
  \] 
  allora il sistema è \textbf{BIBO stabile}.

  \vspace{1em}
  \noindent
  Il sistema è BIBO stabile se tutti i suoi poli stanno nel semipiano complesso negativo.
\end{definition}

\noindent
Per BIBO stabilizzare un sistema bisogna togliere gli zeri \( \lambda_i \) con 
\( \Re(\lambda_i) > 0 \), semplificandoli dividendo per lo stesso valore.

\begin{example}
  Studiamo la stabilità del seguente sistema:
  \[
  v'(t) - 3 v(t) = u''(t) - 5u'(t) + 4u(t)
  \] 
  In questo caso abbiamo che \( n < m \). Calcoliamo il polinomio caratteristico:
  \[
  s - 3 = s^2 - 5s + 4
  \] 
  Abbiamo che:
  \[
    \begin{aligned}
      H(s) &= \frac{n(s)}{d(s)}
            = \frac{\text{{Polinomio caratteristico dell'ingresso}}}
                   {\text{{Polinomio caratteristico dell'uscita}}}\\
           &= \frac{s^2 - 5s + 4}{s-3}\\
           &= \frac{(s-1)(s-4)}{s-3}
    \end{aligned}
  \] 
  La soluzione è \( \lambda_1 = 3 \), quindi il sistema non è asintoticamente stabile,
  di conseguenza è instabile.

  \vspace{1em}
  \noindent
  Per verificare se il sistema è BIBO stabile bisogna vedere se si possono semplificare
  gli zeri. In questo caso tutte le radici del denominatore (i poli) hanno parte reale
  maggiore di 0, quindi il sistema non è BIBO stabile.
\end{example}

\begin{example}
  Studiamo la stabilità del seguente sistema:
  \[
  v''(t) + 3v'(t) + 2v(t) = u''(t) - 4u'(t) + 3u(t)
  \] 
  Calcoliamo la funzione di trasferimento \( H(s) \):
  \[
    \begin{aligned}
      H(S) &= \frac{s^2 -4s +3}{s^2 +3s + 2}\\
           &= \frac{(s-3)(s-1)}{(s+2)(s+1)}
    \end{aligned}
  \] 
  Le soluzioni sono:
  \[
  \begin{aligned}
    \lambda_1 &= -2\\
    \lambda_2 &= -1
  \end{aligned}
  \] 
  \( \Re(\lambda_i) < 0 \) quindi il sistema è asintoticamente stabile, di conseguenza
  anche BIBO stabile.
\end{example}

\begin{example}
  Studiamo la stabilità del seguente sistema:
  \[
    v'''(t) + 7v''(t) - 2v'(t) + 6v(t) = u''(t) + 3u'(t) - 4u(t)
  \] 
  Calcoliamo la funzione di trasferimento \( H(s) \):
  \[
  \begin{aligned}
    H(s) &= \frac{s^2 + 3s - 4}{s^3 + 7s^2 - 2s + 6}\\
         &= \frac{(s-4)(s-1)}{(s+3)(s+2)(s-1)}
  \end{aligned}
  \] 
  Le soluzioni sono:
  \[
  \begin{aligned}
    \lambda_1 &= -3\\
    \lambda_2 &= -2\\
    \lambda_3 &= 1
  \end{aligned}
  \]
  Siccome \( \Re(\lambda_3) > 0 \) il sistema non è asintoticamente stabile.

  \vspace{1em}
  \noindent
  Controlliamo se il sistema è BIBO stabile:
  \[
    \frac{(s-4)\cancel{(s-1)}}{(s+3)(s+2)\cancel{(s-1)}}
  \] 
  Il polo con parte reale minore di 0 si semplifica, quindi il sistema è BIBO stabile,
  perchè tutti i poli hanno parte reale minore di 0.
\end{example}

\subsection{Antitrasformata di Laplace unilatera}
Prendendo in considerazione la trasformata di Laplace del sistema:
\[
  V(s) = \frac{n(s)}{d(s)} \cdot V(s) + \frac{p(s)}{d(s)}
\] 
si vuole trovare l'antitrasformata, quindi si applicano le seguenti regole considerando
soltanto ciò di cui si vuole trovare l'antitrasformata:
\begin{itemize}
  \item Risposta forzata:
    \[
    \frac{n(s)}{d(s)} \cdot U(s)
    \] 

  \item Risposta libera:
    \[
    \frac{p(s)}{d(s)}
    \]

  \item Risposta impulsiva:
    \[
    \frac{n(s)}{d(s)}
    \]

  \item Risposta totale:
    \[
    \frac{n(s)}{d(s)} \cdot U(s) + \frac{p(s)}{d(s)}
    \]
\end{itemize}
Di conseguenza consideriamo:
\[
V(s) = \frac{n(s)}{d(s)}
\] 
\begin{itemize}
  \item Se \( deg\left[ n(s) \right] \ge deg\left[ d(s) \right] \) (sistema proprio)
    bisogna fare la divisione polinomiale e arrivare alla divisione in fratti semplici
    e infine applicare l'antitrasformata di Laplace.
    \begin{itemize}
      \item \textbf{Divisione polinomiale}:

        \vspace{1em}
        \noindent
        \[
          V(s) = \frac{r(s)}{d(s)} + k \quad \text{con} \quad deg\left[ r(s) \right] < deg\left[ d(s) \right]
        \] 
        Si ha che \( k \) è la trasformata di Laplace dell'impulso:
        \[
          \mathcal{L}\left[ k \cdot \delta_0(t) \right](s) = k
        \] 
        e quindi la sua anti-trasformata è:
        \[
          \mathcal{L}\left[ k \cdot \delta_0(t) \right](s) = k \to \mathcal{L}^{-1}
          \to k \cdot \delta_0(t)
        \] 

        \begin{example}
          Considerando la seguente risposta:
          \[
            V(s) = \frac{2s^2 + 4s - 3}{s^2 -s -1}
          \] 
          si ha che \( m = 2 \) e \( n = 2 \), quindi siamo nel caso:
          \[
            deg\left[ n(s) \right] \ge  deg\left[ d(s) \right]
          \] 
          quindi bisogna fare la divisione polinomiale:
          \[
            \begin{aligned}
              V(s) &= \frac{2s^2 + 4s - 3}{s^2 -s -1}\\
                   &= \frac{6s-1}{s^2-s-1} + 2
            \end{aligned}
          \]
          Ora bisogna trasformare in fratti semplici.
        \end{example}
    \end{itemize}

  \item Se \( deg\left[ n(s) \right] < deg\left[ d(s) \right] \) (sistema strattamente proprio)
    si può saltare la divisione polinomiale e applicare direttamente l'antitrasformata.
\end{itemize}

\noindent
\textbf{Decomposizione in fratti semplici}:
\[
  \frac{r(s)}{d(s)} = \sum_{i=1}^{m} \sum_{l=0}^{\mu_i-1} \frac{c_{i,l}}{(s-\alpha_i)^{l+1}}
\] 
Per trovare i valori di \( c_{i,l} \) si usa la formula:
\[
\begin{aligned}
  c_{i,l} = \lim_{s \to \alpha_i} \frac{d^{\mu_i-l-1}}
  {d  s^{\mu_i-l-1}} \cdot 
\left( \left( s-\alpha_i \right)^{\mu_i} \frac{r(s)}{d(s)} \right)
\end{aligned}
\] 

\begin{example}
  Si vuole scomporre la seguente trasformata di Laplace in fratti semplici:
  \[
  V(s) = \frac{3s^2-1}{(s+1)^2(s-2)(s+5)}
  \] 

  \vspace{1em}
  \noindent
  Quindi si ha che:
  \[
    V(s) = \frac{A}{(s-2)} + \frac{B}{(s+1)} + \frac{C}{(s+1)^2} + \frac{D}{(s+5)}
  \] 
  dove \( A, B, C, D \) sono le costanti \( c_{i,l} \) e i denominatori sono le radici
  \( (s-\alpha_i) \) del polinomio \( d(s) \). Poi si calcolano i valori di \( A, B, C, D \)
  e si ottiene la decomposizione in fratti semplici.
\end{example}

\begin{example}
  Si vuole scomporre in fratti semplici:
  \[
  V(s) = \frac{s-20}{(s+4)(s-2)}
  \] 
  Abbiamo che:
  \[
  \begin{aligned}
    \alpha_1 &= -4 \quad \mu_1 = 1\\
    \alpha_2 &= 2 \quad \mu_2 = 1
  \end{aligned}
  \] 
  Quindi si ha che:
  \[
    V(s) = \frac{c_{1,0}}{s+4} + \frac{c_{2,0}}{s-2} = \frac{A}{s+4} + \frac{B}{s-2}
  \] 
  Per trovare \( A \) e \( B \) si può fare in due modi:
  \begin{enumerate}
    \item Fare il denominatore comune e sommare i numeratori
      \[
      \begin{aligned}
        \frac{A}{s+4} + \frac{B}{s-2} &= \frac{A(s-2)+B(s+4)}{(s+4)(s-2)}\\
                                      &= \frac{As-2A+Bs+4B}{(s+4)(s-2)}\\
      \end{aligned}
      \] 
      \[
      \begin{cases}
        (A+B)s = 1s\\
        -2A+4B = -20
      \end{cases}
      \to 
      \begin{cases}
        A+B = 1\\
        4B-2A = -20
      \end{cases}
      \to 
      \begin{cases}
        A = 4\\
        B = -3
      \end{cases}
      \] 
      Quindi:
      \[
        \frac{s-20}{(s+4)(s-2)} = \frac{4}{s+4} - \frac{3}{s-2}
      \] 

    \item Si può usare la formula:
      \[
        c_{i,l} = \lim_{s \to \alpha_i} \frac{d^{\mu_i-l-1} \left( \left( s-\alpha_i \right)^{\mu_i} \frac{r(s)}{d(s)} \right)}
        {d  s^{\mu_i-l-1}}
      \] 
      Abbiamo che:
      \[
      \begin{aligned}
        \mu_1 &= 1\\
        \alpha_1 &= -4
      \end{aligned}
      \] 
      \[
        \begin{aligned}
          c_{1,0} = A &= \lim_{s \to -4} \frac{d^{1-0-1} \left( \cancel{(s+4)} \frac{s-20}{\cancel{(s+4)}(s-2)} \right)}
          {d s^{1-0-1}}
                      &= \frac{-24}{-6} = 4\\
        \end{aligned}
      \] 
      e
      \[
      \begin{aligned}
        \mu_2 &= 1\\
        \alpha_2 &= 2
      \end{aligned}
      \] 
      \[
        \begin{aligned}
          c_{2,0} = B &= \lim_{s \to 2} \frac{d^{1-0-1} \left( \cancel{(s-2)} \frac{s-20}{(s+4)\cancel{(s-2)}} \right)}
          {d s^{1-0-1}}
                      &= \frac{-18}{6} = -3\\
        \end{aligned}
      \]
      Alla fine si ottiene:
      \[
        \frac{s-20}{(s+4)(s-2)} = \frac{4}{s+4} - \frac{3}{s-2}
      \] 
  \end{enumerate}
\end{example}

\vspace{1em}
\noindent
\textbf{Antitrasformata di Laplace}:

\noindent
Dopo aver applicato tutti i passaggi precedenti si arriva ad avere:
\[
  V(s) = k + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} \frac{c_{i,l}}{(s-\lambda)^{l+1}}
\] 
da questa forma si può antitrasformare:
\[
  \begin{aligned}
    v(t) &= \mathcal{L}^{-1}[k](t) + \left[\sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} c_{i,l} \cdot
              \mathcal{L}^{-1}\left[ \frac{1}{(s-\lambda_i)^{l+1}} \right](t)\right]\\
         &= k \cdot \delta_0(t) + \left[\sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} c_{i,l} \cdot \frac{t^l}{l!} \cdot e^{\lambda t} \cdot \delta_{-1}(t)\right]
  \end{aligned}
\] 

\begin{example}
  Consideriamo il seguente sistema:
  \[
  v''(t) - v'(t) -2v(t) = u''(t) + 2u'(t) + u(t)
  \] 
  con condizioni iniziali:
  \[
  \begin{cases}
    v(0^-) = 0\\
    v'(0^-) = -1
  \end{cases}
  \] 
  \[
    u(t) = e^{-3t} \cdot \delta_{-1}(t)
  \] 
  Si vuole calcolare:
  \begin{enumerate}
    \item Stabilità
    \item Risposta libera
      \begin{enumerate}
        \item Nel tempo
        \item Nelle frequenze
      \end{enumerate}
    \item Risposta impulsiva
    \item Risposta forzata
    \item Risposta totale
  \end{enumerate}

  \vspace{1em}
  \noindent
  \begin{enumerate}
    \item Stabilità:

      \vspace{1em}
      \noindent
      Scriviamo l'equazione caratteristica:
      \[
      s^2-s-2 = 0
      \] 
      Troviamo le soluzioni:
      \[
        \lambda_{1,2} = \frac{-b \pm \sqrt{b^2-4ac}}{2a} = \frac{1 \pm \sqrt{1+8}}{2} = \frac{1 \pm 3}{2}
      \] 
      \[
      \begin{aligned}
        \lambda_1 = -1 \quad \mu_1 = 1\\
        \lambda_2 = 2 \quad \mu_2 = 1
      \end{aligned}
      \] 
      Il sistema non è asintoticamente stabile perchè \( \lambda_1 > 0 \).
      Per calcolare la BIBO stabilità bisogna calcolare la funzione di trasferimento e
      vedere se i suoi poli hanno tutti parte reale minore di 0:
      \[
        V(s) = \underbrace{\frac{p(s)}{d(s)}}_{V_l(s)} + 
        \underbrace{\underbrace{\frac{h(s)}{d(s)}}_{H(s)} \cdot U(s)}_{V_f(s)}
      \] 
      \[
        \begin{aligned}
          H(s) &= \frac{s^2+2s+1}{s^2-s-2} = \frac{(s+1)^{\cancel{2}}}{(s-2)\cancel{(s+1)}}\\
               &= \frac{s+1}{s-2}
        \end{aligned}
      \] 
      Non è BIBO stabile perchè \( \lambda_1 = 2 \).

    \item Risposta libera:
      \begin{enumerate}
        \item Nel tempo:
          \[
          s^2-s-2 = 0 \to (s-2)(s+1) = 0
          \] 
          \[
            \begin{aligned}
              r &= 2\\
              \lambda_1 = 2 \quad \mu_1 = 1\\
              \lambda_2 = -1 \quad \mu_2 = 1
            \end{aligned}
          \] 
          Utilizziamo l'equazione per la risposta libera nel tempo:
          \[
            \begin{aligned}
              v_l(t) &= \sum_{i=1}^{r} \sum_{l=0}^{\mu_i-1} c_{i,l} \cdot \frac{t^l}{l!} \cdot e^{\lambda_i t}
                     &= c_1 \cdot e^{2t} + c_2 \cdot e^{-t}
            \end{aligned}
          \] 
          Calcoliamo le derivate:
          \[
          \begin{aligned}
            v_l(t) &= c_1 \cdot e^{2t} + c_2 \cdot e^{-t}\\
            v'_l(t) &= 2c_1 \cdot e^{2t} - c_2 \cdot e^{-t}\\
          \end{aligned}
          \] 
          li mettiamo a sistema con le condizioni iniziali:
          \[
            \begin{cases}
              v_l(0) &= c_1 \cdot \cancel{e^{2t}} + c_2 \cdot \cancel{e^{-t}}\\
              v'_l(0) &= 2c_1 \cdot \cancel{e^{2t}} - c_2 \cdot \cancel{e^{-t}}\\
            \end{cases}
          \] 
          \[
            \begin{cases}
              c_1 = 0\\
              c_2 = 1
            \end{cases}
          \]
          Quindi:
          \[
            v_l(t) = e^{-t}
          \]

        \item Nelle frequenze:
          
          \vspace{1em}
          \noindent
          Calcoliamo la trasformata di Laplace dell'ingresso e dell'uscita:
          \[
            \begin{aligned}
              \mathcal{L}\left[ v''(t) - v'(t) -2v(t) \right](s) &= \mathcal{L}\left[ u''(t) + 2u'(t) + u(t) \right](s)\\
            \end{aligned}
          \]
          \[
          \begin{aligned}
            \mathcal{L}\left[ v''(t) \right](s) &= s^2 V(s) - s \cdot \stackrel{1}{\cancel{v(0^-)}}
            - \stackrel{1}{\cancel{s^0}} \stackrel{-1}{\cancel{\frac{dv(0^-)}{dt}}}\\
                                                &= s^2 V(s) - s + 1
          \end{aligned}
          \] 
          \[
          \begin{aligned}
            \mathcal{L}\left[ v'(t) \right](s) &= s V(s) - \stackrel{1}{s^0} \stackrel{1}{\cancel{v(0^-)}}\\
                                                &= s V(s) - 1
          \end{aligned}
          \] 
          \[
          \begin{aligned}
            \mathcal{L}\left[ v(t) \right](s) &= V(s)\\
          \end{aligned}
          \] 
          Quindi l'uscita sarà:
          \[
            s^2 V(s) - s + 1 - s V(s) + 1 - 2V(s)
          \] 

          \vspace{1em}
          \noindent
          L'entrata diventa:
          \[
            \begin{aligned}
              \mathcal{L}\left[ u''(t) \right](s) &= s^2 U(s) - \stackrel{0}{\cancel{s^1 u(0^-)}}
              - \stackrel{0}{\cancel{s^0 \frac{du(0^-)}{dt}}}
            \end{aligned}
          \] 
          \[
            \begin{aligned}
              \mathcal{L}\left[ u'(t) \right](s) &= s U(s) - \stackrel{0}{s^0 \cancel{u(0^-)}}
            \end{aligned}
          \] 
          \[
            \begin{aligned}
              \mathcal{L}\left[ u(t) \right](s) &= U(s)
            \end{aligned}
          \]
          Quindi l'ingresso sarà:
          \[
            s^2 U(s) + 2s U(s) + U(s)
          \]

          \vspace{1em}
          \noindent
          Tutto il sistema diventa:
          \[
          s^2 V(s) - s + 1 - s V(s) + 1 - 2V(s) = s^2 U(s) + 2s U(s) + U(s)
          \] 

          Raccogliamo per \( V(s) \) e \( U(s) \):
          \[
            \underbrace{\left( s^2 - s - 2 \right)}_{\text{Pol. Car. uscita}} V(s) - s + 2 
            = \underbrace{\left( s^2+2s+1 \right)}_{\text{Pol. Car. ingresso}} U(s)
          \] 
          \[
            V(s) = \frac{\cancel{s-2}}{\cancel{(s-2)}(s+1)} + \frac{(s+1)^{\cancel{2}}}{(s-2)\cancel{(s+1)}} \cdot U(s)
          \] 
          La trasformata di Laplace di \( u(t) \) è:
          \[
            u(t) = e^{-3t} \cdot \delta_{-1}(t)
          \] 
          \[
          \downarrow \mathcal{L}
          \] 
          \[
            \mathcal{L}^{-1}\left[ A \cdot e^{\lambda t} \cdot \delta_{-1}(t) \right](t) = \frac{A}{(s-\lambda)}
          \] 
          \[
            U(s) = \frac{1}{s+3}
          \] 
          Quindi si ha:
          \[
            \underbrace{V(s)}_{V_t(s)} = \underbrace{\frac{1}{s+1}}_{V_l(s)} +
            \underbrace{\underbrace{\frac{s+1}{s-2}}_{H(S)} \cdot \frac{1}{s+3}}_{V_f(s)}
          \] 

          \vspace{1em}
          \noindent
          La risposta libera in frequenza è:
          \[
            V_l(s) = \frac{1}{s+1}
          \]
          Il numeratore ha grado minore del denominatore, quindi si può antitrasformare
          passando subito a fare la decomposizione in fratti semplici. Siccome abbiamo
          una sola radice al denominatore si ha già la forma minima.

          Passiamo a fare l'antitrasformata di Laplace:
          \[
            \mathcal{L}^{-1}\left[ \frac{A}{s-\lambda} \right](t) = A \cdot e^{\lambda t} \cdot \delta_{-1}(t)
          \] 
          \[
            V_l(s) = \frac{1}{s+1} \stackrel{\mathcal{L}^{-1}}{\to} e^{-t} \cdot \delta_{-1}(t)
          \] 
      \end{enumerate}

    \item Risposta impulsiva:
      \[
      H(s) = \frac{s+1}{s-2}
      \] 
      Facciamo divisione polinomiale:
      \[
      \begin{aligned}
        H(s) &= \frac{s+1}{s-2}\\
             &= 1 + \frac{3}{s-2}
      \end{aligned}
      \] 
      Possiamo calcolare l'antitrasformata di laplace di ogni singolo termine, ottenendo
      così la risposta impulsiva nel tempo:
      \[
        H(s) = 1 + \frac{3}{s-2}
      \] 
      \[
        \downarrow \mathcal{L}^{-1}
      \] 
      \[
        h(t) = \delta_0(t) + 3 \cdot e^{2t} \cdot \delta_{-1}(t)
      \]


    \item Risposta forzata:
      \[
        V_f(s) = \frac{s+1}{(s-2)(s+3)}
      \] 
      Scomponiamo in fratti semplici:
      \[
        V_f(s) = \frac{A}{s-2} + \frac{B}{s+3}
      \]
      \begin{enumerate}
        \item Il primo metodo è quello di fare il denominatore comune:
          \[
            \begin{aligned}
              \frac{A}{s-2} + \frac{B}{s+3} &= \frac{As+3A+Bs-2B}{(s-2)(s+3)}\\
                                            &= \frac{(A+B)s + (3A-2B)}{(s-2)(s+3)}
            \end{aligned}
          \] 
          Mettiamo a sistema:
          \[
          \begin{cases}
            (A+B)s = 1s\\
            3A-2B = 1
          \end{cases}
          \to 
          \begin{cases}
            A+B = 1\\
            3A-2B = 1
          \end{cases}
          \to
          \begin{cases}
            A = 1-B\\
            3-3B-2B = 1
          \end{cases}
          \]\[
          \to
          \begin{cases}
            A = 1-B\\
            -5B = -2
          \end{cases}
          \to 
          \begin{cases}
            A = \frac{3}{5}\\
            B = \frac{2}{5}
          \end{cases}
          \] 
          Si ha quindi:
          \[
            \frac{3}{5} \cdot \frac{1}{s-2} + \frac{2}{5} \cdot \frac{1}{s+3}
          \] 
          \[
            \downarrow \mathcal{L}^{-1} \quad \mathcal{L}\left[ \frac{A}{s-\lambda} \right](t) = A \cdot e^{\lambda t} \cdot \delta_{-1}(t)
          \] 
          \[
            \left( \frac{3}{5} \cdot e^{2t} + \frac{2}{5} \cdot e^{-3t} \right) \cdot \delta_{-1}(t)
          \] 

        \item Il secondo metodo è quello di usare la formula:
          \[
            c_i = \lim_{s \to \lambda_i} \left( \frac{d^{\mu_i-l-1} \cdot \frac{r(s)}{d(s)}}{d s^{\mu_i-l-1}} \cdot (s-\lambda) \right)  
          \] 
          \[
            A = \lim_{s \to 2} \frac{d^{1-0-1}}{ds^{1-0-1}} \cdot \frac{s+1}{(s-2)(s+3)} \cdot (s-2) = \frac{3}{5}
          \] 
          \[
            B = \lim_{s \to -3} \frac{d^{1-0-1}}{ds^{1-0-1}} \cdot \frac{s+1}{(s-2)(s+3)} \cdot (s+3) = \frac{2}{5}
          \] 
      \end{enumerate}

    \item Risposta totale:
      \[
        \begin{aligned}
          v_t &= \mathcal{L}^{-1}\left[V_l(s)\right](t) + \mathcal{L}^{-1}\left[V_f(s)\right](t)\\
              &= e^{-t} \cdot \delta_{-1}(t) + \left( \frac{3}{5} \cdot e^{2t} + \frac{2}{5} \cdot e^{-3t} \right) \cdot \delta_{-1}(t)\\
              &= \left( e^{-t} + \frac{3}{5} \cdot e^{2t} + \frac{2}{5} \cdot e^{-3t} \right) \delta_{-1}(t) 
        \end{aligned}
      \] 
  \end{enumerate}
\end{example}

\section{Sistemi a blocchi}
Un sistema è rappresentato da un blocco con un input e un output:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {\( \Sigma \) };
    \draw[->] (-1,0) -- (A) node[midway,above left] {$\stackrel{u(t)}{\text{Ingresso}}$};
    \draw[->] (A) -- (1,0) node[midway,above right] {$\stackrel{v(t)}{\text{Uscita}}$};
  \end{tikzpicture}
  \caption{Rappresentazione di un sistema}
\end{figure}

\noindent
I sistemi hanno sempre un input e un output perchè consideriamo solo sistemi SISO
(Single Input Single Output).

\subsection{Tipi di sistemi}
I sistemi possono essere messi insieme e questo viene fatto in più modi:
\subsubsection{Sistema in serie}
In un sistema in serie si mettono i sistemi uno dietro l'altro:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum width=1cm,minimum height=1cm] (A) at (0,0) {\( \Sigma_1 \) };
    \node[draw,minimum width=1cm,minimum height=1cm, right= of A] (B) {\( \Sigma_2 \) };
    \draw[->] (-1,0) -- (A) node[midway,above left] {\( x_1 \) };
    \draw[->] (A) -- (B)node[midway, above left] {\( y_1 \) } node[midway, above right] {\( x_2 \) };
    \draw[->] (B) -- (3,0) node[midway,above right] {\( y_2 \) };
  \end{tikzpicture}
  \caption{Sistema in serie}
\end{figure}
\[
  y_1 = x_2
\] 

\subsubsection{Sistema in parallelo}
In un sistema in parallelo si mettono i sistemi uno accanto all'altro:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node (x) at (0,0) {\( x \)};
    \node[draw,minimum size=1cm,above right=0.1cm and 1.5cm of x] (A) {\( \Sigma_1 \) };
    \node[draw,minimum size=1cm,below right=0.1cm and 1.5cm of x] (B) {\( \Sigma_2 \) };

    \draw[->] (x) -- ++(0.5,0) |- (A.west) node[above left] {\( x_1 \)};
    \draw[->] (x) -- ++(0.5,0) |- (B.west) node[above left] {\( x_2 \)};

    \node[draw,circle,minimum size=0.7cm,below right=-0.05cm and 1.0cm of A]
      (C) {+};
    \node[right=of C] (y) {\( y \)};

    \node[above right=0.2cm and 0.2cm of C] (sum) {Nodo sommatore};

    \draw[<-] (C) -- (sum);
      

    \draw[->] (A.east) node[above right] {\( y_1 \) } -| (C.north);
    \draw[->] (B.east) node[above right] {\( y_2 \) } -| (C.south);

    \draw[->] (C.east) -- (y);
  \end{tikzpicture}
  \caption{Sistema in parallelo}
\end{figure}
\[
  x = x_1 = x_2
\]
\[
  y = y_1 + y_2
\] 

\subsubsection{Sistema di retroazione}
In un sistema di retroazione l'output di un sistema è l'input di un altro:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node (x) at (0,0) {\( x \)};

    \node[draw,circle,minimum size=0.7cm,right=1cm of x] (sum) {+};
    \node[draw,minimum size=1cm,right=1.5cm of sum] (A) {\( \Sigma_1 \) };
    \node[draw,minimum size=1cm,below=of A] (B) {\( \Sigma_2 \) };

    \coordinate[right=1cm of A] (n);
    \fill (n) circle (0.05cm) node[above,scale=0.8] {Nodo};

    \draw[->] (x) -- (sum);
    \draw[->] (sum) -- (A.west) node[above left] {\( x_1 \)};
    \draw[<-] (sum) |- (B.west) node[above left] {\( y_2 \)};

    \draw[->] (A.east) node[above right] {\( x_2 \) } -- (n) |- (B.east) node[above right] {\( y_1 \)};
    \draw[->] (n) -- ++(0.5,0) node[above] {\( y \) };
  \end{tikzpicture}
  \caption{Sistema di retroazione}
\end{figure}
\[
  x_1 = x + y_2
\] 
\[
  y = y_1 = x_2
\] 

\subsubsection{Nodi sommatori}
I nodi sommatori hanno un numero indefinito di ingressi e una sola uscita:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,circle,minimum size=0.7cm] (sum) {};

    \draw[<-] (sum.west) node[above left,scale=0.8] {+} -- ++(-1,0) node[above] {\( x \)};
    \draw[<-] (sum.south) node[below right,scale=0.8] {+} -- ++(0,-1) node[right] {\( y \)};
    \draw[->] (sum.east) -- ++(1,0) node[above right] {\( z=+x+y \)};
  \end{tikzpicture}
  \begin{tikzpicture}
    \node[draw,circle,minimum size=0.7cm] (sum) {};

    \draw[<-] (sum.west) node[above left,scale=0.8] {+} -- ++(-1,0) node[above] {\( x \)};
    \draw[<-] (sum.south) node[below right,scale=0.8] {$-$} -- ++(0,-1) node[right] {\( y \)};
    \draw[->] (sum.east) -- ++(1,0) node[above right] {\( z=+x-y \)};
  \end{tikzpicture}
  \caption{Nodi sommatori con segno diverso}
\end{figure}
\noindent
(solitamente viene rappresentato con una X in un cerchio, ma quel simbolo lo useremo
per rappresentare il prodotto).

\subsection{Controlli}
Un controllo è un sistema a tempo continuo con un ingresso e un'uscita e può essere di 
due tipi:
\begin{itemize}
  \item \textbf{Controllo ad anello aperto}: l'uscita non torna nell'ingresso
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \node[draw,minimum size=1cm] (A) at (0,0) {\( \Sigma \) };

        \draw[<-] (A) -- ++(-1.5,0) node[above] {\( x \)};
        \draw[->] (A) -- ++(1.5,0) node[above] {\( y \)};
      \end{tikzpicture}
      \caption{Controllo ad anello aperto}
    \end{figure}

  \item \textbf{Controllo ad anello chiuso}: l'uscita torna nell'ingresso
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \node (x) at (0,0) {\( x \)};

        \node[draw,circle,minimum size=0.7cm,right=1cm of x] (sum) {+};
        \node[draw,minimum size=1cm,right=1.5cm of sum] (A) {\( \Sigma_1 \) };
        \node[draw,minimum size=1cm,below=of A] (B) {\( \Sigma_2 \) };

        \coordinate[right=1cm of A] (n);
        \fill (n) circle (0.05cm);

        \draw[->] (x) -- (sum);
        \draw[->] (sum) -- (A.west) node[above left] {\( x_1 \)};
        \draw[<-] (sum) |- (B.west) node[above left] {\( y_2 \)};

        \draw[->] (A.east) node[above right] {\( x_2 \) } -- (n) |- (B.east) node[above right] {\( y_1 \)};
        \draw[->] (n) -- ++(0.5,0) node[above] {\( y \) };

        \node[below=0cm of B,align=center] (h) {Funzioni di\\trasferimento dei\\sistemi};
      \end{tikzpicture}
      \caption{Controllo ad anello chiuso}
    \end{figure}
    \noindent
    (un esempio è il termostato)
\end{itemize}

\begin{example}
  Prendiamo ad esempio la seguente equazione:
  \[
    \frac{dy(t)}{dt} + ay(t) = bx(t)
  \] 
  \[
    y(t) = -\frac{1}{a} \frac{dy(t)}{dt} + \frac{b}{a} x(t)
  \] 
  Il diagramma a blocchi è:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[draw,minimum size=1cm] (A) at (0,0) {\( \frac{b}{a} \) };
      \node[draw,circle,minimum size=0.7cm,right=1cm of A] (sum) {+};
      \coordinate[right=1cm of sum] (n1);
      \coordinate[right=2cm of n1] (n2);
      \coordinate[right=1cm of n2] (n3);

      \fill (n3) circle (0.05cm);

      \node[draw,minimum size=1cm,below=of n1] (B) {\( -\frac{1}{a} \) };
      \node[draw,minimum size=1cm,below=of n2] (C) {\( \frac{d}{dt} \) };

      \draw[<-] (A.west) -- ++(-1.5,0) node[above] {\( x(t) \)};
      \draw[->] (A.east) -- (sum) -- (n3) -- ++(1,0) node[above] {\( y(t) \)};
      \draw[<-] (sum.south) |- (B.west);
      \draw (B) -- (C);
      \draw[->] (n3) |- (C);
    \end{tikzpicture}
  \end{figure}
\end{example}

\subsubsection{Nomenclatura}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,circle,minimum size=0.7cm] (sum) {};
    \node[draw,minimum size=1cm,align=center,right=1.5cm of sum] (ff) {Segnale\\feed forward};
    \node[draw,minimum size=1cm,align=center,right=1.5cm of ff] (proc) {Processo};
    \node[draw,minimum size=1cm,align=center,below right=1cm and 0cm of ff] (feedback) {Elemento\\
      di feedback};
    \coordinate[right=of proc] (n) {};

    \fill (n) circle (0.05cm);

    \draw[<-] (sum.west) node[above left,scale=0.8] {+} -- ++(-1,0) node[above] {\( r \)}
      node[below,align=center,scale=0.8] {Segnale di\\riferimento};
    \draw[->] (sum.east) -- (ff.west) node[midway,above] {\( e \)}
      node[midway,below,align=center,scale=0.8] {\( e=r\pm b \)\\Segnale di\\attenuazione};
    \draw[->] (ff.east) -- (proc.west) node[midway,above] {\( u \)}
      node[midway,below,align=center,scale=0.8] {Segnale di\\controllo};
    \draw[<-] (proc.north) -- ++(0,1) node[left] {\( h \)}
      node[right,align=center,scale=0.8] {Disturbo};
    \draw (proc) -- (n);
    \draw[->] (n) |- (feedback.east);
    \draw[->] (feedback.west) node[above left] {\( b \) }
      node[below left,align=center,scale=0.8] {Segnale di\\feedback}
      -| (sum.south) node[below right,scale=0.8] {\( \pm \) };
    \draw[->] (n) -- ++(1,0) node[above] {\( c \)}
      node[below,align=center,scale=0.8] {Output\\controllo};
  \end{tikzpicture}
  \caption{Nomenclatura di un sistema di controllo}
\end{figure}

Il segnale di attuazione viene chiamato:
\begin{itemize}
  \item \textbf{Feedback negativo}: Quando:
    \[
    e = r-b
    \] 
  \item \textbf{Feedback positivo}: Quando:
    \[
    e = r+b
    \] 
\end{itemize}

\subsection{Controllori}
I controllori sono di 3 tipi e vanno a definire le regole di controllo:
\begin{itemize}
  \item \textbf{Proporzionale} (P): L'output è proporzionale all'errore
    \[
      u(t) = K_P \cdot e
    \]

  \item \textbf{Derivativo} (D): L'output è proporzionale alla derivata dell'errore
    \[
      u(t) = K_D \cdot \frac{de}{dt}
    \]

  \item \textbf{Integrativo} (I): L'output è proporzionale all'integrale dell'errore
    \[
      u(t) = K_I \cdot \int e \, dt
    \]
\end{itemize}
I tre controllori possono essere combinati e si rappresentano con la concatenazione
delle lettere:
\begin{itemize}
  \item \textbf{PD}: Proporzionale-Derivativo
  \item \textbf{PI}: Proporzionale-Integrativo
  \item \textbf{DI}: Derivativo-Integrativo
  \item \textbf{PID}: Proporzionale-Integrativo-Derivativo
    \[
      u_{\text{PID}} = K_P \cdot e + K_D \cdot \frac{de}{dt} + K_I \cdot \int e \, dt
    \] 
\end{itemize}

\vspace{1em}
\noindent
Un sistema può essere tradotto dal tempo continuo al tempo discreto, attraverso un
campionatore:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum size=1cm] (r) {LTI};
    \node[above=0cm of r] {\( t \in \mathbb{R} \)};

    \node[draw,minimum size=1cm,right=2.5cm of r] (z) {LTI};
    \node[above=0cm of z] {\( k \in \mathbb{Z} \)};

    \draw (r) -- ++(1.5,0) -- ++(0.5,0.5);
    \draw[->] (r) ++(2,0) node[below left,scale=0.8,xshift=0.6cm] {Campionatore} -- (z);
  \end{tikzpicture}
  \caption{Campionamento di un sistema}
\end{figure}

\noindent
Oltre al campionatore si utilizza anche un componente chiamato \textbf{zero holder},
che è un componente che mantiene il valore del segnale invariato fino all'istante
successivo.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,minimum size=1cm,align=center] at (3.5,0) (z) {Zero\\holder};

    \draw (0,0) -- ++(1,0) -- ++(0.5,0.5);
    \draw[->] (1.5,0) -- (z);
  \end{tikzpicture}
  \[
  \downarrow
  \] 
  \begin{tikzpicture}[scale=0.8]
    \draw[->] (-0.2,0) -- (8,0) node[right] {t};
    \draw[->] (0,-0.2) -- (0,4.5) node[above] {v(t)};

    \draw[domain=0:8,samples=100] plot(\x,{cos(\x r)*exp(\x/8)+2});
    \draw[blue,domain=0:8,samples=20] plot[ycomb](\x,{cos(\x r)*exp(\x/8)+2});
  \end{tikzpicture}
  \[
  \downarrow
  \] 
  \begin{tikzpicture}[scale=0.8]
    \draw[->] (-0.2,0) -- (8,0) node[right] {k};
    \draw[->] (0,-0.2) -- (0,4.5) node[above] {v(k)};

    \draw[red,domain=0:8,samples=20] plot[const plot](\x,{cos(\x r)*exp(\x/8)+2});
  \end{tikzpicture}
\end{figure}

\begin{example}
  Prendiamo ad esempio il seguente sistema iniziale:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      [
      every node/.style={node distance=0.6cm},
      ]
      \def\ns{0.8cm}
      \def\ss{0.7cm}
      \node[draw,circle,minimum size=\ss] (sum1) {};
      \node[draw,circle,minimum size=\ss,right=of sum1] (sum2) {};
      \node[draw,minimum size=\ns,right=of sum2] (g1) {\( G_1 \)};
      \node[draw,minimum size=\ns,right=of g1] (g4) {\( G_4 \)};
      \node[draw,minimum size=\ns,below=of g4] (h1) {\( H_1 \)};
      \node[draw,minimum size=\ns,below=of h1] (h2) {\( H_2 \)};
      \coordinate[right=of g4] (n1);
      \fill (n1) circle (0.05cm);
      \node[draw,minimum size=\ns,right=of n1] (g2) {\( G_2 \)};
      \node[draw,minimum size=\ns,above=of g2] (g3) {\( G_3 \)};
      \node[draw,circle,minimum size=\ss,right=of g2] (sum3) {};
      \coordinate[right=of sum3] (n2);
      \fill (n2) circle (0.05cm);

      \draw[<-] (sum1.west) node[above left,scale=0.8] {\( + \) } 
        -- ++(-1,0) node[above] {\( r \)};
      \draw[->] (sum1.east) -- (sum2.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum2) -- (g1);
      \draw[->] (g1) -- (g4);
      \draw[->] (g4) -- (n1) -- (g2);
      \draw[->] (g2) -- (sum3.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum3) -- (n2) -- ++(1,0) node[above] {\( c \)};
      \draw[->] (n1) |- (g3);
      \draw[->] (g3) -| (sum3.north) node[above right,scale=0.8] {\( + \)};
      \draw[->] (n1) |- (h1);
      \draw[->] (h1) -| (sum2.south) node[below right,scale=0.8] {\( + \)};
      \draw[->] (n2) |- (h2);
      \draw[->] (h2) -| (sum1.south) node[below right,scale=0.8] {\( - \)};
    \end{tikzpicture}
  \end{figure}
  \noindent
  Vogliamo ottenere un sistema in forma canonica, cioè un sistema con un solo nodo,
  ad esempio:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node (x) at (0,0) {\( R \)};

      \node[draw,circle,minimum size=0.7cm,right=1cm of x] (sum) {+};
      \node[draw,minimum size=1cm,right=1.5cm of sum] (A) {\( A \) };
      \node[draw,minimum size=1cm,below=of A] (B) {\( B \) };

      \coordinate[right=1cm of A] (n);
      \fill (n) circle (0.05cm);

      \draw[->] (x) -- (sum);
      \draw[->] (sum) -- (A.west);
      \draw[<-] (sum) |- (B.west);

      \draw[->] (A.east) -- (n) |- (B.east);
      \draw[->] (n) -- ++(0.5,0) node[above] {\( C \) };
    \end{tikzpicture}
    \[
    \downarrow
    \] 
    \begin{tikzpicture}
      \node[draw,minimum size=1cm] (D) {\( D \) };
      \draw[<-] (D) -- ++(-1.5,0) node[above] {\( R \)};
      \draw[->] (D) -- ++(1.5,0) node[above] {\( C \)};
    \end{tikzpicture}
    \caption{Sistema in forma canonica}
  \end{figure}
\end{example}

\subsubsection{Nomenclatura della forma canonica}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node (x) at (0,0) {\( R \)};

    \node[draw,circle,minimum size=0.7cm,right=1cm of x] (sum) {+};
    \node[draw,minimum size=1cm,right=1.5cm of sum] (A) {\( G \) };
    \node[draw,minimum size=1cm,below=of A] (B) {\( H \) };

    \coordinate[right=1cm of A] (n);
    \fill (n) circle (0.05cm);

    \draw[->] (x) -- (sum);
    \draw[->] (sum) -- (A.west) node[midway,above] {\( E \)};
    \draw[<-] (sum) |- (B.west) node[midway,above right] {\( B \) };

    \draw[->] (A.east) -- (n) |- (B.east);
    \draw[->] (n) -- ++(0.5,0) node[above] {\( C \) };
  \end{tikzpicture}
  \caption{Nomenclatura della forma canonica}
\end{figure}
\begin{itemize}
  \item \( G \): Funzione di trasferimento discreta
  \item \( H \): Funzione di trasferimento di feedback
  \item \( GH \): Funzione di trasferimento dell'anello (loop)
  \item \( \frac{C}{R} \): Funzione di trasferimento dell'anello chiuso ed è definita come:
    \[
    \frac{C}{R} = \frac{G}{1 \pm GH} = \frac{\text{Equazione caratteristica dell'ingresso}}
    {\text{Equazione caratteristica dell'uscita}}
    \] 

  \item \( \frac{E}{R} \): Rapporto del segnale di attuazione (errore) ed è definito come:
    \[
    \frac{E}{R} = \frac{1}{1 \pm GH}
    \]

  \item \( \frac{B}{R} \): Rapporto di feedback ed è definito come:
    \[
    \frac{B}{R} = \frac{GH}{1 \pm GH}
    \]
\end{itemize}
L'obiettivo è quello di semplificare il sistema finchè non si ottiene una forma canonica.

\begin{example}
  Se prendiamo ad esempio il sistema massa-molla-smorzatore l'equazione sarà:
  \[
    \begin{aligned}
      M \cdot a &= \sum F\\
                &= F_{\text{ext}} - Kx - bx'\\
      \underbrace{F_{\text{ext}}}_{\text{Ingresso}} &= \underbrace{kx + bx'+Mx''}_
                {\text{Uscita}}\\
      \downarrow \mathcal{L} & X(s) = \mathcal{L}\left[ x(t) \right](s) \\
                             &= k X(s) +bs X(s)+ M s^2 X(s)\\
    \end{aligned}
  \] 
  \[
    X(s) = \frac{F_{\text{ext}}}{\underbrace{\left( k + bs + Ms^2 \right)}_{A}}
  \] 
  \noindent
  Il sistema di questo esempio è il seguente:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[draw,minimum size=1cm] (fext) {\( F_{\text{ext}} \) };
      \node[draw,minimum size=1cm,right=of fext] (eq) {\( \frac{1}{K+bs+M s^2} \) };

      \draw[<-] (fext) -- ++(-1.5,0) node[above] {\( s \)};
      \draw[->] (fext) -- (eq);
      \draw[->] (eq) -- ++(2,0) node[above] {\( X(s) \)};
    \end{tikzpicture}
    \caption{Sistema massa-molla-smorzatore}
  \end{figure}
\end{example}

\section{Operazioni sui blocchi}
I blocchi possono essere combinati tra loro in diversi modi:
\begin{enumerate}
  \item \textbf{Combinazione di blocchi in serie}: Dati due blocchi \( A \) e \( B \) si
    ottiene un nuovo blocco il cui contenuto è il prodotto dei due blocchi:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
      [
      every node/.style={node distance=0.6cm},
      ]
        \node[draw,minimum size=1cm] (A) {\( A \) };
        \node[draw,minimum size=1cm,right=of fext] (B) {\(B\) };

        \draw[<-] (A) -- ++(-1.5,0) node[above] {\(x\)};
        \draw[->] (A) -- (B);
        \draw[->] (B) -- ++(1.5,0) node[above] {\(y\)};
      \end{tikzpicture}
      \[
      \downarrow
      \] 
      \begin{tikzpicture}
        \node[draw,minimum size=1cm] (C) {\(A \cdot B\) };

        \draw[<-] (C) -- ++(-1.5,0) node[above] {\(x\)};
        \draw[->] (C) -- ++(1.5,0) node[above] {\(y\)};
      \end{tikzpicture}
    \end{figure}
    \noindent
    Questo perchè avere due sistemi in serie equivale a fare una convoluzione, di conseguenza
    un prodotto di sistemi.

  \item \textbf{Combinazione di blocchi in parallelo}: Dati due blocchi \( A \) e \( B \) si
    ottiene un nuovo blocco il cui contenuto è la somma dei due blocchi:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
      [
      every node/.style={node distance=0.6cm},
      ]
        \node[draw,minimum size=1cm] (A) {\( A \) };
        \coordinate[left=of A] (n);
        \fill (n) circle (0.05cm);
        \node[draw,minimum size=1cm,below=of A] (B) {\(B\) };
        \node[draw,circle,minimum size=0.7cm,right=of A] (sum) {};

        \draw (n) -- ++(-1,0) node[above] {\(x\)};
        \draw[->] (n) -- (A);
        \draw[->] (A) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum.east) -- ++(1,0) node[above] {\(y\)};
        \draw[->] (B.east) -| (sum.south) node[below right,scale=0.8] {\( \pm \)};
        \draw (B) -| (n);
      \end{tikzpicture}
      \[
      \downarrow
      \] 
      \begin{tikzpicture}
        \node[draw,minimum size=1cm] (C) {\(A \pm B\) };

        \draw[<-] (C) -- ++(-1.5,0) node[above] {\(x\)};
        \draw[->] (C) -- ++(1.5,0) node[above] {\(y\)};
      \end{tikzpicture}
    \end{figure}
    \begin{enumerate}
      \item \textbf{Rimozione di un blocco parallelo}: Dato un blocco \( A \) in parallelo
        con un blocco \( B \) si può rimuovere la connessione parallela sostituendola con
        il rapporto tra i 2 blocchi
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
      [
      every node/.style={node distance=0.6cm},
      ]
        \node[draw,minimum size=1cm] (A) {\( A \) };
        \coordinate[left=of A] (n);
        \fill (n) circle (0.05cm);
        \node[draw,minimum size=1cm,below=of A] (B) {\(B\) };
        \node[draw,circle,minimum size=0.7cm,right=of A] (sum) {};

        \draw (n) -- ++(-1,0) node[above] {\(x\)};
        \draw[->] (n) -- (A);
        \draw[->] (A) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum.east) -- ++(1,0) node[above] {\(y\)};
        \draw[->] (B.east) -| (sum.south) node[below right,scale=0.8] {\( \pm \)};
        \draw (B) -| (n);
      \end{tikzpicture}
      \[
      \downarrow
      \] 
      \begin{tikzpicture}
      [
      every node/.style={node distance=0.6cm},
      ]
        \node[draw,minimum size=1cm] (B) {\(B\) };
        \coordinate[right=of B] (n);
        \fill (n) circle (0.05cm);
        \node[draw,minimum size=1cm,right=of n] (A/B) {\(\frac{A}{B}\) };
        \node[draw,circle,minimum size=0.7cm,right=of A/B] (sum) {};

        \draw[<-] (B) -- ++(-1.5,0) node[above] {\(x\)};
        \draw[->] (B) -- (A/B);
        \draw[->] (A/B) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum) -- ++(1.5,0) node[above] {\(y\)};
        \draw[->] (n) -- ++(0,-1) -| (sum.south) node[below right,scale=0.8] {\( \pm \)};
      \end{tikzpicture}
    \end{figure}
    \end{enumerate}


  \item \textbf{Rimozione di un anello feedback}: Dato un blocco \( A \) in feedback con
    un blocco \( B \) si può rimuovere la connessione di feedback sostituendola con:
    \[
    \frac{A}{1 \pm AB}
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
      [
      every node/.style={node distance=0.6cm},
      ]
        \node[draw,minimum size=1cm] (A) {\( A \) };
        \coordinate[right=of A] (n);
        \fill (n) circle (0.05cm);
        \node[draw,minimum size=1cm,below=of A] (B) {\(B\) };
        \node[draw,circle,minimum size=0.7cm,left=of A] (sum) {};

        \draw[->] (n) -- ++(1,0) node[above] {\(y\)};
        \draw (A) -- (n);
        \draw[->] (sum.east) -- (A);
        \draw[<-] (sum.west) node[above left,scale=0.8] {\( + \)}
          -- ++(-1,0) node[above] {\(x\)};
        \draw[->] (B.west) -| (sum.south) node[below right,scale=0.8] {\( \mp \)};
        \draw (B) -| (n);
      \end{tikzpicture}
      \[
      \downarrow
      \] 
      \begin{tikzpicture}
        \node[draw,minimum size=1cm,scale=1.2] (C) {\(\frac{A}{1 \pm AB}\) };

        \draw[<-] (C) -- ++(-1.5,0) node[above] {\(x\)};
        \draw[->] (C) -- ++(1.5,0) node[above] {\(y\)};
      \end{tikzpicture}
    \end{figure}

    \begin{enumerate}
      \item \textbf{Rimozione dal loop}: 
        \begin{figure}[H]
          \centering
          \begin{tikzpicture}
            [
            every node/.style={node distance=0.6cm},
            ]
            \node[draw,minimum size=1cm] (A) {\( A \) };
            \coordinate[right=of A] (n);
            \fill (n) circle (0.05cm);
            \node[draw,minimum size=1cm,below=of A] (B) {\(B\) };
            \node[draw,circle,minimum size=0.7cm,left=of A] (sum) {};

            \draw[->] (n) -- ++(1,0) node[above] {\(y\)};
            \draw (A) -- (n);
            \draw[->] (sum.east) -- (A);
            \draw[<-] (sum.west) node[above left,scale=0.8] {\( + \)}
              -- ++(-1,0) node[above] {\(x\)};
            \draw[->] (B.west) -| (sum.south) node[below right,scale=0.8] {\( \mp \)};
            \draw (B) -| (n);
          \end{tikzpicture}
          \[
            \downarrow
          \] 
          \begin{tikzpicture}
            [
            every node/.style={node distance=0.6cm},
            ]
            \node[draw,minimum size=1cm] (B) {\(\frac{1}{B}\) };
            \node[draw,circle,minimum size=0.7cm,right=of B] (sum) {};
            \node[draw,minimum size=1cm,right=of sum] (A/B) {\(\frac{1}{AB}\) };
            \coordinate[right=of A/B] (n);
            \fill (n) circle (0.05cm);

            \draw[<-] (B) -- ++(-1.5,0) node[above] {\(x\)};
            \draw[->] (B) -- (sum.west) node[above left,scale=0.8] {\( + \)};
            \draw[->] (sum.east) -- (A/B);
            \draw (A/B) -- (n);
            \draw[->] (n) -- ++(1.5,0) node[above] {\(y\)};
            \draw[<-] (sum.south) node[below right,scale=0.8] {\( \mp \)} -- ++(0,-1) -| (n);
          \end{tikzpicture}
        \end{figure}
    \end{enumerate}

  \item \textbf{Riorganizzazione degli input nel nodo sommatore}:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \node (w) {\( w \) };
        \node[below=0.3cm of w] (x) {\( x \) };
        \node[below=0.3cm of x] (y) {\( y \) };
        \node[draw,circle,minimum size=0.7cm,right=of w] (sum1) {};
        \node[draw,circle,minimum size=0.7cm,right=of sum1] (sum2) {};
        \node[right=of sum2] (z) {\( z \) };

        \draw[->] (w) -- (sum1.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum1) -- (sum2.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum2) -- (z);

        \draw[->] (x) -| (sum1.south) node[below right,scale=0.8] {\( \pm \)};
        \draw[->] (y) -| (sum2.south) node[below right,scale=0.8] {\( \pm \)};
      \end{tikzpicture}
      \[
      \downarrow
      \] 
      \begin{tikzpicture}
        \node (w) {\( w \) };
        \node[below=0.3cm of w] (x) {\( y \) };
        \node[below=0.3cm of x] (y) {\( x \) };
        \node[draw,circle,minimum size=0.7cm,right=of w] (sum1) {};
        \node[draw,circle,minimum size=0.7cm,right=of sum1] (sum2) {};
        \node[right=of sum2] (z) {\( z \) };

        \draw[->] (w) -- (sum1.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum1) -- (sum2.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum2) -- (z);

        \draw[->] (x) -| (sum1.south) node[below right,scale=0.8] {\( \pm \)};
        \draw[->] (y) -| (sum2.south) node[below right,scale=0.8] {\( \pm \)};
      \end{tikzpicture}
    \end{figure}
    \begin{enumerate}
      \item \textbf{Riorganizzazione dei nodi sommatori}:
        \begin{figure}[H]
          \centering
          \begin{tikzpicture}
            \node (w) {\( w \) };
            \node[below=0.3cm of w] (x) {\( x \) };
            \node[below=0.3cm of x] (y) {\( y \) };
            \node[draw,circle,minimum size=0.7cm,right=of w] (sum1) {};
            \node[draw,circle,minimum size=0.7cm,right=of sum1] (sum2) {};
            \node[right=of sum2] (z) {\( z \) };

            \draw[->] (w) -- (sum1.west) node[above left,scale=0.8] {\( + \)};
            \draw[->] (sum1) -- (sum2.west) node[above left,scale=0.8] {\( + \)};
            \draw[->] (sum2) -- (z);

            \draw[->] (x) -| (sum1.south) node[below right,scale=0.8] {\( \pm \)};
            \draw[->] (y) -| (sum2.south) node[below right,scale=0.8] {\( \pm \)};
          \end{tikzpicture}
          \[
          \downarrow
          \] 
          \begin{tikzpicture}
            \node (w) {\( w \) };
            \node[below=0.8cm of w] (x) {\( x \) };
            \node[below=0.8cm of x] (y) {\( y \) };
            \node[draw,circle,minimum size=0.7cm,right=of w] (sum1) {};
            \node[draw,circle,minimum size=0.7cm,below=0.5cm of sum1] (sum2) {};
            \node[right=of sum1] (z) {\( z \) };

            \draw[->] (w) -- (sum1.west) node[above left,scale=0.8] {\( + \)};
            \draw[->] (sum1) -- (z);
            \draw[->] (sum2) -- (sum1.south) node[below right,scale=0.8] {\( + \)};
            \draw[->] (x) -- (sum2.west) node[above left,scale=0.8] {\( \pm \)};
            \draw[->] (y) -| (sum2.south) node[below right,scale=0.8] {\( \pm \)};
          \end{tikzpicture}
        \end{figure}
    \end{enumerate}

  \item \textbf{Spostamento dei nodi somma prima del blocco}:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \node (x) {\( x \) };
        \node[draw,minimum size=1cm,right=of x] (A) {\( A \) };
        \node[draw,circle,minimum size=0.7cm,right=of A] (sum) {};
        \node[right=of sum] (z) {\( z \) };
        \node[below=of z] (y) {\( y \) };

        \draw[->] (x) -- (A);
        \draw[->] (A) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum) -- (z);
        \draw[->] (y) -| (sum.south) node[below right,scale=0.8] {\( \pm \)};
      \end{tikzpicture}
      \[
      \downarrow
      \] 
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \node (x) {\( x \) };
        \node[draw,circle,minimum size=0.7cm,right=of x] (sum) {};
        \node[draw,minimum size=1cm,right=of sum] (A) {\( A \) };
        \node[draw,minimum size=1cm,below=of A] (1/A) {\( \frac{1}{A} \) };
        \node[right=of A] (z) {\( z \) };
        \node[right=of 1/A] (y) {\( y \) };

        \draw[->] (x) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum) -- (A);
        \draw[->] (A) -- (z);
        \draw[->] (y) -- (1/A);
        \draw[->] (1/A) -| (sum.south) node[below right,scale=0.8] {\( \pm \)};
      \end{tikzpicture}
    \end{figure}

  \item \textbf{Spostamento dei nodi somma dopo il blocco}:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \node (x) {\( x \) };
        \node[below=of x] (y) {\( y \) };
        \node[draw,circle,minimum size=0.7cm,right=of x] (sum) {};
        \node[draw,minimum size=1cm,right=of sum] (A) {\( A \) };
        \node[right=of A] (z) {\( z \) };

        \draw[->] (x) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum) -- (A);
        \draw[->] (A) -- (z);
        \draw[->] (y) -| (sum.south) node[below right,scale=0.8] {\( \pm \)};
      \end{tikzpicture}
      \[
      \downarrow
      \] 
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \node (x) {\( x \) };
        \node[draw,minimum size=1cm,right=of x] (A1) {\( A \) };
        \node[draw,minimum size=1cm,below=of A1] (A2) {\( A \) };
        \node[draw,circle,minimum size=0.7cm,right=of A1] (sum) {};
        \node[left=of A2] (y) {\( y \) };
        \node[right=of sum] (z) {\( z \) };

        \draw[->] (x) -- (A1);
        \draw[->] (A1) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum) -- (z);
        \draw[->] (A2) -| (sum.south) node[below right,scale=0.8] {\( \pm \)};
        \draw[->] (y) -- (A2);
      \end{tikzpicture}
    \end{figure}

  \item \textbf{Spostamento di un nodo prima di un blocco}:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \node (x) {\( x \) };
        \node[draw,minimum size=1cm,right=of x] (A) {\( A \) };
        \coordinate[right=of A] (n);
        \fill (n) circle (0.05cm);
        \node[below=of x] (y1) {\( y \) };
        \node[right=of n] (y2) {\( y \) };

        \draw[->] (x) -- (A);
        \draw[->] (A) -- (y2);
        \draw[->] (n) |- (y1);
      \end{tikzpicture}
      \[
      \downarrow
      \] 
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \node (x) {\( x \) };
        \coordinate[right=1cm of x] (n);
        \fill (n) circle (0.05cm);
        \node[draw,minimum size=1cm,right=of n] (A1) {\( A \) };
        \node[right=of A1] (y2) {\( y \) };
        \node[draw,minimum size=1cm,below=1cm of n] (A2) {\(A\) };
        \node[left=of A2] (y1) {\( y \) };

        \draw[->] (x) -- (A1);
        \draw[->] (A1) -- (y2);
        \draw[->] (n) -- (A2);
        \draw[->] (A2) -- (y1);
      \end{tikzpicture}
    \end{figure}

  \item \textbf{Spostamento di un nodo dopo un blocco}:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \node (x1) {\( x \) };
        \node[below=of x1] (x2) {\( x \) };
        \coordinate[right=of x1] (n);
        \fill (n) circle (0.05cm);
        \node[draw,minimum size=1cm,right=of n] (A) {\( A \) };
        \node[right=of A] (y) {\( y \) };

        \draw[->] (x1) -- (A);
        \draw[->] (n) |- (x2);
        \draw[->] (A) -- (y);
      \end{tikzpicture}
      \[
      \downarrow
      \] 
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \node (x1) {\( x \) };
        \node[draw,minimum size=1cm,right=of x1] (A) {\( A \) };
        \node[draw,minimum size=1cm,below=of A] (1/A) {\( \frac{1}{A} \) };
        \node[left=of 1/A] (x2) {\( x \) };
        \coordinate[right=of A] (n);
        \fill (n) circle (0.05cm);
        \node[right=of n] (y) {\( y \) };
        
        \draw[->] (x1) -- (A);
        \draw[->] (A) -- (y);
        \draw[->] (n) |- (1/A);
        \draw[->] (1/A) -- (x2);
      \end{tikzpicture}
    \end{figure}
\end{enumerate}

\begin{example}
  Prendiamo ad esempio il seguente sistema:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      [
      every node/.style={node distance=0.6cm},
      ]
      \def\ns{0.8cm}
      \def\ss{0.7cm}
      \node[draw,circle,minimum size=\ss] (sum1) {};
      \node[draw,circle,minimum size=\ss,right=of sum1] (sum2) {};
      \node[draw,minimum size=\ns,right=of sum2] (g1) {\( G_1 \)};
      \node[draw,minimum size=\ns,right=of g1] (g4) {\( G_4 \)};
      \node[draw,minimum size=\ns,below=of g4] (h1) {\( H_1 \)};
      \node[draw,minimum size=\ns,below=of h1] (h2) {\( H_2 \)};
      \coordinate[right=of g4] (n1);
      \fill (n1) circle (0.05cm);
      \node[draw,minimum size=\ns,right=of n1] (g2) {\( G_2 \)};
      \node[draw,minimum size=\ns,above=of g2] (g3) {\( G_3 \)};
      \node[draw,circle,minimum size=\ss,right=of g2] (sum3) {};
      \coordinate[right=of sum3] (n2);
      \fill (n2) circle (0.05cm);

      \draw[<-] (sum1.west) node[above left,scale=0.8] {\( + \) } 
        -- ++(-1,0) node[above] {\( R \)};
      \draw[->] (sum1.east) -- (sum2.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum2) -- (g1);
      \draw[->] (g1) -- (g4);
      \draw[->] (g4) -- (n1) -- (g2);
      \draw[->] (g2) -- (sum3.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum3) -- (n2) -- ++(1,0) node[above] {\( C \)};
      \draw[->] (n1) |- (g3);
      \draw[->] (g3) -| (sum3.north) node[above right,scale=0.8] {\( + \)};
      \draw[->] (n1) |- (h1);
      \draw[->] (h1) -| (sum2.south) node[below right,scale=0.8] {\( + \)};
      \draw[->] (n2) |- (h2);
      \draw[->] (h2) -| (sum1.south) node[below right,scale=0.8] {\( - \)};
    \end{tikzpicture}
  \end{figure}
  \noindent
  L'obiettivo è quello di trasformare tutto questo sistema in un unico blocco
  per poter poi fare la trasformata di Laplace.
  \begin{enumerate}
    \item Applicare la trasformazione delle serie per ogni blocco in serie:
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \def\ns{0.8cm}
          \def\ss{0.7cm}
          \node[draw,circle,minimum size=\ss] (sum1) {};
          \node[draw,circle,minimum size=\ss,right=of sum1] (sum2) {};
          \node[draw,blue,minimum size=\ns,right=of sum2] (g1g4) {\( G_1 \cdot G_4 \)};
          \node[draw,minimum size=\ns,below=of g1g4] (h1) {\( H_1 \)};
          \node[draw,minimum size=\ns,below=of h1] (h2) {\( H_2 \)};
          \coordinate[right=of g1g4] (n1);
          \fill (n1) circle (0.05cm);
          \node[draw,minimum size=\ns,right=of n1] (g2) {\( G_2 \)};
          \node[draw,minimum size=\ns,above=of g2] (g3) {\( G_3 \)};
          \node[draw,circle,minimum size=\ss,right=of g2] (sum3) {};
          \coordinate[right=of sum3] (n2);
          \fill (n2) circle (0.05cm);

          \draw[<-] (sum1.west) node[above left,scale=0.8] {\( + \) } 
            -- ++(-1,0) node[above] {\( R \)};
          \draw[->] (sum1.east) -- (sum2.west) node[above left,scale=0.8] {\( + \)};
          \draw[->] (sum2) -- (g1g4);
          \draw[->] (g1g4) -- (n1) -- (g2);
          \draw[->] (g2) -- (sum3.west) node[above left,scale=0.8] {\( + \)};
          \draw[->] (sum3) -- (n2) -- ++(1,0) node[above] {\( C \)};
          \draw[->] (n1) |- (g3);
          \draw[->] (g3) -| (sum3.north) node[above right,scale=0.8] {\( + \)};
          \draw[->] (n1) |- (h1);
          \draw[->] (h1) -| (sum2.south) node[below right,scale=0.8] {\( + \)};
          \draw[->] (n2) |- (h2);
          \draw[->] (h2) -| (sum1.south) node[below right,scale=0.8] {\( - \)};
        \end{tikzpicture}
      \end{figure}

    \item Applicare la trasformazione dei blocchi in parallelo per ogni blocco in parallelo:
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \def\ns{0.8cm}
          \def\ss{0.7cm}
          \node[draw,circle,minimum size=\ss] (sum1) {};
          \node[draw,circle,minimum size=\ss,right=of sum1] (sum2) {};
          \node[draw,minimum size=\ns,right=of sum2] (g1g4) {\( G_1 \cdot G_4 \)};
          \node[draw,minimum size=\ns,below=of g1g4] (h1) {\( H_1 \)};
          \node[draw,minimum size=\ns,below=of h1] (h2) {\( H_2 \)};
          \coordinate[right=of g1g4] (n1);
          \fill (n1) circle (0.05cm);
          \node[draw,blue,minimum size=\ns,right=of n1] (g2g3) {\( G_2 + G_3 \)};
          \coordinate[right=of g2g3] (n2);
          \fill (n2) circle (0.05cm);

          \draw[<-] (sum1.west) node[above left,scale=0.8] {\( + \) } 
            -- ++(-1,0) node[above] {\( R \)};
          \draw[->] (sum1.east) -- (sum2.west) node[above left,scale=0.8] {\( + \)};
          \draw[->] (sum2) -- (g1g4);
          \draw[->] (g1g4) -- (n1) -- (g2g3);
          \draw[->] (g2g3) -- (n2) -- ++(1,0) node[above] {\( C \)};
          \draw[->] (n1) |- (h1);
          \draw[->] (h1) -| (sum2.south) node[below right,scale=0.8] {\( + \)};
          \draw[->] (n2) |- (h2);
          \draw[->] (h2) -| (sum1.south) node[below right,scale=0.8] {\( - \)};
        \end{tikzpicture}
      \end{figure}

    \item Applicare la trasformazione di retroazione per ogni blocco in retroazione:
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \def\ns{0.8cm}
          \def\ss{0.7cm}
          \node[draw,circle,minimum size=\ss] (sum1) {};
          \node[draw,blue,minimum size=\ns,right=of sum1,scale=1.4] (g1) {\(\frac{G_1 \cdot G_4}{1 - G_1 \cdot G_4 \cdot H_1}\)};
          \node[draw,minimum size=\ns,below=of g1] (h2) {\( H_2 \)};
          \node[draw,minimum size=\ns,right=of g1] (g2) {\( G_2 + G_3 \)};
          \coordinate[right=of g2] (n2);
          \fill (n2) circle (0.05cm);

          \draw[<-] (sum1.west) node[above left,scale=0.8] {\( + \) } 
            -- ++(-1,0) node[above] {\( R \)};
          \draw[->] (sum1) -- (g1);
          \draw[->] (g1) -- (g2);
          \draw[->] (g2) -- (n2) -- ++(1,0) node[above] {\( C \)};
          \draw[->] (n2) |- (h2);
          \draw[->] (h2) -| (sum1.south) node[below right,scale=0.8] {\( - \)};
        \end{tikzpicture}
      \end{figure}

    \item Applicare la trasformazione dello spostamento dei nodi/nodi sommatori:

      \noindent
      In questo caso non serve

    \item Ripetere i passaggi fino ad ottenere un unico blocco:
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \def\ns{0.8cm}
          \def\ss{0.7cm}
          \node[draw,circle,minimum size=\ss] (sum1) {};
          \node[draw,blue,minimum size=\ns,right=of sum1,scale=1.4] (g1)
            {\(\frac{
                G_1 \cdot G_4 \cdot \left( G_2 + G_3 \right) 
              }{
              1 - G_1 \cdot G_4 \cdot H_1}\)
            };
          \node[draw,minimum size=\ns,below=of g1] (h2) {\( H_2 \)};
          \coordinate[right=of g1] (n2);
          \fill (n2) circle (0.05cm);

          \draw[<-] (sum1.west) node[above left,scale=0.8] {\( + \) } 
            -- ++(-1,0) node[above] {\( R \)};
          \draw[->] (sum1) -- (g1);
          \draw[->] (g1) -- (n2) -- ++(1,0) node[above] {\( C \)};
          \draw[->] (n2) |- (h2);
          \draw[->] (h2) -| (sum1.south) node[below right,scale=0.8] {\( - \)};
        \end{tikzpicture}
      \end{figure}
      \noindent
      Il sistema finale è dato da:
      \[
        \frac{
          G_1 \cdot G_4 \left( G_2 + G_3 \right)
        }{
          1 - G_1 \cdot G_4 \cdot H_1
        }
        \cdot 
        \frac{
          1
        }{
          1 + \frac{
            G_1 \cdot G_4 \left( G_2 + G_3 \right)
          }{
            1 - G_1 \cdot G_4 \cdot H_1
          }
          \cdot
          H_2
        }
        =
      \] 
      \[
        =\frac{
          G_1 \cdot G_4 \left( G_2 + G_3 \right)
        }{
          1 - \cancel{G_1 \cdot G_4} \cdot H_1
        }
        \cdot 
        \frac{
          1 - \cancel{G_1 \cdot G_4} \cdot H_1
        }{
          \left[ 1 - G_1 \cdot G_4 \cdot H_1 - G_1 \cdot G_4 \left( G_2 + G_3 \right)  \right] \cdot H_2
        }
        =
      \] 
      \[
        =\frac{
          G_1 \cdot G_4 \left( G_2 + G_3 \right) 
        }{
          H_2 - G_1 \cdot G_4 \cdot H_1 \cdot H_2 - G_1 \cdot G_4 \left( G_2 + G_3 \right) \cdot H_2
        }
        =
      \] 
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \def\ns{0.8cm}
          \def\ss{0.7cm}
          \node[draw,blue,minimum size=\ns,right=of sum1,scale=1.4] (g1)
            {\(\frac{
                G_1 \cdot G_4 \left( G_2 + G_3 \right) 
              }{
                H_2 - G_1 \cdot G_4 \cdot H_1 \cdot H_2 - G_1 \cdot G_4 \left( G_2 + G_3 \right) \cdot H_2
              }
              \)
            };

          \draw[<-] (g1.west) -- ++(-1,0) node[above] {\( R \)};
          \draw[->] (g1.east) -- ++(1,0) node[above] {\( C \)};
        \end{tikzpicture}
      \end{figure}
      \noindent
      Questo è il sistema finale in forma canonica.
  \end{enumerate}
\end{example}

\begin{example}
  Consideriamo il seguente sistema:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      [
      every node/.style={node distance=0.6cm},
      ]
      \node (x) {\( x \) };
      \node[draw,minimum size=1cm,right=of x] (A) {\( A \) };
      \coordinate[right=of A] (n1);
      \fill (n1) circle (0.05cm);
      \node[draw,circle,minimum size=0.7cm,right=of n1] (sum1) {1};
      \node[draw,minimum size=1cm,right=of sum1] (B) {\( B \) };
      \node[draw,circle,minimum size=0.7cm,right=of B] (sum2) {2};
      \coordinate[right=of sum2] (n2);
      \fill (n2) circle (0.05cm);
      \node[right=of n2] (y) {\( y \)};
      \node[draw,minimum size=1cm,below=of sum1] (D) {\( D \) };
      \node[draw,minimum size=1cm,above=of B] (C) {\( C \) };
      \node[draw,minimum size=1cm,above=of C] (E) {\( E \) };
      \node[draw,circle,minimum size=0.7cm,left=of C] (sum3) {};

      \draw[->] (x) -- (A);
      \draw[->] (A) -- (sum1.west) node[above left,scale=0.8] {\( + \) };
      \draw[->] (sum1) -- (B);
      \draw[->] (B) -- (sum2);
      \draw[->] (sum2) -- (y);
      \draw[->] (n1) |- (D);
      \draw[->] (D) -| (sum2);
      \draw[->] (n2) |- (C);
      \draw[->] (n2) |- (E);
      \draw[->] (E) -| (sum3.north) node[above left,scale=0.8] {\( - \)};
      \draw[->] (C) -- (sum3.east) node[above right,scale=0.8] {\( + \)};
      \draw[->] (sum3) -- (sum1.north) node[above right,scale=0.8] {\( - \)};
      \end{tikzpicture}
  \end{figure}
  \noindent
  dove:
  \[
  \begin{aligned}
    A &= \frac{1}{s}\\
    B &= s^2\\
    C &= \frac{(s-2)(s+1)}{s^2}\\
    D &= s+2\\
    E &= \frac{1}{s^2}
  \end{aligned}
  \] 
  \noindent
  I passaggi sono i seguenti:
  \begin{enumerate}
    \item 
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \node (x) {\( x \) };
          \node[draw,minimum size=1cm,right=of x] (A) {\( A \) };
          \coordinate[right=of A] (n1);
          \fill (n1) circle (0.05cm);
          \node[draw,circle,minimum size=0.7cm,right=of n1] (sum1) {1};
          \node[draw,minimum size=1cm,right=of sum1] (B) {\( B \) };
          \node[draw,circle,minimum size=0.7cm,right=of B] (sum2) {2};
          \coordinate[right=of sum2] (n2);
          \fill (n2) circle (0.05cm);
          \node[right=of n2] (y) {\( y \)};
          \node[draw,minimum size=1cm,below=of sum1] (D) {\( D \) };
          \node[draw,blue,minimum size=1cm,above=of B] (C) {\( C - E \) };

          \draw[->] (x) -- (A);
          \draw[->] (A) -- (sum1.west) node[above left,scale=0.8] {\( + \) };
          \draw[->] (sum1) -- (B);
          \draw[->] (B) -- (sum2);
          \draw[->] (sum2) -- (y);
          \draw[->] (n1) |- (D);
          \draw[->] (D) -| (sum2);
          \draw[->] (n2) |- (C);
          \draw[->] (C) -| (sum1.north) node[above right,scale=0.8] {\( - \)};
        \end{tikzpicture}
      \end{figure}
    \item 
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \node (x) {\( x \) };
          \node[draw,minimum size=1cm,right=of x] (A) {\( A \) };
          \coordinate[right=of A] (n1);
          \fill (n1) circle (0.05cm);
          \coordinate[right=1.5cm of n1] (n2);
          \node[draw,circle,minimum size=0.7cm,right=1cm of n2] (sum2) {2};
          \node[draw,circle,minimum size=0.7cm,right=of sum2] (sum1) {1};
          \node[draw,minimum size=1cm,right=of sum1] (B) {\( B \) };
          \coordinate[right=of B] (n3);
          \fill (n3) circle (0.05cm);
          \node[right=of n3] (y) {\( y \)};
          \node[draw,blue,minimum size=1cm,below=of n2] (D) {\( \frac{D}{B} \) };
          \node[draw,minimum size=1cm,above=of B] (C) {\( C-E \) };

          \draw[->] (x) -- (A);
          \draw[->] (A) -- (sum2.west) node[above left,scale=0.8] {\( + \) }
            node[midway,above,blue] {1};
          \draw[->] (sum2) -- (sum1.west) node[above left,scale=0.8] {\( + \) };
          \draw[->] (sum1) -- (B);
          \draw[->] (B) -- (y);
          \draw[->] (n3) |- (C);
          \draw[->] (C) -| (sum1.north) node[above right,scale=0.8] {\( - \)};
          \draw[->] (n1) |- (D);
          \draw[->] (D) -| (sum2.south) node[below right,scale=0.8] {\( - \)};
        \end{tikzpicture}
      \end{figure}
    \item 
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \node (x) {\( x \) };
          \node[draw,minimum size=1cm,right=of x] (A) {\( A \) };
          \node[draw,blue,minimum size=1cm,right=of A] (D) {\( 1 - \frac{D}{B} \) };
          \node[draw,circle,minimum size=0.7cm,right=of D] (sum1) {1};
          \node[draw,minimum size=1cm,right=of sum1] (B) {\( B \) };
          \coordinate[right=of B] (n3);
          \fill (n3) circle (0.05cm);
          \node[right=of n3] (y) {\( y \)};
          \node[draw,minimum size=1cm,above=of B] (C) {\( C-E \) };

          \draw[->] (x) -- (A);
          \draw[->] (A) -- (D);
          \draw[->] (D) -- (sum1.west) node[above left,scale=0.8] {\( + \) };
          \draw[->] (sum1) -- (B);
          \draw[->] (B) -- (y);
          \draw[->] (n3) |- (C);
          \draw[->] (C) -| (sum1.north) node[above right,scale=0.8] {\( - \)};
        \end{tikzpicture}
      \end{figure}
    \item 
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \node (x) {\( x \) };
          \node[draw,minimum size=1cm,right=of x] (A) {\( A \) };
          \node[draw,minimum size=1cm,right=of A] (D) {\( \frac{B- D}{B} \) };
          \node[draw,blue,minimum size=1cm,right=of D] (B) {\( \frac{B}{1 + B \left( C-E \right) } \) };
          \node[right=of B] (y) {\( y \)};

          \draw[->] (x) -- (A);
          \draw[->] (A) -- (D);
          \draw[->] (D) -- (B);
          \draw[->] (B) -- (y);
        \end{tikzpicture}
      \end{figure}
    \item Il sistema finale è dato da:
      \[
      A \cdot \frac{
        B - D
      }{
        \cancel{B}
      }
      \cdot 
      \frac{
        \cancel{B}
      }{
        1 + B \left( C - E \right) 
      }
      \] 
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          [
          every node/.style={node distance=0.6cm},
          ]
          \node (x) {\( x \) };
          \node[draw,blue,minimum size=1cm,right=of x,scale=1.4] (A) {\( \frac{A \cdot \left( B - D \right) }{1 + B \left( C - E \right) } \) };
          \node[right=of A] (y) {\( y \)};

          \draw[->] (x) -- (A);
          \draw[->] (A) -- (y);
        \end{tikzpicture}
      \end{figure}
  \end{enumerate}
  Alla fine la funzione di trasferimento del sistema sarà:
  \[
  \begin{aligned}
    \frac{A \cdot (B - D)}{1+B(C-E)} &= \frac{\frac{1}{s} \cdot \left( s^2 - (s+2) \right) }
    {1+\left( \cancel{s^2} \cdot \left( \frac{(s-2)(s+1)}{\cancel{s^2}} -
    \frac{1}{\cancel{s^2}} \right) \right)}\\
    &= \frac{\frac{1}{s} \cdot \left( s^2 - s + 2 \right)}{1 + (s-2)(s+1)-1}
  \end{aligned}
  \] 
\end{example}

\section{Diagrammi di flusso}
\subsection{Nomenclatura}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \coordinate (x1) node[below] at (x1) {\( x_1 \)};
    \fill (x1) circle (0.05cm);

    \coordinate[right=of x1] (A) node[above] at (A) {\( A \)};

    \coordinate[right=of A] (x2) node[below] at (x2) {\( x_2 \)};
    \fill (x2) circle (0.05cm);

    \node[above left=0.5cm and 0.5cm of x1] (nodi) {Nodo};
    \draw[-latex] (nodi) -- (x1);

    \node[below=0.5cm of A] (arco) {Arco};
    \draw[-latex] (arco) -- (A);

    \draw[->] (x1) -- (A);
    \draw (A) -- (x2);
  \end{tikzpicture}
  \caption{Nomenclatura base}
\end{figure}

Prendiamo ad esempio il seguente diagramma:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[
      every node/.style={node distance=2.5cm},
      decoration={
        markings,
        mark=at position 0.5 with {\arrow{>}}
      }
    ] 
    
    \coordinate (x1) node[below,align=center] at (x1) 
      {\( x_1 \)\\Nodo di input\\(Solo nodi in uscita)};
    \fill (x1) circle (0.05cm);

    \coordinate[right=of x1] (x2) node[below] at (x2) {\( x_2 \)};
    \fill (x2) circle (0.05cm);

    \coordinate[right=of x2] (x3) node[below] at (x3) {\( x_3 \)};
    \fill (x3) circle (0.05cm);

    \coordinate[right=of x3] (x4) node[below,align=center] at (x4) 
      {\( x_4 \)\\Nodo di output\\(Solo nodi in entrata)};
    \fill (x4) circle (0.05cm);
    
    \draw[postaction={decorate}] (x1) -- (x2) node[midway,above,align=center]
      {Peso di un arco\\\( A_{21} \)};
    \draw[postaction={decorate}] (x2) -- (x3) node[midway,above,align=center]
      {\( A_{22} \) };
    \draw[postaction={decorate}] (x3) -- (x4) node[midway,above,align=center]
      {\( A_{23} \) };

    \path (x3) edge [loop above,min distance=1cm,in=135,out=45,postaction={decorate}]
      node {\( A_{33} \) } (x3);

    \path (x3) edge [bend left=1.5cm,postaction={decorate}] node[below] {\( A_{32} \) } (x2);
    \path (x2) edge [bend left=3cm,postaction={decorate}] node[above] {\( A_{42} \) } (x4);
  \end{tikzpicture}
\end{figure}
Definiamo:
\begin{itemize}
  \item \textbf{Percorso in avanti}: Un cammino che unisce un nodo di ingresso ad un nodo 
    di uscita
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[
        every node/.style={node distance=2.5cm},
        decoration={
          markings,
          mark=at position 0.5 with {\arrow{>}}
        }
        ] 
        \coordinate (x1) node[below,align=center] at (x1) 
          {\( x_1 \)};
        \fill (x1) circle (0.05cm);

        \coordinate[right=of x1] (x2) node[below] at (x2) {\( x_2 \)};
        \fill (x2) circle (0.05cm);

        \coordinate[right=of x2] (x3) node[below] at (x3) {\( x_3 \)};
        \fill (x3) circle (0.05cm);

        \coordinate[right=of x3] (x4) node[below,align=center] at (x4) 
          {\( x_4 \)};
        \fill (x4) circle (0.05cm);

        \draw[red,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,align=center]
          {\( A_{21} \)};
        \draw[postaction={decorate}] (x2) -- (x3) node[midway,above,align=center]
          {\( A_{22} \) };
        \draw[postaction={decorate}] (x3) -- (x4) node[midway,above,align=center]
          {\( A_{23} \) };

        \path (x3) edge [loop above,min distance=1cm,in=135,out=45,postaction={decorate}]
          node {\( A_{33} \) } (x3);

        \path (x3) edge [bend left=1.5cm,postaction={decorate}] node[below] {\( A_{32} \) } (x2);
        \path[red,thick] (x2) edge [bend left=3cm,postaction={decorate}] node[above] {\( A_{42} \) } (x4);
      \end{tikzpicture}
      \begin{tikzpicture}[
        every node/.style={node distance=2.5cm},
        decoration={
          markings,
          mark=at position 0.5 with {\arrow{>}}
        }
        ] 
        \coordinate (x1) node[below,align=center] at (x1) 
          {\( x_1 \)};
        \fill (x1) circle (0.05cm);

        \coordinate[right=of x1] (x2) node[below] at (x2) {\( x_2 \)};
        \fill (x2) circle (0.05cm);

        \coordinate[right=of x2] (x3) node[below] at (x3) {\( x_3 \)};
        \fill (x3) circle (0.05cm);

        \coordinate[right=of x3] (x4) node[below,align=center] at (x4) 
          {\( x_4 \)};
        \fill (x4) circle (0.05cm);

        \draw[red,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,align=center]
          {\( A_{21} \)};
        \draw[red,thick,postaction={decorate}] (x2) -- (x3) node[midway,above,align=center]
          {\( A_{22} \) };
        \draw[red,thick,postaction={decorate}] (x3) -- (x4) node[midway,above,align=center]
          {\( A_{23} \) };

        \path (x3) edge [loop above,min distance=1cm,in=135,out=45,postaction={decorate}]
          node {\( A_{33} \) } (x3);

        \path (x3) edge [bend left=1.5cm,postaction={decorate}] node[below] {\( A_{32} \) } (x2);
        \path (x2) edge [bend left=3cm,postaction={decorate}] node[above] {\( A_{42} \) } (x4);
      \end{tikzpicture}
    \end{figure}

  \item \textbf{Percorso ad anello}: Un cammino che inizia e finisce nello stesso nodo
    senza passare più volte per nodi intermedi. Si dice \textbf{self loop} quando
    passa più volte per lo stesso nodo.
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[
        every node/.style={node distance=2.5cm},
        decoration={
          markings,
          mark=at position 0.5 with {\arrow{>}}
        }
        ] 
        \coordinate (x1) node[below,align=center] at (x1) 
          {\( x_1 \)};
        \fill (x1) circle (0.05cm);

        \coordinate[right=of x1] (x2) node[below] at (x2) {\( x_2 \)};
        \fill (x2) circle (0.05cm);

        \coordinate[right=of x2] (x3) node[below] at (x3) {\( x_3 \)};
        \fill (x3) circle (0.05cm);

        \coordinate[right=of x3] (x4) node[below,align=center] at (x4) 
          {\( x_4 \)};
        \fill (x4) circle (0.05cm);

        \draw[postaction={decorate}] (x1) -- (x2) node[midway,above,align=center]
          {\( A_{21} \)};
        \draw[red,thick,postaction={decorate}] (x2) -- (x3) node[midway,above,align=center]
          {\( A_{22} \) };
        \draw[postaction={decorate}] (x3) -- (x4) node[midway,above,align=center]
          {\( A_{23} \) };

        \path (x3) edge [loop above,min distance=1cm,in=135,out=45,postaction={decorate}]
          node {\( A_{33} \) } (x3);

        \path[red,thick] (x3) edge [bend left=1.5cm,postaction={decorate}] node[below] {\( A_{32} \) } (x2);
        \path (x2) edge [bend left=3cm,postaction={decorate}] node[above] {\( A_{42} \) } (x4);
      \end{tikzpicture}
    \end{figure}

  \item \textbf{Guadagno}: Prodotto di tutti i pesi degli archi lungo un percorso
\end{itemize}

\subsection{Regole di trasformazione}
\subsubsection{Regola dell'addizione}
\[
\sum x_1 \cdot A_i = y
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[
    every node/.style={node distance=0.5cm},
    decoration={
      markings,
      mark=at position 0.5 with {\arrow{>}}
    }
    ] 
    \coordinate (x1) node[left,align=center] at (x1) 
      {\( x_1 \)};
    \fill (x1) circle (0.05cm);

    \coordinate[below=of x1] (x2) node[left,align=center] at (x2) 
      {\( x_2 \)};
    \fill (x2) circle (0.05cm);

    \coordinate[below=of x2] (x3) node[left,align=center] at (x3) 
      {\( x_3 \)};
    \fill (x3) circle (0.05cm);

    \coordinate[below=of x3] (x4) node[left,align=center] at (x4) 
      {\( x_4 \)};
    \fill (x4) circle (0.05cm);

    \coordinate[below=of x4] (xn) node[left,align=center] at (xn) 
      {\( x_n \)};
    \fill (xn) circle (0.05cm);

    \coordinate[right=2cm of x3] (y) node[right,align=center] at (y) 
      {\( y \)};
    \fill (y) circle (0.05cm);

    \draw[postaction={decorate}] (x1) -- (y) node[midway,above] {\( A_1 \)};
    \draw[postaction={decorate}] (x2) -- (y);
    \draw[postaction={decorate}] (x3) -- (y);
    \draw[postaction={decorate}] (x4) -- (y);
    \draw[postaction={decorate}] (xn) -- (y) node[midway,below] {\( A_n \)};
  \end{tikzpicture}
  \caption{Regola dell'addizione}
\end{figure}

\subsubsection{Regola della trasmissione}
\[
y_i = x \cdot A_i
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[
    every node/.style={node distance=0.5cm},
    decoration={
      markings,
      mark=at position 0.5 with {\arrow{>}}
    }
    ] 
    \coordinate (y1) node[right,align=center] at (y1) 
      {\( y_1 \)};
    \fill (y1) circle (0.05cm);

    \coordinate[below=of y1] (y2) node[right,align=center] at (y2) 
      {\( y_2 \)};
    \fill (y2) circle (0.05cm);

    \coordinate[below=of y2] (y3) node[right,align=center] at (y3) 
      {\( y_3 \)};
    \fill (y3) circle (0.05cm);

    \coordinate[below=of y3] (y4) node[right,align=center] at (y4) 
      {\( y_4 \)};
    \fill (y4) circle (0.05cm);

    \coordinate[below=of y4] (yn) node[right,align=center] at (yn) 
      {\( y_n \)};
    \fill (yn) circle (0.05cm);

    \coordinate[left=2cm of y3] (x) node[left,align=center] at (x) 
      {\( x \)};
    \fill (x) circle (0.05cm);

    \draw[postaction={decorate}] (y1) -- (x) node[midway,above] {\( A_1 \)};
    \draw[postaction={decorate}] (y2) -- (x);
    \draw[postaction={decorate}] (y3) -- (x);
    \draw[postaction={decorate}] (y4) -- (x);
    \draw[postaction={decorate}] (yn) -- (x) node[midway,below] {\( A_n \)};
  \end{tikzpicture}
  \caption{Regola della trasmissione}
\end{figure}

\subsubsection{Regola della moltiplicazione}
\[
y = x_1 \cdot A \cdot x_2 \cdot B \ldots
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}[
    every node/.style={node distance=2.5cm},
    decoration={
      markings,
      mark=at position 0.5 with {\arrow{>}}
    }
    ] 
    \coordinate (x1) node[below,align=center] at (x1) 
      {\( x_1 \)};
    \fill (x1) circle (0.05cm);

    \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
      {\( x_2 \)};
    \fill (x2) circle (0.05cm);

    \coordinate[right=of x2] (y) node[below,align=center] at (y) 
      {\( y \)};
    \fill (y) circle (0.05cm);

    \draw[postaction={decorate}] (x1) -- (x2) node[midway,above] {\( A \)};
    \draw[postaction={decorate}] (x2) -- (y) node[midway,above] {\( B \)};
  \end{tikzpicture}
  \caption{Regola della moltiplicazione}
\end{figure}

\subsection{Passaggio dallo schema a blocchi al diagramma di flusso}
Prendiamo uno schema a blocchi base:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    [
    every node/.style={node distance=0.6cm},
    ]
    \node (R) {\( R \) };
    \node[draw,circle,minimum size=0.7cm,right=of R] (sum) {};
    \node[draw,minimum size=1cm,right=of sum] (G) {\( G \) };
    \node[draw,minimum size=1cm,below=of G] (H) {\( H \) };
    \coordinate[right=of G] (n);
    \fill (n) circle (0.05cm);
    \node[right=of n] (C) {\( C \)};

    \draw[->] (R) -- (sum.west) node[above left,scale=0.8] {\( + \)};
    \draw[->] (sum) -- (G);
    \draw[->] (G) -- (C);
    \draw[->] (n) |- (H);
    \draw[->] (H) -| (sum.south) node[below right,scale=0.8] {\( - \)};
  \end{tikzpicture}
\end{figure}
\noindent
Per convertire questo schema in un diagramma di flusso dobbiamo seguire le seguenti regole:
\begin{enumerate}
  \item Individuare i nodi di ingresso e di uscita
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \coordinate (R) node[above] at (R) {\( R \) };
        \fill[red,thick] (R) circle (0.05cm) node[below] {\( x_1 \) };
        \node[draw,circle,minimum size=0.7cm,right=of R] (sum) {};
        \node[draw,minimum size=1cm,right=of sum] (G) {\( G \) };
        \node[draw,minimum size=1cm,below=of G] (H) {\( H \) };
        \coordinate[right=of G] (n);
        \fill (n) circle (0.05cm);
        \coordinate[right=of n] (C) node[above] at (C) {\( C \)};
        \fill[red,thick] (C) circle (0.05cm) node[below] {\( x_2 \) };

        \draw[->] (R) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum) -- (G);
        \draw[->] (G) -- (C);
        \draw[->] (n) |- (H);
        \draw[->] (H) -| (sum.south) node[below right,scale=0.8] {\( - \)};
      \end{tikzpicture}
    \end{figure}
  \item Per ogni nodo somma si aggiunge un nodo
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \coordinate (R) node[above] at (R) {\( R \) };
        \fill[red,thick] (R) circle (0.05cm) node[below] {\( x_1 \) };
        \node[draw,circle,minimum size=0.9cm,right=of R] (sum) {};
        \fill[red,thick] (sum) circle (0.05cm) node[below] {\( x_2 \) };
        \node[draw,minimum size=1cm,right=of sum] (G) {\( G \) };
        \node[draw,minimum size=1cm,below=of G] (H) {\( H \) };
        \coordinate[right=of G] (n);
        \fill (n) circle (0.05cm);
        \coordinate[right=of n] (C) node[above] at (C) {\( C \)};
        \fill[red,thick] (C) circle (0.05cm) node[below] {\( x_3 \) };

        \draw[->] (R) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum) -- (G);
        \draw[->] (G) -- (C);
        \draw[->] (n) |- (H);
        \draw[->] (H) -| (sum.south) node[below right,scale=0.8] {\( - \)};
      \end{tikzpicture}
    \end{figure}
  \item Per ogni nodo dello schema a blocchi si aggiunge un nodo al diagramma di flusso
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.6cm},
        ]
        \coordinate (R) node[above] at (R) {\( R \) };
        \fill[red,thick] (R) circle (0.05cm) node[below] {\( x_1 \) };
        \node[draw,circle,minimum size=0.9cm,right=of R] (sum) {};
        \fill[red,thick] (sum) circle (0.05cm) node[below] {\( x_2 \) };
        \node[draw,minimum size=1cm,right=of sum] (G) {\( G \) };
        \node[draw,minimum size=1cm,below=of G] (H) {\( H \) };
        \coordinate[right=of G] (n);
        \fill[red,thick] (n) circle (0.05cm) node[above] {\( x_3 \) };
        \coordinate[right=of n] (C) node[above] at (C) {\( C \)};
        \fill[red,thick] (C) circle (0.05cm) node[below] {\( x_4 \) };

        \draw[->] (R) -- (sum.west) node[above left,scale=0.8] {\( + \)};
        \draw[->] (sum) -- (G);
        \draw[->] (G) -- (C);
        \draw[->] (n) |- (H);
        \draw[->] (H) -| (sum.south) node[below right,scale=0.8] {\( - \)};
      \end{tikzpicture}
    \end{figure}
  \item Unisco i nodi con archi il cui peso è la funzione dentro al blocco. Se tra i due
    nodi non c'è un blocco, l'arco avrà peso 1
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[
        every node/.style={node distance=2.5cm},
        decoration={
          markings,
          mark=at position 0.5 with {\arrow{>}}
        }
        ] 
        \coordinate (x1) node[below,align=center] at (x1) 
          {\( x_1 \)};
        \fill (x1) circle (0.05cm);

        \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
          {\( x_2 \)};
        \fill (x2) circle (0.05cm);

        \coordinate[right=of x2] (x3) node[below,align=center] at (x3) 
          {\( x_3 \)};
        \fill (x3) circle (0.05cm);

        \coordinate[right=of x3] (x4) node[below,align=center] at (x4) 
          {\( x_4 \)};
        \fill (x4) circle (0.05cm);

        \draw[postaction={decorate}] (x1) -- (x2) node[midway,above] {\( 1 \)};
        \draw[postaction={decorate}] (x2) -- (x3) node[midway,above] {\( G \)};
        \draw[postaction={decorate}] (x3) -- (x4) node[midway,above] {\( 1 \)};
        \path (x3) edge [postaction={decorate},bend right=3cm,min distance=1.5cm]
          node[above] {\( -H \) } (x2);
      \end{tikzpicture}
      \caption{Diagramma di flusso}
    \end{figure}
\end{enumerate}
L'obiettivo anche in questo caso è quello di ridurre il diagramma di flusso ad un unico
arco per ottenere la funzione di trasferimento:
\[
\frac{C}{R} = \frac{G}{1 \pm H \cdot G}
\] 

\begin{definition}[Formula di Mason]
  La funzione di trasferimento è data da:
  \[
  T = \frac{\sum_i p_i \Delta_i}{\Delta}
  \] 
  dove:
  \begin{itemize}
    \item \( p_i \): È il guadagno dell'\( i \)-esimo percorso in avanti.
    \item \( \Delta \): È il discriminante del sistema ed è definito come:
      \[
        \begin{aligned}
          \Delta &= 1 - (-1)^{k+1} \sum_k \sum_j p_{j,k}\\
                 &= 1 - \sum_j p_{j,1} + \sum_j p_{j,2} - \sum_j p_{j,3} + \ldots\\
                 &= 1 - \left( \parbox{3cm}{somma dei guadagni\\di tutti gli archi} \right) +
                 \left( \parbox{4cm}{somma dei guadagni\\dei prodotti degli anelli che\\
                 non si toccano due a due} \right) +\\
                 &\left( \parbox{4cm}{Somma dei guadagni\\dei prodotti degli anelli che\\non
                 si toccano tre a tre} \right) + \ldots
        \end{aligned}
      \]
      Dove \( p_{j,k} \) è il \( j \)-esimo prodotto dei percorsi di ordine \( k \) che
      non si toccano.
    \item \( \Delta_i \): Sono i discriminanti in cui i pesi degli archi che toccano
      il percorso vengono messi a \( 0 \).
  \end{itemize}
\end{definition}

\begin{example}
  Prendiamo ad esempio il seguente diagramma di flusso:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[
      every node/.style={node distance=2.5cm},
      decoration={
        markings,
        mark=at position 0.5 with {\arrow{>}}
      }
      ] 
      \coordinate (x1) node[below,align=center] at (x1) 
        {\( x_1 \)};
      \fill (x1) circle (0.05cm);

      \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
        {\( x_2 \)};
      \fill (x2) circle (0.05cm);

      \coordinate[right=of x2] (x3) node[below,align=center] at (x3) 
        {\( x_3 \)};
      \fill (x3) circle (0.05cm);

      \coordinate[right=of x3] (x4) node[below,align=center] at (x4) 
        {\( x_4 \)};
      \fill (x4) circle (0.05cm);

      \draw[postaction={decorate}] (x1) -- (x2) node[midway,above] {\( 1 \)};
      \draw[postaction={decorate}] (x2) -- (x3) node[midway,above] {\( G \)};
      \draw[postaction={decorate}] (x3) -- (x4) node[midway,above] {\( 1 \)};
      \path (x3) edge [postaction={decorate},bend right=3cm,min distance=1.5cm]
        node[above] {\( -H \) } (x2);

      \path[blue] (x2) edge [postaction={decorate},bend right=3cm,min distance=1.5cm]
        node[above] {\( 1 \) } (x1);
      \path[blue] (x4) edge [postaction={decorate},bend right=3cm,min distance=1.5cm]
        node[above] {\( 1 \) } (x3);
    \end{tikzpicture}
  \end{figure}
  \noindent
  Il percorso 1 è:
  \[
  P_1 = \left( x_1,x_2,x_3,x_4 \right) = 1 \cdot G \cdot 1 = G
  \] 
  Il percorso 1,1 è:
  \[
    P_{1,1} = P_1^1 = A_{1,1} = A_1^1 = \left( x_2, x_3 \right) = -GH
  \]
  Ci sarebbero anche gli anelli che hanno guadagno 1, ma non vengono considerati.
  \[
    \color{blue}P_{2,1} = P_2^1 = A_{2,1} = A_2^1 = \left( x_1, x_2 \right) = 1 \cdot 1 = 1
  \] 
  Ora si può calcolare il discriminante:
  \[
    \Delta = 1 - \left( P_{1,1} \right) + \left( 0 \right) = 1 + GH
  \] 
  Annullo tutti gli archi che toccano il percorso 1:
  \[
    \Delta_1 = 1 - \cancel{P_{1,1}}^0 = 1 - 0 = 1
  \]
  Ora si può calcolare la funzione di trasferimento:
  \[
    T = \frac{\sum_1 P_i \Delta_i}{\Delta} = \frac{P_1 \cdot \Delta_1}{\Delta} = \frac{G \cdot 1}{1 + GH} = \frac{G}{1 + GH}
  \] 
\end{example}
\begin{example}
  Prendiamo ad esempio il seguente schema a blocchi:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      [
      every node/.style={node distance=0.4cm},
      ]
      \def\blocksize{0.7cm}
      \def\sumsize{0.7cm}
      \coordinate (x) node[above] at (x) {\( x \) };
      \node[draw,circle,minimum size=\sumsize,right=of x] (sum1) {};
      \coordinate[right=of sum1] (n1);
      \fill (n1) circle (0.05cm);
      \node[draw,circle,minimum size=\sumsize,right=of n1] (sum2) {};
      \node[draw,minimum size=\blocksize,right=of sum2] (A) {\( A \) };
      \node[draw,minimum size=\blocksize,below=of A] (B) {\( B \) };
      \node[draw,minimum size=\blocksize,above=of A] (F) {\( F \) };
      \coordinate[right=of A] (n2);
      \fill (n2) circle (0.05cm);
      \node[draw,circle,minimum size=\sumsize,right=of n2] (sum3) {};
      \coordinate[right=of sum3] (n3);
      \fill (n3) circle (0.05cm);
      \node[draw,circle,minimum size=\sumsize,right=of n3] (sum4) {};
      \node[draw,minimum size=\blocksize,right=of sum4] (C) {\( C \) };
      \node[draw,minimum size=\blocksize,below=of C] (D) {\( D \) };
      \node[draw,minimum size=\blocksize,above=of C] (G) {\( G \) };
      \node[draw,circle,minimum size=\sumsize,right=of C] (sum5) {};
      \node[draw,minimum size=\blocksize,below=2cm of n3] (E) {\( E \) };
      \coordinate[right=of sum5] (n4);
      \fill (n4) circle (0.05cm);
      \coordinate[right=of n4] (n5);
      \fill (n5) circle (0.05cm);
      \coordinate[right=of n5] (y) node[above] at (y) {\( y \)};

      \draw[->] (x) -- (sum1.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum1) -- (sum2.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum2) -- (A);
      \draw[->] (A) -- (sum3.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum3) -- (sum4.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum4) -- (C);
      \draw[->] (C) -- (sum5.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum5) -- (y);

      \draw[->] (n1) |- (F);
      \draw[->] (F) -| (sum3.north) node[above right,scale=0.8] {\( + \)};

      \draw[->] (n2) |- (B);
      \draw[->] (B) -| (sum2.south) node[below right,scale=0.8] {\( - \)};

      \draw[->] (n3) |- (G);
      \draw[->] (G) -| (sum5.north) node[above right,scale=0.8] {\( + \)};

      \draw[->] (n4) |- (D);
      \draw[->] (D) -| (sum4.south) node[below right,scale=0.8] {\( - \)};

      \draw[->] (n5) |- (E);
      \draw[->] (E) -| (sum1.south) node[below right,scale=0.8] {\( + \)};
    \end{tikzpicture}
  \end{figure}
  Deriviamo i nodi del diagramma di flusso:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      [
      every node/.style={node distance=0.4cm},
      ]
      \def\blocksize{0.7cm}
      \def\sumsize{0.7cm}
      \coordinate (x) node[above] at (x) {\( x \) };
      \fill[red,thick] (x) circle (0.05cm) node[below] {\( x \) };
      \node[draw,circle,minimum size=\sumsize,right=of x] (sum1) {};
      \fill[red,thick] (sum1) circle (0.05cm) node[below,scale=0.8] {\( x_1 \) };
      \coordinate[right=of sum1] (n1);
      \fill[red,thick] (n1) circle (0.05cm) node[below] {\( x_2 \) };
      \node[draw,circle,minimum size=\sumsize,right=of n1] (sum2) {};
      \fill[red,thick] (sum2) circle (0.05cm) node[below,scale=0.8] {\( x_3 \) };
      \node[draw,minimum size=\blocksize,right=of sum2] (A) {\( A \) };
      \node[draw,minimum size=\blocksize,below=of A] (B) {\( B \) };
      \node[draw,minimum size=\blocksize,above=of A] (F) {\( F \) };
      \coordinate[right=of A] (n2);
      \fill[red,thick] (n2) circle (0.05cm) node[above] {\( x_4 \) };
      \node[draw,circle,minimum size=\sumsize,right=of n2] (sum3) {};
      \fill[red,thick] (sum3) circle (0.05cm) node[below,scale=0.8] {\( x_5 \) };
      \coordinate[right=of sum3] (n3);
      \fill[red,thick] (n3) circle (0.05cm) node[below] {\( x_6 \) };
      \node[draw,circle,minimum size=\sumsize,right=of n3] (sum4) {};
      \fill[red,thick] (sum4) circle (0.05cm) node[below,scale=0.8] {\( x_7 \) };
      \node[draw,minimum size=\blocksize,right=of sum4] (C) {\( C \) };
      \node[draw,minimum size=\blocksize,below=of C] (D) {\( D \) };
      \node[draw,minimum size=\blocksize,above=of C] (G) {\( G \) };
      \node[draw,circle,minimum size=\sumsize,right=of C] (sum5) {};
      \fill[red,thick] (sum5) circle (0.05cm) node[below,scale=0.8] {\( x_8 \) };
      \node[draw,minimum size=\blocksize,below=2cm of n3] (E) {\( E \) };
      \coordinate[right=of sum5] (n4);
      \fill[red,thick] (n4) circle (0.05cm) node[above] {\( x_9 \) };
      \coordinate[right=of n4] (n5);
      \fill[red,thick] (n5) circle (0.05cm) node[above] {\( x_{10} \) };
      \coordinate[right=of n5] (y) node[above] at (y) {\( y \)};
      \fill[red,thick] (y) circle (0.05cm) node[below] {\( y \) };

      \draw[->] (x) -- (sum1.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum1) -- (sum2.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum2) -- (A);
      \draw[->] (A) -- (sum3.west) node[above left,scale=0.8,xshift=0.1cm] {\( + \)};
      \draw[->] (sum3) -- (sum4.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum4) -- (C);
      \draw[->] (C) -- (sum5.west) node[above left,scale=0.8] {\( + \)};
      \draw[->] (sum5) -- (y);

      \draw[->] (n1) |- (F);
      \draw[->] (F) -| (sum3.north) node[above right,scale=0.8] {\( + \)};

      \draw[->] (n2) |- (B);
      \draw[->] (B) -| (sum2.south) node[below right,scale=0.8] {\( - \)};

      \draw[->] (n3) |- (G);
      \draw[->] (G) -| (sum5.north) node[above right,scale=0.8] {\( + \)};

      \draw[->] (n4) |- (D);
      \draw[->] (D) -| (sum4.south) node[below right,scale=0.8] {\( - \)};

      \draw[->] (n5) |- (E);
      \draw[->] (E) -| (sum1.south) node[below right,scale=0.8] {\( + \)};
    \end{tikzpicture}
  \end{figure}
  \noindent
  Rappresentiamo il diagramma di flusso:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}[
      every node/.style={node distance=0.9cm},
      decoration={
        markings,
        mark=at position 0.5 with {\arrow{>}}
      }
      ] 
      \coordinate (x) node[below,align=center] at (x) 
        {\( x \)};
      \fill (x) circle (0.05cm);

      \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
        {\( x_1 \)};
      \fill (x1) circle (0.05cm);

      \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
        {\( x_2 \)};
      \fill (x2) circle (0.05cm);

      \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
        {\( x_3 \)};
      \fill (x3) circle (0.05cm);

      \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
        {\( x_4 \)};
      \fill (x4) circle (0.05cm);

      \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
        {\( x_5 \)};
      \fill (x5) circle (0.05cm);

      \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
        {\( x_6 \)};
      \fill (x6) circle (0.05cm);

      \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
        {\( x_7 \)};
      \fill (x7) circle (0.05cm);

      \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
        {\( x_8 \)};
      \fill (x8) circle (0.05cm);

      \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
        {\( x_9 \)};
      \fill (x9) circle (0.05cm);

      \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
        {\( x_{10} \)};
      \fill (x10) circle (0.05cm);

      \coordinate[right=of x10] (y) node[below,align=center] at (y)
        {\( y \)};
      \fill (y) circle (0.05cm);

      \draw[postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
      \draw[postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
      \draw[postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
      \draw[postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
      \draw[postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
      \draw[postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
      \draw[postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
      \draw[postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
      \draw[postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
      \draw[postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
      \draw[postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

      \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
        node[below] {\( -B \) } (x3);
      \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
        node[below] {\( -D \) } (x7);

      \path (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
        node[above] {\( F \) } (x5);
      \path (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
        node[above] {\( G \) } (x8);

      \path (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
        node[above] {\( E \) } (x1);
    \end{tikzpicture}
  \end{figure}
  Le due rappresentazioni sono equivalenti.

  \vspace{1em}
  \noindent
  Utilizziamo la formula di Mason per calcolare la funzione di trasferimento:
  \begin{enumerate}
    \item Troviamo tutti i percorsi:
      \begin{enumerate}
        \item 
          \[
            P_1 = AC
          \] 
          I nodi coinvolti sono: \( \left( x_1,x_2,x_3,x_4,x_5,x_6,x_7,x_8,x_9,x_{10} \right) \) 
          \begin{figure}[H]
            \centering
            \begin{tikzpicture}[
              every node/.style={node distance=0.9cm},
              decoration={
                markings,
                mark=at position 0.5 with {\arrow{>}}
              }
              ] 
              \coordinate (x) node[below,align=center] at (x) 
                {\( x \)};
              \fill (x) circle (0.05cm);

              \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                {\( x_1 \)};
              \fill (x1) circle (0.05cm);

              \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                {\( x_2 \)};
              \fill (x2) circle (0.05cm);

              \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                {\( x_3 \)};
              \fill (x3) circle (0.05cm);

              \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                {\( x_4 \)};
              \fill (x4) circle (0.05cm);

              \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                {\( x_5 \)};
              \fill (x5) circle (0.05cm);

              \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                {\( x_6 \)};
              \fill (x6) circle (0.05cm);

              \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                {\( x_7 \)};
              \fill (x7) circle (0.05cm);

              \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                {\( x_8 \)};
              \fill (x8) circle (0.05cm);

              \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                {\( x_9 \)};
              \fill (x9) circle (0.05cm);

              \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                {\( x_{10} \)};
              \fill (x10) circle (0.05cm);

              \coordinate[right=of x10] (y) node[below,align=center] at (y)
                {\( y \)};
              \fill (y) circle (0.05cm);

              \draw[red,thick,postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[red,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[red,thick,postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[red,thick,postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
              \draw[red,thick,postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[red,thick,postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[red,thick,postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[red,thick,postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
              \draw[red,thick,postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[red,thick,postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[red,thick,postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

              \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                node[below] {\( -B \) } (x3);
              \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                node[below] {\( -D \) } (x7);

              \path (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                node[above] {\( F \) } (x5);
              \path (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                node[above] {\( G \) } (x8);

              \path (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                node[above] {\( E \) } (x1);
            \end{tikzpicture}
          \end{figure}

        \item 
          \[
            P_2 = FC
          \] 
          I nodi coinvolti sono: \( \left( x_1,x_2,x_5,x_6,x_7,x_8,x_9,x_{10} \right) \)
          \begin{figure}[H]
            \centering
            \begin{tikzpicture}[
              every node/.style={node distance=0.9cm},
              decoration={
                markings,
                mark=at position 0.5 with {\arrow{>}}
              }
              ] 
              \coordinate (x) node[below,align=center] at (x) 
                {\( x \)};
              \fill (x) circle (0.05cm);

              \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                {\( x_1 \)};
              \fill (x1) circle (0.05cm);

              \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                {\( x_2 \)};
              \fill (x2) circle (0.05cm);

              \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                {\( x_3 \)};
              \fill (x3) circle (0.05cm);

              \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                {\( x_4 \)};
              \fill (x4) circle (0.05cm);

              \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                {\( x_5 \)};
              \fill (x5) circle (0.05cm);

              \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                {\( x_6 \)};
              \fill (x6) circle (0.05cm);

              \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                {\( x_7 \)};
              \fill (x7) circle (0.05cm);

              \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                {\( x_8 \)};
              \fill (x8) circle (0.05cm);

              \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                {\( x_9 \)};
              \fill (x9) circle (0.05cm);

              \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                {\( x_{10} \)};
              \fill (x10) circle (0.05cm);

              \coordinate[right=of x10] (y) node[below,align=center] at (y)
                {\( y \)};
              \fill (y) circle (0.05cm);

              \draw[blue,thick,postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[blue,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
              \draw[postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[blue,thick,postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[blue,thick,postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[blue,thick,postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
              \draw[blue,thick,postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[blue,thick,postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[blue,thick,postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

              \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                node[below] {\( -B \) } (x3);
              \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                node[below] {\( -D \) } (x7);

              \path[blue,thick] (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                node[above] {\( F \) } (x5);
              \path (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                node[above] {\( G \) } (x8);

              \path (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                node[above] {\( E \) } (x1);
            \end{tikzpicture}
          \end{figure}

        \item
          \[
            P_3 = AG
          \]
          I nodi coinvolti sono: \( \left( x_1,x_2,x_3,x_4,x_5,x_6,x_8,x_9,x_{10} \right)  \) 
          \begin{figure}[H]
            \centering
            \begin{tikzpicture}[
              every node/.style={node distance=0.9cm},
              decoration={
                markings,
                mark=at position 0.5 with {\arrow{>}}
              }
              ] 
              \coordinate (x) node[below,align=center] at (x) 
                {\( x \)};
              \fill (x) circle (0.05cm);

              \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                {\( x_1 \)};
              \fill (x1) circle (0.05cm);

              \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                {\( x_2 \)};
              \fill (x2) circle (0.05cm);

              \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                {\( x_3 \)};
              \fill (x3) circle (0.05cm);

              \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                {\( x_4 \)};
              \fill (x4) circle (0.05cm);

              \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                {\( x_5 \)};
              \fill (x5) circle (0.05cm);

              \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                {\( x_6 \)};
              \fill (x6) circle (0.05cm);

              \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                {\( x_7 \)};
              \fill (x7) circle (0.05cm);

              \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                {\( x_8 \)};
              \fill (x8) circle (0.05cm);

              \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                {\( x_9 \)};
              \fill (x9) circle (0.05cm);

              \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                {\( x_{10} \)};
              \fill (x10) circle (0.05cm);

              \coordinate[right=of x10] (y) node[below,align=center] at (y)
                {\( y \)};
              \fill (y) circle (0.05cm);

              \draw[green!50!black,thick,postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[green!50!black,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[green!50!black,thick,postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[green!50!black,thick,postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
              \draw[green!50!black,thick,postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[green!50!black,thick,postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
              \draw[green!50!black,thick,postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[green!50!black,thick,postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[green!50!black,thick,postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

              \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                node[below] {\( -B \) } (x3);
              \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                node[below] {\( -D \) } (x7);

              \path (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                node[above] {\( F \) } (x5);
              \path[green!50!black,thick] (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                node[above] {\( G \) } (x8);

              \path (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                node[above] {\( E \) } (x1);
            \end{tikzpicture}
          \end{figure}

        \item
          \[
            P_3 = FG
          \]
          I nodi coinvolti sono: \( \left( x_1,x_2,x_5,x_6,x_8,x_9,x_{10} \right)  \) 
          \begin{figure}[H]
            \centering
            \begin{tikzpicture}[
              every node/.style={node distance=0.9cm},
              decoration={
                markings,
                mark=at position 0.5 with {\arrow{>}}
              }
              ] 
              \coordinate (x) node[below,align=center] at (x) 
                {\( x \)};
              \fill (x) circle (0.05cm);

              \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                {\( x_1 \)};
              \fill (x1) circle (0.05cm);

              \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                {\( x_2 \)};
              \fill (x2) circle (0.05cm);

              \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                {\( x_3 \)};
              \fill (x3) circle (0.05cm);

              \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                {\( x_4 \)};
              \fill (x4) circle (0.05cm);

              \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                {\( x_5 \)};
              \fill (x5) circle (0.05cm);

              \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                {\( x_6 \)};
              \fill (x6) circle (0.05cm);

              \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                {\( x_7 \)};
              \fill (x7) circle (0.05cm);

              \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                {\( x_8 \)};
              \fill (x8) circle (0.05cm);

              \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                {\( x_9 \)};
              \fill (x9) circle (0.05cm);

              \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                {\( x_{10} \)};
              \fill (x10) circle (0.05cm);

              \coordinate[right=of x10] (y) node[below,align=center] at (y)
                {\( y \)};
              \fill (y) circle (0.05cm);

              \draw[purple,thick,postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[purple,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
              \draw[postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[purple,thick,postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
              \draw[purple,thick,postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[purple,thick,postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
              \draw[purple,thick,postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

              \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                node[below] {\( -B \) } (x3);
              \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                node[below] {\( -D \) } (x7);

              \path[purple,thick] (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                node[above] {\( F \) } (x5);
              \path[purple,thick] (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                node[above] {\( G \) } (x8);

              \path (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                node[above] {\( E \) } (x1);
            \end{tikzpicture}
          \end{figure}
      \end{enumerate}

    \item Troviamo tutti gli anelli:
      
      \begin{itemize}
        \item Anelli di ordine 1
          \begin{enumerate}
            \item 
              \[
                A_1^1 = -AB \quad \left( x_3,x_4 \right) 
              \]
              \begin{figure}[H]
                \centering
                \begin{tikzpicture}[
                  every node/.style={node distance=0.9cm},
                  decoration={
                    markings,
                    mark=at position 0.5 with {\arrow{>}}
                  }
                  ] 
                  \coordinate (x) node[below,align=center] at (x) 
                    {\( x \)};
                  \fill (x) circle (0.05cm);

                  \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                    {\( x_1 \)};
                  \fill (x1) circle (0.05cm);

                  \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                    {\( x_2 \)};
                  \fill (x2) circle (0.05cm);

                  \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                    {\( x_3 \)};
                  \fill (x3) circle (0.05cm);

                  \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                    {\( x_4 \)};
                  \fill (x4) circle (0.05cm);

                  \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                    {\( x_5 \)};
                  \fill (x5) circle (0.05cm);

                  \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                    {\( x_6 \)};
                  \fill (x6) circle (0.05cm);

                  \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                    {\( x_7 \)};
                  \fill (x7) circle (0.05cm);

                  \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                    {\( x_8 \)};
                  \fill (x8) circle (0.05cm);

                  \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                    {\( x_9 \)};
                  \fill (x9) circle (0.05cm);

                  \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                    {\( x_{10} \)};
                  \fill (x10) circle (0.05cm);

                  \coordinate[right=of x10] (y) node[below,align=center] at (y)
                    {\( y \)};
                  \fill (y) circle (0.05cm);

                  \draw[postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[red,thick,postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
                  \draw[postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
                  \draw[postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

                  \path[red,thick] (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -B \) } (x3);
                  \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -D \) } (x7);

                  \path (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( F \) } (x5);
                  \path (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( G \) } (x8);

                  \path (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                    node[above] {\( E \) } (x1);
                \end{tikzpicture}
              \end{figure}

            \item
              \[
                A_2^1 = -CD \quad \left( x_7,x_8,x_9 \right) 
              \]
              \begin{figure}[H]
                \centering
                \begin{tikzpicture}[
                  every node/.style={node distance=0.9cm},
                  decoration={
                    markings,
                    mark=at position 0.5 with {\arrow{>}}
                  }
                  ] 
                  \coordinate (x) node[below,align=center] at (x) 
                    {\( x \)};
                  \fill (x) circle (0.05cm);

                  \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                    {\( x_1 \)};
                  \fill (x1) circle (0.05cm);

                  \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                    {\( x_2 \)};
                  \fill (x2) circle (0.05cm);

                  \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                    {\( x_3 \)};
                  \fill (x3) circle (0.05cm);

                  \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                    {\( x_4 \)};
                  \fill (x4) circle (0.05cm);

                  \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                    {\( x_5 \)};
                  \fill (x5) circle (0.05cm);

                  \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                    {\( x_6 \)};
                  \fill (x6) circle (0.05cm);

                  \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                    {\( x_7 \)};
                  \fill (x7) circle (0.05cm);

                  \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                    {\( x_8 \)};
                  \fill (x8) circle (0.05cm);

                  \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                    {\( x_9 \)};
                  \fill (x9) circle (0.05cm);

                  \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                    {\( x_{10} \)};
                  \fill (x10) circle (0.05cm);

                  \coordinate[right=of x10] (y) node[below,align=center] at (y)
                    {\( y \)};
                  \fill (y) circle (0.05cm);

                  \draw[postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
                  \draw[postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[blue,thick,postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
                  \draw[blue,thick,postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

                  \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -B \) } (x3);
                  \path[blue,thick] (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -D \) } (x7);

                  \path (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( F \) } (x5);
                  \path (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( G \) } (x8);

                  \path (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                    node[above] {\( E \) } (x1);
                \end{tikzpicture}
              \end{figure}

            \item
              \[
                A_3^1 = FCE \quad \left( x_1,x_2,x_5,x_6,x_7,x_8,x_9 \right) 
              \]
              \begin{figure}[H]
                \centering
                \begin{tikzpicture}[
                  every node/.style={node distance=0.9cm},
                  decoration={
                    markings,
                    mark=at position 0.5 with {\arrow{>}}
                  }
                  ] 
                  \coordinate (x) node[below,align=center] at (x) 
                    {\( x \)};
                  \fill (x) circle (0.05cm);

                  \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                    {\( x_1 \)};
                  \fill (x1) circle (0.05cm);

                  \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                    {\( x_2 \)};
                  \fill (x2) circle (0.05cm);

                  \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                    {\( x_3 \)};
                  \fill (x3) circle (0.05cm);

                  \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                    {\( x_4 \)};
                  \fill (x4) circle (0.05cm);

                  \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                    {\( x_5 \)};
                  \fill (x5) circle (0.05cm);

                  \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                    {\( x_6 \)};
                  \fill (x6) circle (0.05cm);

                  \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                    {\( x_7 \)};
                  \fill (x7) circle (0.05cm);

                  \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                    {\( x_8 \)};
                  \fill (x8) circle (0.05cm);

                  \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                    {\( x_9 \)};
                  \fill (x9) circle (0.05cm);

                  \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                    {\( x_{10} \)};
                  \fill (x10) circle (0.05cm);

                  \coordinate[right=of x10] (y) node[below,align=center] at (y)
                    {\( y \)};
                  \fill (y) circle (0.05cm);

                  \draw[postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[green!50!black,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
                  \draw[postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[green!50!black,thick,postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[green!50!black,thick,postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[green!50!black,thick,postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
                  \draw[green!50!black,thick,postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[green!50!black,thick,postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

                  \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -B \) } (x3);
                  \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -D \) } (x7);

                  \path[green!50!black,thick] (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( F \) } (x5);
                  \path (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( G \) } (x8);

                  \path[green!50!black,thick] (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                    node[above] {\( E \) } (x1);
                \end{tikzpicture}
              \end{figure}

            \item
              \[
                A_4^1 = FGE \quad \left( x_1,x_2,x_3,x_6,x_8,x_9,x_{10} \right) 
              \]
              \begin{figure}[H]
                \centering
                \begin{tikzpicture}[
                  every node/.style={node distance=0.9cm},
                  decoration={
                    markings,
                    mark=at position 0.5 with {\arrow{>}}
                  }
                  ] 
                  \coordinate (x) node[below,align=center] at (x) 
                    {\( x \)};
                  \fill (x) circle (0.05cm);

                  \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                    {\( x_1 \)};
                  \fill (x1) circle (0.05cm);

                  \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                    {\( x_2 \)};
                  \fill (x2) circle (0.05cm);

                  \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                    {\( x_3 \)};
                  \fill (x3) circle (0.05cm);

                  \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                    {\( x_4 \)};
                  \fill (x4) circle (0.05cm);

                  \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                    {\( x_5 \)};
                  \fill (x5) circle (0.05cm);

                  \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                    {\( x_6 \)};
                  \fill (x6) circle (0.05cm);

                  \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                    {\( x_7 \)};
                  \fill (x7) circle (0.05cm);

                  \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                    {\( x_8 \)};
                  \fill (x8) circle (0.05cm);

                  \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                    {\( x_9 \)};
                  \fill (x9) circle (0.05cm);

                  \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                    {\( x_{10} \)};
                  \fill (x10) circle (0.05cm);

                  \coordinate[right=of x10] (y) node[below,align=center] at (y)
                    {\( y \)};
                  \fill (y) circle (0.05cm);

                  \draw[postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[purple,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[purple,thick,postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[purple,thick,postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
                  \draw[purple,thick,postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[purple,thick,postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
                  \draw[purple,thick,postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[purple,thick,postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

                  \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -B \) } (x3);
                  \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -D \) } (x7);

                  \path (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( F \) } (x5);
                  \path[purple,thick] (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( G \) } (x8);

                  \path[purple,thick] (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                    node[above] {\( E \) } (x1);
                \end{tikzpicture}
              \end{figure}

            \item
              \[
                A_5^1 = ACE \quad \left( x_1,x_2,x_3,x_4,x_5,x_6,x_7,x_8,x_9,x_{10} \right) 
              \]
              \begin{figure}[H]
                \centering
                \begin{tikzpicture}[
                  every node/.style={node distance=0.9cm},
                  decoration={
                    markings,
                    mark=at position 0.5 with {\arrow{>}}
                  }
                  ] 
                  \coordinate (x) node[below,align=center] at (x) 
                    {\( x \)};
                  \fill (x) circle (0.05cm);

                  \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                    {\( x_1 \)};
                  \fill (x1) circle (0.05cm);

                  \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                    {\( x_2 \)};
                  \fill (x2) circle (0.05cm);

                  \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                    {\( x_3 \)};
                  \fill (x3) circle (0.05cm);

                  \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                    {\( x_4 \)};
                  \fill (x4) circle (0.05cm);

                  \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                    {\( x_5 \)};
                  \fill (x5) circle (0.05cm);

                  \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                    {\( x_6 \)};
                  \fill (x6) circle (0.05cm);

                  \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                    {\( x_7 \)};
                  \fill (x7) circle (0.05cm);

                  \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                    {\( x_8 \)};
                  \fill (x8) circle (0.05cm);

                  \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                    {\( x_9 \)};
                  \fill (x9) circle (0.05cm);

                  \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                    {\( x_{10} \)};
                  \fill (x10) circle (0.05cm);

                  \coordinate[right=of x10] (y) node[below,align=center] at (y)
                    {\( y \)};
                  \fill (y) circle (0.05cm);

                  \draw[postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[orange,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[orange,thick,postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[orange,thick,postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
                  \draw[orange,thick,postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[orange,thick,postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[orange,thick,postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[orange,thick,postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
                  \draw[orange,thick,postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[orange,thick,postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

                  \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -B \) } (x3);
                  \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -D \) } (x7);

                  \path (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( F \) } (x5);
                  \path (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( G \) } (x8);

                  \path[orange,thick,] (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                    node[above] {\( E \) } (x1);
                \end{tikzpicture}
              \end{figure}

            \item
              \[
                A_6^1 = AGE \quad \left( x_1,x_2,x_3,x_4,x_5,x_6,x_8,x_9,x_{10} \right) 
              \]
              \begin{figure}[H]
                \centering
                \begin{tikzpicture}[
                  every node/.style={node distance=0.9cm},
                  decoration={
                    markings,
                    mark=at position 0.5 with {\arrow{>}}
                  }
                  ] 
                  \coordinate (x) node[below,align=center] at (x) 
                    {\( x \)};
                  \fill (x) circle (0.05cm);

                  \coordinate[right=of x] (x1) node[below,align=center] at (x1) 
                    {\( x_1 \)};
                  \fill (x1) circle (0.05cm);

                  \coordinate[right=of x1] (x2) node[below,align=center] at (x2) 
                    {\( x_2 \)};
                  \fill (x2) circle (0.05cm);

                  \coordinate[right=of x2] (x3) node[above,align=center] at (x3) 
                    {\( x_3 \)};
                  \fill (x3) circle (0.05cm);

                  \coordinate[right=of x3] (x4) node[above,align=center] at (x4) 
                    {\( x_4 \)};
                  \fill (x4) circle (0.05cm);

                  \coordinate[right=of x4] (x5) node[below,align=center] at (x5) 
                    {\( x_5 \)};
                  \fill (x5) circle (0.05cm);

                  \coordinate[right=of x5] (x6) node[below,align=center] at (x6)
                    {\( x_6 \)};
                  \fill (x6) circle (0.05cm);

                  \coordinate[right=of x6] (x7) node[above,align=center] at (x7)
                    {\( x_7 \)};
                  \fill (x7) circle (0.05cm);

                  \coordinate[right=of x7] (x8) node[below,align=center] at (x8)
                    {\( x_8 \)};
                  \fill (x8) circle (0.05cm);

                  \coordinate[right=of x8] (x9) node[above,align=center] at (x9)
                    {\( x_9 \)};
                  \fill (x9) circle (0.05cm);

                  \coordinate[right=of x9] (x10) node[below,align=center] at (x10)
                    {\( x_{10} \)};
                  \fill (x10) circle (0.05cm);

                  \coordinate[right=of x10] (y) node[below,align=center] at (y)
                    {\( y \)};
                  \fill (y) circle (0.05cm);

                  \draw[postaction={decorate}] (x) -- (x1) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[red!10!purple,thick,postaction={decorate}] (x1) -- (x2) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x2) -- (x3) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x3) -- (x4) node[midway,above] {\( A \)};
                  \draw[postaction={decorate}] (x4) -- (x5) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[red!10!purple,thick,postaction={decorate}] (x5) -- (x6) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x6) -- (x7) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x7) -- (x8) node[midway,above] {\( C \)};
                  \draw[red!10!purple,thick,postaction={decorate}] (x8) -- (x9) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[red!10!purple,thick,postaction={decorate}] (x9) -- (x10) node[midway,above,scale=0.7] {\( 1 \)};
                  \draw[postaction={decorate}] (x10) -- (y) node[midway,above,scale=0.7] {\( 1 \)};

                  \path (x4) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -B \) } (x3);
                  \path (x9) edge [postaction={decorate},bend left=3cm,min distance=1cm]
                    node[below] {\( -D \) } (x7);

                  \path[red!10!purple,thick] (x2) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( F \) } (x5);
                  \path[red!10!purple,thick] (x6) edge [postaction={decorate},bend left=3cm,min distance=1.5cm]
                    node[above] {\( G \) } (x8);

                  \path[red!10!purple,thick] (x10) edge [postaction={decorate},bend right=3cm,min distance=3cm]
                    node[above] {\( E \) } (x1);
                \end{tikzpicture}
              \end{figure}
          \end{enumerate}

        \item Anelli di ordine 2:
          \begin{table}[H]
            \centering
            \bgroup
            \def\arraystretch{1.5}
            \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}
              \hline
              & Anelli & \( x_1 \) & \( x_2 \) & \( x_3 \) & \( x_4 \) & \( x_5 \) & \( x_6 \) & \( x_7 \) & \( x_8 \) & \( x_9 \) & \( x_{10} \) \\
              \hline
              \( A_1^1 \) & -AB & & &$\times$&$\times$& & & & & & \\ 
              \hline
              \( A_2^1 \) & -CD & & & & & & &$\times$&$\times$&$\times$& \\
              \hline
              \( A_3^1 \) & FCE &$\times$&$\times$& & &$\times$&$\times$&$\times$&$\times$&$\times$& \\
              \hline
              \( A_4^1 \) & FGE &$\times$&$\times$& & &$\times$&$\times$& &$\times$&$\times$&$\times$\\
              \hline
              \( A_5^1 \) & ACE &$\times$&$\times$&$\times$&$\times$&$\times$&$\times$&$\times$&$\times$&$\times$&$\times$\\
              \hline
              \( A_6^1 \) & AGE &$\times$&$\times$&$\times$&$\times$&$\times$&$\times$& &$\times$&$\times$&$\times$\\
              \hline
            \end{tabular}
            \egroup
          \end{table}
          Si controlla ogni arco con ogni altro arco (a 2 a 2) e si controlla se hanno
          nodi in comune. Se non hanno nodi in comune si moltiplicano i guadagni
          degli archi.
          \[
          A_1^2 = (-AB) \cdot (-CD) = ABCD
          \] 
          \[
          A_2^2 = (-AB) \cdot FCE = -ABCEF
          \] 
          \[
          A_3^2 = (-AB) \cdot FGE = -ABEFG
          \] 
          Ora si controlla a 3 a 3:

          Non esistono nodi di ordine 3, quindi non esistono triplette di archi che
          non si toccano.
      \end{itemize}

    \item Calcoliamo il discriminante:
      \[
        \begin{aligned}
          \Delta &= 1 - \left( A_1^1 + A_2^1 + A_3^1 + A_4^1 + A_5^1 + A_6^1 \right) +
                 \left( A_1^2 + A_2^2 + A_3^2 \right)\\
                 &= 1 - \left( -AB - CD + FCE + FGE + ACE + AGE \right) +\\
                 &\left( ABCD - ABCEF - ABEFG \right)\\
                 &= 1 + AB + CD - FCE - FGE - ACE - AGE + \\
                 &ABCD - ABCEF - ABEFG
        \end{aligned}
      \]
    \item Calcoliamo i discriminanti di tutti i percorsi:
      \[
        \begin{aligned}
          P_1 &= AC\\
          \Delta_1 &= 1 + \cancel{AB} + \cancel{CD} - \cancel{FCE} - \cancel{FGE} - \cancel{ACE} - \cancel{AGE} +\\
                  &\cancel{ABCD} - \cancel{ABCEF} - \cancel{ABEFG} = 1
        \end{aligned}
      \] 
      \[
        \begin{aligned}
          P_2 &= FC\\
          \Delta_2 &= 1 + AB + \cancel{CD} - \cancel{FCE} - \cancel{FGE} - \cancel{ACE} - \cancel{AGE} +\\
                  &\cancel{ABCD} - \cancel{ABCEF} - \cancel{ABEFG} = 1 + AB
        \end{aligned}
      \] 
      \[
        \begin{aligned}
          P_3 &= AG\\
          \Delta_3 &= 1 + \cancel{AB} + \cancel{CD} - \cancel{FCE} - \cancel{FGE} - \cancel{ACE} - \cancel{AGE} +\\
                  &\cancel{ABCD} - \cancel{ABCEF} - \cancel{ABEFG} = 1
        \end{aligned}
      \]
      \[
        \begin{aligned}
          P_4 &= FG\\
          \Delta_4 &= 1 + AB + \cancel{CD} - \cancel{FCE} - \cancel{FGE} - \cancel{ACE} - \cancel{AGE} +\\
                  &\cancel{ABCD} - \cancel{ABCEF} - \cancel{ABEFG} = 1 + AB
        \end{aligned}
      \]

    \item Calcoliamo la funzione di trasferimento:
      \[\scalebox{0.8}{
          $
            \begin{aligned}
              T &= \frac{\sum_i P_i \Delta_i}{\Delta}\\
                &= \frac{AC \cdot 1 + FC \cdot (1 + AB) + AG \cdot 1 + FG \cdot (1 + AB)}{1 + AB + CD - FCE - FGE - ACE - AGE + ABCD - ABCEF - ABEFG}\\
                &= \frac{AC + FC + FCAB + AG + FG + FGAB}{1 + AB + CD - FCE - FGE - ACE - AGE + ABCD - ABCEF - ABEFG}\\
            \end{aligned}
            $
      }
      \]
  \end{enumerate}
\end{example}

\section{Diagrammi di Bode}
Questo diagramma ci aiuta a capire il comportamento del sistema al variare della
frequenza del segnale di ingresso. In particolare ci permette di capire
come si comporta un sistema descritto da segnali
\textbf{sinusoidali}. 

\subsection{Motivo delle sinusoidi}
I sistemi descritti da segnali sinusoidali sono utili perchè
vedremo che qualsiasi segnale può essere rappresentato come una somma di sinusoidi.

\vspace{1em}
\noindent
Un sistema LTI causale permette le seguenti operazioni:
\begin{itemize}
  \item \( u(t) \cdot a \) 
  \item \( \frac{d u(t)}{t} \) 
  \item \( \int u(t) \,dt \) 
  \item \( u_1(t) + u_2(t) \) 
\end{itemize}
L'output del sistema è un onda scalata rispetto all'ampiezza o ritardata rispetto al
tempo.
\begin{example}
  \label{ex:lti-sin}
  Prendiamo ad esempio il seguente sistema:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      [
        every node/.style={node distance=0.5}
      ]
      \node (u) {\( u(t) \)};
      \coordinate[right=of u] (n1);
      \node[draw,minimum size=1cm,above right=of n1] (2) {2};
      \node[draw,minimum size=1cm,below right=of n1] (d) {\( \int dt \) };
      \node[draw,circle,minimum size=0.7cm,right=1.5cm of n1] (sum) {};
      \node[right=of sum] (v) {\( v(t) \)};

      \draw (u) -- (n1);
      \draw (n1) |- (2);
      \draw (n1) |- (d);
      \draw (d) -| (sum.south) node[below right,scale=0.8] {\( + \) };
      \draw (2) -| (sum.north) node[above right,scale=0.8] {\( + \) };
      \draw (sum) -- (v);
    \end{tikzpicture}
    \caption{Esempio di sistema}
  \end{figure}
  \[
  \begin{aligned}
    u(t) &= \sin\left(\frac{1}{2}t\right)\\
    \omega &= \frac{1}{2} \frac{rad}{s} \alpha Hz
  \end{aligned}
  \] 
  Calcoliamo l'ingresso:
  \[
  \begin{aligned}
    v(t) &= 2 \cdot u(t) + \int u(t) \,dt\\
         &= 2 \sin\left(\frac{1}{2}t\right) + \int \sin\left(\frac{1}{2}t\right) \,dt\\
         &= 2 \sin\left(\frac{1}{2}t\right) - 2 \cos\left(\frac{1}{2}t\right)
  \end{aligned}
  \] 
  Utilizziamo un'\textbf{identità trigonometrica}, cioè:
  \[
    \begin{aligned}
      \color{red}a \color{black} sin(x) + \color{red} b \color{black} cos(x) =\\
      = \sqrt{a^2 + b^2} \cdot \sin(x + \rho )
    \end{aligned}
  \] 
  dove: \( \rho = atan\left(\frac{b}{a}\right) \quad a \ge 0 \) 
  \[
  \begin{aligned}
    v(t) &= \overbrace{2}^{a} \sin\left(\overbrace{\frac{1}{2}t}^{x}\right) \overbrace{- 2}^{b} \cos(\frac{1}{2}t)\\
         &= \sqrt{2^2 + (-2)^2} \cdot  \sin\left(\frac{1}{2}t + atan\left(\frac{-2}{2}\right)\right)\\
         &= \sqrt{8} \cdot  \sin\left(\frac{1}{2}t + atan(-1)\right)\\
         &= 2.83 \cdot \sin\left(\frac{1}{2}t - 0.785\right)\\
         &= A \cdot \sin(\omega + \phi)
  \end{aligned}
  \] 
\end{example}

\subsection{Rappresentazione del diagramma di Bode}
Il diagramma di bode permette di rappresentare il comportamento di un sistema LTI formato 
da sinusoidi, di seguito guardiamo un diagramma semi-logaritmico 
(cioè con un asse lineare e uno logaritmico) che rappresenta l'ampiezza (grafico in alto)
e la fase (grafico in basso) di un sistema LTI:
\begin{figure}[H]
  \centering
  \BodeZPK[%
  group/scale=1.5,
  plot/mag/{transparent},
  plot/ph/{transparent},
  axes/mag/{ytick distance=40,ylabel={Ampiezza (dB)}},
  axes/ph/{ytick distance=90,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}},
  approx/asymptotic,
  commands/mag/{%
    \draw[red,thick] (axis cs:1,80) -- (axis cs:1,60) -- (axis cs:10,60)
    node[midway, below] {Decade} -- (axis cs:10,80);
  },
  ]{%
    z/{0,{-0.1,-0.5},{-0.1,0.5}},
    p/{{-0.5,-10},{-0.5,10}},
    k/10,%
  }
  {0.01}
  {100}
  \caption{Diagramma di Bode}
\end{figure}
\vspace{1em}
\noindent
\textbf{Osservazione}:

\noindent
  Il decibel \( dB \) è un unità di misura inventata nel 1920 per misurare quanto si
  disperde il segnale acustico su una transmission unit (\( 1TU = 10 \log_{10} \Delta_{\text{Potenza}} \)).
  Quindi un decibel è il minimo di potenza che un orecchio umano può percepire.
  \[
    \text{Potenza} = \text{Ampiezza}^2
  \] 
  \[
    1 bel = 1 TU = 10\log_{10} A^2 = 20 \log_{10} A
  \] 
  \[
    1 dB = \frac{1}{10} bel
  \] 

  \begin{example}
    Riprendiamo l'esempio \ref{ex:lti-sin}:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      [
        every node/.style={node distance=0.5}
      ]
      \node (u) {\( u(t) \)};
      \coordinate[right=of u] (n1);
      \node[draw,minimum size=1cm,above right=of n1] (2) {2};
      \node[draw,minimum size=1cm,below right=of n1] (d) {\( \int dt \) };
      \node[draw,circle,minimum size=0.7cm,right=1.5cm of n1] (sum) {};
      \node[right=of sum] (v) {\( v(t) \)};

      \draw (u) -- (n1);
      \draw (n1) |- (2);
      \draw (n1) |- (d);
      \draw (d) -| (sum.south) node[below right,scale=0.8] {\( + \) };
      \draw (2) -| (sum.north) node[above right,scale=0.8] {\( + \) };
      \draw (sum) -- (v);
    \end{tikzpicture}
    \caption{Esempio di sistema}
  \end{figure}

    \[
      \begin{aligned}
        u(t) &= \sin(\frac{1}{2}t) \quad \omega = \frac{1}{2}\\
        v(t) &= 2.83 \cdot \sin\left(\frac{1}{2}t - 0.785\right)\\
      \end{aligned}
    \] 
    Studiamo il sistema in frequenza:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        [
        every node/.style={node distance=0.5}
        ]
        \node (u) {\( U(t) \)};
        \coordinate[right=of u] (n1);
        \node[draw,minimum size=1cm,above right=of n1] (2) {2};
        \node[draw,minimum size=1cm,below right=of n1] (d) {\( \frac{1}{s} \) };
        \node[draw,circle,minimum size=0.7cm,right=1.5cm of n1] (sum) {};
        \node[right=of sum] (v) {\( V(t) \)};

        \draw (u) -- (n1);
        \draw (n1) |- (2);
        \draw (n1) |- (d);
        \draw (d) -| (sum.south) node[below right,scale=0.8] {\( + \) };
        \draw (2) -| (sum.north) node[above right,scale=0.8] {\( + \) };
        \draw (sum) -- (v);
      \end{tikzpicture}
    \end{figure}
    \[
      \begin{aligned}
        V(s) &= \left( 2 + \frac{1}{s} \right) U(s)\\
        \frac{V(s)}{U(s)} &= 2 + \frac{1}{s} = \frac{2s + 1}{s} \quad \text{Funzione di trasferimento del sistema}\\
      \end{aligned}
    \] 
    \( s \) è un numero complesso:
    \[
      s = \sigma + j \omega
    \] 
    Con la risposta in frequenza la \( s \) diventa \( s = j \omega \), quindi
    otteniamo:
    \[
      \begin{aligned}
        \frac{V(s)}{U(s)} &= \frac{2j\omega + 1}{j\omega}\\
                          &= \frac{2 \cancel{j \omega}}{\cancel{j \omega}} + \frac{1}{j \omega} \cdot \frac{j}{j}\\
                          &= 2 - \frac{1}{\omega} \cdot j\\
                          & \omega = \frac{1}{2}
      \end{aligned}
    \] 
    La rispsota del sistema nel piano dei complessi è:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \draw[->] (-1,0) -- (3,0) node[right] {\( \Re \)};
        \draw[->] (0,-3) -- (0,1) node[above] {\( \Im \)};

        \coordinate (o) at (2,-2) node[right] at (o) {\( \omega \) };
        \fill (o) circle (0.05cm);

        \draw[dashed] (o) -- (2,0) node[above] {2};
        \draw[dashed] (o) -- (0,-2) node[left] {-2};

        \draw[->,red,thick] (0,0) -- (o) node[midway,below] {l};
        \draw[green!50!black,thick] (1,0) arc (0:-45:1) node[midway,right] {\( \theta \)};
      \end{tikzpicture}
    \end{figure}
    dove:
    \[
      \begin{aligned}
        \text{Ampiezza} &= l = \sqrt{\Re^2 + \Im^2}\\ 
        \text{Fase} &= \theta = atan2\left( \Im, \Re \right)
      \end{aligned}
    \]
    \[
      atan2(\sigma ,j \omega) =
      \begin{cases}
        atan \left( \frac{\omega}{\sigma } \right) & \text{se } \sigma > 0,\;\; \omega \in \mathbb{R}\\
        segno(\omega) \cdot \frac{\pi}{2} & \text{se } \sigma = 0,\;\; \omega \neq 0\\
        atan \left( \frac{\omega}{\sigma } \right) + \pi \cdot segno(\omega) & \text{se } \sigma < 0,\;\; \text{ o } \sigma =0\;\; \omega \ge  0
      \end{cases}
    \] 
    Il diagramma di Bode sarà:
    \begin{figure}[H]
      \centering
      \BodeZPK[%
      group/scale=1.5,
      plot/mag/{blue,thick},
      plot/ph/{red,thick},
      axes/mag/{ytick distance=20,ylabel={Ampiezza (dB)}},
      axes/ph/{ytick distance=20,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}},
      ]{%
        z/{{-0.5}},
        p/{0},
        k/2,%
      }
      {0.001}
      {10}
      \caption{Diagramma di Bode}
    \end{figure}
  \end{example}
  
\subsubsection{Risposta in frequenza}
Si parte dal sistema con un input preciso:
\[
  \begin{aligned}
    u(t) = A e^{j \left( \omega_0 t + \phi \right) } = A e^{j \omega_0 t} e^{j \phi}
  \end{aligned}
\] 
dove:
\[
\begin{aligned}
  A \in \mathbb{R}_+\\
  \phi,\omega_0 \in \mathbb{R}
\end{aligned}
\] 
Questo input viene messo in un sistema BIBO stabile e riceviamo un output \( v(t) \).
Poi calcoliamo:
\[
\begin{aligned}
  H(j \omega) &= \int_{- \infty}^{+ \infty} h(\tau) e^{-j \omega \tau} \,d\tau\\
  \downarrow & s = j \omega_0\\
             &= \mathcal{L}\left[ h(t) \right](s) \Bigg|_{s = j \omega_0}
\end{aligned}
\] 
Se in input avessimo degli esponenziali o delle sinusoidali, l'output cambia solo
per un fattore di scala o di fase:
\begin{example}
  Se consideriamo un \textbf{fasore}:
  \[
    u(t) = A e^{j \phi} \cdot  e^{j \omega t}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node (u) {\( u(t) \) };
      \node[draw,minimum size=1cm,right=of u] (s) {\( h(t) \) };
      \node[right=of s] (v) {\( v(t) \) };

      \draw[->] (u) -- (s);
      \draw[->] (s) -- (v);
    \end{tikzpicture}
  \end{figure}
  \[
    \begin{aligned}
      v(t) &= \int_{- \infty}^{+ \infty} h(\tau) \cdot u(t - \tau) \,d\tau\\
           &= \int_{- \infty}^{+ \infty} h(\tau) \cdot A e^{j \phi} \cdot e^{j \omega (t - \tau)} \,d\tau\\
           &= A \cdot e^{j \phi} \cdot e^{j \omega t} \int_{- \infty}^{+ \infty} h(\tau) \cdot e^{-j \omega \tau} \,d\tau\\
           &= A \cdot e^{j \phi} \cdot e^{j \omega t} \cdot H(j \omega)\\
           &= A \cdot e^{j \phi} \cdot e^{j \omega t} \cdot A(\omega) e^{j \varphi (\omega)}\\
           &= A \cdot A(\omega) \cdot  e^{j \left( \phi + \varphi(\omega) \right) } \cdot e^{j \omega t}
    \end{aligned}
  \] 
  dove:
  \[
    \begin{aligned}
      A &= \text{Ampiezza di \( u(t) \)}\\
      A(\omega) &= \text{Ampiezza della risposta in frequenza}\\
      \phi &= \text{Fase di \( u(t) \)}\\
      \varphi(\omega) &= \text{Fase della risposta in frequenza}
    \end{aligned}
  \] 
  Notiamo che la frequenza di \( u(t) \), cioè \( \omega \), rimane invariata.
\end{example}

\subsection{Esempi}
\begin{example}
  Consideriamo l'esempio \ref{ex:lti-sin} nel dominio del tempo:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      [
        every node/.style={node distance=0.5}
      ]
      \node (u) {\( u(t) \)};
      \coordinate[right=of u] (n1);
      \node[draw,minimum size=1cm,above right=of n1] (2) {2};
      \node[draw,minimum size=1cm,below right=of n1] (d) {\( \int dt \) };
      \node[draw,circle,minimum size=0.7cm,right=1.5cm of n1] (sum) {};
      \node[right=of sum] (v) {\( v(t) \)};

      \draw (u) -- (n1);
      \draw (n1) |- (2);
      \draw (n1) |- (d);
      \draw (d) -| (sum.south) node[below right,scale=0.8] {\( + \) };
      \draw (2) -| (sum.north) node[above right,scale=0.8] {\( + \) };
      \draw (sum) -- (v);
    \end{tikzpicture}
    \caption{Esempio di sistema}
  \end{figure}
  \[
  \begin{aligned}
    u(t) &= \sin\left(\frac{1}{2}t\right)\\
    v(t) &= 2 \sin \left( \frac{1}{2}t \right) + \int \sin \left( \frac{1}{2}t \right) \,dt\\
         &= 2.83 \cdot \sin\left(\frac{1}{2}t - 0.785 rad\right)\\
  \end{aligned}
  \] 
  Possiamo andare a trasformare il sistema nel dominio delle frequenze:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      [
      every node/.style={node distance=0.5}
      ]
      \node (u) {\( U(t) \)};
      \coordinate[right=of u] (n1);
      \node[draw,minimum size=1cm,above right=of n1] (2) {2};
      \node[draw,minimum size=1cm,below right=of n1] (d) {\( \frac{1}{s} \) };
      \node[draw,circle,minimum size=0.7cm,right=1.5cm of n1] (sum) {};
      \node[right=of sum] (v) {\( V(t) \)};

      \draw (u) -- (n1);
      \draw (n1) |- (2);
      \draw (n1) |- (d);
      \draw (d) -| (sum.south) node[below right,scale=0.8] {\( + \) };
      \draw (2) -| (sum.north) node[above right,scale=0.8] {\( + \) };
      \draw (sum) -- (v);
    \end{tikzpicture}
  \end{figure}
  \[
  \begin{aligned}
    u(t) &= \sin \left( \frac{1}{2}t \right) \\
    s &= \cancel{\sigma } + j \omega = j \omega\\
    w &= \frac{1}{2} \frac{rad}{s} = \frac{1}{2} Hz
    \frac{V(t)}{U(t)} &= \frac{2s + 1}{s}\\
                      &= \frac{2 j \omega + 1}{j \omega}\\
                      &= \color{blue}2 \color{orange}- \frac{1}{\omega} j\\
                      &\omega = \frac{1}{2}
  \end{aligned}
  \] 
  Il grafico sul piano complesso sarà:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (-1,0) -- (3,0) node[right] {\( \Re \)};
      \draw[->] (0,-3) -- (0,1) node[above] {\( \Im \)};

      \coordinate (o) at (2,-2) node[right,orange] at (o) {\( \omega \) };
      \fill[orange] (o) circle (0.05cm);

      \draw[dashed,blue] (2,1) -- (2,-3);
      \node[blue,below right] at (2,0) {2};
      \node[left] at (0,-2) {-2};

      \draw[->,red,thick] (0,0) -- (o) node[midway,below] {l};
      \draw[green!50!black,thick] (1,0) arc (0:-45:1) node[midway,right] {\( \theta \)};
    \end{tikzpicture}
  \end{figure}
  Sappiamo che:
  \begin{itemize}
    \item L'ampiezza \( l \) vale:
      \[
        l =  \left| \sigma + j \omega \right| = \left| \sigma  \right| = \sqrt{\Re^2 + \Im^2} 
      \] 
    \item La fase \( \theta \) vale:
      \[
        \theta = arg(\sigma + j \omega) = atan2(\Im, \Re)
      \]
      \[
      arg(\sigma + j \omega) =
      \begin{cases}
        arctan\left( \frac{\omega}{\sigma } \right) & \sigma > 0\\
        \frac{\pi }{2} & \sigma  = 0,\;\; \omega > 0\\
        -\frac{\pi }{2} & \sigma  = 0,\;\; \omega < 0\\
        arctan\left( \frac{\omega}{\sigma } \right) + \pi & \sigma < 0,\;\; \omega \ge 0\\
        arctan\left( \frac{\omega}{\sigma } \right) - \pi & \sigma < 0,\;\; \omega < 0
      \end{cases}
      \] 
      \[
        segno(\alpha) = \frac{\alpha}{|\alpha|} = \begin{cases}
          1 & \text{ se } \alpha > 0\\
          0 & \text{ altrimenti}
        \end{cases}
      \] 
      \[
      arg(\sigma + j \omega) =
      \begin{cases}
        arctan\left( \frac{\omega}{\sigma } \right) & \sigma > 0\\
        segno(\omega) \cdot \frac{\pi}{2} & \sigma = 0,\;\; \omega \neq 0\\
        arctan\left( \frac{\omega}{\sigma } \right) + \pi \cdot segno(\omega) & \sigma < 0\\
      \end{cases}
      \] 
  \end{itemize}
  Se volessimo disegnare il grafico del punto trovato sul grafico dei complessi
  esso diventa:
  \begin{figure}[H]
    \centering
    \BodeZPK[%
    group/scale=1.5,
    plot/mag/{transparent},
    plot/ph/{transparent},
    axes/mag/{ytick distance=20,ylabel={Ampiezza (dB)}},
    axes/ph/{ytick distance=45,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}},
    commands/mag/{\node at (axis cs: 0.5,8.828427125) [circle,fill,blue,inner sep=0.05cm,
    label=above:{$\omega = \frac{1}{2}, A = 2$}]{};},
    commands/ph/{\node at (axis cs: 0.5,-45) [circle,fill,red,inner sep=0.05cm,
    label=above:{$\omega = \frac{1}{2}, \phi = -45$}]{};}
    ]{%
      z/{{-0.5}},
      p/{0},
      k/2,%
    }
    {0.001}
    {10}
    \caption{Singolo punto nel diagramma di Bode}
  \end{figure}
  \noindent
  Se il nostro punto andasse più in basso, cioè \( w \) diventa più piccolo, allora
  la fase diventa più piccola fino a \( -90 \) gradi. Se invece il punto va più in alto, cioè \( w \) diventa
  più grande, allora la fase diventa più grande fino a \( 0 \) gradi.

  \vspace{1em}
  \noindent
  Per ogni frequenza \( w \) abbiamo un'ampiezza e una fase diversa e si vuole
  rappresentare questo grafico in un diagramma di Bode:
  \begin{figure}[H]
    \centering
    \BodeZPK[%
    group/scale=1.5,
    plot/mag/{blue,thick},
    plot/ph/{red,thick},
    axes/mag/{ytick distance=20,ylabel={Ampiezza (dB)}},
    axes/ph/{ytick distance=45,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}},
    commands/mag/{\node at (axis cs: 0.5,8.828427125) [circle,fill,blue,inner sep=0.05cm]{};},
    commands/ph/{\node at (axis cs: 0.5,-45) [circle,fill,red,inner sep=0.05cm]{};}
    ]{%
      z/{{-0.5}},
      p/{0},
      k/2,%
    }
    {0.001}
    {10}
    \caption{Diagramma di Bode}
  \end{figure}
\end{example}

\subsubsection{Operazioni tra numeri complessi}
Siano \( a,b \in \mathbb{C} \) 
\begin{enumerate}
  \item \( \left| a \cdot b \right| = |a| \cdot |b| \) 
    \[
    arg(a \cdot b) = arg(a) + arg(b)
    \] 
  \item \( \left| \frac{a}{b} \right| = \frac{|a|}{|b|} \) 
    \[
    arg\left( \frac{a}{b} \right) = arg(a) - arg(b)
    \]
  \item \( \left| a^{\mu} \right| = |a|^{\mu} \) 
    \[
    arg(a^{\mu}) = \mu \cdot arg(a)
    \]
\end{enumerate}

\subsubsection{Logaritmo di un numero complesso}
Il logaritmo di un numero complesso \( s \) è quel numero \( x \in \mathbb{C} \) 
tale che:
\[
  \ln(s) = x \iff s = e^x
\] 
Se scriviamo \( s \) come:
\[
  s = \rho e^{j \theta}
\] 
e \( x \) in forma polare:
\[
x = \sigma + j \omega
\] 
Abbiamo che:
\[
  \begin{aligned}
    s = e^x \to \rho e^{j \theta} &= e^{\sigma + j \omega}\\
    e^{\ln(\rho)} \cdot e^{j \theta} &= e^{\sigma} \cdot e^{j \omega}\\
  \end{aligned}
\] 
Da questo otteniamo:
\[
\begin{aligned}
  \ln(\rho) &= \sigma\\
  \theta &= \omega
\end{aligned}
\] 
Quindi:
\[
\begin{aligned}
  \ln(s) &= x\\
         &= \ln(\rho) + j \theta\\
         &= \ln \left| s \right| + j \cdot arg(s)
\end{aligned}
\] 

\subsection{Forma di Bode}
Sappiamo che la funzione di trasferimento è calcolata come il rapporto tra
il polinomio caratteristico dell'ingresso e il polinomio caratteristico dell'uscita:
\[
  \begin{aligned}
    H(s) &= \frac{\sum_j b_j s^j}{\sum_i a_i s^i} \cdot U(s)\\
         &= k \cdot \frac{
           \left( s - z_1 \right)^{\mu_1} \cdot \left( s - z_2 \right)^{\mu_2} \cdot \ldots \cdot \left( s - z_l \right)^{\mu_l}
         }{
           \left( s - p_1 \right)^{\nu_1} \cdot \left( s - p_2 \right)^{\nu_2} \cdot \ldots \cdot \left( s - p_r \right)^{\nu_r}
         }\\
         &= \text{Costante} \cdot \frac{
           \text{Zeri di \( H(s) \), radici del numeratore}
         }{
           \text{Poli di \( H(s) \), radici del denominatore}
         }
  \end{aligned}
\] 
dove:
\[
\begin{aligned}
  \mu_i = \text{molteplicità degli zeri}\\
  \nu_i = \text{molteplicità dei poli}\\
  l \le m, \quad \mu_1 + \mu_2 + \ldots + \mu_l = m\\
  r \le n, \quad \nu_1 + \nu_2 + \ldots + \nu_r = n\\
\end{aligned}
\] 
Da questa funzione di trasferimento vogliamo trovare la \textbf{forma di Bode}.
Riscriviamo la funzione di trasferimento come:
\[
  \resizebox{1\hsize}{!}{
    $
\begin{aligned}
  H(s) &= k_b \cdot \frac{
    \prod_i \left( 1 + s \tau'_i \right)^{\mu'_i} \cdot \prod_k \left( 1 + 2 \zeta'_k
    \frac{s}{\omega'_{n,k}} + \frac{s^2}{\left( \omega'_{n,k} \right) ^2} \right)^{\mu'_k}
  }{
    \left( s^{\nu_i} \right) \prod_i \left( 1 + s \tau_i \right)^{\mu_i} \cdot
    \prod_k \left( 1 + 2 \zeta_k \frac{s}{\omega_{n,k}} + \frac{s^2}{\left( \omega_{n,k} \right)^2} \right)^{\mu_k}
  }
\end{aligned}
$
}
\] 
Questa è detta \textbf{forma di Bode}, dove:
\begin{itemize}
  \item \( k_b \): È il termine costante chiamato \textbf{Guadagno di Bode}
  \item \( s^{\nu} \): Raggruppa tutte le radici nulle:
    \[
      \frac{s^s}{s^n} = \frac{1}{s^{-1}}
    \] 
  \item \( \left( 1 + s\tau_i \right)^{\mu_i} \): Raggruppa la singola radice reale:
    \[
    \left( s + 1 \right) 
    \] 
  \item \( \left( 1 + 2 \zeta_k \frac{s}{\omega_{n,k}} + \frac{s^2}{\left( \omega_{n,k} \right)^2} \right)^{\mu_k} \):
    Raggruppa la singola radice complessa coniugata
  \item \( \tau \): Costante di tempo
\end{itemize}

\vspace{1em}
\noindent
Per arrivare alla forma di Bode bisogna raccogliere tutte le "costanti":
\begin{enumerate}
  \item Poli e zeri nulli:
    \[
      \begin{aligned}
        H(s) &= 4 \frac{
          s^3 + s^2 - 2s
        }{
          s^3 + s^4
        }\\
        &= 4 \frac{
          \color{blue}s\color{black} \left( s^2 + s - 2 \right) 
        }{
          \color{blue}s^2\color{black} \left( s + 1 \right) 
        } \quad \color{blue} \text{nulli}\\
        &= 4 \color{red}\underbrace{\frac{1}{s}}_{\text{Forma di Bode}}\color{black} \cdot \frac{
          s^2 + s - 2
        }{
          s+1
        }
      \end{aligned}
    \] 
    La \color{red} forma di Bode \color{black} è:
    \[
      \frac{1}{s^{\nu}}
    \]
  \item Poli e zeri reali
    \[
    \begin{aligned}
      H(s) &= 4 \cdot \frac{1}{s} \cdot \frac{
        s^2+s-2
      }{s+1}
    \end{aligned}
    \] 
    \[
    \Delta = b^2 - 4ac = 1 - 4 \cdot 1 \cdot -2 = 9 > 0 \;\; \surd
    \] 
    \[
      \begin{aligned}
        H(s) &= 4 \cdot \frac{1}{s} \cdot \frac{
          s^2+s-2
        }{s+1}\\
             &= 4 \cdot \frac{1}{s} \cdot \frac{
               (s-1)(s+2)
             }{
               s+1
             }\\
           &= 4 \cdot \frac{1}{s} \cdot \frac{
             (-1)(1-s) \cdot (+2)(1+\frac{s}{2})
           }{
             (1)(1+s)
           } \\
           &= \frac{
             4 \cdot (-1) \cdot (2)
           }{(1)}
           \cdot \frac{1}{s}
           \cdot \frac{
             (1-s)(1+\frac{s}{2})
           }{
             (1+s)
           }\\
           &= -8 \cdot \frac{1}{s} \cdot \frac{
             (1-s)(1+\frac{s}{2})
           }{(1+s)}
         \end{aligned}
    \] 
    Siamo arrivati ad una forma di Bode:
    \[
      k_b \cdot \frac{1}{s^{\nu}} \cdot \frac{
        \left( 1 + s \tau'_1 \right)^{\mu'_1} \left( 1 + s \tau'_2 \right)^{\mu'_2}
      }{
        \left( 1 + s\tau_1 \right)^{\mu_1}
      }
    \] 
    dove:
    \[
    \begin{aligned}
      k_b = -8\\
      \frac{1}{s^{\nu}} = \text{Zero nullo}\\
      \tau'_1 = -1\\
      \tau'_2 = \frac{1}{2}\\
      \tau_1 = 1
    \end{aligned}
    \] 

  \item Poli e zeri complessi coniugati
    \[
      \begin{aligned}
        z = \sigma + j \omega\\
        \bar{z} = \sigma - j \omega
      \end{aligned}
    \] 
    Abbiamo che:
    \[
      \begin{aligned}
    &\left( s - \left( \sigma  + j \omega \right)^{\mu} \right) \cdot \left( s - \left( \sigma - j \omega \right) \right)\\
    &= \left( s^2 - s \sigma  + s j \omega - s \sigma - s j \omega + |z|^2 \right)^{\mu}\\
    &= \left( s^2 - 2 s \sigma + |z|^2 \right)^{\mu}\\
    &= |z|^{2 \mu} \left( 1 - 2 \frac{\sigma }{|z|^2}s + \frac{s^2}{|z|^2} \right)^{\mu}\\
    &= |z|^{2 \mu} \left( 1 - 2 \zeta \frac{s}{\omega_n} + \frac{s^2}{\omega_n^2} \right)^{\mu}
      \end{aligned}
    \] 
    Dove:
    \[
      \begin{aligned}
        \zeta -\frac{\sigma }{|z|} &= \frac{-\Re(z)}{|z|} = \text{Coefficiente di smorzamento}\\
        \omega_n &= |z| = \text{Pulsazione naturale}
      \end{aligned}
    \] 
    \begin{example}
      Prendiamo ad esempio il sistema:
      \[
      \left( s - \left( 2 + j \right)\right)^2 \left( s - \left( 2 - j \right) \right)^2
      \] 
      Calcoliamo la forma di Bode:
      \[
      \begin{aligned}
      &\left( s - \left( 2 + j \right)\right)^2 \left( s - \left( 2 - j \right) \right)^2\\
      &= \left( s^2 - 2s + s j - 2 s - s j + |2+j|^2 \right)^2\\
      &= \left( s^2 - 4s + 5 \right)^2\\
      &= 5 \left( 1 - \frac{4}{5}s + \frac{s^2}{5} \right) \cdot 5 \left( 1 - \frac{4}{5}s + \frac{s^2}{5} \right)\\
      &= (5)^2 \left( 1 - \frac{4}{5}s + \frac{s^2}{5} \right)^2\\
      \end{aligned}
      \] 
      Dobbiamo trovare \( \omega_n \):
      \[
      \begin{aligned}
        \omega_n &= \sqrt{\omega_n^2} = \sqrt{5}\\
      \end{aligned}
      \] 
      La formula diventa:
      \[
        5^2 \left( 1 - \frac{4}{\sqrt{5}}s + \frac{s^2}{\left( \sqrt{5}  \right)^2} \right)^2
      \] 
      Dobbiamo trovare \( \zeta \):
      \[
      \begin{aligned}
        \frac{2 \zeta}{\omega_n} &= -\frac{4}{\sqrt{5}}\\
        \frac{2 \zeta}{\cancel{\sqrt{5}}} &= -\frac{4}{\cancel{\sqrt{5}}}\\
        \zeta &= -\frac{\stackrel{2}{\cancel{4}}}{\sqrt{5} } \cdot \frac{1}{\cancel{2}} =
        -\frac{2}{\sqrt{5} }
      \end{aligned}
    \]
    La formula diventa:
    \[
      5^2 \left( 1 + 2 \underbrace{\left( -\frac{2}{\sqrt{5} } \right)}_{\zeta} \frac{s}{\underbrace{\sqrt{5}}_{\omega_n} } + \frac{s^2}{\underbrace{\left( \sqrt{5}  \right)^2}_{\omega_n^2}}  \right) 
    \] 
    \end{example}
    \begin{example}
      Prendiamo in considerazione un trinomio:
      \[
      5 \left( 1 - \frac{2}{5}s + \frac{3}{5}s^2 \right) 
      \] 
      Troviamo \( \omega_n \) e \( \zeta \):
      \[
      \begin{aligned}
        \omega_n &= \sqrt{\frac{5}{3}}\\
        \frac{2 \zeta}{\omega_n} &= -\frac{2}{5}\\
        \zeta &= - \frac{1}{5 \omega_n} = -\frac{1}{\sqrt{15} }
      \end{aligned}
      \] 
      La formula diventa:
      \[
        5 \left( 1 + 2 \left( -\frac{1}{\sqrt{15} } \right) \frac{s}{\sqrt{\frac{5}{3}}} + \frac{s^2}{\left( \sqrt{\frac{5}{3}} \right)^2} \right)
      \] 

      \textbf{Attenzione:}

      \noindent
      \textbf{Non tutti i trinomi sono complessi coniugati}
    \end{example}
\end{enumerate}

\vspace{1em}
\noindent
Quello che si vuole fare una volta trovata la forma di bode è quella di 
trasformare tutto in frequenza:
\[
H(s) \to H(j \omega)
\] 
Quindi la forma di Bode in frequenza diventa:
\[
  \resizebox{1\hsize}{!}{
    $
  H(jw) = k_b \frac{
    \prod_i \left( 1 + j \omega \tau'_i \right)^{\mu'_i} \cdot \prod_k \left( 1 + j2 \zeta'_k
    \frac{\omega}{\omega'_{n,k}} \color{red}-\color{black} \frac{\omega^2}{\left( \omega'_{n,k} \right) ^2} \right)^{\mu'_k}
  }{
    \left( j \omega \right)^{\nu} \prod_i \left( 1 + j \omega \tau_i \right)^{\mu_i} \cdot
    \prod_k \left( 1 + j2 \zeta_k \frac{\omega}{\omega_{n,k}} \color{red}-\color{black} \frac{\omega^2}{\left( \omega_{n,k} \right)^2} \right)^{\mu_k}
  }
$}
\] 
\begin{example}
  Vogliamo portare in forma di bode la seguente funzione di trasferimento:
  \[
    \begin{aligned}
      H(s) &= \frac{
        s^3 - 2s^2 - 8s
      }{
        s^4 - 2s^3 + 2s^2
      }\\
      &= \frac{
        \cancel{s} \left( s^2 - 2s - 8 \right)
      }{
        s^{\cancel{2}} \left( s^2 - 2s + 2 \right)
      }\\
      &= \frac{
        s^2 - 2s - 8
      }{
        s \left( s^2 - 2s + 2 \right)
      }
    \end{aligned}
  \] 
  Il delta del numeratore è:
  \[
  \Delta = b^2 - 4ac = 4 - 4 \cdot 1 \cdot -8 = 36 > 0
  \] 
  È maggiore di 0, quindi si può semplificare.

  Il delta del denominatore è:
  \[
  \Delta = b^2 - 4ac = 4 - 4 \cdot 1 \cdot 2 = -4 < 0
  \]
  È minore di 0, quindi non si può semplificare.

  \[
  \begin{aligned}
      &= \frac{
        s^2 - 2s - 8
      }{
        s \left( s^2 - 2s + 2 \right)
      }\\
      &= \frac{
        \left( s-4 \right) \left( s+2 \right)
      }{
        s \left( s^2 - 2s + 2 \right)
      }\\
      &= \frac{
        (-4) \left( 1 - \frac{s}{4} \right) \cdot (2) \left( 1 + \frac{s}{2} \right)
      }{
        s \cdot (2) \left( 1 - s + \frac{s^2}{2} \right) 
      }\\
      &= -4 \cdot \frac{1}{s} \cdot \frac{
        \left( 1 - \frac{s}{4} \right) \left( 1 + \frac{s}{2} \right)
      }{
        \left( 1 - s + \frac{s^2}{2} \right)
      }
  \end{aligned}
  \] 
  Questa è la forma di Bode.

  \vspace{1em}
  \noindent
  Ora vogliamo trovare tutte le costanti:
  \[
    \begin{aligned}
      \left( 1 - \frac{s}{4} \right) &\to \tau_1 = -\frac{1}{4}\\
      \left( 1 + \frac{s}{2} \right) &\to \tau_2 = \frac{1}{2}\\
      \left( 1 - s + \frac{s^2}{2} \right) &\to \omega_n^2 = 2 \to \omega_n = \sqrt{2}\\
      \frac{2 \zeta}{\omega_n} = -1 \to \frac{2 \zeta}{\sqrt{2} }= -1 &\to \zeta = \frac{-1 \cdot \sqrt{2} }{2} = - \frac{\sqrt{2} }{2}
    \end{aligned}
  \] 
\end{example}

\begin{example}
  Prendiamo ad esempio la funzione di trasferimento:
  \[
  \begin{aligned}
    H(s) &= \frac{
      5 \cdot  \left( s ^2 - 5s + 2s \right) 
    }{
      s ^2 \cdot \left( s + 3 \right) ^2
    }\\
    &= \frac{
      5 \cdot 2s \left( \frac{s ^2}{2s} - \frac{5}{2s}s + 1 \right) 
    }{
      9 \cdot s ^2 \left( \frac{s}{3} + 1 \right) ^2
    }\\
    &= \frac{12s}{9} \cdot \frac{
      \left( 1 - \frac{1}{5}s + \frac{s ^2}{2s} \right) 
    }{
      s ^2 \left( 1 + \frac{s}{3} \right) ^2
    }
  \end{aligned}
  \] 
  Si arriva ad una forma del tipo:
  \[
    k_b \cdot \frac{\text{Radici}}{\text{Radici}}
  \] 
  Si raccolgono tutte le costanti per arrivare alla forma di Bode.

  \vspace{1em}
  \noindent
\end{example}

\subsection{Disegno del diagramma di Bode}
Ci sono 4 possibili diagrammi di Bode:
\begin{enumerate}
  \item Termine costante \( k_b \) 
  \item Uno zero o un polo nullo \( s^{\mu} \) dove \( \mu \) è la molteplicità
  \item Uno zero o un polo reale \( \left( 1 + \tau s \right)^{\mu} \)
    dove \( \tau \) è la costante di tempo
  \item Uno zero o un polo complesso coniugato \( \left( 1 + 2 \zeta \frac{s}{\omega_n} + \frac{s^2}{\omega_n^2} \right)^{\mu} \)
    dove \( \zeta \) è il coefficiente di smorzamento e \( \omega_n \) è la pulsazione naturale
\end{enumerate}

\subsubsection{Termine costante}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {\( \Re \)};
    \draw[->] (0,-0.5) -- (0,1.5) node[above] {\( \Im \)};

    \fill[blue] (1,0) circle (0.05cm) node[below] {\( k_b \) };
    \fill[red] (-1,0) circle (0.05cm) node[below] {\( -k_b \) };

    \draw[->,green!50!black] (1,0) arc (0:180:1);
    \node[above right,green!50!black,scale=0.8] at (1,0) {\( 0\degree \)};
    \node[above left,green!50!black,scale=0.8] at (-1,0) {\( 180\degree \)};
  \end{tikzpicture}
\end{figure}
\noindent
\begin{definition}
  Si calcola l'ampiezza:
  \[
    A = \left| H(j \omega) \right| = \left| k_b \right| = k_b
  \] 
  \[
    A(\omega) = 20 \log_{10} \left( |k_b| \right)
  \] 
  E la fase:
  \[
    \phi = atan2\left( \sigma + j \omega \right) = 
    \begin{cases}
      0\degree & \text{se } k_b > 0\\
      -180\degree & \text{se } k_b < 0
    \end{cases}
  \] 
  \[
    \phi(\omega) = 
    \begin{cases}
      0\degree & \text{se } k_b > 0\\
      -180\degree & \text{se } k_b < 0
    \end{cases}
  \] 
\end{definition}

\vspace{1em}
\noindent
Se prendiamo \(\color{blue} k_b = 10 \) avremo:
\[
\begin{aligned}
  A(\omega) &= 20 \log_{10} \left( 10 \right) = 20 \cdot 1 = 20\\
  \phi(\omega) &= 0\degree
\end{aligned}
\] 

\noindent
Se prendiamo \( \color{red} k_b = -10 \) avremo:
\[
\begin{aligned}
  A(\omega) &= 20 \log_{10} \left( 10 \right) = 20 \cdot 1 = 20\\
  \phi(\omega) &= -180\degree\\
\end{aligned}
\] 
\begin{figure}[H]
  \centering
  % Magnitude
  \begin{BodeMagPlot}[scale=1.5,ytick distance=20,ymin=-40,ymax=40,ylabel={Ampiezza (dB)},xlabel={}] {0.01} {100}
    \node[above right,blue] at (axis cs: 0.01,20) {\( k_b = 10 \) };
    \node[below right,red] at (axis cs: 0.01,20) {\( k_b = -10 \) };
    % kb = 10
    \addBodeZPKPlots[%
    true/{blue,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {magnitude}
    {
      k/10
    }

    % kb = -10
    \addBodeZPKPlots[%
    true/{red,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {magnitude}
    {
      k/-10
    }
  \end{BodeMagPlot}

  % Phase
  \begin{BodePhPlot}[scale=1.5,ytick distance=90,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}] {0.01} {100}
    % kb = 10
    \addBodeZPKPlots[%
    true/{blue,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {phase}
    {
      k/10
    }

    % kb = -10
    \addBodeZPKPlots[%
    true/{red,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {phase}
    {
      k/-10
    }
  \end{BodePhPlot}
  \caption{Diagramma con \( \color{blue}k_b = 10 \) e \( \color{red}k_b = -10 \) }
\end{figure}

\subsubsection{Zero o polo nullo}
\[
  H(s) = H(j \omega) \to  \left( j \omega \right)^{\mu}
\] 
dove:
\[
  \mu \in \mathbb{Z}, \;\; \mu > 0 \text{ per gli zeri},\;\; \mu < 0 \text{ per i poli} 
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {\( \Re \)};
    \draw[->] (0,-2) -- (0,2) node[above] {\( \Im \)};

    \fill[blue] (0,1) circle (0.05cm);
    \fill[red] (0,-1) circle (0.05cm);

    \draw[<-,green!50!black] (0,-1) arc (270:90:1);
    \draw[<-,green!50!black] (0,1) arc (90:-90:1);
  \end{tikzpicture}
\end{figure}
\noindent
\begin{definition}
  \[
    \left| H(j \omega) \right| = \left| \left( j \omega \right)^{\mu} \right| = \left| \omega \right|^{\mu} = \omega^{\mu}
  \] 
  \[
    \begin{aligned}
      A(\omega) &= \left| H(j \omega) \right|_{dB}\\
                &= 20 \log_{10} \left( \omega^{\mu} \right)\\
                &= 20 \mu \log_{10} \left( \omega \right)
    \end{aligned}
  \] 
  È una retta che passa per \( \left( 10^0,0 \right) \) e cresce (o decresce) di
  \( 20 \mu \) dB/decade.

  \noindent
  La fase:
  \[
    \phi(\omega) = atan2\left( j \omega \right)^{\mu} = \mu \cdot atan2\left( j \omega \right) = \mu \cdot 90\degree
  \] 
  È una retta costante.
\end{definition}


\vspace{1em}
\noindent
Consideriamo i seguenti zeri (\( s^1 \) ) e poli (\( s^{-1} \) ) di \( H(s) \) 
\begin{table}[H]
  \centering
  \begin{tabular}{c|c|c|c}
    \( \omega \) & \( \color{blue}s^1 \) & \(\color{red} s^{-1} \) & \(\color{green!50!black} s^{-2} \)  \\
    \hline
    \( 10^{-2} \) & -40 & 40 & 80\\
    \( 10^{-1} \) & -20 & 20 & 40\\
    \( 10^0 \) & 0 & 0 & 0\\
    \( 10^1 \) & 20 & -20 & -40\\
    \( 10^2 \) & 40 & -40 & -80\\
  \end{tabular}
\end{table}
\begin{figure}[H]
  \centering
  % Magnitude
  \begin{BodeMagPlot}[scale=1.5,ytick distance=40,ylabel={Ampiezza (dB)},xlabel={}] {0.01} {100}
    % s^1
    \node[below right,blue,scale=0.8] at (axis cs: 0.01,-40) {\( 20 \frac{dB}{dec}\) };
    \addBodeZPKPlots[%
    true/{blue,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {magnitude}
    {
      z/0
    }

    % s^{-1}
    \node[below right=0.2cm,red,scale=0.8] at (axis cs: 0.01,40) {\( 20 \frac{dB}{dec}\) };
    \addBodeZPKPlots[%
    true/{red,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {magnitude}
    {
      p/0
    }

    % s^{-2}
    \node[right=0.3cm,green!50!black,scale=0.8] at (axis cs: 0.01,80) {\( 40 \frac{dB}{dec}\) };
    \addBodeZPKPlots[%
    true/{green!50!black,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {magnitude}
    {
      p/0,
      p/0
    }
  \end{BodeMagPlot}

  % Phase
  \begin{BodePhPlot}[scale=1.5,ytick distance=90,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}] {0.01} {100}
    % s^0
    \addBodeZPKPlots[%
    true/{blue,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {phase}
    {
      z/0
    }

    % s^{-1}
    \addBodeZPKPlots[%
    true/{red,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {phase}
    {
      p/0
    }

    % s^{-2}
    \addBodeZPKPlots[%
    true/{green!50!black,thick},
    linear/{transparent},
    asymptotic/{transparent}]
    {phase}
    {
      p/0,
      p/0
    }
  \end{BodePhPlot}
  \caption{Diagramma di Bode con \( \color{blue}s^1 \), \( \color{red}s^{-1} \) e \( \color{green!50!black}s^{-2} \) }
\end{figure}

\subsubsection{Zero o polo reale}
\[
  H(s) \to \left( 1 + \tau s \right)^{\mu}
\]
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {\( \Re \)};
    \draw[->] (0,-2) -- (0,2) node[above] {\( \Im \)};

    \fill[blue] (-1,0) circle (0.05cm) node[below] {s};
    \fill[red] (1,0) circle (0.05cm) node[below] {s};
  \end{tikzpicture}
\end{figure}
Abbiamo che un polo si può scrivere come:
\[
\frac{1}{1 + \frac{s}{\omega_0}} = \frac{1}{1 + \tau s}
\] 
con:
\[
\omega_0 = \frac{1}{|\tau|}
\] 
Quindi il polo in \( j \omega \) si può scrivere come:
\[
  \begin{aligned}
    &\frac{1}{1 + \frac{j \omega}{w_0}}\cdot \frac{1 - \frac{j \omega}{\omega_0}}{1 - \frac{j \omega}{\omega_0}}\\
    &= \frac{1 - \frac{j \omega}{\omega_0}}{1 + \frac{\omega^2}{\omega_0^2}}
  \end{aligned}
\] 
La parte reale e immaginaria sono rispettivamente:
\[
\begin{aligned}
  \Re &= \frac{1}{1 + \frac{\omega^2}{\omega_0^2}}\\
  \Im &= \frac{-\frac{\omega}{\omega_0}j}{1 + \frac{\omega^2}{\omega_0^2}}
\end{aligned}
\] 

\begin{definition}
  L'ampiezza e la fase sono:
  \[
    \begin{aligned}
      A(\omega) &= 20 \log_{10} \left( \sqrt{\Re^2 + \Im^2} \right)\\
      \phi(\omega) &= atan2\left( \Re, \Im \right)
    \end{aligned}
  \] 
  \[
    \downarrow
  \] 
  \[
    \begin{aligned}
      A(\omega) &= -20 \log_{10} \left( \sqrt{1 + \frac{\omega^2}{\omega_0}} \right)\\
      \phi(\omega) &= atan2\left( -\frac{\omega}{\omega_0} \right)
    \end{aligned}
  \] 
\end{definition}

\vspace{1em}
\noindent
Se consideriamo le seguenti omega:
\begin{itemize}
  \item \( \omega \ll \omega_0 \)
    \[
      \begin{aligned}
        A(\omega) &= -20 \log_{10} \left( \sqrt{1} \right) = 0\\
        \phi(\omega) &= atan2\left( 0 \right) = 0
      \end{aligned}
    \] 
    \item \( \omega = \omega_0 \) 
      \[
        \begin{aligned}
          A(\omega) &= -20 \log_{10} \left( \sqrt{2} \right) = -3dB\\
          \phi(\omega) &= atan2\left( -1 \right) = -45\degree
        \end{aligned}
      \] 

    \item \( \omega \gg \omega_0 \) 
      \[
        \begin{aligned}
          A(\omega) &= -20 \log_{10} \left( \sqrt{\frac{\omega^2}{\omega_0^2}} \right) =
          -20 \frac{dB}{decade}\\
          \phi(\omega) &= atan2\left( -\infty \right) \approx -90\degree
        \end{aligned}
      \]
\end{itemize}
Consideriamo un polo di \( H(s) \) 
\[
  \color{blue} \left( 1 + \frac{s}{10} \right)^{-1}
\] 
Calcoliamo \( \omega_0 \):
\[
  \omega_0 = \frac{1}{|\tau|}
\] 
\[
  \tau = \frac{1}{10} \to \omega_0 = 10
\] 
Prima di \( \omega_0 \) la funzione è nulla e successivamente cresce o decresce di
20 dB/decade.
\begin{figure}[H]
  \centering
  % Magnitude
  \begin{BodeMagPlot}[scale=1.5,ytick distance=20,ylabel={Ampiezza (dB)},xlabel={}] {0.01} {10000}
    \addBodeZPKPlots[%
    true/{green!50!black,thick},
    linear/{blue,thick},
    asymptotic/{transparent}]
    {magnitude}
    {
      p/-10
    }

    \node[green!50!black,scale=0.8,align=center] at (axis cs: 9,-40)
    {Comportamento\\reale};
    \node[above=0.5cm,blue,scale=0.8,align=center] at (axis cs: 1000,-60)
    {Comportamento\\asintotico};

    \draw[purple,dashed] (axis cs: 10,0) -- (axis cs: 10,-85) node[above right] {\( \omega_0 \)};
  \end{BodeMagPlot}

  % Phase
  \begin{BodePhPlot}[scale=1.5,ytick distance=45,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}] {0.01} {10000}
    \addBodeZPKPlots[%
    true/{green!50!black},
    linear/{blue,thick},
    asymptotic/{transparent}]
    {phase}
    {
      p/-10
    }

    \draw[purple,dashed] (axis cs: 10,10) -- (axis cs: 10,-100);

    \node[below,align=center,scale=0.8] at (axis cs: 100,0) (p) {Una decade prima\\\( \frac{\omega_0}{10} \)};
    \node[above,align=center,scale=0.8] at (axis cs: 1,-90) (d) {Una decade dopo\\\(\omega_0 \cdot 10\)};

    \draw[->] (p) |- (axis cs: 1,0);
    \draw[->] (d) |- (axis cs: 100,-90);

    \coordinate (c) at (axis cs: 10,-45) node[right,scale=0.8] at (c) {\( -45\degree \)};
    \fill (c) circle (0.05cm);
  \end{BodePhPlot}
  \caption{Diagramma di Bode di un polo reale: \( \color{blue} \left( 1 + \frac{s}{10} \right)^{-1} \) }
\end{figure}

\noindent
Consideriamo uno zero di \( H(s) \) 
\[
  \color{red} \left( 1 + \frac{s}{10} \right)^{1}
\] 
\[
\omega_0 = 10
\] 
\begin{figure}[H]
  \centering
  % Magnitude
  \begin{BodeMagPlot}[scale=1.5,ytick distance=20,ylabel={Ampiezza (dB)},xlabel={}] {0.01} {10000}
    \addBodeZPKPlots[%
    true/{green!50!black,thick},
    linear/{red,thick},
    asymptotic/{transparent}]
    {magnitude}
    {
      z/-10
    }

    \draw[purple,dashed] (axis cs: 10,0) -- (axis cs: 10,-85) node[above right] {\( \omega_0 \)};
  \end{BodeMagPlot}

  % Phase
  \begin{BodePhPlot}[scale=1.5,ytick distance=45,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}] {0.01} {10000}
    \addBodeZPKPlots[%
    true/{green!50!black},
    linear/{red,thick},
    asymptotic/{transparent}]
    {phase}
    {
      z/-10
    }

    \draw[purple,dashed] (axis cs: 10,10) -- (axis cs: 10,-100);
  \end{BodePhPlot}
  \caption{Diagramma di Bode di uno zero reale: \( \color{red} \left( 1 + \frac{s}{10} \right)^{1} \) }
\end{figure}

\vspace{1em}
\noindent
La formula generale per calcolare l'ampiezza e la fase è:
\begin{itemize}
  \item \( \omega \ll \omega_0 \) 
    \[
    \begin{aligned}
      A(\omega) = 0\\
      \phi(\omega) = 0
    \end{aligned}
    \] 
  \item \( \omega \gg \omega_0 \) 
    \[
    \begin{aligned}
      A(\omega) &= 20 \cdot \log_{10} \left( \omega |\tau| \right)^{\mu}\\
                &= 20 \cdot \mu \left( \log_{10} (\omega) + \log_{10} \left( \left| \tau \right|  \right)  \right) \\
      \phi(\omega) &= atan2 \left( \omega \tau \right)^{\mu}\\
                   &= \mu \cdot segno \left( \tau \right) \cdot 90\degree
    \end{aligned}
    \] 
    Il comportamento della decade prima e dopo si descrive come:
    \[
      \begin{aligned}
        \text{Decade prima} &= \left( \frac{\omega_0}{10}, 0\degree \right) \\
        \text{Decade dopo} &= \left( 10 \cdot \omega_0, \mu \cdot segno \left( \tau \right) \cdot 90\degree \right)
      \end{aligned}
    \] 
\end{itemize}

\begin{definition}
  \[
    \begin{aligned}
      A(\omega) &= \begin{cases}
        0\degree & \omega \le \omega_n\\
        20 \cdot \mu \cdot \log_{10} \left( \omega \left| \tau \right|  \right) =
        20 \cdot \mu \left( \log_{10}(\omega) + \log_{10}(|\tau|) \right)  & \omega > \omega_n
      \end{cases}\\
        \phi(\omega) &= \begin{cases}
          0\degree & \omega \le \omega_n\\
          \mu \cdot segno(\tau) \cdot 90\degree & \omega > \omega_n
        \end{cases}
        \end{aligned}
      \] 
      La fase non cambia drasticamente.

      Si prende \( \left( \frac{\omega_n}{10}, 0\degree \right)  \) e \( \left( 10 \omega_n \right), 
      \mu \cdot segno(\tau) \cdot 90\degree\) e si traccia una retta tra i due punti.
\end{definition}

\subsubsection{Polo o zero complesso coniugato}
\[
  H(s) \to \left( 1 + 2 \zeta \frac{s}{\omega_n} + \frac{s^2}{\omega_n^2} \right)^{\mu}
\]
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[->] (-2,0) -- (2,0) node[right] {\( \Re \)};
    \draw[->] (0,-2) -- (0,2) node[above] {\( \Im \)};

    \fill[blue] (-1,1) circle (0.05cm);
    \fill[blue] (-1,-1) circle (0.05cm);

    \fill[red] (1,1) circle (0.05cm);
    \fill[red] (1,-1) circle (0.05cm);

    \draw[dashed,blue] (-1,1) -- (-1,-1);
    \draw[dashed,red] (1,1) -- (1,-1);
  \end{tikzpicture}
\end{figure}
\noindent
I valori sono a coppie. Bisogna considerare sia la pulsazione naturale \( \omega_n \)
che il coefficiente di smorzamento \( \zeta \).

\vspace{1em}
\noindent
Consideriamo un polo:
\[
\frac{\omega_0^2}{s^2 + 2 \zeta \omega_0s + \omega_0^2}
\] 
se la portiamo in forma di bode abbiamo:
\[
\frac{1}{
  1 + 2 \zeta \frac{s}{\omega_0} + \frac{s^2}{\omega_0^2}
}
\] 
Si può passare a \( s = j \omega \) per ottenere:
\[
\frac{1}{
  1 + 2 j \zeta \frac{\omega}{\omega_0} - \frac{\omega^2}{\omega_0^2}
}
\] 
Fattorizzando si ottiene:
\[
  \begin{aligned}
    \Re &= \frac{1 - \left( \frac{\omega}{\omega_0} \right)^2 }{
      \left( 1 - \left( \frac{\omega}{\omega_0} \right) ^2 \right) ^2 + \left( 2 \zeta \frac{\omega}{\omega_0} \right) ^2
    }\\
    \Im &= \frac{-2j \left( \frac{\omega}{\omega_0} \right) }{
      \left( 1 - \left( \frac{\omega}{\omega_0} \right) ^2 \right) ^2 
      + \left( 2 \zeta \frac{\omega}{\omega_0} \right) ^2
    }
  \end{aligned}
\] 
Consideriamo i seguenti casi:
\begin{itemize}
  \item \( \omega \ll \omega_0 = \omega_n \) 
    \[
    \begin{aligned}
      A(\omega) &= -20 \log_{10} \left( \sqrt{1} \right) = 0\\
      \phi(\omega) &= atan2\left( 0 \right) = 0
    \end{aligned}
    \] 

  \item \( \omega = \omega_0 = \omega_n \) 
    \[
      \begin{aligned}
        A(\omega) &= 20 \log_{10} \left( 2 \zeta \right)\\
        \phi(\omega) = -90\degree
      \end{aligned}
    \] 
    Si distinguono 4 casi:
    \begin{itemize}
      \item \( \zeta = 0.5 \) 

        $A = 0$

      \item \( \zeta > 0.5 \) 

        Il grafico passa per \( \omega_0 \) 

      \item \( \zeta < 0.5 \) 

        Si presenta un picco di risonanza

      \item \( \zeta = 0 \) 

        Si ha una discontinuità
    \end{itemize}

  \item \( \omega \gg \omega_0 = \omega_n \) 
    \[
    \begin{aligned}
      A(\omega) &= -20 \log_{10} \left( \frac{\omega}{\omega_0} \right)^2 \\
                &= -40 \log_{10} \left( \frac{\omega}{\omega_0} \right)\\
      \phi(\omega) &= atan2\left( 2 \zeta \frac{\omega}{\omega_0} \right)\\
                   &= atan2\left( +\infty \right) = -180\degree
    \end{aligned}
    \] 
    È una retta che decresce di 40 dB/decade.
\end{itemize}

Prendiamo ad esempio il polo:
\[
  \color{blue} \left( 1 + 2j \left( \frac{1}{5} \right) \frac{\omega}{2} - \frac{\omega^2}{4} \right)^{-1}
\] 
con:
\[
\begin{aligned}
  \mu &= 1\\
  \zeta &= \frac{1}{5}\\
  \omega_n &= 2
\end{aligned}
\] 
Il picco di risonanza si calcola come:
\[
  \omega_r = \omega_n \cdot \sqrt{1 - 2 \zeta^2} = 1.92
\] 
Più \( \zeta \) è piccolo, più il picco di risonanza diventa grande.

La massima ampiezza si calcola come:
\[
  M_r = 20 \cdot \mu \cdot \log_{10} \left( 2 \zeta \cdot \sqrt{1 - \zeta^2} \right) = 8.14
\] 
\begin{figure}[H]
  \centering
  \begin{BodeMagPlot}[scale=1.5,ytick distance=20,ylabel={Ampiezza (dB)},xlabel={}]{0.01}{100}
    \addBodeComponentPlot[green!50!black]{\MagCSPoles{0.2}{1}}
    \addBodeComponentPlot[blue,thick]{\MagCSPolesLin{0.2}{1}}

    \draw[purple,dashed] (axis cs: 2,20) -- (axis cs: 2,-85) node[above right] {\( \omega_0 \)};

    \node[align=center,scale=0.9] at (axis cs: 10,-10) (r) {Picco di\\risonanza};
    \draw[->] (r) -- (axis cs: 1.92,-2);
  \end{BodeMagPlot}

  % Phase
  \begin{BodePhPlot}[scale=1.5,ytick distance=90,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}] {0.01} {100}
    \addBodeComponentPlot[green!50!black]{\PhCSPoles{0.2}{1}}
    \addBodeComponentPlot[blue,thick]{\PhCSPolesLin{0.2}{1}}

    \draw[purple,dashed] (axis cs: 2,10) -- (axis cs: 2,-190);
  \end{BodePhPlot}
  \caption{Diagramma di Bode di un polo complesso coniugato}
\end{figure}

\vspace{1em}
\noindent
Le formule generali per calcolare l'ampiezza e la fase sono:
\begin{itemize}
  \item \( \omega \ll \omega_0 \) 
    \[
    \begin{aligned}
      A(\omega) = 0\\
      \phi(\omega) = 0
    \end{aligned}
    \] 
  \item \( \omega \gg \omega_0 = \omega_n \) 
    \[
    \begin{aligned}
      A(\omega) &= 40 \cdot \mu \left( \log_{10} \omega - \log_{10} \omega_n \right) \\
                &= 40 \log_{10} \left( \frac{\omega}{\omega_n} \right) 
      \phi(\omega) = \mu \cdot segno(\zeta) \cdot 180\degree
    \end{aligned}
    \]
    Si distinguono 4 casi:
    \begin{itemize}
      \item \( \zeta = 0 \) 

        Si ha un asintoto verticale in \( A(\omega) \) in \( \omega_n \)

      \item \( 0 < \zeta < 0.5 \)

        Si ha un picco di risonanza che vale:
        \[
          \omega_r = \omega_n \cdot \sqrt{1 - 2 \zeta^2}
        \] 
        e una massima ampiezza di:
        \[
          M_r = 20 \cdot \mu \cdot \log_{10} \left( 2 \zeta \cdot \sqrt{1 - \zeta^2} \right)
        \]
        Il picco di risonanza si trova in \( \left( \omega_r, M_r \right)  \) 

      \item \( \zeta = 0.5 \)

        Si ha che \( A(\omega) = 0\) 

      \item \( 0.5 < \zeta < 1 \) 

        Passa sotto il grafico asintotico
    \end{itemize}
\end{itemize}

\begin{definition}
  \[
    \begin{aligned}
      A(\omega) &= \begin{cases}
        0\degree & \omega \le \omega_n\\
        40 \cdot \mu \cdot \log_{10} \left( \frac{\omega}{\omega_n} \right) = 40 \cdot \mu \left[
      \log_{10}(\omega) - \log_{10}(\omega_n) \right] & \omega > \omega_n
    \end{cases}\\
        \phi(\omega) &= \begin{cases}
          0\degree & \omega \le \omega_n\\
          \mu \cdot segno(\zeta) \cdot 180\degree & \omega > \omega_n
        \end{cases}
        \end{aligned}
      \] 

      Per la transizione di fasi bisogna calcolare:
      \[
        \left( \frac{1}{5^{|\zeta|}} \cdot \omega_n, 0\degree \right);
        \left( 5^{|\zeta|} \cdot \omega_n, \mu \cdot segno(\zeta) \cdot 180\degree \right) 
      \] 
      oppure

      \[
        \left( \frac{\omega_n}{10}, 0\degree \right);
        \left(10 \cdot \omega_n, \mu \cdot segno(\zeta) \cdot 180\degree \right) 
      \] 
      e si traccia la retta che li collega.

      \vspace{1em}
      \noindent
      Se \( 0 < \zeta \le \frac{1}{2} \) c'è un picco di risonanza,
      \[
        \left( \omega_r, \mu_r \right) 
      \] 
      \[
        \begin{aligned}
          \omega_r &= \omega_r \sqrt{1 - 2 \zeta^2}\\ 
          M_r &= 20 \cdot \mu \cdot \log_{10} \left( 2 \zeta \cdot \sqrt{1 - \zeta^2} \right)
        \end{aligned}
      \] 
\end{definition}

\subsubsection{Esempio}
\begin{example}
  \label{es:bode}
  Prendiamo in considerazione la seguente funzione di trasferimento:
  \[
  H(s) = \frac{s ^2 \left( s+1 \right) \left( s ^2 + 3s + 16 \right) }{2s - 1}
  \] 
  \begin{enumerate}
    \item Portare in forma di bode:
      \[
      \Delta = b^2 - 4ac = 9 - 64 = -55 < 0
      \] 
      \[
        \begin{aligned}
          H(s) &= \frac{
            s ^2 (1) \left( 1 + \frac{s}{1} \right)^1
            (16) \left( \frac{16}{16} + \frac{3}{16}s + \frac{s ^2}{16} \right)^1
          }{
            (-1) \left( +1 - \frac{2}{1}s \right)^1
          }
          \\
          &= -16 \frac{
            s ^2 \left( 1+s \right) \left( 1 + \frac{3}{16}s + \frac{s ^2}{16} \right) 
          }{
            \left( 1 - 2s \right) 
          }
        \end{aligned}
      \] 
  \end{enumerate}
  Disegnamo \( \color{blue}k_b \) 
  \[
    \begin{aligned}
      A &= 20 \cdot \log_{10} \left( \left| -16 \right|  \right) = 24\\
      \phi &= \begin{cases}
        0\degree & \text{se } -16 > 0\\
        -180\degree & \text{se } -16 < 0
      \end{cases} = -180\degree
      \end{aligned}
    \] 
    \begin{figure}[H]
      \centering
      % Magnitude
      \begin{BodeMagPlot}[scale=1.5,ytick distance=20,ylabel={Ampiezza (dB)},xlabel={},ymin=0,ymax=60] {0.01} {100}
        \addBodeZPKPlots[%
        true/{blue,thick},
        linear/{transparent},
        asymptotic/{transparent}]
        {magnitude}
        {
          k/-16
        }

        \node[blue,above right,scale=0.8] at (axis cs:0.01,24) {24dB};
      \end{BodeMagPlot}

      % Phase
      \begin{BodePhPlot}[
        scale=1.5,ytick distance=90,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)},
        ymin=-270,ymax=0
        ] {0.01} {100}
        \addBodeZPKPlots[%
        true/{blue,thick},
        linear/{transparent},
        asymptotic/{transparent}]
        {phase}
        {
          k/-16
        }
      \end{BodePhPlot}
      \caption{Diagramma di Bode di \( \color{blue}k_b \)}
    \end{figure}

    \vspace{1em}
    \noindent
    Disegnamo \( \color{red} (1+s) \)
    \[
    \begin{aligned}
      \mu &= 1\\
      \tau &= 1\\
      \omega &= \frac{1}{|\tau|} = 1 \
    \end{aligned}
    \] 
    \[
    \begin{aligned}
      A &= \begin{cases}
        0\degree & \omega \le \omega_n\\
        20 \cdot \mu \log_{10} \left( \omega \left| \tau \right|  \right) = 20 \frac{dB}{dec} & \omega > \omega_n
      \end{cases}\\
      \phi &= \begin{cases}
        0\degree & \omega \le \omega_n\\
        \mu \cdot segno(\tau) \cdot 90\degree
      \end{cases}
    \end{aligned}
    \] 
    \begin{figure}[H]
      \centering
      % Magnitude
      \begin{BodeMagPlot}[scale=1.5,ytick distance=20,ylabel={Ampiezza (dB)},xlabel={}] {0.01} {100}
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{red,thick},
        asymptotic/{transparent}]
        {magnitude}
        {
          z/-1
        }

        \draw[red,dashed] (axis cs:1,50) -- (axis cs:1,-5) node[above right] {\( \omega \) };
        \draw[thin,dashed] (axis cs:1,0) -| (axis cs:10,20) 
        node[midway,above left,scale=0.8] {\( 20 \frac{dB}{dec} \) };
      \end{BodeMagPlot}

      % Phase
      \begin{BodePhPlot}[
        scale=1.5,ytick distance=90,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)},
        ] {0.01} {100}
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{red,thick},
        asymptotic/{transparent}]
        {phase}
        {
          z/-1
        }
        \draw[red,dashed] (axis cs:1,100) -- (axis cs:1,-5) node[above right] {\( \omega \) };
      \end{BodePhPlot}
      \caption{Diagramma di Bode di \( \color{red}(1+s) \)}
    \end{figure}

    \vspace{1em}
    \noindent
    Disegnamo \( \color{green!50!black} s^2 \)
    \[
    \begin{aligned}
      \mu = 2
    \end{aligned}
    \] 
    \[
    \begin{aligned}
      A &= 20 \cdot \mu \log_{10} \left( \omega  \right) = 40 \frac{dB}{dec}\\
      \phi &= \mu \cdot 90\degree = 180\degree
    \end{aligned}
    \] 
    \begin{figure}[H]
      \centering
      % Magnitude
      \begin{BodeMagPlot}[scale=1.5,ytick distance=20,ylabel={Ampiezza (dB)},xlabel={}] {0.01} {100}
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{green!50!black,thick},
        asymptotic/{transparent}]
        {magnitude}
        {
          z/0,
          z/0
        }
      \end{BodeMagPlot}

      % Phase
      \begin{BodePhPlot}[
        scale=1.5,ytick distance=90,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)},
        ymin=0,ymax=360
        ] {0.01} {100}
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{green!50!black,thick},
        asymptotic/{transparent}]
        {phase}
        {
          z/0,
          z/0
        }
      \end{BodePhPlot}
      \caption{Diagramma di Bode di \( \color{green!50!black}s^2 \)}
    \end{figure}

    \vspace{1em}
    \noindent
    Disegnamo \( \color{purple} \left( 1 + \frac{3}{16}s + \frac{s ^2}{16} \right)  \) 
    \[
    \begin{aligned}
      \mu &= 1\\
      \omega_n &= \sqrt{16} = 4\\
      \frac{2 \zeta}{\omega_n} = \frac{3}{16} \to \zeta = \frac{3}{16} \cdot \frac{\omega_n}{2} = \frac{3}{8}
    \end{aligned}
    \] 
    \[
    \begin{aligned}
      A &= \begin{cases}
        0\degree & \omega \le \omega_n\\
        40 \cdot \mu \cdot \log_{10} \left( \frac{\omega}{\omega_n} \right) & \omega > \omega_n
      \end{cases}\\
    \end{aligned}
    \] 
    \[
      \begin{aligned}
        \omega_r = \omega_n \cdot \sqrt{1 - 2 \zeta^2} = 3.5\\
        M_r = 20 \cdot \mu \log_{10} \left( 2 \zeta \cdot \sqrt{1 - \zeta^2} \right) = 8.14
      \end{aligned}
    \] 
    \[
    \phi = \begin{cases}
      0\degree & \omega \le \omega_n\\
      180\degree \cdot \mu \cdot segno(\zeta) = 180\degree & \omega > \omega_n
    \end{cases}
    \] 
    \begin{figure}[H]
      \centering
      % Magnitude
      \begin{BodeMagPlot}[scale=1.5,ytick distance=20,ylabel={Ampiezza (dB)},xlabel={}] {0.01} {100}
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{purple,thick},
        asymptotic/{purple}]
        {magnitude}
        {
          z/{{-1.5,-3.708099244}, {-1.5,3.708099244}},
          k/0.06
        }

        \draw[purple,dashed] (axis cs: 4,70) -- (axis cs: 4,-10) node[above right,scale=0.8] {\( \omega_n = 4 \)};

        \draw[thin,dashed] (axis cs:4,0) -| (axis cs:40,40) 
        node[midway,above left,scale=0.8] {\( 40 \frac{dB}{dec} \) };
      \end{BodeMagPlot}

      % Phase
      \begin{BodePhPlot}[
        scale=1.5,ytick distance=90,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)},
        ] {0.01} {100}
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{purple,thick},
        asymptotic/{transparent}]
        {phase}
        {
          z/{{-1.5,-3.708099244}, {-1.5,3.708099244}},
        }
        \draw[purple,dashed] (axis cs: 4,190) -- (axis cs: 4,-15) node[above right,scale=0.8] {\( \omega_n = 4 \)};
      \end{BodePhPlot}
      \caption{Diagramma di Bode di 
      \( \color{purple} \left( 1 + \frac{3}{16}s + \frac{s ^2}{16} \right)  \)}
    \end{figure}

    \vspace{1em}
    \noindent
    Disegnamo \( \color{orange} \left( 1 - 2s \right)  \)
    \[
    \begin{aligned}
      \mu &= 1\\
      \tau &= -2\\
      \omega_n &= \frac{1}{|\tau|} = \frac{1}{2}
    \end{aligned}
    \] 
    \[
    \begin{aligned}
      A &= \begin{cases}
        0\degree & \omega \le \omega_n\\
        20 \cdot \mu \log_{10} \left( \omega \left| \tau \right|  \right) = 20 \frac{dB}{dec} & \omega > \omega_n
      \end{cases}\\
        \phi &= \begin{cases}
          0\degree & \omega \le \omega_n\\
          \mu \cdot segno(\tau) \cdot 90\degree = -90\degree & \omega > \omega_n
        \end{cases}
    \end{aligned}
    \] 
    \begin{figure}[H]
      \centering
      % Magnitude
      \begin{BodeMagPlot}[scale=1.5,ytick distance=20,ylabel={Ampiezza (dB)},xlabel={}] {0.01} {100}
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{orange,thick},
        asymptotic/{transparent}]
        {magnitude}
        {
          p/{0.5},
          k/0.5
        }

        \draw[orange,dashed] (axis cs:0.5,10) -- (axis cs:0.5,-50) node[above right,scale=0.8] {\( \omega_n = 0.5 \) };
        \draw[thin,dashed] (axis cs:5,-20) -| (axis cs:0.5,0) 
        node[midway,above right,scale=0.8] {\( -20 \frac{dB}{dec} \) };
      \end{BodeMagPlot}

      % Phase
      \begin{BodePhPlot}[
        scale=1.5,ytick distance=90,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)},
        ] {0.01} {100}
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{orange,thick},
        asymptotic/{transparent}]
        {phase}
        {
          p/{0.5},
        }
        \draw[orange,dashed] (axis cs:0.5,-80) -- (axis cs:0.5,-190) node[above right,scale=0.8] {\( \omega_n = 0.5 \) };
      \end{BodePhPlot}
      \caption{Diagramma di Bode di \( \color{orange} \left( 1 - 2s \right)  \)}
    \end{figure}
\end{example}

\subsection{Comportamento totale di Bode}
Una volta disegnati i singoli grafici si sommano assieme:
\begin{example}
  Riprendiamo l'esempio \ref{es:bode}
  \begin{enumerate}
    \item 
      \[
        \begin{aligned}
          10^0 & \leftarrow \text{Zero reale e zero nullo}\\
          4 & \leftarrow \text{Zero complesso coniugato}\\
          -0.5 & \leftarrow \text{Polo reale}
        \end{aligned}
      \] 
      Scriviamo una tabella con le decadi più vicine per vedere meglio l'andamento:
      \begin{table}[H]
        \centering
        \begin{tabular}{c|c|c|c|c}
          $\stackrel{(0.1)}{10^{-1}}$ & $0.5$ & $\stackrel{(1)}{10^{0}}$ & $4$ & $\stackrel{(10)}{10^{1}}$\\
        \end{tabular}
      \end{table}

    \item Andiamo a calcolare il valore di ciascun termine dei valori trovati e sommiamo i contributi per ogni blocco
    \begin{figure}[H]
      \centering
      % Magnitude
      \begin{BodeMagPlot}[scale=1.9,ytick distance=20,ylabel={Ampiezza (dB)},xlabel={Frequenza (rad/s)}] {0.01} {100}
        % Kb
        \addBodeZPKPlots[%
        true/{blue,thick},
        linear/{transparent},
        asymptotic/{transparent}]
        {magnitude}
        {
          k/-16
        }

        % (1 + s)
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{red,thick},
        asymptotic/{transparent}]
        {magnitude}
        {
          z/-1
        }

        % s^2
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{green!50!black,thick},
        asymptotic/{transparent}]
        {magnitude}
        {
          z/0,
          z/0
        }

        % (1 + (3/16)s + (1/16)s^2)
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{purple,thick},
        asymptotic/{purple}]
        {magnitude}
        {
          z/{{-1.5,-3.708099244}, {-1.5,3.708099244}},
          k/0.06
        }

        % (1 - 2s)
        \addBodeZPKPlots[%
        true/{transparent},
        linear/{orange,thick},
        asymptotic/{transparent}]
        {magnitude}
        {
          p/{0.5},
          k/0.5
        }

        % Omega_n
        \draw[orange,dashed] (axis cs:0.5,95) -- (axis cs:0.5,-95) node[above left,scale=0.6] {\( \omega_1 = 0.5 \) };
        \draw[red,dashed] (axis cs:1,95) -- (axis cs:1,-95) node[above right,scale=0.6] {\( \omega_2 \) };
        \draw[purple,dashed] (axis cs: 4,95) -- (axis cs: 4,-95) node[above right,scale=0.6] {\( \omega_3 = 4 \)};
        \draw[dashed] (axis cs: 0.1,95) -- (axis cs: 0.1,-95);
        \draw[dashed] (axis cs: 10,95) -- (axis cs: 10,-95);

        \node[blue,above right,scale=0.6] at (axis cs:0.01,24) {24dB};
        \node[green!50!black,align=center,scale=0.6] at (axis cs: 30,80) {\( 40 \frac{dB}{dec} \) };
        \node[purple,align=center,scale=0.6] at (axis cs: 30,45) {\( 40 \frac{dB}{dec} \) };
        \node[red,align=center,scale=0.6] at (axis cs: 30,15) {\( 20 \frac{dB}{dec} \) };
        \node[orange,align=center,scale=0.6] at (axis cs: 30,-50) {\( -20 \frac{dB}{dec} \) };
      \end{BodeMagPlot}
      \caption{Unione di tutti i diagrammi}
    \end{figure}
      \noindent
      Andamento in tabella:
      \begin{table}[H]
        \centering
        \begin{tabular}{c|c|c|c|c|c}
          $\omega$ & $10^{-1}$ & $0.5$ & $10^{0}$ & $4$ & $10^{1}$\\
          \hline
          \color{blue} \( k_b \;db/dec \) & \color{blue}0 & \color{blue}0 & \color{blue}0 & \color{blue}0 & \color{blue}0 \\
          \color{red} \( \text{zero-}\mathbb{R}_1 \;db/dec\) & \color{red}0 & \color{red}0 & \color{red}0 & \color{red}20 & \color{red}20 \\ 
          \color{green!50!black} \( \text{zero-nullo}_1 \;db/dec\) & \color{green!50!black}40 & \color{green!50!black}40 & \color{green!50!black}40 & \color{green!50!black}40 & \color{green!50!black}40 \\ 
          \color{purple} \( \text{zero-cc}_1 \;db/dec\) & \color{purple}0 & \color{purple}0 & \color{purple}0 & \color{purple}0 & \color{purple}40 \\ 
          \color{orange} \( \text{Polo-}\mathbb{R}_1 \;db/dec\) & \color{orange}0 & \color{orange}0 & \color{orange}-20 & \color{orange}-20 & \color{orange}-20 \\ 
          \hline
          Totale & 40 & 40 & 20 & 40 & 80
        \end{tabular}
      \end{table}

    \item Si fa il grafico delle ampiezze considerando gli omega che abbiamo calcolato:
      \begin{table}[H]
        \centering
        \begin{tabular}{c|c|c|c|c|c}
          $\omega$ & $10^{-1}$ & $0.5$ & $10^{0}$ & $4$ & $10^{1}$\\
          \hline
          \color{blue} \( k_b (dB) \) & \color{blue}24 & \color{blue}24 & \color{blue}24 & \color{blue}24 & \color{blue}24 \\
          \color{red} \( \text{zero-}\mathbb{R}_1 \; \left(20 \cdot \log(\omega \cdot |\tau|),\; \tau = 1\right) \)
                                    & \color{red}0 & \color{red}0 & \color{red}0 & \color{red}12 & \color{red}20 \\ 
          \color{green!50!black} \( \text{zero-nullo}_1 \; \left(40 \cdot \log(\omega)\right) \)
                                    & \color{green!50!black}-40 & \color{green!50!black}-12& \color{green!50!black}0 & \color{green!50!black}24 & \color{green!50!black}40 \\ 
          \color{purple} \( \text{zero-cc}_1 \; \left(40 \cdot \log(\frac{\omega}{\omega_n}), \; \zeta = \frac{3}{8}, \omega_n = 4\right) \)
                                    & \color{purple}0 & \color{purple}0 & \color{purple}0 & \color{purple}0 & \color{purple}16 \\ 
          \color{orange} \( \text{Polo-}\mathbb{R}_1 \; \left(-20 \cdot \log(\omega \cdot |\tau|), \; \tau = -2\right)\) 
                                    & \color{orange}0 & \color{orange}0 & \color{orange}-6 & \color{orange}-18 & \color{orange}-26 \\ 
          \hline
          Totale (dB) & -16 & 12 & 18 & 42 & 74
        \end{tabular}
      \end{table}
    \begin{figure}[H]
      \centering
      % Magnitude
      \begin{BodeMagPlot}[scale=1.9,ytick distance=40,ylabel={Ampiezza (dB)},xlabel={Frequenza (rad/s)}] {0.01} {100}
        % Transfer function magnitude
        \addBodeZPKPlots[%
        true/{teal,thin},
        linear/{violet,thick},
        asymptotic/{transparent}]
        {magnitude}
        {
          z/{0,0,-1,{-1.5,-3.708099244}, {-1.5,3.708099244}},
          p/0.5,
          k/0.5,
        }

        % Omega_n
        \draw[orange,dashed] (axis cs:0.5,170) -- (axis cs:0.5,-77) node[above left,scale=0.6] {\( \omega_1 = 0.5 \) };
        \draw[red,dashed] (axis cs:1,170) -- (axis cs:1,-77) node[above right,scale=0.6] {\( \omega_2 \) };
        \draw[purple,dashed] (axis cs: 4,170) -- (axis cs: 4,-77) node[above right,scale=0.6] {\( \omega_3 = 4 \)};
        \draw[dashed] (axis cs: 0.1,170) -- (axis cs: 0.1,-77);
        \draw[dashed] (axis cs: 10,170) -- (axis cs: 10,-77);

        % Points
        \fill[violet] (axis cs:0.1,-16) circle (1.5pt) node[below right,scale=0.6] {-16dB};
        \fill[violet] (axis cs:0.5,12) circle (1.5pt) node[below right,scale=0.6] {12dB};
        \fill[violet] (axis cs:1,18) circle (1.5pt) node[below right,scale=0.6] {18dB};
        \fill[violet] (axis cs:4,42) circle (1.5pt) node[below right,scale=0.6] {42dB};
        \fill[violet] (axis cs:10,74) circle (1.5pt) node[below right,scale=0.6] {74dB};
      \end{BodeMagPlot}
      \caption{Ampiezza totale}
    \end{figure}

    \item Si fa il grafico delle fasi facendo lo stesso ragionamento fatto per le ampiezze,
      ma considerando solo il valore asintotico:
      \begin{table}[H]
        \centering
        \begin{tabular}{c|c|c|c|c|c}
          $\omega$ & $10^{-1}$ & $0.5$ & $10^{0}$ & $4$ & $10^{1}$\\
          \hline
          \color{blue} \( k_b  \) & \color{blue}-180 & \color{blue}-180 & \color{blue}-180 & \color{blue}-180 & \color{blue}-180 \\
          \color{red} \( \text{zero-}\mathbb{R}_1 \)
                                    & \color{red}0 & \color{red}0 & \color{red}0 & \color{red}90 & \color{red}90 \\ 
          \color{green!50!black} \( \text{zero-nullo}_1 \)
                                    & \color{green!50!black}180 & \color{green!50!black}180 & \color{green!50!black}180 & \color{green!50!black}180 & \color{green!50!black}180 \\ 
          \color{purple} \( \text{zero-cc}_1 \)
                                    & \color{purple}0 & \color{purple}0 & \color{purple}0 & \color{purple}0 & \color{purple}180 \\ 
          \color{orange} \( \text{Polo-}\mathbb{R}_1 \) 
                                    & \color{orange}0 & \color{orange}0 & \color{orange}90 & \color{orange}90 & \color{orange}90 \\ 
          \hline
          Totale  & $0\degree$ & $0\degree$ & $90\degree$ & $180\degree$ & $360\degree$
        \end{tabular}
      \end{table}
      \begin{figure}[H]
        \centering
        % Magnitude
        \begin{BodePhPlot}[scale=1.9,ytick distance=40,ylabel={Fase (deg)},xlabel={Frequenza (rad/s)}] {0.01} {100}
          % Transfer function phase
          \addBodeZPKPlots[%
          true/{teal,thin},
          linear/{transparent},
          asymptotic/{violet,thick}]
          {phase}
          {
            z/{0,0,-1,{-1.5,-3.708099244}, {-1.5,3.708099244}},
            p/0.5,
          }

          % Omega_n
          \draw[orange,dashed] (axis cs:0.5,380) -- (axis cs:0.5,-37) node[above left,scale=0.6] {\( \omega_1 = 0.5 \) };
          \draw[red,dashed] (axis cs:1,380) -- (axis cs:1,-37) node[above right,scale=0.6] {\( \omega_2 \) };
          \draw[purple,dashed] (axis cs: 4,380) -- (axis cs: 4,-37) node[above right,scale=0.6] {\( \omega_3 = 4 \)};
          \draw[dashed] (axis cs: 0.1,380) -- (axis cs: 0.1,-37);
          \draw[dashed] (axis cs: 10,380) -- (axis cs: 10,-37);
        \end{BodePhPlot}
        \caption{Fase totale}
      \end{figure}
  \end{enumerate}
\end{example}

\section{Trasformata di Fourier}
Fourier ha dimostrato che qualsiasi segnale periodico o aperiodico può essere scomposto
in una \textbf{somma di sinusoidi}, nello specifico somme di integrali di sinusoidi.
\begin{example}
  L'esempio più classico è l'elaborazione dei suoni, se abbiamo un MI più un DO
  si ottiene una somma di due sinusoidi che rappresenta le due note:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (0,0) -- (5.5,0) node[right] {t};
      \draw[->] (0,-1) -- (0,1) node[above] {A};
      \draw[domain=0:5,smooth,variable=\x,red,samples=300] plot ({\x},{sin(4*\x r)}) node[above right] {DO};
      \draw[domain=0:5,smooth,variable=\x,blue,samples=300] plot ({\x},{sin(6.59*\x r)}) node[below right] {MI};
    \end{tikzpicture}
  \end{figure}
  \[
  \downarrow
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \draw[->] (0,0) -- (5.5,0) node[right] {t};
      \draw[->] (0,-2) -- (0,2) node[above] {A};
      \draw[domain=0:5,smooth,variable=\x,green!50!black,samples=300] plot ({\x},{sin(4*\x r)+sin(6.59*\x r)});
    \end{tikzpicture}
    \caption{Somma di due sinusoidi}
  \end{figure}
\end{example}
\noindent
Per generare lo stesso segnale con la stessa frequenza servono più sinusoidi e
quando la somma di sinusoidi è infinita si ottiene il segnale originale.

\subsection{Sinusoidi come vettori}
Ogni sinusoide può essere rappresentata come un vettore che ruota in senso antiorario
su una cirfonferenza con velocità angolare \( \omega \) e ampiezza \( A \):
\[
  e^{i \omega t}
\] 
Da questo si può prendere una funzione e generare il grafico dell'avvolgimento
della funzione sul piano bidimensionale (grafico del winding):
\[
  g(t) \cdot e^{-2\pi \cdot i  f_0 \cdot \omega t}
\] 
Per calcolare il grafico di winding si deve calcolare il centro di massa come la media
dei punti sul grafico:
\[
    cdm = \frac{1}{N} \cdot \sum_{k=1}^N g(t_k) \cdot e^{-2\pi \cdot i f_0 \cdot \omega t_k}
\] 
\[
\downarrow
\] 
\[
  \lim_{N \to \infty} \frac{1}{N} \cdot \sum_{k=1}^N g(t_k) \cdot e^{-2\pi \cdot i f_0 \cdot \omega t_k} = \frac{1}{t_2-t_1} \int_{t_1}^{t_2} -g(t_k) \cdot e^{-2\pi \cdot if_0 \cdot \omega t} \, dt
\] 
Questa è la quasi trasformata di Fourier, per ottenere la trasformata di Fourier
bisogna togliere il peso iniziale:
\[
 TD_{\text{Fourier}} = \int_{-\infty}^{+\infty} -g(t) \cdot e^{-2\pi \cdot i f_0 \cdot \omega t} \, dt
\] 
Dal grafico della trasformata di Fourier si rilevano dei picchi che rappresentano
tutte le frequenze che compongono il segnale totale.

\vspace{1em}
\noindent
Anche in questo caso il risultato ottenuto nel dominio delle frequenze è uguale
a quello ottenuto nel dominio del tempo.


\subsubsection{Segnali periodici}
Un segnale periodico è rappresentabile tramite la \textbf{serie di Fourier}, cioè una
somma infinita di segnali sinusoidali.

\subsubsection{Segnali non periodici}
Un segnale non periodico è rappresentabile tramite la \textbf{trasformata di Fourier},
cioè una somma di sinusoidi con frequenze continue.
Un segnale non periodico può essere trasformato in un segnale periodico replicandolo
un multiplo di volte.

\subsection{Serie di Fourier}
Consideriamo un segnale periodico \( x(t) \) con periodo \( T_0 \):
\[
x(t) = x(t + T_0)
\] 
con \textbf{frequenza fondamentale}
\[
  w_0 = \frac{2\pi}{T_0} = 2\pi f_0
\] 

\vspace{1em}
\noindent
Se si passa alla rappresentazione tramite esponenziali complessi si può riscrivere:
\[
  e^{j \omega_0 t} \to  T_0 = \frac{2\pi}{\omega_0}
\] 
si può moltiplicare per una costante \( k \) per ottenere dei multipli della frequenza
fondamentale:
\[
  e^{j k \omega_0 t} \to T_0 = \frac{2\pi}{k \omega_0}
\] 

\vspace{1em}
\noindent
\begin{definition}
  Questo segnale si può riscrivere come una combinazione lineare di \( e^{j k \omega_0 t} \):
  \[
    x(t) = \sum_{k=-\infty}^{+\infty} a_k \cdot e^{j k \omega_0 t}
  \] 
  con periodo \( T_0 \) e frequenza fondamentale \( \omega_0 = \frac{2 \pi}{T_0} = 2 \pi f_0 \).

  Questa rappresentazione si chiama \textbf{serie di Fourier}.
\end{definition}

\vspace{1em}
\noindent
\( a_k \in \mathbb{C} \), quindi si può riscrivere in forma polare o cartesiana:
\[
\begin{aligned}
  a_k &= \color{blue}A_k e^{j \theta_k} \\
      &= \color{red}B_x + j C_k
\end{aligned}
\] 
Una serie di fourier può essere scritta come serie di funzioni trigonometriche:
\[
  e^{j k \omega_0 t} = \cos(k \omega_0 t) + j \sin(k \omega_0 t)
\] 
Da cui si può scrivere la serie di Fourier come somma di seni e coseni:
\[
  \begin{aligned}
    x(t) &= \color{blue}a_0 + 2 \sum_{k=1}^{+\infty} A_k \cos(k \omega_0 t + \theta_k)\\
         &= \color{red}a_0 + 2 \sum_{k=1}^{+\infty} \left[ B_k \cos(k \omega_0 t) - i C_k \sin(k \omega_0 t) \right]
  \end{aligned}
\] 

\vspace{1em}
\noindent
Per calcolare i coefficienti \( a_k \) si può fare un integrale su un periodo \( T_0 \):
\[
  \int_{t_0}^{t_0 + T_0} = \int_{t_0} e^{j k \omega_0 t} \, dt = \begin{cases}
    0 & k \neq 0\\
    t_0 & k = 0
  \end{cases}
\] 
Usando la rappresentazione con seno e coseno:
\[
  \int_{t_0} \cos(k \omega_0 t) \, dt + j \int_{t_0} \sin(k \omega_0 t) \, dt = \begin{cases}
    0 & k \neq 0\\
    t_0 & k = 0
  \end{cases}
\] 

\vspace{1em}
\noindent
Si fa quindi l'integrale sul periodo di \( x(t) \):
\[
  \int_{t_0} x(t) e^{-j N \omega_0 t} \,dt = \int_{t_0} e^{-j N \omega_0 t} \sum_{k=-\infty}^{+\infty} a_k e^{j k \omega_0 t} \, dt
\] 
si porta fuori dall'integrale la sommatoria:
\[
  \int_{t_0} e^{-j N \omega_0 t} \sum_{k=-\infty}^{+\infty} a_k e^{j k \omega_0 t} \, dt =
  \underbrace{\sum_{k=-\infty}^{+\infty} a_k \int_{t_0} e^{-j (k-N) \omega_0 t} \, dt}_{
    \begin{cases}
      0 & k \neq N\\
      t_0 & k = N
    \end{cases}
  }
\] 
e si può riscrivere tutto come:
\[
  \int_{t_0} x(t) e^{-j N \omega_0 t} \, dt = a_n \cdot t_0
\] 
\[
  a_n = \frac{1}{t_0} \int_{t_0} x(t) e^{-j N \omega_0 t} \, dt
\] 
generalizzando diventa:
\begin{definition}
  \[
    a_k = \frac{1}{t_0} \int_{t_0} x(t) e^{-j k \omega_0 t} \, dt
  \] 
  Questa è la \textbf{equazione di analisi} e ci permette di calcolare i singoli coefficienti
  della serie di Fourier.
\end{definition}
\begin{definition}
  \[
    x(t) = \sum_{k=-\infty}^{+\infty} a_k \cdot e^{j k \omega_0 t}
  \] 
  Questa è l'\textbf{equazione di sintesi} e ci
  permette di rappresentare qualsiasi segnale periodico come somma infinita di funzioni
  armonicamente correlate tra di loro, quindi che hanno una frequenza multipla della
  frequenza fondamentale.
\end{definition}

\begin{theorem}
  Sia \( v(t) \) una funzione di valori reali o complessi, con \( t \in \mathbb{R} \),
  periodica di periodo \( T_0 \) e con frequenza \( f_0 \) (\( \omega_0 = \frac{2 \pi }
  {T_0} = 2 \pi f_0 \))
  \begin{itemize}
    \item \( v(t) \) è generalmente continua, cioè continua in un insieme finito di punti
    \item \( v(t) \) è generalmente derivabile e la sua derivata prima è generalmente
      continua e anche generalmente limitata su un intervallo specifico \( [t_0, t_0 + T_0] \),
      allora la funzione si dice \textbf{quadrato sommabile}, cioè:
      \[
        \begin{aligned}
          \int_{-\infty}^{+\infty} |v(t)|^2 \, dt < +\infty &=\\
          \int_{T_0} |v(t)|^2 \, dt < +\infty&
        \end{aligned}
      \] 
      È sviluppabile in serie di Fourier, quindi \( \forall t \) in cui è continua vale che:
      \[
        \text{Equazione di Sintesi:} \quad
        v(t) = \sum_{k=-\infty}^{+\infty} a_k \cdot e^{j k \omega_0 t}
      \] 
      \[
        \text{Equazione di analisi:} \quad
        a_k = \frac{1}{T_0} \int_{T_0} v(t) e^{-j k \omega_0 t} \, dt
      \] 
      Nei punti in cui non è continua vale che:
      \[
        \frac{v(t^-) + v(t^+)}{2} = \sum_{k=-\infty}^{+\infty} a_k \cdot e^{j k \omega_0 t}
      \] 
  \end{itemize}
  Il primo coefficiente della serie di Fourier corrisponde al picco che si vede nel
  grafico della trasformata e corrisponde al valore medio della funzione:
  \[
    a_0 = \frac{1}{T_0} \int_{T_0} v(t) \, dt
  \] 

  \vspace{1em}
  \noindent
  La funzione di sintesi può essere scritta in diversi modi:
  \begin{itemize}
    \item Serie di Fourier in forma sinusoidale:
      \[
        \begin{aligned}
          v(t) &= a_0 + \sum_{k=1}^{+\infty} 2 \left| a_k \right|  \cos(k \omega_0 t + arg(a_k))\\
               &= a_0 + \sum_{k=1}^{+\infty} \left[ A_k \cos(k \omega_0 t) + B_k \sin(k \omega_0 t) \right]
        \end{aligned}
      \] 
      \[
      A_k = 2 \Re(a_k) \quad B_k = -2 \Im(a_k)
      \] 
  \end{itemize}
  La sommatoria va da \( -\infty \) a \( +\infty \), ma non ci sono frequenze negative
  questo perchè serve solo a gestire i valori complessi.
\end{theorem}

\subsubsection{Segnali simmetrici e asimmetrici}
\begin{itemize}
  \item \textbf{Segnale periodico non-simmetrico}
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \begin{axis}[
          scale=1.5,
          width=8cm,
          height=5cm,
          ylabel = \( v(t) \),
          xlabel = \( t \),
          ymin=-2, ymax=2,
          xmin=-5, xmax=5,
          xtick = {-1,1},
          xticklabels = {$-\frac{T_0}{2}$, $\frac{T_0}{2}$},
          yticklabel style = {anchor=south west, scale=0.8},
          xticklabel style = {anchor=south west, scale=0.8},
          axis lines = center
          ]
          \addplot[blue, thick] coordinates {
            (-4,-1) (-4,1)
            (-3,1) (-3,-1)
            (-2,-1) (-2,1)
            (-1,1) (-1,-1)
            (0,-1) (0,1)
            (1,1) (1,-1)
            (2,-1) (2,1)
            (3,1) (3,-1)
            (4,-1) (4,1)
          };
        \end{axis}
      \end{tikzpicture}
      \caption{Segnale periodico non-simmetrico}
    \end{figure}
    \[
      a_k = \frac{1}{T_0} \int_{\frac{-T_0}{2}}^{0} \stackrel{v(t)}{(-1)} \cdot e^{-j k \omega_0 t} \, dt +
      \frac{1}{T_0} \int_{0}^{\frac{T_0}{2}} \stackrel{v(t)}{1} \cdot e^{-j k \omega_0 t} \, dt
    \] 
    \[
      \stackrel{\vdots}{\downarrow}
    \] 
    \[
      a_k = \frac{1}{j \pi k} \left[ 1 - (-1)^k \right] \quad k \neq 0
    \] 

    \vspace{1em}
    \noindent
    Il grafico dei coefficienti è il seguente:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \begin{axis}[
          width = 1\textwidth,
          height = 0.6\textwidth,
          ylabel = \( j \pi a_k \),
          xlabel = \( \omega \),
          ymin=-3, ymax=3,
          xmin=-6, xmax=6,
          ytick=\empty,
          xtick = {-5,-4,...,5},
          xticklabel style = {scale=0.8},
          axis lines = center
          ]
          \addplot[blue, mark=*, mark size=1.5pt] coordinates {
              (-5,-2/5) (-4,0) (-3,-2/3) (-2,0) (-1,-2) (0,0)
              (1,2) (2,0) (3,2/3) (4,0) (5,2/5)
          };
          
          \node[below, scale=0.8] at (axis cs:-5,-2/5) {\( -\frac{2}{5} \)};
          \node[below, scale=0.8] at (axis cs:-3,-2/3) {\( -\frac{2}{3} \)};
          \node[below, scale=0.8] at (axis cs:-1,-2) {\( -2 \)};
          \node[above, scale=0.8] at (axis cs:1,2) {\( 2 \)};
          \node[above, scale=0.8] at (axis cs:3,2/3) {\( \frac{2}{3} \)};
          \node[above, scale=0.8] at (axis cs:5,2/5) {\( \frac{2}{5} \)};
        \end{axis}
      \end{tikzpicture}
      \caption{Coefficienti \( a_k \) per segnale non-simmetrico}
    \end{figure}

    \begin{itemize}
      \item Armoniche dispari
      \item \( a_k \) immaginari
      \item \( a_k = -a_{-k}\) antisimmetrico
    \end{itemize}
    Siccome tutti i coefficienti sono immaginari si ha una serie di seni e si può
    riscrivere come:
    \[
      v(t) = a_0 + \sum_{k=1}^{+\infty} \underbrace{2j}_{\text{Per avere termini reali}} \cdot a_k \sim(k \omega_0 t)
    \] 

  \item \textbf{Segnale periodico simmetrico}
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \begin{axis}[
          scale=1.5,
          width=8cm,
          height=3.5cm,
          ylabel = \( v(t) \),
          xlabel = \( t \),
          ymin=0, ymax=1.5,
          xmin=-5, xmax=5,
          xtick = {-2.5,-1.5,1.5,2.5},
          ytick = {1},
          xticklabels = {$-T_0$, $-\frac{T_0}{2}$, $\frac{T_0}{2}$, $T_0$},
          yticklabel style = {anchor=south west, scale=0.8},
          xticklabel style = {anchor=north, scale=0.8},
          axis lines = center
          ]
          \addplot[blue, thick] coordinates {
            (-4,0) (-4,1)
            (-3,1) (-3,0)
            (-2,0) (-2,1)
            (-1,1) (-1,0)
            (0,0) (0,1)
            (1,1) (1,0)
            (2,0) (2,1)
            (3,1) (3,0)
            (4,0) (4,1)
          };
        \end{axis}
      \end{tikzpicture}
      \caption{Segnale periodico simmetrico}
    \end{figure}
    \[
    a_k = \begin{cases}
      \frac{1}{2} & k = 0\\
      \frac{\sin\left( \frac{\pi k}{2} \right)}{\pi k} & k \neq 0
    \end{cases}
    \] 

    \vspace{1em}
    \noindent
    Il grafico dei coefficienti è il seguente:
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \begin{axis}[
          clip=false,
          width = 1\textwidth,
          height = 0.6\textwidth,
          ylabel = \( j \pi a_k \),
          xlabel = \( \omega \),
          ymin=-1/2, ymax=2,
          xmin=-5.5, xmax=5.5,
          ytick=\empty,
          xtick = {-5,-4,...,5},
          xticklabel style = {scale=0.8},
          axis lines = center
          ]
          \addplot[blue, mark=*, mark size=1.5pt] coordinates {
              (-5,1/5) (-4,0) (-3,-1/3) (-2,0) (-1,1) (0,1/2)
              (1,1) (2,0) (3,-1/3) (4,0) (5,1/5)
          };
          
          \node[above right, scale=0.8] at (axis cs:0,1/2) {\( \frac{1}{2} \)};
          \node[above, scale=0.8] at (axis cs:1,1) {\( 1 \)};
          \node[below, scale=0.8] at (axis cs:3,-1/3) {\( -\frac{1}{3} \)};
          \node[above, scale=0.8] at (axis cs:5,1/5) {\( \frac{1}{5} \)};
        \end{axis}
      \end{tikzpicture}
      \caption{Coefficienti \( a_k \) per segnale simmetrico}
    \end{figure}

    \begin{itemize}
      \item Armoniche dispari
      \item \( a_k \) è reale
      \item \( a_k = a_{-k} \) simmetrico
    \end{itemize}
    Siccome tutti i coefficienti sono reali si ha una serie di coseni e si può riscrivere
    come:
    \[
      v(t) = a_0 + \sum_{k=1}^{+\infty} 2 \cdot a_k \cos(k \omega_0 t)
    \] 
\end{itemize}

\subsubsection{Serie di Fourier troncata}
Serve per limitare la sommatoria a \( N \) termini.

\vspace{1em}
\noindent
Sia \( N \in \mathbb{Z} \) 
\[
  \underbrace{v_N(t)}_{\text{\( v(t) \) rappresentato con \( N \) componenti}} =
  \sum_{k=-N}^{N} \tilde{a}_k \cdot e^{j k \omega_0 t} \quad a_k \in \mathbb{C}, \quad \omega_0,t \in \mathbb{R},
  \quad k \in \mathbb{Z}
\] 
Calcoliamo l'errore quadratico medio (MSE, Mean Square Error) che è la misura
dell'errore di approssimazione
\[
  MSE\left(v(t),v_N(t)\right) := \frac{1}{T_0} \int_{T_0} |v(t) - v_N(t)|^2 \, dt
\] 
misura l'energia della differenza di due segnali.
\[
  \tilde{a}_k = a_k = \lim_{N \to \infty} MSE\left(v(t),v_N(t)\right) = 0
\] 
\begin{define}
  \textbf{Fenomeno di Gibs}: Aumentando il numero di armoniche si ha un aumento
  di armoniche ad alta frequenza nei punti di discontinuità.
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        scale=1.5,
        width=8cm,
        height=5cm,
        ylabel = \( v(t) \),
        xlabel = \( t \),
        ymin=-2, ymax=2,
        xmin=-5, xmax=5,
        xtick = {-1,1},
        xticklabels = {$-\frac{T_0}{2}$, $\frac{T_0}{2}$},
        yticklabel style = {anchor=south west, scale=0.8},
        xticklabel style = {anchor=south west, scale=0.8},
        axis lines = center
        ]
        \addplot[blue, thick] coordinates {
            (-4,-1) (-4,1)
            (-3,1) (-3,-1)
            (-2,-1) (-2,1)
            (-1,1) (-1,-1)
            (0,-1) (0,1)
            (1,1) (1,-1)
            (2,-1) (2,1)
            (3,1) (3,-1)
            (4,-1) (4,1)
          };

        \node[font=\tiny, pin=280:{Discontinuità}] at (axis cs:1,-1) {};
      \end{axis}
    \end{tikzpicture}
    \caption{Discontinuità}
  \end{figure}
  \[
  T = 2 \pi \quad \text{Non simmetrico}
  \] 
  \[
  t = k \pi 
  \]
  \[
    \begin{aligned}
      v(t) &= a_0 + \sum_{k=-\infty}^{+\infty} B_k \sin(k \omega_0 t)\\
      a_k  &= \frac{1}{2 \pi } \int_{0}^{2 \pi} v(t) e^{-j k \omega_0 t} \, dt \\
           &= \frac{-i}{2 \pi k} \left( 2 - 2 e^{-j \pi t} \right) 
    \end{aligned}
  \] 
  \[
  a_k = \begin{cases}
    \frac{-2 j}{k \pi } & k \text{ è dispari}\\
    0 & \text{altrimenti}
  \end{cases}
  \] 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        xlabel = $t$,
        xtick = {-.25,.25},
        xticklabels = {$-\frac{T_0}{2}$, $\frac{T_0}{2}$},
        ytick = \empty,
        domain = -.75:.75,
        samples = 200,
        legend style = {%
          at = {(0.5,1.02)},
        anchor = south},
        axis lines = center
        ]
        \addplot[thin, mark = none] gnuplot {(x - floor(x +.5)) < 0 ? -1 : 1};
        \addplot+[blue, thick, mark = none] gnuplot[raw gnuplot] {%
            set samples 200;
          fourier(k, x) = 4/((2*k+1)*pi) * cos(2*(2*k+1)*pi*x - pi/2);
        plot[-.75:.75] sum [k=0:8] fourier(k,x)
        };
      \end{axis}
    \end{tikzpicture}
    \caption{Fenomeno di Gibbs}
  \end{figure}
\end{define}

\subsection{Dalla serie di Fourier alla trasformata di Fourier}
Se si ha un segnale non periodico che va da \( \left[ -T_1, T_1 \right] \):
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\Tone{2}
    \begin{axis}[
      height = 0.4\textwidth,
      ylabel = $v(t)$,
      xlabel = $t$,
      xmin=-\Tone*2, xmax=\Tone*2,
      ymin= 0, ymax = 3,
      ytick = \empty,
      xtick = {-\Tone, \Tone},
      xticklabels = {$-T_1$, $T_1$},
      axis lines = middle,
      declare function ={ f(\x) = sin(deg(\x))/2 + 1.5; },
    ]
      \addplot[blue,thick,domain=-\Tone:\Tone,samples=100]{f(x)};
      \draw[dashed] (axis cs:-\Tone,0) -- (axis cs:-\Tone,{f(-\Tone)});
      \draw[dashed] (axis cs:\Tone,0) -- (axis cs:\Tone,{f(\Tone)});
    \end{axis}
  \end{tikzpicture}
  \caption{Segnale non periodico}
\end{figure}

\[
  \underbrace{\tilde{v}(t)}_{\text{Periodico}} = \underbrace{v(t)}_{\text{Non periodico}}
\] 
\[
|t| < \frac{T_0}{2}
\] 
Se \( T_0 \to \infty \) si ha che \( \tilde{v}(t) \to v(t) \). Cioè si prende un segnale
periodico e si fa tendere il periodo a infinito facendolo sembrare non periodico.
Questo passaggio si può fare anche al contrario, cioè prendere un segnale non periodico
e farlo diventare periodico.
\begin{itemize}
  \item Usiamo la serie di Fourier per rappresentare \( \tilde{v}(t) \) 
  \item Facciamo tendere \( T_0 \) a infinito \( T_0 \to \infty \) per rappresentare \( v(t) \)
\end{itemize}

\begin{example}
  Partiamo da un segnale non periodico e lo replichiamo nel tempo con periodo \( T_0 \) 
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \def\Tone{2}
      \def\Tzero{2.5*\Tone}
      \begin{axis}[
        clip=false,
        width = 1\textwidth,
        height = 0.4\textwidth,
        ylabel = $\tilde{v}(t)$,
        xlabel = $t$,
        xmin=-\Tzero*1.5, xmax=\Tzero*1.5,
        ymin= 0, ymax = 3,
        ytick = \empty,
        xtick = {-\Tzero, -\Tone, \Tone, \Tzero},
        xticklabels = {$-T_0$, $-T_1$, $T_1$, $T_0$},
        axis lines = middle,
        declare function ={ f(\x) = sin(deg(\x))/2 + 1.5; },
        ]
        \addplot[blue,thick,domain=-\Tone:\Tone,samples=100]{f(x)};
        \draw[dashed] (axis cs:-\Tone,0) -- (axis cs:-\Tone,{f(-\Tone)});
        \draw[dashed] (axis cs:\Tone,0) -- (axis cs:\Tone,{f(\Tone)});

        \addplot[green!50!black,thick,domain=-\Tone -\Tzero:\Tone - \Tzero,samples=100]{f(x + \Tzero)};
        \draw[dashed] (axis cs:-\Tone-\Tzero,0) -- (axis cs:-\Tone-\Tzero,{f(-\Tone)});
        \draw[dashed] (axis cs:\Tone-\Tzero,0) -- (axis cs:\Tone-\Tzero,{f(\Tone)});


        \addplot[green!50!black,thick,domain=-\Tone +\Tzero:\Tone + \Tzero,samples=100]{f(x - \Tzero)};
        \draw[dashed] (axis cs:-\Tone+\Tzero,0) -- (axis cs:-\Tone+\Tzero,{f(-\Tone)});
        \draw[dashed] (axis cs:\Tone+\Tzero,0) -- (axis cs:\Tone+\Tzero,{f(\Tone)});

        \node[coordinate, pin={[green!50!black,align=center,pin distance=1cm]above:Segnale non periodico\\replicato con periodo $T_0$}] at (axis cs:\Tzero,{f(0)}) {};
      \end{axis}
    \end{tikzpicture}
    \caption{Segnale non periodico replicato}
  \end{figure}
  \[
    \tilde{v}(t) = v(t) \quad |t| < \frac{T_0}{2}
  \] 
  Applichiamo la serie di Fourier su \( \tilde{v}(t) \):
  \[
    \tilde{v}(t) = \sum_{k=-\infty}^{+\infty} \tilde{a}_k \cdot e^{j k \omega_0 t}
  \] 
  \[
    \omega_0 = \frac{2 \pi}{T_0} = 2 \pi f_0
  \] 
  \[
    \begin{aligned}
      a_k &= \frac{1}{T_0} \int_{-\frac{T_0}{2}}^{\frac{T_0}{2}} \tilde{v}(t) e^{-j k \omega_0 t} \, dt\\
          &= \frac{1}{T_0} \int_{-\infty}^{+\infty} v(t) e^{-j k \omega_0 t} \, dt
    \end{aligned}
  \] 
  Rappresentiamo \( k \omega_0 \) con una funzione \( V(\omega) \) 
  \[
    V(\omega) := \int_{-\infty}^{+\infty} v(t) e^{-j \omega t} \, dt \quad \to \quad
    T_0 a_k = V(\omega) \Big|_{\omega = k \omega_0}
  \] 
  \( V(\omega) \) è l'\textbf{inviluppo} di \( T_0 a_k \):
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        width = 1\textwidth,
        height = 0.6\textwidth,
        ylabel = \( j \pi a_k \),
        xlabel = \( \omega \),
        ymin=-3, ymax=3,
        xmin=-6, xmax=6,
        ytick=\empty,
        xtick={1,...,5},
        xticklabel style = {scale=0.8},
        axis lines = center
        ]
        \addplot[blue, mark=*, mark size=1.5pt] coordinates {
            (-5,-2/5) (-4,0) (-3,-2/3) (-2,0) (-1,-2) (0,0)
            (1,2) (2,0) (3,2/3) (4,0) (5,2/5)
          };

        \node[pin={[]right:$T_0 a_k$}] at (axis cs: 1, 2) {};
        \node[pin={[blue]above:$V(w)$}] at (axis cs: 4.5, 0.1) {};
      \end{axis}
    \end{tikzpicture}
    \caption{Inviluppo di \( T_0 a_k \)}
  \end{figure}

  \vspace{1em}
  \noindent
  \[
    \begin{aligned}
      \tilde{v}(t) &= \sum_{k=-\infty}^{+\infty} a_k \cdot e^{j k \omega_0 t}\\
                   &= \sum_{k=-\infty}^{+\infty} \frac{1}{T_0} V(k \omega_0) \cdot e^{j k \omega_0 t}\\
    \end{aligned}
  \] 
  \[
  \downarrow
  \] 
  \[
    \tilde{v}(t) = \frac{1}{2 \pi } \sum_{k=-\infty}^{+\infty} V(k \omega_0) \cdot e^{j k \omega_0 t} \omega_0
  \] 
  Se \( T_0 \to \infty \) otteniamo che:
  \begin{itemize}
    \item \( \omega_0 \to 0 \) 
    \item \( \tilde{v}(t) \to v(t) \) 
    \item \( \omega_0 \to d \omega \) 
    \item \( \sum \to \int \) 
  \end{itemize}
  Con queste premesse possiamo riscrivere la funzione come:
  \[
    \tilde{v}(t) = \frac{1}{2 \pi } \sum_{-\infty}^{+\infty} V(k \omega_0) \cdot e^{j k \omega_0 t} \omega_0
  \] 
  \[
  \downarrow
  \] 
  \[
    v(t) = \frac{1}{2 \pi } \int_{-\infty}^{+\infty} V(\omega) \cdot e^{j \omega t} \, d\omega
  \] 
  È la trasformata di Fourier inversa.

  \vspace{1em}
  \noindent
  \[
    V(\omega) = \int_{-\infty}^{+\infty} v(t) \cdot e^{-j \omega t} \, dt
  \] 
  È la trasformata di Fourier.
\end{example}

\begin{definition}
  \[
    v(t) = \frac{1}{2 \pi } \int_{-\infty}^{+\infty} V(\omega) \cdot e^{j \omega t} \, d\omega
  \] 
  È l'\textbf{equazione di sintesi per un segnale non periodico} che equivale alla
  trasformata \textbf{inversa} di Fourier.

  \vspace{1em}
  \noindent
  \[
    V(\omega) = \int_{-\infty}^{+\infty} v(t) \cdot e^{-j \omega t} \, dt
  \] 
  È l'\textbf{equazione di analisi per un segnale non periodico} che equivale alla
  \textbf{trasformata di Fourier}.
\end{definition}

\begin{example}
  Prendiamo ad esempio un segnale non periodico:
  \[
    v(t) = e^{-at}
  \] 
  Calcoliamo la trasformata di Fourier:
  \[
    \begin{aligned}
      V(\omega) &= \int_{-\infty}^{+\infty} v(t) \cdot e^{-j \omega t} \, dt\\
                &= \int_{-\infty}^{+\infty} e^{-t (a+j \omega)} \, dt\\
                &= \frac{-1}{a + j \omega} \cdot e^{-(a+j \omega)t} \Big|_{\infty}^{0}\\
                &= \frac{1}{a + j \omega}
    \end{aligned}
  \] 

  \vspace{1em}
  \noindent
  Con Laplace sarebbe stato:
  \[
    e^{\lambda t} = \frac{1}{s - \lambda}
  \] 
  \[
  \downarrow
  \] 
  \[
    e^{-at} = \frac{1}{s + a} = \frac{1}{a + j \omega}
  \] 
\end{example}

\subsubsection{Sviluppo dei coefficienti di Fourier}
Prendiamo in considerazione il segnale rettangolare:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\Tone{1/2}
    \def\Tzero{2.5*\Tone}
    \def\A{1}
    \begin{axis}[
      clip=false,
      width = .6\textwidth,
      height = .4\textwidth,
      ylabel = $x(t)$,
      xlabel = $t$,
      xmin=-\Tzero*1.5, xmax=\Tzero*1.5,
      ymin= -0.5, ymax = \A * 2,
      ytick = \empty,
      xtick = {-\Tzero, -\Tone, \Tone, \Tzero},
      xticklabels = {$-T_0$, $-T_1$, $T_1$, $T_0$},
      axis lines = middle,
      xlabel style = {below},
      declare function ={ 
        rect(\x) = 
        (abs(\x) > \Tone) * 0 +
        (abs(\x) == \Tone) * 0 +
        (abs(\x) < \Tone-0.0001) * \A
      ;},
      ]
      \addplot[blue,thick,domain=-\Tone:\Tone,samples=100]{rect(x)};

      % \addplot[green!50!black,thick,domain=-\Tone -\Tzero:\Tone - \Tzero,samples=100]{rect(x + \Tzero)};
      % \addplot[green!50!black,thick,domain=-\Tone +\Tzero:\Tone + \Tzero,samples=100]{rect(x - \Tzero)};
      \node[align=center,opacity=0,scale=0.8] at (axis description cs:0.5,-0.15) {Inviluppo dei\\coefficienti};
    \end{axis}
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\Tone{1/2}
    \def\Tzero{2.5*\Tone}
    \def\A{1}
    \begin{axis}[
      clip=false,
      width = .6\textwidth,
      height = .4\textwidth,
      ylabel = $\frac{1}{T_0}X(\omega)$,
      xlabel = $\omega$,
      xmin=-15, xmax=15,
      ymin= -0.5, ymax = \A * 1.9,
      ytick = \empty,
      axis lines = middle,
      xlabel style = {below},
      declare function ={ 
        sinc(\x) = 
        (\x == 0) * \A +
        sin(deg(\x))/\x
      ;},
      ]
      \addplot[cyan,thick,domain=-15:15,samples=100]{sinc(x)};

      \node[align=center,scale=0.8] at (axis description cs:0.5,-0.15) {Inviluppo dei\\coefficienti};
    \end{axis}
  \end{tikzpicture}
  \caption{Segnale rettangolare}
\end{figure}
\noindent
Replichiamo il segnale in un periodo \( T_0 \) e osserviamo il cambiamento dei coefficienti
di Fourier:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\Tone{1/2}
    \def\Tzero{2.5*\Tone}
    \def\A{1}
    \begin{axis}[
      clip=false,
      width = .6\textwidth,
      height = .4\textwidth,
      ylabel = $x(t)$,
      xlabel = $t$,
      xmin=-\Tzero*1.5, xmax=\Tzero*1.5,
      ymin= -0.5, ymax = \A * 2,
      ytick = \empty,
      xtick = {-\Tzero, -\Tone, \Tone, \Tzero},
      xticklabels = {$-T_0$, $-T_1$, $T_1$, $T_0$},
      axis lines = middle,
      xlabel style = {below},
      declare function ={ 
        rect(\x) = 
        (abs(\x) > \Tone) * 0 +
        (abs(\x) == \Tone) * 0 +
        (abs(\x) < \Tone-0.0001) * \A
      ;},
      ]
      \addplot[blue,thick,domain=-\Tone:\Tone,samples=100]{rect(x)};

      \addplot[green!50!black,thick,domain=-\Tone -\Tzero:\Tone - \Tzero,samples=100]{rect(x + \Tzero)};
      \addplot[green!50!black,thick,domain=-\Tone +\Tzero:\Tone + \Tzero,samples=100]{rect(x - \Tzero)};
      \node[align=center,opacity=0,scale=0.8] at (axis description cs:0.5,-0.15) {Inviluppo dei\\coefficienti};
    \end{axis}
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\Tone{1/2}
    \def\Tzero{2.5*\Tone}
    \def\A{1}
    \begin{axis}[
      clip=false,
      width = .6\textwidth,
      height = .4\textwidth,
      ylabel = $\frac{1}{T_0}X(\omega)$,
      xlabel = $\omega$,
      xmin=-15, xmax=15,
      ymin= -0.5, ymax = \A * 1.9,
      ytick = \empty,
      axis lines = middle,
      xlabel style = {below},
      declare function ={ 
        sinc(\x) = 
        (\x == 0) * \A +
        sin(deg(\x))/\x
      ;},
      ]
      \addplot[cyan,thick,domain=-15:15,samples=100]{sinc(x)};

      \node[align=center,scale=0.8] at (axis description cs:0.5,-0.15) {Inviluppo dei\\coefficienti};

      \def\inc{1.5}
      \pgfplotsinvokeforeach{-15,-15 + \inc,...,15}{
        \draw[cyan, -latex] (axis cs:#1,0) -- (axis cs:#1,{sinc(#1)});
      }
    \end{axis}
  \end{tikzpicture}
  \caption{$T_0 = 4T_1$}
\end{figure}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\Tone{1/2}
    \def\Tzero{3.5*\Tone}
    \def\A{1}
    \begin{axis}[
      clip=false,
      width = .6\textwidth,
      height = .4\textwidth,
      ylabel = $x(t)$,
      xlabel = $t$,
      xmin=-\Tzero*1.5, xmax=\Tzero*1.5,
      ymin= -0.5, ymax = \A * 2,
      ytick = \empty,
      xtick = {-\Tzero, -\Tone, \Tone, \Tzero},
      xticklabels = {$-T_0$, $-T_1$, $T_1$, $T_0$},
      axis lines = middle,
      xlabel style = {below},
      declare function ={ 
        rect(\x) = 
        (abs(\x) > \Tone) * 0 +
        (abs(\x) == \Tone) * 0 +
        (abs(\x) < \Tone-0.0001) * \A
      ;},
      ]
      \addplot[blue,thick,domain=-\Tone:\Tone,samples=100]{rect(x)};

      \addplot[green!50!black,thick,domain=-\Tone -\Tzero:\Tone - \Tzero,samples=100]{rect(x + \Tzero)};
      \addplot[green!50!black,thick,domain=-\Tone +\Tzero:\Tone + \Tzero,samples=100]{rect(x - \Tzero)};
      \node[align=center,opacity=0,scale=0.8] at (axis description cs:0.5,-0.15) {Inviluppo dei\\coefficienti};
    \end{axis}
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\Tone{1/2}
    \def\Tzero{2.5*\Tone}
    \def\A{1}
    \begin{axis}[
      clip=false,
      width = .6\textwidth,
      height = .4\textwidth,
      ylabel = $\frac{1}{T_0}X(\omega)$,
      xlabel = $\omega$,
      xmin=-15, xmax=15,
      ymin= -0.5, ymax = \A * 1.9,
      ytick = \empty,
      axis lines = middle,
      xlabel style = {below},
      declare function ={ 
        sinc(\x) = 
        (\x == 0) * \A +
        sin(deg(\x))/\x
      ;},
      ]
      \addplot[cyan,thick,domain=-15:15,samples=100]{sinc(x)};

      \node[align=center,scale=0.8] at (axis description cs:0.5,-0.15) {Inviluppo dei\\coefficienti};

      \def\inc{0.75}
      \pgfplotsinvokeforeach{-15,-15 + \inc,...,15}{
        \draw[cyan, -latex] (axis cs:#1,0) -- (axis cs:#1,{sinc(#1)});
      }
    \end{axis}
  \end{tikzpicture}
  \caption{$T_0 = 8T_1$}
\end{figure}
\[
\ldots
\] 
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \def\Tone{1/2}
    \def\Tzero{6.5*\Tone}
    \def\A{1}
    \begin{axis}[
      clip=false,
      width = .6\textwidth,
      height = .4\textwidth,
      ylabel = $x(t)$,
      xlabel = $t$,
      xmin=-\Tzero*1.5, xmax=\Tzero*1.5,
      ymin= -0.5, ymax = \A * 2,
      ytick = \empty,
      xtick = {-\Tzero, -\Tone, \Tone, \Tzero},
      xticklabels = {$-\infty$, $-T_1$, $T_1$, $\infty$},
      axis lines = middle,
      xlabel style = {below},
      declare function ={ 
        rect(\x) = 
        (abs(\x) > \Tone) * 0 +
        (abs(\x) == \Tone) * 0 +
        (abs(\x) < \Tone-0.0001) * \A
      ;},
      ]
      \addplot[blue,thick,domain=-\Tone:\Tone,samples=100]{rect(x)};

      \addplot[green!50!black,thick,domain=-\Tone -\Tzero:\Tone - \Tzero,samples=100]{rect(x + \Tzero)};
      \addplot[green!50!black,thick,domain=-\Tone +\Tzero:\Tone + \Tzero,samples=100]{rect(x - \Tzero)};
      \node[align=center,opacity=0,scale=0.8] at (axis description cs:0.5,-0.15) {Inviluppo dei\\coefficienti};
    \end{axis}
  \end{tikzpicture}
  \begin{tikzpicture}
    \def\Tone{1/2}
    \def\Tzero{2.5*\Tone}
    \def\A{1}
    \begin{axis}[
      clip=false,
      width = .6\textwidth,
      height = .4\textwidth,
      ylabel = $\frac{1}{T_0}X(\omega)$,
      xlabel = $\omega$,
      xmin=-15, xmax=15,
      ymin= -0.5, ymax = \A * 1.9,
      ytick = \empty,
      axis lines = middle,
      xlabel style = {below},
      declare function ={ 
        sinc(\x) = 
        (\x == 0) * \A +
        sin(deg(\x))/\x
      ;},
      ]
      \addplot[cyan,thick,fill=cyan,fill opacity=0.5,domain=-15:15,samples=100]{sinc(x)} \closedcycle;

      \node[align=center,scale=0.8] at (axis description cs:0.5,-0.15) {Inviluppo dei\\coefficienti};
    \end{axis}
  \end{tikzpicture}
  \caption{$T_0 \to \infty$}
\end{figure}

\subsubsection{Trasformata di Fourier di un segnale periodico}
\[
  \begin{aligned}
    \tilde{v}(t) \leftrightarrow a_k \quad \text{Coefficienti delle serie di fourier}\\
    \tilde{v}(t) \stackrel{\mathcal{F}}{\leftrightarrow} \tilde{V}(\omega) \quad \text{Trasformata di Fourier}\\
    \tilde{v}(t) := \sum_{k=-\infty}^{+\infty} 2 \pi a_k \cdot \delta(\omega - k \omega_0) \text{ Treno di impulsi}\\
  \end{aligned}
\] 
\[
  \begin{aligned}
    \tilde{v}(t) &= \frac{1}{2 \pi } \int_{-\infty}^{+\infty} \tilde{V}(\omega) \cdot e^{j \omega t} \, d\omega\\
                 &= \frac{1}{2 \pi } \sum_{k=-\infty}^{+\infty} 2 \pi a_k \cdot
                 \underbrace{\int_{-\infty}^{+\infty} \delta(\omega - k \omega_0) \cdot e^{-j \omega t} \, d\omega}_{e^{-j k \omega_0 t}}
  \end{aligned}
\] 

\subsubsection{Come usare la trasformata di Fourier}
\begin{enumerate}
  \item \( v(t) \) non periodico
    \begin{itemize}
      \item Costruisco un segnale periodico \( \tilde{v}(T) \) in cui il singolo periodo
        è definito da \( v(t) \)
      \item \( \tilde{v}(t) \) ha serie di fourier
      \item All'aumentare del periodo $\tilde{v}(t) \to v(t)$ e la serie di Fourier di
        \( \tilde{v}(t) \to TdF \) di \( v(t) \) 
    \end{itemize}

  \item \( \tilde{v}(t) \) è periodico, \( v(t) \) rappresenta il singolo periodo
    \begin{itemize}
      \item Coefficienti della serie di Fourier \( = \frac{1}{T_0} \cdot \text{campioni delle
        TdF di } v(t) \)
    \end{itemize}

  \item \( \tilde{v}(t) \) è periodico
    \begin{itemize}
      \item La trasformata di Fourier di \( \tilde{v}(t) \) è definita come \textbf{treno
        di impulsi}
        \[
          \tilde{V}(\omega) = \sum_{k=-\infty}^{+\infty} 2 \pi a_k \cdot \delta(\omega - k \omega_0)
        \] 
        \begin{figure}[H]
          \centering
          \def\A{1}
          \def\xmin{-4}
          \def\xmax{4}
          \begin{tikzpicture}
            \begin{axis}[
              clip = false,
              height = 0.4\textwidth,
              ylabel = \(v(t)\),
              xlabel = \(t\),
              xmin= \xmin, xmax= \xmax,
              ymin= 0, ymax = 1.5,
              ytick = \empty,
              xtick = \empty,
              axis lines = middle,
              ]
              \addplot[-latex,blue,ultra thick] coordinates {
                  (0,0) (0,\A)
                } node[above right,scale=0.9] {$v(t)$ non periodico};
            \end{axis}
          \end{tikzpicture}
          \scalebox{2}{\( \stackrel{\mathcal{F}}{\leftrightarrow} \)}
          \begin{tikzpicture}
            \begin{axis}[
              clip = false,
              height = 0.4\textwidth,
              ylabel = \(V(\omega)\),
              xlabel = \(\omega\),
              xmin= \xmin, xmax= \xmax,
              ymin= 0, ymax = 1.5,
              ytick = \empty,
              xtick = \empty,
              axis lines = middle,
              ]
              \addplot[cyan,thick] coordinates {
                  (\xmin,\A) (\xmax,\A)
                };
            \end{axis}
          \end{tikzpicture}
        \end{figure}
        \noindent
        Se \( T_0 \to \infty\) allora il treno di impulsi diventa sempre più fitto fino
        ad una retta costante:
        \begin{figure}[H]
          \centering
          \begin{tikzpicture}
            \def\A{1}
            \def\xmin{-10}
            \def\xmax{10}
            \def\Tzero{2}
            \begin{axis}[
              clip = false,
              height = 0.4\textwidth,
              ylabel = \(\tilde{v}(t)\),
              xlabel = \(t\),
              xmin= \xmin, xmax= \xmax,
              ymin= 0, ymax = 1.5,
              ytick = \empty,
              xtick = {-\Tzero,\Tzero},
              xticklabels = {\(-T_0\),\(T_0\)},
              axis lines = middle,
              ]
              \pgfplotsinvokeforeach{0,\Tzero,...,\xmax-0.5}{
                \addplot[-latex,blue,domain=\xmin:\xmax,ultra thick] coordinates {
                    (#1,0) (#1,\A)
                  };
              }

              \pgfplotsinvokeforeach{-\Tzero, -2*\Tzero,...,\xmin+0.5}{
                \addplot[-latex,blue,domain=\xmin:\xmax,ultra thick] coordinates {
                    (#1,0) (#1,\A)
                  };
              }

              \draw[opacity=0] (axis cs:0,0) -- (axis cs:0,-0.1) 
                -- (axis cs:{(2*pi)/\Tzero},-0.1)
                node[midway, below] {\(\frac{2\pi}{T_0}\)} -- (axis cs:{(2*pi)/\Tzero},0);
            \end{axis}
          \end{tikzpicture}
          \scalebox{2}{\( \stackrel{\mathcal{F}}{\leftrightarrow} \)}
          \begin{tikzpicture}
            \def\A{1}
            \def\xmin{-10}
            \def\xmax{10}
            \def\Tzero{2}
            \begin{axis}[
              clip = false,
              height = 0.4\textwidth,
              ylabel = \(\tilde{V}(\omega)\),
              xlabel = \(\omega\),
              xmin= \xmin, xmax= \xmax,
              ymin= 0, ymax = 1.5,
              ytick = \empty,
              xtick = \empty,
              axis lines = middle,
              xlabel style = {below},
              ]

              \def\inc{(2*pi)/\Tzero}
              \pgfplotsinvokeforeach{\xmin+0.5,\xmin+0.5 + \inc,...,\xmax}{
                \addplot[-latex,cyan,domain=\xmin:\xmax,ultra thick] coordinates {
                    (#1,0) (#1,\A)
                  };
              }

              \draw (axis cs:\xmin+0.5,0) -- (axis cs:\xmin+0.5,-0.1) 
                -- (axis cs:{\xmin+0.5+(2*pi)/\Tzero},-0.1)
                node[midway, below] {\(\frac{2\pi}{T_0}\)} -- (axis cs:{\xmin+0.5+(2*pi)/\Tzero},0);
            \end{axis}
          \end{tikzpicture}
        \end{figure}
        \begin{figure}[H]
          \centering
          \begin{tikzpicture}
            \def\A{1}
            \def\xmin{-10}
            \def\xmax{10}
            \def\Tzero{4}
            \begin{axis}[
              clip = false,
              height = 0.4\textwidth,
              ylabel = \(\tilde{v}(t)\),
              xlabel = \(t\),
              xmin= \xmin, xmax= \xmax,
              ymin= 0, ymax = 1.5,
              ytick = \empty,
              xtick = {-\Tzero,\Tzero},
              xticklabels = {\(-T_0\),\(T_0\)},
              axis lines = middle,
              ]
              \pgfplotsinvokeforeach{0,\Tzero,...,\xmax-0.5}{
                \addplot[-latex,blue,domain=\xmin:\xmax,ultra thick] coordinates {
                    (#1,0) (#1,\A)
                  };
              }

              \pgfplotsinvokeforeach{-\Tzero, -2*\Tzero,...,\xmin+0.5}{
                \addplot[-latex,blue,domain=\xmin:\xmax,ultra thick] coordinates {
                    (#1,0) (#1,\A)
                  };
              }

              \draw[opacity=0] (axis cs:0,0) -- (axis cs:0,-0.1) 
                -- (axis cs:{(2*pi)/\Tzero},-0.1)
                node[midway, below] {\(\frac{2\pi}{T_0}\)} -- (axis cs:{(2*pi)/\Tzero},0);
            \end{axis}
          \end{tikzpicture}
          \scalebox{2}{\( \stackrel{\mathcal{F}}{\leftrightarrow} \)}
          \begin{tikzpicture}
            \def\A{1}
            \def\xmin{-10}
            \def\xmax{10}
            \def\Tzero{4}
            \begin{axis}[
              clip = false,
              height = 0.4\textwidth,
              ylabel = \(\tilde{V}(\omega)\),
              xlabel = \(\omega\),
              xmin= \xmin, xmax= \xmax,
              ymin= 0, ymax = 1.5,
              ytick = \empty,
              xtick = \empty,
              axis lines = middle,
              xlabel style = {below},
              ]

              \def\inc{(2*pi)/\Tzero}
              \pgfplotsinvokeforeach{\xmin+0.5,\xmin+0.5 + \inc,...,\xmax}{
                \addplot[-latex,cyan,domain=\xmin:\xmax,ultra thick] coordinates {
                    (#1,0) (#1,\A)
                  };
              }

              \draw (axis cs:\xmin+0.5,0) -- (axis cs:\xmin+0.5,-0.1) 
                -- (axis cs:{\xmin+0.5+(2*pi)/\Tzero},-0.1)
                node[midway, below] {\(\frac{2\pi}{T_0}\)} -- (axis cs:{\xmin+0.5+(2*pi)/\Tzero},0);
            \end{axis}
          \end{tikzpicture}
        \end{figure}
        \begin{figure}[H]
          \centering
          \begin{tikzpicture}
            \def\A{1}
            \def\xmin{-10}
            \def\xmax{10}
            \def\Tzero{8}
            \begin{axis}[
              clip = false,
              height = 0.4\textwidth,
              ylabel = \(\tilde{v}(t)\),
              xlabel = \(t\),
              xmin= \xmin, xmax= \xmax,
              ymin= 0, ymax = 1.5,
              ytick = \empty,
              xtick = {-\Tzero,\Tzero},
              xticklabels = {\(-\infty\),\(\infty\)},
              axis lines = middle,
              ]
              \pgfplotsinvokeforeach{0,\Tzero,...,\xmax-0.5}{
                \addplot[-latex,blue,domain=\xmin:\xmax,ultra thick] coordinates {
                    (#1,0) (#1,\A)
                  };
              }

              \pgfplotsinvokeforeach{-\Tzero, -2*\Tzero,...,\xmin+0.5}{
                \addplot[-latex,blue,domain=\xmin:\xmax,ultra thick] coordinates {
                    (#1,0) (#1,\A)
                  };
              }

              \draw[opacity=0] (axis cs:0,0) -- (axis cs:0,-0.1) 
                -- (axis cs:{(2*pi)/\Tzero},-0.1)
                node[midway, below] {\(\frac{2\pi}{T_0}\)} -- (axis cs:{(2*pi)/\Tzero},0);
            \end{axis}
          \end{tikzpicture}
          \scalebox{2}{\( \stackrel{\mathcal{F}}{\leftrightarrow} \)}
          \begin{tikzpicture}
            \def\A{1}
            \def\xmin{-10}
            \def\xmax{10}
            \def\Tzero{10}
            \begin{axis}[
              clip = false,
              height = 0.4\textwidth,
              ylabel = \(\tilde{V}(\omega)\),
              xlabel = \(\omega\),
              xmin= \xmin, xmax= \xmax,
              ymin= 0, ymax = 1.5,
              ytick = \empty,
              xtick = \empty,
              axis lines = middle,
              xlabel style = {below},
              ]

              \addplot[cyan,domain=\xmin:\xmax,ultra thick] coordinates {
                  (\xmin+0.5,\A) (\xmax-0.5,\A)
                };
              \addplot[fill=cyan,fill opacity=0.5,domain=\xmin:\xmax,draw opacity=0] coordinates {
                  (\xmin+0.5,\A) (\xmax-0.5,\A)
                  (\xmax-0.5,0) (\xmin+0.5,0)
                } \closedcycle;

              \def\inc{(2*pi)/\Tzero}
              \pgfplotsinvokeforeach{\xmin+0.5,\xmin+0.5 + \inc,...,\xmax-0.5}{
                \addplot[-latex,cyan,opacity=0.2,domain=\xmin:\xmax,ultra thick] coordinates {
                    (#1,0) (#1,\A)
                  };
              }

              \draw (axis cs:\xmin+0.5,0) -- (axis cs:\xmin+0.5,-0.1) 
                -- (axis cs:{\xmin+0.5+(2*pi)/\Tzero},-0.1)
                node[midway, below] {\(\frac{2\pi}{T_0}\)} -- (axis cs:{\xmin+0.5+(2*pi)/\Tzero},0);
            \end{axis}
          \end{tikzpicture}
          \caption{Trasformata di Fourier all'aumentare di \(T_0\)}
        \end{figure}
    \end{itemize}
\end{enumerate}

% -----------------
\subsection{Condizioni di esistenza della trasformata di Fourier}
\begin{definition}[Equazione di sintesi]
  Sia \( v(t), \; t \in \mathbb{R} \) un segnale a valori reali o complessi, si definisce
  la trasformata di Fourier del segnale come:
  \[
    \mathcal{F} \left[ v(t) \right](f) := \int_{-\infty}^{+\infty} v(t) \cdot
    e^{-j \omega_0 t} \, dt = V(f)
  \] 
  Dove \( V \) è una funzione che va da \( \mathbb{R} \to \mathbb{C} \), con \( f \in \mathbb{R} \).
  Questa viene chiamata \textbf{equazione di sintesi}.
\end{definition}
\begin{definition}[Equazione di analisi]
  Data una funzione \( V: \mathbb{R} \to \mathbb{C} \) si definisce anti-trasformata di
  Fourier la funzione:
  \[
    \mathcal{F}^{-1}\left[ V(f) \right](t) := \frac{1}{2 \pi } \int_{-\infty}^{+\infty} V(f) \cdot
    e^{j \omega_0 t} \, df = v(t)
  \] 
  Dove \( v \) è una funzione che va da \( \mathbb{R} \to \mathbb{C} \), con \( t \in \mathbb{R} \).
  Questa viene chiamata \textbf{equazione di analisi}.
\end{definition}
\vspace{1em}
\noindent
\textbf{Condizioni di esistenza della trasformata di Fourier}:
\begin{theorem}
  Sia \( v(t), \; t \in \mathbb{R} \) un segnale a valori reali o complessi. Se almeno
  una delle seguenti condizioni è vera, allora la funzione è trasformabile secondo
  \( \mathcal{F} \):
  \begin{enumerate}
    \item \( v(t) \) è sommabile, cioè: 
      \[
        \int_{-\infty}^{+\infty} \left| v(t) \right| \,dt < \infty
      \]
      e a variabile limitata su ogni intervallo finito di \( \mathbb{R} \), cioè è
      esprimibile come differenza di funzioni limitate non decrescenti.

    \item \( v(t) \) è un segnale di energia, cioè:
      \[
        \int_{-\infty}^{+\infty} \left| v(t) \right|^2 \, dt < \infty
      \]

    \item \( v(t) \) è un segnale di potenza, cioè:
      \[
        \lim_{T \to \infty} \frac{1}{2T} \int_{-\infty}^{+\infty} \left| v(t) \right|^2 \, dt < \infty
      \] 
      bisogna però "\textbf{finestrare}" il segnale, cioè moltiplicarlo per una
      finestra rettangolare
  \end{enumerate}
\end{theorem}

\subsection{Trasformate notevoli}
Le trasformate di Fourier notevoli sono le seguenti:
\begin{itemize}
  \item \textbf{Impulso}
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$t$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$v(t)$};

        \draw[-latex,blue,thick] (0,0) -- (0,1) node[right] {$A$};
      \end{tikzpicture}
      \caption{Impulso unitario}
    \end{figure}
    \noindent
    La trasformata di Fourier è:
    \[
      \begin{aligned}
        \mathcal{F}\left[ A \delta_0(t) \right](f) &= A 
        \int_{-\infty}^{+\infty} \delta_0(t) \cdot e^{-j 2 \pi f t} \, dt\\
                                                   &= A \int_{-\infty}^{+\infty}
                                                   \delta_0(t) \cdot 1 \, dt\\
                                                   &= A
      \end{aligned}
    \] 
    (per le regole del campionamento)
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$f$};
        \draw[->] (0,-0.1) -- (0,1.5) node[above] {$V(\omega)$};

        \draw[cyan,thick] (-1.5,1) -- (1.5,1) node[right] {$A$};
      \end{tikzpicture}
      \caption{Trasformata di Fourier dell'impulso}
    \end{figure}


  \item \textbf{Esponenziale causale}
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \begin{axis}[
          axis lines = middle,
          xmin= 0, xmax= 6,
          ymin= 0, ymax = 6,
          ylabel = $v(t)$,
          xlabel = $t$,
          xtick = \empty,
          ytick = \empty,
          xlabel style = {below},
          ylabel style = {left},
          ]
          \addplot[blue,thick,domain=0:6, samples=50]{exp(x/2)};
          \addplot[red,thick,domain=0:6, samples=50]{exp(-x/2)};
        \end{axis}
      \end{tikzpicture}
      \caption{Esponenziale causale}
    \end{figure}
    \noindent
    La trasformata di Fourier è:
    \[
      \mathcal{F}\left[ A e^{j \phi} e^{\lambda t} 
      \underbrace{\delta_{-1}(t)}_{\text{Causalità}} \right](t) =
      \frac{A e^{j \phi}}{j 2 \pi  f - \lambda}
    \] 

    \vspace{1em}
    \noindent
    La trasformata di Laplace è molto simile, basta infatti sostituire la \( s \) 
    con \( j \omega = j 2 \pi f \) e si ottiene la trasformata di Fourier:
    \[
      \mathcal{L}\left[ A e^{j \phi} e^{\lambda t} 
      \delta_{-1}(t) \right](s) = \frac{A e^{j \phi}}{s - \lambda}
    \] 


  \item \textbf{Finestra rettangolare di altezza \( A \) e supporto \( T \)}
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \def\T{1/2}
        \def\xmin{-\T*3}
        \def\xmax{\T*3}
        \def\A{1}
        \begin{axis}[
          clip=false,
          width = .6\textwidth,
          height = .4\textwidth,
          ylabel = $v(t)$,
          xlabel = $t$,
          xmin=\xmin, xmax=\xmax,
          ymin= -0.5, ymax = \A * 2,
          ytick = {\A},
          yticklabels = {$A$},
          yticklabel style = {above right},
          xtick = {-\T, \T},
          xticklabels = {$-\frac{T}{2}$, $\frac{T}{2}$},
          axis lines = middle,
          xlabel style = {below},
          declare function ={ 
            rect(\x) = 
            (abs(\x) > \T) * 0 +
            (abs(\x) == \T) * 0 +
            (abs(\x) < \T-0.0001) * \A
          ;},
          ]
          \addplot[blue,thick,domain=\xmin:\xmax,samples=100]{rect(x)};
        \end{axis}
      \end{tikzpicture}
      \caption{Finestra rettangolare}
    \end{figure}
    \noindent
    La trasformata di Fourier è:
    \[
      \mathcal{F}\left[ A \Pi\left(\frac{t}{T}\right) \right](f) = AT \cdot sinc(fT)
    \]
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \def\Tone{1/2}
        \def\Tzero{2.5*\Tone}
        \def\A{1}
        \begin{axis}[
          clip=false,
          width = .6\textwidth,
          height = .4\textwidth,
          ylabel = $V(\omega)$,
          xlabel = $\omega$,
          xmin=-15, xmax=15,
          ymin= -0.5, ymax = \A * 1.9,
          ytick = {\A},
          yticklabels = {$A$},
          yticklabel style = {above right},
          xtick = \empty,
          axis lines = middle,
          xlabel style = {below},
          declare function ={ 
            sinc(\x) = 
            (\x == 0) * \A +
            sin(deg(\x))/\x
          ;},
          ]
          \addplot[cyan,thick,domain=-15:15,samples=100]{sinc(x)};
        \end{axis}
      \end{tikzpicture}
      \caption{Trasformata di Fourier della finestra rettangolare}
    \end{figure}
    \noindent
    Questa funzione è chiamata \textbf{sinc}.


  \item \textbf{Funzione costante}
    \vspace{1em}
    \noindent
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \def\T{1/2}
        \def\xmin{-\T*3}
        \def\xmax{\T*3}
        \def\A{1}
        \begin{axis}[
          clip=false,
          width = .5\textwidth,
          height = .4\textwidth,
          ylabel = $v(t)$,
          xlabel = $t$,
          xmin=\xmin, xmax=\xmax,
          ymin= -0.5, ymax = \A * 2,
          ytick = {\A},
          yticklabels = {$A$},
          yticklabel style = {above right},
          xtick = {-\T, \T},
          xticklabels = {$-\frac{T}{2}$, $\frac{T}{2}$},
          axis lines = middle,
          xlabel style = {below},
          declare function ={ 
            rect(\x) = 
            (abs(\x) > \T) * 0 +
            (abs(\x) == \T) * 0 +
            (abs(\x) < \T-0.0001) * \A
          ;},
          ]
          \addplot[orange,domain=\xmin:\xmax,samples=100]{rect(x)};

          \addplot[blue,thick,domain=\xmin:\xmax]{\A/2};

          \node[pin={[orange]45:{$\Pi\left( \frac{t}{T} \right)$}}] at (axis cs:\T,\A) {};
        \end{axis}
      \end{tikzpicture}
      \scalebox{2}{\( \to \)}
      \begin{tikzpicture}
        \def\T{1/2}
        \def\xmin{-\T*3}
        \def\xmax{\T*3}
        \def\A{1}
        \begin{axis}[
          clip=false,
          width = .5\textwidth,
          height = .4\textwidth,
          ylabel = $v(t) \cdot \Pi \left( \frac{t}{T} \right) $,
          xlabel = $t$,
          xmin=\xmin, xmax=\xmax,
          ymin= -0.5, ymax = \A * 2,
          ytick = {\A},
          yticklabels = {$A$},
          yticklabel style = {above right},
          xtick = {-\T, \T},
          xticklabels = {$-\frac{T}{2}$, $\frac{T}{2}$},
          axis lines = middle,
          xlabel style = {below},
          declare function ={ 
            rect(\x) = 
            (abs(\x) > \T) * 0 +
            (abs(\x) == \T) * 0 +
            (abs(\x) < \T-0.0001) * \A
          ;},
          ]
          \addplot[blue,thick,domain=\xmin:\xmax,samples=100]{rect(x)};

          \addplot[blue,dotted,thin,domain=\xmin:\xmax]{\A/2};
        \end{axis}
      \end{tikzpicture}
      \caption{Funzione costante}
    \end{figure}
    La funzione costante non può essere trasformata facilmente, quindi bisogna
    "finestrarla", cioè moltiplicare il segnale per una finestra rettangolare:
    \[
    v(t) = A \to v_T(t) = A \cdot \Pi(\frac{t}{T})
    \] 
    La sua trasformata di Fourier è la stessa del segnale rettangolare:
    \[
      \mathcal{F}\left[\underbrace{v(t)}_{\text{Ampiezza } = A} \cdot 
      \underbrace{\Pi\left(\frac{t}{T}\right)}_{\text{Ampiezza } = 1} \right](f)
      = AT \cdot sinc(fT)
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \def\Tone{1/2}
        \def\Tzero{2.5*\Tone}
        \def\A{1}
        \begin{axis}[
          clip=false,
          width = .6\textwidth,
          height = .4\textwidth,
          ylabel = $V(\omega)$,
          xlabel = $\omega$,
          xmin=-15, xmax=15,
          ymin= -0.5, ymax = \A * 1.9,
          ytick = {\A},
          yticklabels = {$A$},
          yticklabel style = {above right},
          xtick = \empty,
          axis lines = middle,
          xlabel style = {below},
          declare function ={ 
            sinc(\x) = 
            (\x == 0) * \A +
            sin(deg(\x))/\x
          ;},
          ]
          \addplot[cyan,thick,domain=-15:15,samples=100]{sinc(x)};
        \end{axis}
      \end{tikzpicture}
      \caption{Trasformata di Fourier della funzione costante}
    \end{figure}


  \item \textbf{Fasore}
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}[scale=1.5]
        \draw[->] (-1.5,0) -- (1.5,0) node[right] {$\Re$};
        \draw[->] (0,-1.5) -- (0,1.5) node[above] {$\Im$};

        \draw (0,0) circle (1);

        \draw[blue,thick,->] (1,0) arc (0:60:1);
      \end{tikzpicture}
      \caption{Fasore}
    \end{figure}
    \[
      v(t) = A \cdot e^{j 2 \pi f_0 t}
    \] 
    Anche in questo caso bisogna moltiplicare per il segnale rettangolare:
    \[
      v_T(t) = A \cdot e^{j 2 \pi f_0 t} \cdot \Pi\left(\frac{t}{T}\right)
    \] 
    La trasformata di Fourier è:
    \[
      \mathcal{F}\left[ v_T(t) \right](f) = AT \cdot sinc((f - f_0) \cdot t)
    \] 
    \begin{figure}[H]
      \centering
      \begin{tikzpicture}
        \def\Fzero{7}
        \def\A{1}
        \begin{axis}[
          clip=false,
          width = .6\textwidth,
          height = .4\textwidth,
          ylabel = $V(\omega)$,
          xlabel = $\omega$,
          xmin=-15, xmax=15,
          ymin= -0.5, ymax = \A * 1.9,
          ytick = {\A},
          yticklabels = {$A$},
          yticklabel style = {above right},
          xtick = \empty,
          axis lines = middle,
          xlabel style = {below},
          declare function ={ 
            sinc(\x) = 
            (\x == 0) * \A +
            sin(deg(\x))/\x
          ;},
          ]
          \addplot[cyan,thick,domain=-15:15,samples=100]{sinc(x - \Fzero)};

          \draw[dashed] (axis cs:\Fzero,\A) -- (axis cs:\Fzero,0) node[below] {$f_0$};
        \end{axis}
      \end{tikzpicture}
      \caption{Trasformata di Fourier del fasore}
    \end{figure}
  \item \textbf{Seno}
    \vspace{1em}
    \noindent
    Possiamo derivare il seno utilizzando la formula di Eulero su un fasore:
    \[
    v(t) = A \cdot \sin(2 \pi f_0 t)
    \] 
    La trasformata di Fourier è:
    \[
      \mathcal{F}\left[ v(t) \right](f) = \frac{A}{2j} \left( \delta(f - f_0) - \delta(f + f_0) \right)
    \]
    Il seno è solo la parte immaginaria del fasore.
  \item \textbf{Coseno}
    \vspace{1em}
    \noindent
    \[
    v(t) = A \cdot \cos(2 \pi f_0 t)
    \] 
    La trasformata di Fourier è:
    \[
      \mathcal{F}\left[ v(t) \right](f) = \frac{A}{2} \left( \delta(f - f_0) + \delta(f + f_0) \right)
    \]
    Il coseno è solo la parte reale del fasore.
\end{itemize}

\subsection{Proprietà della trasformata di Fourier}
La trasformata di Laplace è un caso specifico della trasformata di Fourier:
\[
\begin{aligned}
  TdL &\to TdF\\
  s &\to j \omega
\end{aligned}
\] 
Quindi alcune proprietà di Laplace valgono anche per Fourier.
\begin{enumerate}
  \item \textbf{Linearità}
    \[
      a v_1(t) + b v_2(t) \stackrel{\mathcal{F}}{\leftrightarrow} a V_1(f) + b V_2(f)
    \] 

  \item \textbf{Riflessione e coniugazione}
    \[
      v(-t) \stackrel{\mathcal{F}}{\leftrightarrow} V(-f) \quad \text{Riflessione}
    \] 
    \[
      \left.
      \begin{aligned}
        v^*(t) \stackrel{\mathcal{F}}{\leftrightarrow} V^*(-f)\\
        v^*(-t) \stackrel{\mathcal{F}}{\leftrightarrow} V^*(f)
      \end{aligned}
    \right\}
    \text{ Coniugazione}
    \]

  \item \textbf{Convoluzione nel dominio del tempo}
    \[
      \left[ v_1 \ast v_2 \right](t) \stackrel{\mathcal{F}}{\leftrightarrow} V_1(f) \cdot V_2(f)
    \] 

  \item \textbf{Traslazione nel dominio del tempo}
    \[
      v(t - \tau) \stackrel{\mathcal{F}}{\leftrightarrow} e^{-j 2 \pi f \tau} \cdot V(f)
    \] 

  \item \textbf{Traslazione nel dominio delle frequenze}
    \[
      e^{j 2 \pi f_0 t} \cdot v(t) \stackrel{\mathcal{F}}{\leftrightarrow} V(f - f_0)
    \]

  \item \textbf{Modulazione/Prodotto nel dominio del tempo}
    \[
      v_1(t) \cdot v_2(t) \stackrel{\mathcal{F}}{\leftrightarrow} \left[ V_1 \ast V_2 \right](f)
    \]
\end{enumerate}

\begin{example}
  Consideriamo il seguente sistema a blocchi:
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node (u) {$u(t)$};
      \node[right=of u,circle,draw,minimum size=0.7cm] (mul) {$X$};
      \node[below=of mul] (w) {$w(t)$};
      \node[right=of mul,draw,minimum size=1cm] (h) {$h(t)$};

      \draw[->] (u) -- (mul);
      \draw[->] (w) -- (mul);
      \draw[->] (mul) -- (h) node[midway,above] {$\color{blue}a(t)$};
      \draw[->] (h) -- ++(1.5,0) node[midway,above] {$\color{blue}b(t)$};

      \node[pin={[align=center,scale=0.8]above:{Convoluzione nelle frequenze/\\Prodotto nel tempo}}]
        at (mul.north) {};
      \node[pin={[align=center,scale=0.8,xshift=0.4cm]below:{Prodotti nelle frequenze/\\Convoluzioni nel tempo}}]
        at (h.south) {};
    \end{tikzpicture}
    \caption{Sistema a blocchi}
  \end{figure}
  \noindent
  Vogliamo capire come si comporta questo segnale nelle frequenze ($a(t)$) e cosa succede quando
  viene alterato dalla sequenza degli operatori ($b(t)$).
  \[
    \begin{aligned}
      u(t) &= 3 \cdot \cos(6 \pi t) + \cos(2 \pi t)\\
      w(t) &= 2 \cdot \cos(4 \pi t) \\
      h(t) &= 4 \cdot sinc(4t)\\
      \color{blue}b(t) &= ?
    \end{aligned}
  \] 
  Possiamo risolvere in maniera grafica questo problema:
  \begin{enumerate}
    \item Applichiamo le trasformate di Fourier per andare nel dominio delle frequenze:
      \[
      \text{Trasformata notevole: } A \cos(2 \pi f_0 t) = \frac{A}{2} \left( \delta(f - f_0) + \delta(f + f_0) \right)
      \] 
      \[
        \begin{aligned}
          3 \cdot \cos(2 \pi \cdot 3 \cdot t) \stackrel{\mathcal{F}}{=} \frac{3}{2} \left( \delta(f - 3) + \delta(f + 3) \right)\\
          \cos(2 \pi \cdot t) \stackrel{\mathcal{F}}{=} \frac{1}{2} \left( \delta(f - 1) + \delta(f + 1) \right)\\
          U(f) = \frac{3}{2} \left( \delta(f - 3) + \delta(f + 3) \right) + \frac{1}{2} \left( \delta(f - 1) + \delta(f + 1) \right)
        \end{aligned}
      \] 
      \vspace{1em}
      \noindent
      \[
      W(f) = \frac{2}{2} \left( \delta(f - 2) + \delta(f + 2) \right) 
      = \delta(f - 2) + \delta(f + 2)
      \] 
      \vspace{1em}
      \noindent
      \[
        \text{Trasformata notevole: } AT sinc(tT) = A \Pi\left(\frac{f}{T}\right)
      \] 
      \[
        H(f) = 1 \cdot \Pi(\frac{f}{4}) = \Pi(\frac{f}{4})
      \] 

    \item Disegnamo tutti i singoli elementi su un grafico:
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          \begin{axis}[
            width=0.8\textwidth,
            height=0.4\textwidth,
            xlabel = $f$,
            ylabel = $U(f)$,
            xmin= -6, xmax=6,
            ymin= 0, ymax = 3,
            xtick = {-3,-1,1,3},
            ytick = {1/2,3/2},
            yticklabels = {$\frac{1}{2}$,$\frac{3}{2}$},
            axis lines = middle,
            ]
            \addplot[-latex,blue,thick] coordinates {
                (-3,0) (-3,3/2)
              };
            \addplot[-latex,blue,thick] coordinates {
                (-1,0) (-1,1/2)
              };
            \addplot[-latex,blue,thick] coordinates {
                (1,0) (1,1/2)
              };
            \addplot[-latex,blue,thick] coordinates {
                (3,0) (3,3/2)
              };
          \end{axis}
        \end{tikzpicture}
        \caption{Segnale \(U(f)\)}
      \end{figure}

      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          \begin{axis}[
            width=0.8\textwidth,
            height=0.4\textwidth,
            xlabel = $f$,
            ylabel = $W(f)$,
            xmin= -6, xmax=6,
            ymin= 0, ymax = 3,
            xtick = {-2,2},
            ytick = {1},
            axis lines = middle,
            ]
            \addplot[-latex,green!50!black,thick] coordinates {
                (-2,0) (-2,1)
              };
            \addplot[-latex,green!50!black,thick] coordinates {
                (2,0) (2,1)
              };
          \end{axis}
        \end{tikzpicture}
        \caption{Segnale \(W(f)\)}
      \end{figure}

      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          \def\T{4}
          \def\A{1}
          \begin{axis}[
            width=0.8\textwidth,
            height=0.4\textwidth,
            xlabel = $f$,
            ylabel = $H(f)$,
            xmin= -6, xmax=6,
            ymin= 0, ymax = 3,
            xtick = {-2,2},
            xticklabels = {$\underset{-\frac{T}{2}}{-2}$,$\underset{\frac{T}{2}}{2}$},
            ytick = {1},
            yticklabel style = {above left},
            axis lines = middle,
            declare function ={ 
              rect(\x) = 
              (abs(\x) > \T/2) * 0 +
              (abs(\x) == \T/2) * 0 +
              (abs(\x) < (\T/2)-0.0001) * \A
            ;},
            ]
            \addplot[magenta,thick,domain=-\T/2:\T/2,samples=100]{rect(x)};
          \end{axis}
        \end{tikzpicture}
        \caption{Segnale \(H(f)\)}
      \end{figure}

    \item Calcoliamo la convoluzione tra \( U(f) \) e \( W(f) \) per trovare \( A(f) \) :
      \vspace{1em}
      \noindent
      Eseguiamo la convoluzione tra \( U(f) \) e \( W(f) \) fissando un segnale e
      spostare l'altro specchiato. A livello più alto il segnale che si muove viene replicato
      ogni volta che l'asse centrale corrisponde con il segnale fermo:
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          \begin{axis}[
            width=0.8\textwidth,
            height=0.4\textwidth,
            xlabel = $f$,
            ylabel = $\color{blue}U(f)\color{black} \ast \color{green!50!black}W(f)$,
            xmin= -6, xmax=6,
            ymin= 0, ymax = 3,
            xtick = {-5,-3,-1,1,3,5},
            ytick = {1/2,1,3/2,2},
            yticklabels = {$\frac{1}{2}$,1,$\frac{3}{2}$,2},
            axis lines = middle,
            ]


            \addplot[-latex,green!50!black,thick] coordinates {
                (-5,0) (-5,3/2)
              };
            \addplot[-latex,green!50!black,thick] coordinates {
                (-3,0) (-3,1/2)
              };
            \addplot[-latex,green!50!black,thick] coordinates {
                (-1,0) (-1,3/2)
              };
            \addplot[-latex,green!50!black,thick] coordinates {
                (-1,3/2) (-1,3/2+1/2) 
              };
            \addplot[-latex,green!50!black,thick] coordinates {
                (1,0) (1,1/2)
              };
            \addplot[-latex,green!50!black,thick] coordinates {
                (1,1/2) (1,1/2+3/2)
              };
            \addplot[-latex,green!50!black,thick] coordinates {
                (3,0) (3,1/2)
              };
            \addplot[-latex,green!50!black,thick] coordinates {
                (5,0) (5,3/2)
              };

            \addplot[-latex,blue,thin,dashed] coordinates {
                (-3,0) (-3,3/2)
              };
            \addplot[-latex,blue,thin,dashed] coordinates {
                (-1,0) (-1,1/2)
              };
            \addplot[-latex,blue,thin,dashed] coordinates {
                (1,0) (1,1/2)
              };
            \addplot[-latex,blue,thin,dashed] coordinates {
                (3,0) (3,3/2)
              };
          \end{axis}
        \end{tikzpicture}
        \[
          \Downarrow
        \] 
        \begin{tikzpicture}
          \begin{axis}[
            width=0.8\textwidth,
            height=0.4\textwidth,
            xlabel = $f$,
            ylabel = $A(f)$,
            xmin= -6, xmax=6,
            ymin= 0, ymax = 3,
            xtick = {-5,-3,-1,1,3,5},
            ytick = {1/2,3/2,2},
            yticklabels = {$\frac{1}{2}$,$\frac{3}{2}$,2},
            axis lines = middle,
            ]
            \addplot[-latex,red,thick] coordinates {
                (-5,0) (-5,3/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (-3,0) (-3,1/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (-1,0) (-1,3/2+1/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (1,0) (1,1/2+3/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (3,0) (3,1/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (5,0) (5,3/2)
              };
          \end{axis}
        \end{tikzpicture}
        \caption{Segnale \(A(f)\)}
      \end{figure}
      \noindent
      Le altezze dei nuovi segnali replicati saranno la moltiplcazione dei segnali
      che si sovrappongono sommata alle altezze dei diversi segnali che si sovrappongono
      nello stesso punto.

    \item Calcoliamo il prodotto tra \( A(f) \) e \( H(f) \) per trovare \( B(f) \):
      \vspace{1em}
      \noindent
      \begin{figure}[H]
        \centering
        \begin{tikzpicture}
          \def\T{4}
          \def\A{1}
          \begin{axis}[
            width=0.8\textwidth,
            height=0.4\textwidth,
            xlabel = $f$,
            ylabel = $\color{red}A(f)\color{black}\cdot \color{magenta}H(f)$,
            xmin= -6, xmax=6,
            ymin= 0, ymax = 3,
            xtick = {-5,-3,-2,-1,1,2,3,5},
            ytick = {1/2,1,3/2,2},
            yticklabels = {$\frac{1}{2}$,,$\frac{3}{2}$,2},
            axis lines = middle,
            declare function ={ 
              rect(\x) = 
              (abs(\x) > \T/2) * 0 +
              (abs(\x) == \T/2) * 0 +
              (abs(\x) < (\T/2)-0.0001) * \A
            ;},
            ]
            \addplot[-latex,red,thick] coordinates {
                (-5,0) (-5,3/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (-3,0) (-3,1/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (-1,0) (-1,3/2+1/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (1,0) (1,1/2+3/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (3,0) (3,1/2)
              };
            \addplot[-latex,red,thick] coordinates {
                (5,0) (5,3/2)
              };

            \addplot[magenta,thick,domain=-\T/2:\T/2,samples=100]{rect(x)};
          \end{axis}
        \end{tikzpicture}
        \[
          \Downarrow
        \] 
        \begin{tikzpicture}
          \def\T{4}
          \def\A{1}
          \begin{axis}[
            width=0.8\textwidth,
            height=0.4\textwidth,
            xlabel = $f$,
            ylabel = $B(f)$,
            xmin= -6, xmax=6,
            ymin= 0, ymax = 3,
            xtick = {-1,1},
            ytick = {2},
            axis lines = middle,
            ]
            \addplot[-latex,orange,thick] coordinates {
                (-1,0) (-1,3/2+1/2)
              };
            \addplot[-latex,orange,thick] coordinates {
                (1,0) (1,1/2+3/2)
              };
          \end{axis}
        \end{tikzpicture}
        \caption{Segnale \(B(f)\)}
      \end{figure}
  \end{enumerate}
\end{example}

\end{document}

