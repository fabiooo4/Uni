\documentclass[a4paper]{article}
\usepackage{import}
\input{../../preamble.sty}

\begin{document}

\input{title.tex}

\tableofcontents
\pagebreak

\section{Introduzione}
Le basi di dati sono raccolte di dati strutturati, organizzati in modo tale da permettere
un facile accesso. Questi dati sono persistenti, ovvero rimangono memorizzati anche dopo
la chiusura del programma che li ha creati.

\section{Sistema informativo}
Un sistema informativo è l'insieme delle attività umane e dei dispositivi di memorizzazione
ed elaborazione che organizza e gestisce l'informazione di interesse per un organizzazione
di dimensioni qualsiasi. Non contiene necessariamente dati memorizzati in un computer.

Un sistema informativo è composto da:
\begin{itemize}
  \item \textbf{Dato}: è l'elemento di conoscenza di base costituito da simboli che devono
    essere elaborati
  \item \textbf{Informazione}: è l'interpretazione dei dati che permette di ottenere una
    conoscenza più o meno esatta di fatti e situazioni
\end{itemize}


\subsection{Base di dati}
\begin{definition}
  Una \textbf{base di dati} è una \textbf{collezione di dati persistenei} utilizzati per
  rappresentare \textbf{con tecnologia informatica} le informazioni di interesse per un
  \textbf{sistema informativo}
\end{definition}
La soluzione convenzionale per la gestione dei dati è l'uso di file, ma questa presenta
alcuni problemi:
\begin{itemize}
  \item Scarsa efficienza nell'accesso ai dati (accesso sequenziale)
  \item Ridondanza nei dati
  \item Inconsistenza nei dati (aggiornamenti parziali)
  \item Progettazione dei dati replicata per ogni applicazione
\end{itemize}
Per risolvere questi problemi si è creato un livello di astrazione maggiore tra le
applicazioni e il filesystem, ovvero il \textbf{Data Base Management System (DBMS)}.

\begin{definition}
  Un \textbf{DBMS} è un sistema che gestisce su \textbf{memoria secondaria} collezioni
  di dati (chiamate "basi di dati"). Le caratteristiche principali sono:
  \begin{itemize}
    \item Grandi
    \item Condivise, cioè accessibili da più utenti
    \item Persistenti
  \end{itemize}
  Un DBMS assicura:
  \begin{itemize}
    \item Affidabilità, cioè nessuna perdita di dati
    \item Privatezza
    \item Accesso efficiente
  \end{itemize}
\end{definition}

\subsubsection{Modello dei dati}
Un \textbf{modello dei dati} è un insieme di strutture che permettono di descrivere
una base di dati. Per accedere a questi dati si usano delle \textbf{interrogazioni},
cioè delle richieste, in un linguaggio dichiarativo specifico, che permettono di ottenere
i dati desiderati.

Ci sono diversi linguaggi per interagire con un DBMS:
\begin{itemize}
  \item Linguaggio per la definizione dei dati (DDL), consente di definire la struttura
    della base di dati
  \item Linguaggio per l'interrogazione e aggiornamento dei dati (DML), consente
    di interrogare e aggiornare i dati
    \begin{itemize}
      \item Linguaggio di interrogazione: estrae informazioni da una base di dati,
        ad esempio SQL, algèbre relazionale, calcolo relazionale
      \item Linguaggio di manipolazione: popola la base di dati, modifica il suo contenuto
        con aggiunge, cancellazioni e variazioni sui dati, ad esempio SQL
    \end{itemize}
\end{itemize}

Il modello di dati è un insisme di \textbf{costrutti} forniti dal DBMS per descrivere la
struttura e le proprietà dell'informazione contenute in una base di dati.

Ci sono diversi tipi di modelli di dati:
\begin{itemize}
  \item \textbf{Modelli di dati del passato}:
    \begin{itemize}
      \item Modello reticolare
      \item modello gerarchico
    \end{itemize}

  \item \textbf{Modelli di dati attuali}:
    \begin{itemize}
      \item Modello relazionale
      \item Modello ad oggetti
      \item Modello a oggetti-relazionale
      \item Modello basato su documenti (JSON)
      \item Modelli NoSQL
    \end{itemize}
\end{itemize}

I modelli vengono utilizzati per creare:
\begin{itemize}
  \item \textbf{Schema di una base di dati}: è la descrizione della struttura e delle
    proprietà di una specifica base di dati fatta utilizzando i costrutti del modello dei
    dati (lo schema di una base di dati è invariante nel tempo)
  \item \textbf{Istanza di una base di dati}: è costituita dai \textbf{valori effettivi}
    che in un certo istante popolano le strutture dati (l'istanza di una base di dati
    varia nel tempo)
\end{itemize}

Lo schema di una base di dati è diviso in tre livelli:
\begin{itemize}
  \item \textbf{Schema esterno}: è la visione dell'utente della base di dati, cioè la
    parte di base di dati che interessa a un particolare utente o gruppo di utenti
  \item \textbf{Schema logico}: è la visione globale della base di dati, cioè la
    struttura logica della base di dati che descrive tutti i dati e le relazioni tra
    essi
  \item \textbf{Schema interno}: è la rappresentazione fisica della base di dati, cioè
    il modo in cui i dati sono effettivamente memorizzati nella memoria secondaria
\end{itemize}
Le proprietà dello schema sono:
\begin{itemize}
  \item \textbf{Indipendenza fisica}: lo schema logico della base di dati è completamente
    indipendente dallo schema interno
  \item \textbf{Indipendenza logica}: gli schemi esterni della base di dati sono
    indipendenti dallo schema logico
\end{itemize}

\section{Progettazione di una base di dati}
Il ciclo di vita di un processo di automazione di un sistema informativo è diviso in diverse
fasi:
\begin{itemize}
  \item \textbf{Studio di fattibilità}: si valuta se l'automazione del sistema
    informativo è possibile e conveniente
  \item \textbf{Raccolta e analisi dei requisiti}: si individuano proprietà e funzionalità
    del sistema (dati e applicazioni) producendo una descrizione completa ma informale
  \item \textbf{Progettazione}: si produce una descrizione formale del sistema
    informativo
\end{itemize}
La progettazione si divide in due parti principali che vanno di pari passo:
\begin{itemize}
  \item \textbf{Progettazione dei dati}: si produce una descrizione formale dei dati
    (schema). Una volta progettati i dati vengono implementati in un DBMS
  \item \textbf{Progettazione delle applicazioni}: si produce una descrizione formale
    delle applicazioni (specifica)
\end{itemize}
Una volta implementati i dati e le applicazioni si passa alla fase di \textbf{validazione
e collaudo}

\subsection{Progettazione dei dati}
Una metodologia di progettazione dei dati è costituita da:
\begin{itemize}
  \item \textbf{Decomposizione}: dividere in passi le attività di progetto
  \item \textbf{Strategie}: individuare un insieme di strategie e criteri di scelta da
    seguire
  \item \textbf{Modelli di riferimento}: utilizzare modelli di dati e tecniche di
    progettazione consolidate
\end{itemize}
Una buona metodologia deve essere:
\begin{itemize}
  \item Generale
  \item Facile da usare
  \item Deve produrre un risultato di qualità
\end{itemize}

\subsection{Requisiti}
\subsubsection{Progettazione concettuale}
La progettazione concettuale è la prima fase della progettazione dei dati. Lo scopo è
quello di produrre una descrizione formale dei dati (schema concettuale). Lo schema
deve essere \textbf{indipendente dall'implementazione}.

\vspace{1em}
\noindent
Non è solo un progetto intermedio, ma costituisce anche una porzione del risultato finale
perchè rappresenta una descrizione di \textbf{alto livello} del contenuto della base di
dati, comprensibile anche per utenti poco esperti.

\subsubsection{Progettazione logica}
La progettazione logica è la seconda fase della progettazione dei dati. Lo scopo è
quello di tradurre lo schema concettuale in uno schema logico in modo da poterlo
utilizzare su un sistema specifico. Lo schema logico infatti è dipendente dalle
tecnologie utilizzate. Bisogna tenere anche in considerazione le operazioni più
frequenti che le applicazioni effettueranno sulla base di dati.

\subsubsection{Progettazione fisica}
La progettazione fisica è la terza fase della progettazione dei dati. L'obiettivo è quello
di ottimizzare l'accesso ai dati completando lo schema logico con i parametri relativi
alla memorizzazione fisica dei dati e con gli opportuni metodi d'accesso (\textbf{indici}).

\section{Modello Entità-Relazione}
È un modello, formale e non ambiguo, utilizzato per la progettazione concettuale di una
base di dati. Fornisce strumenti formali (costrutti), con sintassi grafica, per specificare la
struttura e le proprietà dei dati da rappresentare indipendentemente dalla tecnologia.

\vspace{1em}
\noindent
Ogni costrutto viene definito specificando:
\begin{itemize}
  \item Il suo significato (o semantica)
  \item La sua sintassi grafica
  \item La rappresentazione delle sue istanze (o occorrenze)
\end{itemize}

\vspace{1em}
\noindent
Progettare indipendentemente dalle tecnologie significa:
\begin{itemize}
  \item \textbf{Non considerare} eventuali ottimizzazioni
  \item \textbf{Considerare} tutti i requisiti senza semplificazioni o convenzioni
  \item \textbf{Considerare} sempre i processi di generazione e modifica dei dati
    per verificare che ogni situazione sia rappresentabile da un'istanza "pulita"
    della base di dati
\end{itemize}

\subsection{Entità}
Un'entità \( E \) rappresenta una \textbf{classe di oggetti} che hanno le seguenti
caratteristiche:
\begin{itemize}
  \item \textbf{Proprietà comuni}
  \item \textbf{Eistenza autonoma} rispetto ad altre classi di oggetti
  \item \textbf{Identificazione univoca}, cioè esiste una chiara corrispondenza tra
    gli oggetti istanze di entità e concetti istanziati nel sistema informativo
\end{itemize}
Un entità si rappresenta con un rettangolo che contiene il nome dell'entità:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=3cm, minimum height=1cm ]
      (E) {Entità \( E \)};
  \end{tikzpicture}
  \caption{Rappresentazione grafica di un'entità}
\end{figure}

\subsubsection{Istanza}
Un'istanza dell'entità \( E \) è un \textbf{oggetto} appartenente alla classe rappresentata
da \( E \). Si indica con \( I(E) \) l'insieme delle istanze di \( E \) che esistono
nella base di dati in un certo istante e alla creazione della base di dati è vuota:
\( I(E) = \emptyset \).

\begin{example}
  Rappresentiamo con il costrutto entità il concetto di \textbf{persona}. Bisogna gestire
  nella base di dati le informazioni che descrivono un gruppo di persone.
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[draw, rectangle, minimum width=3cm, minimum height=1cm ]
        (E) {Persona};
    \end{tikzpicture}
    \caption{Rappresentazione grafica dell'entità Persona}
  \end{figure}
  L'insieme delle istanze dell'entità Persona è il seguente:
  \[
    I(\text{Persona}) = \{p_1, p_2, p_3, \ldots\}
  \]
\end{example}

\subsection{Relazione}
Una relazione \( R \) rappresenta un \textbf{legame logico} tra \textbf{due o più} entità.
Può esserci anche una relazione all'entità stessa (relazione ricorsiva).

\vspace{1em}
\noindent
Una relazione si rappresenta nello schema con un rombo a cui si collegano attraverso delle
linee le entità coinvolte nella relazione. Il nome della relazione viene scritto a fianco
al rombo:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
      (E1) {Entità \( E \)};
    \node[draw, diamond, minimum width=0.7cm, minimum height=0.7cm, right=1cm of E1]
      (R) {};
    \node[below=0.3cm] at (R) {Relazione \( R \)};
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm, right=1cm of R]
      (E2) {Entità \( F \)};
    \draw (E1) -- (R);
    \draw (E2) -- (R);
  \end{tikzpicture}
  \caption{Rappresentazione grafica di una relazione tra due entità}
\end{figure}

\subsubsection{Istanza}
Data una relazione \( R \) tra \( n \) entità \( E_1, \ldots, E_n \) un'istanza della
relazione \( R \) è una \textbf{ennupla di istanze di entità}:
\[
  (e_1, \ldots, e_n) \; \text{dove } e_i \in I(E_i) \text{ per } 1 \le i \le n
\] 
La popolazione di \( R \) rappresenta l'insieme delle coppie di istanze delle entità
\( E \) e \( F \) che sono in relazione in un certo istante:
\[
  I(R) = \left\{ (e_i, f_j) \;\left|\; e_i \in I(E), f_j \in I(F) \right.\right\} 
\]
\begin{example}
  Supponiamo che nello schema ci siano le entità \textbf{Persona} e \textbf{Comune},
  bisogna gestire la \textbf{Residenza} delle persone nei comuni italiani.

  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
        (E1) {Persona};
      \node[draw, diamond, minimum width=0.7cm, minimum height=0.7cm, right=1cm of E1]
        (R) {};
      \node[below=0.3cm] at (R) {Residenza};
      \node[draw, rectangle, minimum width=2cm, minimum height=1cm, right=1cm of R]
        (E2) {Comune};
      \draw (E1) -- (R);
      \draw (E2) -- (R);
    \end{tikzpicture}
    \caption{Rappresentazione grafica della relazione Residenza}
  \end{figure}
  \noindent
  Ciò implica che per esistere un'istanza di residenza devono esistere un'istanza
  di persona e un'istanza di comune.
\end{example}
Data una relazione \( R \) tra \( n \) entità \( \{E_1, E_2, \ldots, E_n\} \)
vale \textbf{sempre} la seguente proprietà sull'insieme delle istanze \( I(R) \):
\[
  I(R) \subseteq I(E_1) \times I(E_2) \times \ldots \times I(E_n)
\] 
La conseguenza di questa proprietà è che non è possibilie rappresentare la stessa ennupla
più volte.

\subsubsection{Relazione ricorsiva}
È una relazione binaria sulla stessa entità:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
      (E) {Entità \( E \)};
    \node[draw, diamond, minimum width=0.7cm, minimum height=0.7cm, above right=1cm of E]
      (R) {};
    \node[above=0.3cm] at (R) {Relazione \( R \)};

    \draw (E) |- (R);
    \draw (E) -| (R);
  \end{tikzpicture}
  \caption{Rappresentazione grafica di una relazione ricorsiva}
\end{figure}

\subsection{Attributo}
Rappresenta una proprietà elementare di un'entità o di una relazione.
Ogni attributo di un'entità o di una relazione associa ad ogni istanza \textbf{un solo}
valore appartenente ad un dominio di valori ammissibili. Può essere visto
come una funzione che ha come dominio le istanze dell'entità (o relazione) e come
codominio l'insieme dei valori ammissibili:
\[
  f_A: I(E) \mapsto D
\] 
dove \( a \) è un attributo dell'entità \( E \), mentre \( I(E) \) l'insieme delle
istanze di \( E \) e \( D \) è l'insieme dei valori ammissibili.

\vspace{1em}
\noindent
La sintassi grafica di un attributo è un cerchio \textbf{vuoto} collegato con una linea all'entità
con accanto il nome dell'attributo:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
      (E) {Entità \( E \)};
    \node[draw, circle, scale=0.7, right=0.5cm of E]
      (A) {};
    \node[right=0.1cm] at (A) {\( A \)};
    \draw (E) -- (A);
  \end{tikzpicture}
  \caption{Rappresentazione grafica di un attributo di un'entità}
\end{figure}

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, diamond, minimum width=0.7cm, minimum height=0.7cm ]
      (E) {};
    \node[below=0.3cm] at (E) {Relazione \( R \)};
    \node[draw, circle, scale=0.7, right=0.5cm of E]
      (A) {};
    \node[right=0.1cm] at (A) {\( A \)};
    \draw (E) -- (A);
  \end{tikzpicture}
  \caption{Rappresentazione grafica di un attributo di una relazione}
\end{figure}

\begin{example}
  Rappresentiamo il concetto di persona tramite un'entità, bisogna gestire nella base
  di dati il nome e il cognome di un gruppo di persone.
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
        (E) {Persona};
      \node[draw, circle, scale=0.7, yshift=0.4cm, right=0.5cm of E]
        (A1) {};
      \node[right=0.1cm] at (A1) {Nome};
      \node[draw, circle, scale=0.7, yshift=-0.4cm, right=0.5cm of E]
        (A2) {};
      \node[right=0.1cm] at (A2) {Cognome};
      \draw (A1) -- +(-0.65cm,0);
      \draw (A2) -- +(-0.65cm,0);
    \end{tikzpicture}
    \caption{Rappresentazione grafica dell'entità Persona con gli attributi Nome e Cognome}
  \end{figure}
\end{example}

\subsubsection{Attributo opzionale e multivalore}
L'attributo opzionale o multivalore si ottiene da un attributo normale specificando un vincolo
di cardinalità (spiegato più avanti per le relazioni \ref{Cardinalità}) sui valori che
l'attributo può assumere (il default è (1,1)). I valori possibili sono i seguenti:
\begin{itemize}
  \item (0,1): attributo opzionale
  \item (1,N): attributo multivalore obbligatorio
  \item (0,N): attributo multivalore opzionale
\end{itemize}

\vspace{1em}
\noindent
La sintassi grafica per rappresentare un attributo opzionale o multivalore è la seguente:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
      (E) {Entità \( E \)};
    \node[draw, circle, scale=0.7, right=1.3cm of E]
      (A) {};
    \node[right=0.1cm] at (A) {\( A \)};
    \draw (E) -- node[midway, above, scale=0.8] {(min,max)} (A);

  \end{tikzpicture}
  \caption{Rappresentazione grafica di un attributo opzionale o multivalore}
\end{figure}

\subsubsection{Attributo composto}
Permette di raggruppare gli attributi di un'entità o di una relazione che hanno un significato
comune.

\vspace{1em}
\noindent
La sintassi grafica per rappresentare un attributo composto è la seguente:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1.5cm ]
      (E) {Entità \( E \)};
    \node[draw, circle, scale=0.7, right=1.3cm of E]
      (B) {};
    \node[right=0.1cm] at (B) {\( B \)};
    \draw (B) -- +(-0.58cm,0);

    \node[draw, circle, scale=0.7, above=0.2cm of B]
      (A) {};
    \node[right=0.1cm] at (A) {\( A \)};
    \draw (A) -- +(-0.62cm,0);

    \node[draw, circle, scale=0.7, below=0.2cm of B]
      (C) {};
    \node[right=0.1cm] at (C) {\( C \)};
    \draw (C) -- +(-0.62cm,0);

    \node[draw, ellipse, minimum height=1.3cm, right=0.5cm of E] (comp) {};

    \draw (E) -- (comp);
  \end{tikzpicture}
  \caption{Rappresentazione grafica di un attributo composto}
\end{figure}

\subsection{Identificatore}
Data un'entità \( E \), un identificatore è un insieme di proprietà (attributi e/o relazioni)
che \textbf{identificano univocamente} ogni istanza di \( E \). Un insieme di proprietà
identifica univocamente le istanze di un'entità \( E \) se \textbf{non esistono} due
istanze di \( E \) che presentano gli stessi valori o istanze nelle proprietà dell'insieme.

\vspace{1em}
\noindent
La sintassi grafica di un identificatore per un'entità con un solo attributo \( a \) è
la seguente:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
      (E) {Entità \( E \)};
    \node[draw, circle, scale=0.7, fill, right=0.5cm of E]
      (A) {};
    \node[right=0.1cm] at (A) {\( A \)};
    \draw (E) -- (A);
  \end{tikzpicture}
  \caption{Rappresentazione grafica di un identificatore con un solo attributo}
\end{figure}
\noindent
Per un identificatore costituito da più attributi \( a, b \) la sintassi grafica è la seguente:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
      (E) {Entità \( E \)};
    \node[draw, circle, scale=0.7, yshift=0.5cm, right=0.5cm of E]
      (A) {};
    \node[right=0.1cm] at (A) {\( A \)};
    \draw (A) -- +(-0.65cm,0);

    \node[draw, circle, scale=0.7, below=0.5cm of A]
      (B) {};
    \node[right=0.1cm] at (B) {\( B \)};
    \draw (B) -- +(-0.65cm,0);

    \node[draw, circle, scale=0.7, fill, above left=0.2cm of A]
      (I) {};
    \draw (I) -- +(0,-1.3cm);
  \end{tikzpicture}
  \caption{Rappresentazione grafica di un identificatore con più attributi}
\end{figure}
\noindent
Può anche esistere un identificatore costituito da una relazione \( R \) (deve essere
una funzione):
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
      (E1) {Entità \( E \)};
    \node[draw, diamond, minimum width=0.7cm, minimum height=0.7cm, right=1cm of E1]
      (R) {};
    \node[below=0.3cm] at (R) {Relazione \( R \)};
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm, right=1cm of R]
      (E2) {\( \ldots \)};
    \draw (E1) -- (R);
    \draw (E2) -- (R);

    \node[draw, circle, scale=0.7, yshift=0.5cm, right=0.5cm of E1]
      (A) {};
    \node[right=0.1cm] at (A) {\( A \)};
    \draw (A) -- +(-0.65cm,0);

    \node[draw, circle, scale=0.7, fill, above left=0.2cm of A]
      (I) {};
    \draw (I) -- +(0,-1.3cm);
  \end{tikzpicture}
  \caption{Rappresentazione grafica di un identificatore costituito da un attributo e una relazione}
\end{figure}
\noindent
Oppure un identificatore può essere costituito soltanto da una relazione \( R \):
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
      (E1) {Entità \( E \)};
    \node[draw, diamond, minimum width=0.7cm, minimum height=0.7cm, right=1cm of E1]
      (R) {};
    \node[below=0.3cm] at (R) {Relazione \( R \)};
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm, right=1cm of R]
      (E2) {\( \ldots \)};
    \draw (E1) -- (R);
    \draw (E2) -- (R);

    \node[draw, circle, scale=0.7, fill, above left=0.2cm of A]
      (I) {};
    \draw (I) -- +(0,-1.3cm);
  \end{tikzpicture}
  \caption{Rappresentazione grafica di un identificatore costituito da una relazione}
\end{figure}
\noindent
Ci sono due tipi di identificatori:
\begin{itemize}
  \item \textbf{Identificatori interni}: sono costituiti solo da attributi dell'entità
  \item \textbf{Identificatori esterni}: sono costituiti da almeno una relazione
    con un'altra entità
\end{itemize}

\vspace{1em}
\noindent
\textbf{Attenzione}: Non esistono identificatori sulle relazioni perchè ogni relazione
è già univocamente identificata dalle istanze delle entità coinvolte.

\begin{example}
  Rappresentiamo il concetto di persona tramite un'entità, bisogna gestire nella base
  di dati il codice fiscale, il nome, il cognome e la data di nascita di un gruppo
  di persone
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
        (E1) {Persona};
      \node[draw, circle, scale=0.7, yshift=0.6cm, right=0.5cm of E1]
        (nome) {};
      \node[right=0.1cm] at (nome) {Nome};
      \draw (nome) -- +(-0.65cm,0);

      \node[draw, circle, scale=0.7, yshift=0cm, right=0.5cm of E1]
        (cognome) {};
      \node[right=0.1cm] at (cognome) {Cognome};
      \draw (cognome) -- +(-0.65cm,0);

      \node[draw, circle, scale=0.7, yshift=-0.6cm, right=0.5cm of E1]
        (data_nascita) {};
      \node[right=0.1cm] at (data_nascita) {Data di nascita};
      \draw (data_nascita) -- +(-0.65cm,0);

      \node[draw, circle, scale=0.7, fill, above left=0.2cm of A]
        (I) {};
      \draw (I) -- +(0,-1.3cm);

      \node[draw, circle, fill, scale=0.7, below=0.5cm of E1]
        (fiscale) {};
      \node[right=0.1cm] at (fiscale) {Codice fiscale};
      \draw (fiscale) -- +(0,0.65cm);
    \end{tikzpicture}
    \caption{Esempio di identificatore interno}
  \end{figure}
\end{example}

\begin{definition}
  Un \textbf{vincolo di identificazione} limita la popolazione di un'entità impedendo
  l'esistenza di due istanze con gli stessi valori nelle proprietà che costituiscono
  l'identificatore.

  \vspace{1em}
  \noindent
  La scelta dell'identificatore va sempre fatta considerando le proprietà significative
  per il sistema informativo. A \textbf{livello concettuale} è quindi da \textbf{evitare}
  l'introduzione di nuovi attributi identificatori (ad esempio l'ID).
\end{definition}

\subsection{Cardinalità}\label{Cardinalità}
Tra due relazioni esistono dei vincoli di cardinalità che limitano il numero di istanze
di una entità che possono essere in relazione con una singola istanza dell'altra entità.
Data una relazione \( R \) i vincoli di cardinalità vengono specificati per ogni entità
\( E_i \) coinvolta nella relazione \( R \) e specificano il numero \textbf{minimo} e
\textbf{massimo} di istanze di \( R \) a cui un istanza di \( E_j \) deve o può 
partecipare.

\vspace{1em}
\noindent
La sintassi grafica per rappresentare i vincoli di cardinalità è la seguente:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
      (E1) {Entità \( E \)};
    \node[draw, diamond, minimum width=0.7cm, minimum height=0.7cm, right=2cm of E1]
      (R) {};
    \node[below=0.3cm] at (R) {Relazione \( R \)};
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm, right=2cm of R]
      (E2) {Entità \( F \)};
    \draw (E1) -- node[midway, above, scale=0.8] {\( (min_1, max_1) \)} (R);
    \draw (E2) -- node[midway, above, scale=0.8] {\( (min_2, max_2) \)} (R);
  \end{tikzpicture}
  \caption{Rappresentazione grafica dei vincoli di cardinalità}
\end{figure}

\subsubsection{Valori possibili per \texorpdfstring{\( \text{MIN}_i \)}{MIN\_i}}
I possibili valori che il minimo \( \text{MIN}_i \) può assumere sono:
\begin{itemize}
  \item 0: Indica che la partecipazione alla relazione \( R \) delle istanze di \( E_i \)
    è \textbf{opzionale}

  \item 1: Indica che la partecipazione alla relazione \( R \) delle istanze di \( E_i \)
    è \textbf{obbligatoria}

  \item \( num > 1 \): Indica che per ogni istanza di \( E_i \) devono essere presenti
    almeno \( num \) occorrenze della relazione \( R \) che la coinvolgono
\end{itemize}

\subsubsection{Valori possibili per \texorpdfstring{\( \text{MAX}_i \)}{MAX\_i}}
\begin{itemize}
  \item 1: Indica che un'istanza di \( E_i \) può \textbf{al massimo} partecipare a una
    sola occorrenza della relazione \( R \) (se \( R \) è binaria questo indica che \( R \)
    \textbf{è una funzione})

  \item \( N \): Indica che un'istanza di \( E_i \) può partecipare a più occorrenze
    della relazione \( R \) senza limite massimo

  \item \( num > 1 \): Indica che per ogni istanza di \( E_i \) possono essere presenti
    \textbf{al massimo} \( num \) occorrenze della relazione \( R \) che la coinvolgono
\end{itemize}

\begin{example}
  Rappresentiamo il concetto di persona e comune tramite due entità, bisogna gestire
  la residenza delle persone nei comuni italiani. Questi requisiti non rappresentano
  la realtà perchè una persona deve avere obbligatoriamente una residenza e può avere
  al massimo una residenza, mentre un comune può avere zero o più persone residenti.
  \begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[draw, rectangle, minimum width=2cm, minimum height=1cm ]
        (E1) {Persona};
      \node[draw, diamond, minimum width=0.7cm, minimum height=0.7cm, right=1.3cm of E1]
        (R) {};
      \node[below=0.3cm] at (R) {Residenza};
      \node[draw, rectangle, minimum width=2cm, minimum height=1cm, right=1.3cm of R]
        (E2) {Comune};
      \draw (E1) -- node[midway, above, scale=0.8] {\( (1, 1) \)} (R);
      \draw (E2) -- node[midway, above, scale=0.8] {\( (0, N) \)} (R);
    \end{tikzpicture}
    \caption{Esempio di Residenza con i vincoli di cardinalità}
  \end{figure}
\end{example}

\begin{definition}
  Una relazione \( R \) può partecipare ad un identificatore esterno di un'entità \( E \)
  \textbf{solo se} tale entità partecipa alla relazione \( R \) con vincolo di
  cardinalità \( (1, 1) \), quindi se \( R \) è una \textbf{funzione} che associa ad
  ogni istanza di \( E \) una e una sola istanza dell'altra entità coinvolta in \( R \).
  Questo vale anche quando \( R \) è la sola proprietà che partecipa all'identificatore.
\end{definition}

\vspace{1em}
\noindent
Si potrebbe utilizzare anche il diagramma UML per rappresentare i concetti del modello
Entità-Relazione, ma questa rappresentazione segue regole diverse, ad esempio la
posizione dove specificare nel diagramma UML i vincoli di cardinalità è invertita rispetto
all'ER.

\subsection{Generalizzazione di entità}
La generalizzazione è un legame logico (simile ad un'ereditarietà tra classi) tra un'entità
padre \( E \) e \( n \) \( (n > 0) \) entità figlie \( E_1, E_2, \ldots, E_n \) dove
\( E \) rappresenta una classe di oggetti più generale rispetto alle classi di oggetti
rappresentate dalle entità figlie.

\vspace{1em}
\noindent
La sintassi grafica per rappresentare una generalizzazione è la seguente:
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm]
      (E) {\( E \) };
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm, below left=1.3cm of E]
      (E1) {\( E_1 \) };
    \node[draw, rectangle, minimum width=2cm, minimum height=1cm, below right=1.3cm of E]
      (E2) {\( E_2 \) };

    \draw[-latex] (E1.north) -- +(0,0.5) -| (E);
    \draw (E2.north) -- +(0,0.5) -| (E);

    \node[below=1.3cm of E] {\( \ldots \)};
  \end{tikzpicture}
  \caption{Esempio di Residenza con i vincoli di cardinalità}
\end{figure}

\subsubsection{Proprietà delle istanze generalizzate}
\begin{itemize}
  \item Ogni istanza di un'entità figlia \( E_i \) è anche istanza dell'entità padre \( E \)
  \item Ogni proprietà (attributi, identificatori e relazioni) dell'entità padre \( E \)
    è anche proprietà di ogni entità figlia \( E_i \) 
\end{itemize}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw (0,0) circle(2cm) node[yshift=-1.5cm] {\( I(E_{\text{padre}}) \)};
    \draw (-0.8,0) circle(1cm) node
      {\( I(E_1) \)};
    \draw (0.8,0) circle(1cm) node
      {\( I(E_2) \)};
  \end{tikzpicture}
  \caption{Istanze di entità generalizzate}
\end{figure}

\subsubsection{Classificazione delle generalizzazioni}
Una generalizzazione può essere classificata secondo due criteri:
\begin{itemize}
  \item \textbf{Totale} se ogni istanza dell'entità padre \( E \) è anche istanza
    di \textbf{almeno una} delle entità figlie \( E_i \), altrimenti si dice
    \textbf{parziale}

  \item \textbf{Esclusiva} se ogni istanza dell'entità padre \( E \) è anche istanza
    di \textbf{al massimo una} delle entità figlie \( E_i \), altrimenti si dice
    \textbf{sovrapposta}
\end{itemize}

\vspace{1em}
\noindent
Per indicare la classificazione di una generalizzazione si mettono le seguenti
notazioni accanto alla freccia della generalizzazione:
\begin{itemize}
  \item (t,e): totale ed esclusiva
  \item (t,s): totale e sovrapposta
  \item (p,e): parziale ed esclusiva
  \item (p,s): parziale e sovrapposta
\end{itemize}

\end{document}
